cscope 15 $HOME/nautilus-NPB/src/test/openmp/NPB-NAS               0000805764
	@BT/bt.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
compu‹_rhs
();

55 
£t_cÚ¡ªts
();

56 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

57 
x_sŞve
();

58 
x_backsub¡™u‹
();

59 
x_sŞve_ûÎ
();

60 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

61 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

62 
cblock
[5][5]);

63 
bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]);

64 
bšvrhs
(
lhs
[5][5], 
r
[5]);

65 
y_sŞve
();

66 
y_backsub¡™u‹
();

67 
y_sŞve_ûÎ
();

68 
z_sŞve
();

69 
z_backsub¡™u‹
();

70 
z_sŞve_ûÎ
();

74 
´og¿m_BT
(*
__buf
, * 
__´iv
);

76 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

77 .
cmd
 = "nas-bt",

78 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

79 .
	ghªdËr
 = 
´og¿m_BT
,

81 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

85 
	$´og¿m_BT
(*
__buf
, * 
__´iv
) {

87 
n™”
, 
¡•
, 
n3
;

88 
Áh»ads
 = 1;

89 
Çvg
, 
mæİs
;

91 
tmax
;

92 
boŞ—n
 
v”if›d
;

93 
şass
;

101 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

117 
n™”
 = 
NITER_DEFAULT
;

118 
dt
 = 
DT_DEFAULT
;

119 
grid_pošts
[0] = 
PROBLEM_SIZE
;

120 
grid_pošts
[1] = 
PROBLEM_SIZE
;

121 
grid_pošts
[2] = 
PROBLEM_SIZE
;

124 
	`´štf
(" Size: %3dx%3dx%3d\n",

125 
grid_pošts
[0], grid_points[1], grid_points[2]);

126 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

128 ià(
grid_pošts
[0] > 
IMAX
 ||

129 
grid_pošts
[1] > 
JMAX
 ||

130 
grid_pošts
[2] > 
KMAX
) {

131 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

132 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

133 
	`ex™
(1);

136 
	`£t_cÚ¡ªts
();

138 
	`š™Ÿlize
();

139 
	`lhsš™
();

140 
	`exaù_rhs
();

146 
	`adi
();

148 
	`š™Ÿlize
();

150 
	`tim”_ş—r
(1);

151 
	`tim”_¡¬t
(1);

153 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

155 ià(
¡•
%20 == 0 || step == 1) {

156 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

158 
	`adi
();

161 #´agm¨
omp
 
·¿Î–


163 #ià
	`defšed
(
_OPENMP
)

164 #´agm¨
omp
 
ma¡”


165 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

167 
	`´štf
("Áh»ad %d\n",
Áh»ads
);

171 
	`tim”_¡İ
(1);

172 
tmax
 = 
	`tim”_»ad
(1);

174 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

176 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

177 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

178 iàĞ
tmax
 != 0.0 ) {

179 
mæİs
 = 1.0e-6*()
n™”
*

180 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

182 
mæİs
 = 0.0;

184 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

185 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

186 
tmax
, 
mæİs
, " floating…oint",

187 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

188 
CS6
, "(none)");

189 
	}
}

194 
	$add
() {

200 
i
, 
j
, 
k
, 
m
;

202 #´agm¨
omp
 

203 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

204 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

205 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

206 
m
 = 0; m < 5; m++) {

207 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

212 
	}
}

217 
	$adi
() {

218 #´agm¨
omp
 
·¿Î–


219 
	`compu‹_rhs
();

221 #´agm¨
omp
 
·¿Î–


222 
	`x_sŞve
();

224 #´agm¨
omp
 
·¿Î–


225 
	`y_sŞve
();

227 #´agm¨
omp
 
·¿Î–


228 
	`z_sŞve
();

230 #´agm¨
omp
 
·¿Î–


231 
	`add
();

232 
	}
}

237 
	$”rÜ_nÜm
(
rms
[5]) {

244 
i
, 
j
, 
k
, 
m
, 
d
;

245 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

247 
m
 = 0; m < 5; m++) {

248 
rms
[
m
] = 0.0;

251 
i
 = 0; i < 
grid_pošts
[0]; i++) {

252 
xi
 = ()
i
 * 
dnxm1
;

253 
j
 = 0; j < 
grid_pošts
[1]; j++) {

254 
‘a
 = ()
j
 * 
dnym1
;

255 
k
 = 0; k < 
grid_pošts
[2]; k++) {

256 
z‘a
 = ()
k
 * 
dnzm1
;

257 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

259 
m
 = 0; m < 5; m++) {

260 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

261 
rms
[
m
] =„ms[m] + 
add
*add;

267 
m
 = 0; m < 5; m++) {

268 
d
 = 0; d <= 2; d++) {

269 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

271 
rms
[
m
] = 
	`sq¹
(rms[m]);

273 
	}
}

278 
	$rhs_nÜm
(
rms
[5]) {

283 
i
, 
j
, 
k
, 
d
, 
m
;

284 
add
;

286 
m
 = 0; m < 5; m++) {

287 
rms
[
m
] = 0.0;

290 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

291 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

292 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

293 
m
 = 0; m < 5; m++) {

294 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

295 
rms
[
m
] =„ms[m] + 
add
*add;

301 
m
 = 0; m < 5; m++) {

302 
d
 = 0; d <= 2; d++) {

303 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

305 
rms
[
m
] = 
	`sq¹
(rms[m]);

307 
	}
}

313 
	$exaù_rhs
() {

315 #´agm¨
omp
 
·¿Î–


324 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

325 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

330 #´agm¨
omp
 

331 
i
 = 0; i < 
grid_pošts
[0]; i++) {

332 
j
 = 0; j < 
grid_pošts
[1]; j++) {

333 
k
 = 0; k < 
grid_pošts
[2]; k++) {

334 
m
 = 0; m < 5; m++) {

335 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

344 #´agm¨
omp
 

345 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

346 
‘a
 = ()
j
 * 
dnym1
;

348 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

349 
z‘a
 = ()
k
 * 
dnzm1
;

351 
i
 = 0; i < 
grid_pošts
[0]; i++) {

352 
xi
 = ()
i
 * 
dnxm1
;

354 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

355 
m
 = 0; m < 5; m++) {

356 
ue
[
i
][
m
] = 
d‹mp
[m];

359 
dp
 = 1.0 / 
d‹mp
[0];

361 
m
 = 1; m <= 4; m++) {

362 
buf
[
i
][
m
] = 
dp
 * 
d‹mp
[m];

365 
cuf
[
i
] = 
buf
[i][1] * buf[i][1];

366 
buf
[
i
][0] = 
cuf
[i] + buf[i][2] * buf[i][2] +

367 
buf
[
i
][3] * buf[i][3];

368 
q
[
i
] = 0.5*(
buf
[i][1]*
ue
[i][1] + buf[i][2]*ue[i][2] +

369 
buf
[
i
][3]*
ue
[i][3]);

372 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

373 
im1
 = 
i
-1;

374 
1
 = 
i
+1;

376 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

377 
tx2
*(
ue
[
1
][1]-ue[
im1
][1])+

378 
dx1tx1
*(
ue
[
1
][0]-2.0*ue[
i
][0]+ue[
im1
][0]);

380 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

381 
tx2
 * ((
ue
[
1
][1]*
buf
[1][1]+
c2
*(ue[1][4]-
q
[ip1]))-

382 (
ue
[
im1
][1]*
buf
[im1][1]+
c2
*(ue[im1][4]-
q
[im1])))+

383 
xxcÚ1
*(
buf
[
1
][1]-2.0*buf[
i
][1]+buf[
im1
][1])+

384 
dx2tx1
*Ğ
ue
[
1
][1]-2.0* ue[
i
][1]+ ue[
im1
][1]);

386 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

387 
tx2
 * (
ue
[
1
][2]*
buf
[1][1]-ue[
im1
][2]*buf[im1][1])+

388 
xxcÚ2
*(
buf
[
1
][2]-2.0*buf[
i
][2]+buf[
im1
][2])+

389 
dx3tx1
*Ğ
ue
[
1
][2]-2.0* ue[
i
][2]+ ue[
im1
][2]);

391 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

392 
tx2
*(
ue
[
1
][3]*
buf
[1][1]-ue[
im1
][3]*buf[im1][1])+

393 
xxcÚ2
*(
buf
[
1
][3]-2.0*buf[
i
][3]+buf[
im1
][3])+

394 
dx4tx1
*Ğ
ue
[
1
][3]-2.0* ue[
i
][3]+ ue[
im1
][3]);

396 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

397 
tx2
*(
buf
[
1
][1]*(
c1
*
ue
[1][4]-
c2
*
q
[ip1])-

398 
buf
[
im1
][1]*(
c1
*
ue
[im1][4]-
c2
*
q
[im1]))+

399 0.5*
xxcÚ3
*(
buf
[
1
][0]-2.0*buf[
i
][0]+buf[
im1
][0])+

400 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

401 
xxcÚ5
*(
buf
[
1
][4]-2.0*buf[
i
][4]+buf[
im1
][4])+

402 
dx5tx1
*Ğ
ue
[
1
][4]-2.0* ue[
i
][4]+ ue[
im1
][4]);

409 
m
 = 0; m < 5; m++) {

410 
i
 = 1;

411 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

412 (5.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] +ue[i+2][m]);

413 
i
 = 2;

414 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

415 (-4.0*
ue
[
i
-1][
m
] + 6.0*ue[i][m] -

416 4.0*
ue
[
i
+1][
m
] + ue[i+2][m]);

419 
m
 = 0; m < 5; m++) {

420 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

421 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

422 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

423 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] + ue[i+2][m]);

427 
m
 = 0; m < 5; m++) {

428 
i
 = 
grid_pošts
[0]-3;

429 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

430 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

431 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m]);

432 
i
 = 
grid_pošts
[0]-2;

433 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

434 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] + 5.0*ue[i][m]);

443 #´agm¨
omp
 

444 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

445 
xi
 = ()
i
 * 
dnxm1
;

447 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

448 
z‘a
 = ()
k
 * 
dnzm1
;

450 
j
 = 0; j < 
grid_pošts
[1]; j++) {

451 
‘a
 = ()
j
 * 
dnym1
;

453 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

454 
m
 = 0; m < 5; m++) {

455 
ue
[
j
][
m
] = 
d‹mp
[m];

458 
dp
 = 1.0/
d‹mp
[0];

460 
m
 = 1; m <= 4; m++) {

461 
buf
[
j
][
m
] = 
dp
 * 
d‹mp
[m];

464 
cuf
[
j
] = 
buf
[j][2] * buf[j][2];

465 
buf
[
j
][0] = 
cuf
[j] + buf[j][1] * buf[j][1] +

466 
buf
[
j
][3] * buf[j][3];

467 
q
[
j
] = 0.5*(
buf
[j][1]*
ue
[j][1] + buf[j][2]*ue[j][2] +

468 
buf
[
j
][3]*
ue
[j][3]);

471 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

472 
jm1
 = 
j
-1;

473 
jp1
 = 
j
+1;

475 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

476 
ty2
*Ğ
ue
[
jp1
][2]-ue[
jm1
][2] )+

477 
dy1ty1
*(
ue
[
jp1
][0]-2.0*ue[
j
][0]+ue[
jm1
][0]);

479 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

480 
ty2
*(
ue
[
jp1
][1]*
buf
[jp1][2]-ue[
jm1
][1]*buf[jm1][2])+

481 
yycÚ2
*(
buf
[
jp1
][1]-2.0*buf[
j
][1]+buf[
jm1
][1])+

482 
dy2ty1
*Ğ
ue
[
jp1
][1]-2.0* ue[
j
][1]+ ue[
jm1
][1]);

484 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

485 
ty2
*((
ue
[
jp1
][2]*
buf
[jp1][2]+
c2
*(ue[jp1][4]-
q
[jp1]))-

486 (
ue
[
jm1
][2]*
buf
[jm1][2]+
c2
*(ue[jm1][4]-
q
[jm1])))+

487 
yycÚ1
*(
buf
[
jp1
][2]-2.0*buf[
j
][2]+buf[
jm1
][2])+

488 
dy3ty1
*Ğ
ue
[
jp1
][2]-2.0*ue[
j
][2] +ue[
jm1
][2]);

490 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

491 
ty2
*(
ue
[
jp1
][3]*
buf
[jp1][2]-ue[
jm1
][3]*buf[jm1][2])+

492 
yycÚ2
*(
buf
[
jp1
][3]-2.0*buf[
j
][3]+buf[
jm1
][3])+

493 
dy4ty1
*Ğ
ue
[
jp1
][3]-2.0*ue[
j
][3]+ ue[
jm1
][3]);

495 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

496 
ty2
*(
buf
[
jp1
][2]*(
c1
*
ue
[jp1][4]-
c2
*
q
[jp1])-

497 
buf
[
jm1
][2]*(
c1
*
ue
[jm1][4]-
c2
*
q
[jm1]))+

498 0.5*
yycÚ3
*(
buf
[
jp1
][0]-2.0*buf[
j
][0]+

499 
buf
[
jm1
][0])+

500 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

501 
yycÚ5
*(
buf
[
jp1
][4]-2.0*buf[
j
][4]+buf[
jm1
][4])+

502 
dy5ty1
*(
ue
[
jp1
][4]-2.0*ue[
j
][4]+ue[
jm1
][4]);

508 
m
 = 0; m < 5; m++) {

509 
j
 = 1;

510 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

511 (5.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] +ue[j+2][m]);

512 
j
 = 2;

513 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

514 (-4.0*
ue
[
j
-1][
m
] + 6.0*ue[j][m] -

515 4.0*
ue
[
j
+1][
m
] + ue[j+2][m]);

518 
m
 = 0; m < 5; m++) {

519 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

520 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

521 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

522 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] + ue[j+2][m]);

526 
m
 = 0; m < 5; m++) {

527 
j
 = 
grid_pošts
[1]-3;

528 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

529 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

530 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m]);

531 
j
 = 
grid_pošts
[1]-2;

532 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

533 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] + 5.0*ue[j][m]);

543 #´agm¨
omp
 

544 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

545 
xi
 = ()
i
 * 
dnxm1
;

547 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

548 
‘a
 = ()
j
 * 
dnym1
;

550 
k
 = 0; k < 
grid_pošts
[2]; k++) {

551 
z‘a
 = ()
k
 * 
dnzm1
;

553 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

554 
m
 = 0; m < 5; m++) {

555 
ue
[
k
][
m
] = 
d‹mp
[m];

558 
dp
 = 1.0/
d‹mp
[0];

560 
m
 = 1; m <= 4; m++) {

561 
buf
[
k
][
m
] = 
dp
 * 
d‹mp
[m];

564 
cuf
[
k
] = 
buf
[k][3] * buf[k][3];

565 
buf
[
k
][0] = 
cuf
[k] + buf[k][1] * buf[k][1] +

566 
buf
[
k
][2] * buf[k][2];

567 
q
[
k
] = 0.5*(
buf
[k][1]*
ue
[k][1] + buf[k][2]*ue[k][2] +

568 
buf
[
k
][3]*
ue
[k][3]);

571 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

572 
km1
 = 
k
-1;

573 
kp1
 = 
k
+1;

575 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

576 
tz2
*Ğ
ue
[
kp1
][3]-ue[
km1
][3] )+

577 
dz1tz1
*(
ue
[
kp1
][0]-2.0*ue[
k
][0]+ue[
km1
][0]);

579 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

580 
tz2
 * (
ue
[
kp1
][1]*
buf
[kp1][3]-ue[
km1
][1]*buf[km1][3])+

581 
zzcÚ2
*(
buf
[
kp1
][1]-2.0*buf[
k
][1]+buf[
km1
][1])+

582 
dz2tz1
*Ğ
ue
[
kp1
][1]-2.0* ue[
k
][1]+ ue[
km1
][1]);

584 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

585 
tz2
 * (
ue
[
kp1
][2]*
buf
[kp1][3]-ue[
km1
][2]*buf[km1][3])+

586 
zzcÚ2
*(
buf
[
kp1
][2]-2.0*buf[
k
][2]+buf[
km1
][2])+

587 
dz3tz1
*(
ue
[
kp1
][2]-2.0*ue[
k
][2]+ue[
km1
][2]);

589 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

590 
tz2
 * ((
ue
[
kp1
][3]*
buf
[kp1][3]+
c2
*(ue[kp1][4]-
q
[kp1]))-

591 (
ue
[
km1
][3]*
buf
[km1][3]+
c2
*(ue[km1][4]-
q
[km1])))+

592 
zzcÚ1
*(
buf
[
kp1
][3]-2.0*buf[
k
][3]+buf[
km1
][3])+

593 
dz4tz1
*Ğ
ue
[
kp1
][3]-2.0*ue[
k
][3] +ue[
km1
][3]);

595 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

596 
tz2
 * (
buf
[
kp1
][3]*(
c1
*
ue
[kp1][4]-
c2
*
q
[kp1])-

597 
buf
[
km1
][3]*(
c1
*
ue
[km1][4]-
c2
*
q
[km1]))+

598 0.5*
zzcÚ3
*(
buf
[
kp1
][0]-2.0*buf[
k
][0]

599 +
buf
[
km1
][0])+

600 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

601 
zzcÚ5
*(
buf
[
kp1
][4]-2.0*buf[
k
][4]+buf[
km1
][4])+

602 
dz5tz1
*Ğ
ue
[
kp1
][4]-2.0*ue[
k
][4]+ ue[
km1
][4]);

608 
m
 = 0; m < 5; m++) {

609 
k
 = 1;

610 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

611 (5.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] +ue[k+2][m]);

612 
k
 = 2;

613 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

614 (-4.0*
ue
[
k
-1][
m
] + 6.0*ue[k][m] -

615 4.0*
ue
[
k
+1][
m
] + ue[k+2][m]);

618 
m
 = 0; m < 5; m++) {

619 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

620 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

621 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

622 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] + ue[k+2][m]);

626 
m
 = 0; m < 5; m++) {

627 
k
 = 
grid_pošts
[2]-3;

628 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

629 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

630 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m]);

631 
k
 = 
grid_pošts
[2]-2;

632 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

633 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] + 5.0*ue[k][m]);

642 #´agm¨
omp
 

643 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

644 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

645 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

646 
m
 = 0; m < 5; m++) {

647 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

654 
	}
}

658 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

659 
d‹mp
[5]) {

668 
m
;

670 
m
 = 0; m < 5; m++) {

671 
d‹mp
[
m
] = 
û
[m][0] +

672 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

673 + 
xi
*
û
[
m
][10]))) +

674 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

675 + 
‘a
*
û
[
m
][11])))+

676 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

677 
z‘a
*
û
[
m
][12])));

679 
	}
}

684 
	$š™Ÿlize
() {

686 #´agm¨
omp
 
·¿Î–


696 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

697 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

705 #´agm¨
omp
 

706 
i
 = 0; i < 
IMAX
; i++) {

707 
j
 = 0; j < 
IMAX
; j++) {

708 
k
 = 0; k < 
IMAX
; k++) {

709 
m
 = 0; m < 5; m++) {

710 
u
[
i
][
j
][
k
][
m
] = 1.0;

720 #´agm¨
omp
 

721 
i
 = 0; i < 
grid_pošts
[0]; i++) {

722 
xi
 = ()
i
 * 
dnxm1
;

724 
j
 = 0; j < 
grid_pošts
[1]; j++) {

725 
‘a
 = ()
j
 * 
dnym1
;

727 
k
 = 0; k < 
grid_pošts
[2]; k++) {

728 
z‘a
 = ()
k
 * 
dnzm1
;

730 
ix
 = 0; ix < 2; ix++) {

731 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

732 &(
Pçû
[
ix
][0][0]));

735 
iy
 = 0; iy < 2; iy++) {

736 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

737 &
Pçû
[
iy
][1][0]);

740 
iz
 = 0; iz < 2; iz++) {

741 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

742 &
Pçû
[
iz
][2][0]);

745 
m
 = 0; m < 5; m++) {

746 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

747 (1.0-
xi
è* 
Pçû
[0][0][
m
];

748 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

749 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

750 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

751 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

753 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

754 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

755 
Pxi
*
P‘a
*
Pz‘a
;

768 
i
 = 0;

769 
xi
 = 0.0;

770 #´agm¨
omp
 
nowa™


771 
j
 = 0; j < 
grid_pošts
[1]; j++) {

772 
‘a
 = ()
j
 * 
dnym1
;

773 
k
 = 0; k < 
grid_pošts
[2]; k++) {

774 
z‘a
 = ()
k
 * 
dnzm1
;

775 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

776 
m
 = 0; m < 5; m++) {

777 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

786 
i
 = 
grid_pošts
[0]-1;

787 
xi
 = 1.0;

788 #´agm¨
omp
 

789 
j
 = 0; j < 
grid_pošts
[1]; j++) {

790 
‘a
 = ()
j
 * 
dnym1
;

791 
k
 = 0; k < 
grid_pošts
[2]; k++) {

792 
z‘a
 = ()
k
 * 
dnzm1
;

793 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

794 
m
 = 0; m < 5; m++) {

795 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

803 
j
 = 0;

804 
‘a
 = 0.0;

805 #´agm¨
omp
 
nowa™


806 
i
 = 0; i < 
grid_pošts
[0]; i++) {

807 
xi
 = ()
i
 * 
dnxm1
;

808 
k
 = 0; k < 
grid_pošts
[2]; k++) {

809 
z‘a
 = ()
k
 * 
dnzm1
;

810 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

811 
m
 = 0; m < 5; m++) {

812 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

820 
j
 = 
grid_pošts
[1]-1;

821 
‘a
 = 1.0;

822 #´agm¨
omp
 

823 
i
 = 0; i < 
grid_pošts
[0]; i++) {

824 
xi
 = ()
i
 * 
dnxm1
;

825 
k
 = 0; k < 
grid_pošts
[2]; k++) {

826 
z‘a
 = ()
k
 * 
dnzm1
;

827 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

828 
m
 = 0; m < 5; m++) {

829 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

837 
k
 = 0;

838 
z‘a
 = 0.0;

839 #´agm¨
omp
 
nowa™


840 
i
 = 0; i < 
grid_pošts
[0]; i++) {

841 
xi
 = ()
i
 *
dnxm1
;

842 
j
 = 0; j < 
grid_pošts
[1]; j++) {

843 
‘a
 = ()
j
 * 
dnym1
;

844 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

845 
m
 = 0; m < 5; m++) {

846 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

854 
k
 = 
grid_pošts
[2]-1;

855 
z‘a
 = 1.0;

856 #´agm¨
omp
 

857 
i
 = 0; i < 
grid_pošts
[0]; i++) {

858 
xi
 = ()
i
 * 
dnxm1
;

859 
j
 = 0; j < 
grid_pošts
[1]; j++) {

860 
‘a
 = ()
j
 * 
dnym1
;

861 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

862 
m
 = 0; m < 5; m++) {

863 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

869 
	}
}

873 
	$lhsš™
() {

875 #´agm¨
omp
 
·¿Î–


877 
i
, 
j
, 
k
, 
m
, 
n
;

885 #´agm¨
omp
 

886 
i
 = 0; i < 
grid_pošts
[0]; i++) {

887 
j
 = 0; j < 
grid_pošts
[1]; j++) {

888 
k
 = 0; k < 
grid_pošts
[2]; k++) {

889 
m
 = 0; m < 5; m++) {

890 
n
 = 0;‚ < 5;‚++) {

891 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

892 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

893 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

903 #´agm¨
omp
 

904 
i
 = 0; i < 
grid_pošts
[0]; i++) {

905 
j
 = 0; j < 
grid_pošts
[1]; j++) {

906 
k
 = 0; k < 
grid_pošts
[2]; k++) {

907 
m
 = 0; m < 5; m++) {

908 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

915 
	}
}

919 
	$lhsx
() {

928 
i
, 
j
, 
k
;

933 #´agm¨
omp
 

934 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

935 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

936 
i
 = 0; i < 
grid_pošts
[0]; i++) {

938 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

939 
tmp2
 = 
tmp1
 *mp1;

940 
tmp3
 = 
tmp1
 * 
tmp2
;

944 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

945 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

946 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

947 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

948 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

950 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

951 
u
[
i
][
j
][
k
][1])

952 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

953 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

954 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

955 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

956 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

957 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

958 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

959 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

961 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

962 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

963 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

964 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

965 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

967 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

968 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

969 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

970 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

971 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

973 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

974 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

975 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


976 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

977 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

978 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


979 - 0.50 * 
c2


980 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

981 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

982 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

983 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

984 * 
tmp2
;

985 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

986 * 
tmp2
;

987 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

989 
njac
[
i
][
j
][
k
][0][0] = 0.0;

990 
njac
[
i
][
j
][
k
][0][1] = 0.0;

991 
njac
[
i
][
j
][
k
][0][2] = 0.0;

992 
njac
[
i
][
j
][
k
][0][3] = 0.0;

993 
njac
[
i
][
j
][
k
][0][4] = 0.0;

995 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

996 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

997 
njac
[
i
][
j
][
k
][1][2] = 0.0;

998 
njac
[
i
][
j
][
k
][1][3] = 0.0;

999 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1001 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1002 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1003 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1004 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1005 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1007 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1008 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1009 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1010 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1011 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1013 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1014 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1015 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1016 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1017 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1019 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1020 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1021 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1022 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1023 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1029 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1031 
tmp1
 = 
dt
 * 
tx1
;

1032 
tmp2
 = 
dt
 * 
tx2
;

1034 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1035 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1036 - 
tmp1
 * 
dx1
;

1037 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1038 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1039 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1040 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1041 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1042 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1043 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1044 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1046 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1047 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1048 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1049 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1050 - 
tmp1
 * 
dx2
;

1051 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1052 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1053 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1054 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1055 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1056 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1058 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1059 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1060 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1061 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1062 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1063 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1064 - 
tmp1
 * 
dx3
;

1065 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1066 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1067 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1068 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1070 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1071 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1072 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1073 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1074 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1075 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1076 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1077 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1078 - 
tmp1
 * 
dx4
;

1079 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1080 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1082 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1083 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1084 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1085 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1086 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1087 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1088 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1089 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1090 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1091 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1092 - 
tmp1
 * 
dx5
;

1094 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1095 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1096 + 
tmp1
 * 2.0 * 
dx1
;

1097 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1098 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1099 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1100 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1102 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1103 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1104 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1105 + 
tmp1
 * 2.0 * 
dx2
;

1106 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1107 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1108 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1110 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1111 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1112 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1113 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1114 + 
tmp1
 * 2.0 * 
dx3
;

1115 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1116 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1118 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1119 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1120 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1121 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1122 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1123 + 
tmp1
 * 2.0 * 
dx4
;

1124 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1126 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1127 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1128 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1129 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1130 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1131 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1132 + 
tmp1
 * 2.0 * 
dx5
;

1134 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1135 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1136 - 
tmp1
 * 
dx1
;

1137 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1138 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1139 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1140 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1141 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1142 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1143 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1144 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1146 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1147 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1148 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1149 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1150 - 
tmp1
 * 
dx2
;

1151 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1152 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1153 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1154 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1155 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1156 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1158 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1159 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1160 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1161 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1162 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1163 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1164 - 
tmp1
 * 
dx3
;

1165 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1166 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1167 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1168 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1170 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1171 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1172 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1173 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1174 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1175 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1176 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1177 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1178 - 
tmp1
 * 
dx4
;

1179 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1180 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1182 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1183 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1184 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1185 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1186 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1187 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1188 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1189 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1190 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1191 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1192 - 
tmp1
 * 
dx5
;

1197 
	}
}

1202 
	$lhsy
() {

1211 
i
, 
j
, 
k
;

1217 #´agm¨
omp
 

1218 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1219 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1220 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1222 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1223 
tmp2
 = 
tmp1
 *mp1;

1224 
tmp3
 = 
tmp1
 * 
tmp2
;

1226 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1227 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1228 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1229 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1230 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1232 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1233 * 
tmp2
;

1234 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1235 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1236 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1237 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1239 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1240 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1241 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1242 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1243 * 
tmp2
 );

1244 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1245 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1246 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1247 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1248 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1250 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1251 * 
tmp2
;

1252 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1253 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1254 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1255 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1257 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1258 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1259 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1260 * 
tmp2


1261 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1262 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1263 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1264 * 
tmp2
;

1265 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1266 - 0.50 * 
c2


1267 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1268 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1269 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1270 * 
tmp2
 );

1271 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1272 * 
tmp2
;

1273 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1275 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1276 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1277 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1278 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1279 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1281 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1282 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1283 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1284 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1285 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1287 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1288 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1289 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1290 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1291 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1293 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1294 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1295 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1296 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1297 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1299 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1300 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1301 - ( 
cÚ43
 * 
c3c4


1302 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1303 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1304 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1306 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1307 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1308 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1309 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1310 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1319 #´agm¨
omp
 

1320 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1321 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1322 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1324 
tmp1
 = 
dt
 * 
ty1
;

1325 
tmp2
 = 
dt
 * 
ty2
;

1327 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1328 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1329 - 
tmp1
 * 
dy1
;

1330 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1331 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1332 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1333 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1334 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1335 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1336 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1337 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1339 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1340 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1341 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1342 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1343 - 
tmp1
 * 
dy2
;

1344 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1345 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1346 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1347 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1348 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1349 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1351 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1352 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1353 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1354 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1355 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1356 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1357 - 
tmp1
 * 
dy3
;

1358 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1359 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1360 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1361 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1363 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1364 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1365 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1366 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1367 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1368 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1369 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1370 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1371 - 
tmp1
 * 
dy4
;

1372 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1373 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1375 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1376 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1377 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1378 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1379 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1380 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1381 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1382 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1383 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1384 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1385 - 
tmp1
 * 
dy5
;

1387 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1388 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1389 + 
tmp1
 * 2.0 * 
dy1
;

1390 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1391 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1392 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1393 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1395 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1396 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1397 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1398 + 
tmp1
 * 2.0 * 
dy2
;

1399 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1400 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1401 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1403 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1404 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1405 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1406 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1407 + 
tmp1
 * 2.0 * 
dy3
;

1408 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1409 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1411 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1412 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1413 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1414 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1415 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1416 + 
tmp1
 * 2.0 * 
dy4
;

1417 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1419 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1420 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1421 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1422 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1423 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1424 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1425 + 
tmp1
 * 2.0 * 
dy5
;

1427 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1428 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1429 - 
tmp1
 * 
dy1
;

1430 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1431 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1432 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1433 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1434 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1435 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1436 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1437 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1439 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1440 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1441 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1442 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1443 - 
tmp1
 * 
dy2
;

1444 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1445 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1446 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1447 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1448 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1449 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1451 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1452 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1453 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1454 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1455 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1456 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1457 - 
tmp1
 * 
dy3
;

1458 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1459 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1460 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1461 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1463 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1464 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1465 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1466 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1467 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1468 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1469 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1470 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1471 - 
tmp1
 * 
dy4
;

1472 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1473 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1475 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1476 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1477 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1478 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1479 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1480 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1481 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1482 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1483 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1484 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1485 - 
tmp1
 * 
dy5
;

1490 
	}
}

1496 
	$lhsz
() {

1505 
i
, 
j
, 
k
;

1511 #´agm¨
omp
 

1512 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1513 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1514 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1516 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1517 
tmp2
 = 
tmp1
 *mp1;

1518 
tmp3
 = 
tmp1
 * 
tmp2
;

1520 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1521 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1522 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1523 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1524 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1526 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1527 * 
tmp2
;

1528 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1529 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1530 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1531 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1533 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1534 * 
tmp2
;

1535 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1536 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1537 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1538 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1540 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1541 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1542 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1543 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1544 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1545 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1546 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1547 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1548 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1550 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1551 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1552 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1553 * 
tmp2


1554 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1555 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1556 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1557 * 
tmp2
;

1558 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1559 * 
tmp2
;

1560 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1561 - 0.50 * 
c2


1562 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1563 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1564 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1565 * 
tmp2
 );

1566 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1568 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1569 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1570 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1571 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1572 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1574 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1575 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1576 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1577 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1578 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1580 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1581 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1582 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1583 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1584 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1586 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1587 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1588 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1589 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1590 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1592 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1593 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1594 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1595 - ( 
cÚ43
 * 
c3c4


1596 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1597 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1599 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1600 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1601 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1602 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1603 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1612 #´agm¨
omp
 

1613 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1614 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1615 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1617 
tmp1
 = 
dt
 * 
tz1
;

1618 
tmp2
 = 
dt
 * 
tz2
;

1620 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1621 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1622 - 
tmp1
 * 
dz1
;

1623 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1624 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1625 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1626 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1627 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1628 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1629 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1630 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1632 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1633 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1634 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1635 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1636 - 
tmp1
 * 
dz2
;

1637 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1638 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1639 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1640 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1641 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1642 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1644 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1645 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1646 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1647 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1648 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1649 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1650 - 
tmp1
 * 
dz3
;

1651 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1652 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1653 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1654 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1656 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1657 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1658 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1659 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1660 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1661 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1662 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1663 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1664 - 
tmp1
 * 
dz4
;

1665 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1666 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1668 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1669 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1670 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1671 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1672 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1673 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1674 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1675 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1676 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1677 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1678 - 
tmp1
 * 
dz5
;

1680 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1681 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1682 + 
tmp1
 * 2.0 * 
dz1
;

1683 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1684 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1685 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1686 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1688 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1689 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1690 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1691 + 
tmp1
 * 2.0 * 
dz2
;

1692 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1693 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1694 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1696 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1697 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1698 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1699 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1700 + 
tmp1
 * 2.0 * 
dz3
;

1701 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1702 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1704 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1705 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1706 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1707 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1708 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1709 + 
tmp1
 * 2.0 * 
dz4
;

1710 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1712 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1713 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1714 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1715 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1716 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1717 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1718 + 
tmp1
 * 2.0 * 
dz5
;

1720 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1721 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1722 - 
tmp1
 * 
dz1
;

1723 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1724 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1725 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1726 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1727 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1728 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1729 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1730 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1732 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1733 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1734 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1735 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1736 - 
tmp1
 * 
dz2
;

1737 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1738 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1739 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1740 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1741 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1742 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1744 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1745 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1746 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1747 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1748 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1749 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1750 - 
tmp1
 * 
dz3
;

1751 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1752 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1753 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1754 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1756 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1757 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1758 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1759 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1760 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1761 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1762 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1763 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1764 - 
tmp1
 * 
dz4
;

1765 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1766 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1768 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1769 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1770 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1771 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1772 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1773 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1774 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1775 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1776 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1777 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1778 - 
tmp1
 * 
dz5
;

1783 
	}
}

1788 
	$compu‹_rhs
() {

1790 
i
, 
j
, 
k
, 
m
;

1791 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1797 #´agm¨
omp
 
nowa™


1798 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1799 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1800 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1801 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1802 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1803 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1804 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1805 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1806 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1807 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1808 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1809 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1820 #´agm¨
omp
 

1821 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1822 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1823 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1824 
m
 = 0; m < 5; m++) {

1825 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1834 #´agm¨
omp
 

1835 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1836 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1837 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1838 
uijk
 = 
us
[
i
][
j
][
k
];

1839 
up1
 = 
us
[
i
+1][
j
][
k
];

1840 
um1
 = 
us
[
i
-1][
j
][
k
];

1842 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1843 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1844 
u
[
i
-1][
j
][
k
][0]) -

1845 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1847 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1848 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1849 
u
[
i
-1][
j
][
k
][1]) +

1850 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1851 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1852 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1853 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1854 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1855 
c2
);

1857 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1858 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1859 
u
[
i
-1][
j
][
k
][2]) +

1860 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1861 
vs
[
i
-1][
j
][
k
]) -

1862 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1863 
u
[
i
-1][
j
][
k
][2]*
um1
);

1865 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1866 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1867 
u
[
i
-1][
j
][
k
][3]) +

1868 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1869 
ws
[
i
-1][
j
][
k
]) -

1870 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1871 
u
[
i
-1][
j
][
k
][3]*
um1
);

1873 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1874 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1875 
u
[
i
-1][
j
][
k
][4]) +

1876 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1877 
qs
[
i
-1][
j
][
k
]) +

1878 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1879 
um1
*um1) +

1880 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1881 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1882 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1883 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1884 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1885 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1886 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1894 
i
 = 1;

1895 #´agm¨
omp
 
nowa™


1896 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1897 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1898 
m
 = 0; m < 5; m++) {

1899 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1900 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1901 
u
[
i
+2][
j
][
k
][
m
]);

1906 
i
 = 2;

1907 #´agm¨
omp
 
nowa™


1908 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1909 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1910 
m
 = 0; m < 5; m++) {

1911 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1912 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1913 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1918 #´agm¨
omp
 
nowa™


1919 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1920 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1921 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1922 
m
 = 0; m < 5; m++) {

1923 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1924 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1925 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1926 
u
[
i
+2][
j
][
k
][
m
] );

1932 
i
 = 
grid_pošts
[0]-3;

1933 #´agm¨
omp
 
nowa™


1934 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1935 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1936 
m
 = 0; m < 5; m++) {

1937 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1938 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1939 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

1944 
i
 = 
grid_pošts
[0]-2;

1945 #´agm¨
omp
 

1946 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1947 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1948 
m
 = 0; m < 5; m++) {

1949 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1950 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

1951 5.0*
u
[
i
][
j
][
k
][
m
] );

1959 #´agm¨
omp
 

1960 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1961 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1962 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1963 
vijk
 = 
vs
[
i
][
j
][
k
];

1964 
vp1
 = 
vs
[
i
][
j
+1][
k
];

1965 
vm1
 = 
vs
[
i
][
j
-1][
k
];

1966 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

1967 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

1968 
u
[
i
][
j
-1][
k
][0]) -

1969 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

1970 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

1971 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

1972 
u
[
i
][
j
-1][
k
][1]) +

1973 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

1974 
us
[
i
][
j
-1][
k
]) -

1975 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

1976 
u
[
i
][
j
-1][
k
][1]*
vm1
);

1977 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

1978 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

1979 
u
[
i
][
j
-1][
k
][2]) +

1980 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

1981 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

1982 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

1983 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

1984 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

1985 *
c2
);

1986 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

1987 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

1988 
u
[
i
][
j
-1][
k
][3]) +

1989 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

1990 
ws
[
i
][
j
-1][
k
]) -

1991 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

1992 
u
[
i
][
j
-1][
k
][3]*
vm1
);

1993 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

1994 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

1995 
u
[
i
][
j
-1][
k
][4]) +

1996 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

1997 
qs
[
i
][
j
-1][
k
]) +

1998 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

1999 
vm1
*vm1) +

2000 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2001 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2002 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2003 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2004 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2005 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2006 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2014 
j
 = 1;

2015 #´agm¨
omp
 
nowa™


2016 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2017 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2018 
m
 = 0; m < 5; m++) {

2019 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2020 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2021 
u
[
i
][
j
+2][
k
][
m
]);

2026 
j
 = 2;

2027 #´agm¨
omp
 
nowa™


2028 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2029 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2030 
m
 = 0; m < 5; m++) {

2031 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2032 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2033 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2038 #´agm¨
omp
 
nowa™


2039 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2040 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2041 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2042 
m
 = 0; m < 5; m++) {

2043 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2044 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2045 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2046 
u
[
i
][
j
+2][
k
][
m
] );

2052 
j
 = 
grid_pošts
[1]-3;

2053 #´agm¨
omp
 
nowa™


2054 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2055 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2056 
m
 = 0; m < 5; m++) {

2057 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2058 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2059 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2064 
j
 = 
grid_pošts
[1]-2;

2065 #´agm¨
omp
 

2066 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2067 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2068 
m
 = 0; m < 5; m++) {

2069 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2070 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2071 5.*
u
[
i
][
j
][
k
][
m
] );

2079 #´agm¨
omp
 

2080 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2081 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2082 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2083 
wijk
 = 
ws
[
i
][
j
][
k
];

2084 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2085 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2087 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2088 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2089 
u
[
i
][
j
][
k
-1][0]) -

2090 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2091 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2092 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2093 
u
[
i
][
j
][
k
-1][1]) +

2094 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2095 
us
[
i
][
j
][
k
-1]) -

2096 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2097 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2098 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2099 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2100 
u
[
i
][
j
][
k
-1][2]) +

2101 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2102 
vs
[
i
][
j
][
k
-1]) -

2103 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2104 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2105 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2106 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2107 
u
[
i
][
j
][
k
-1][3]) +

2108 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2109 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2110 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2111 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2112 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2113 *
c2
);

2114 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2115 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2116 
u
[
i
][
j
][
k
-1][4]) +

2117 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2118 
qs
[
i
][
j
][
k
-1]) +

2119 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2120 
wm1
*wm1) +

2121 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2122 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2123 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2124 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2125 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2126 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2127 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2135 
k
 = 1;

2136 #´agm¨
omp
 
nowa™


2137 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2138 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2139 
m
 = 0; m < 5; m++) {

2140 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2141 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2142 
u
[
i
][
j
][
k
+2][
m
]);

2147 
k
 = 2;

2148 #´agm¨
omp
 
nowa™


2149 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2150 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2151 
m
 = 0; m < 5; m++) {

2152 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2153 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2154 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2159 #´agm¨
omp
 
nowa™


2160 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2161 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2162 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2163 
m
 = 0; m < 5; m++) {

2164 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2165 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2166 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2167 
u
[
i
][
j
][
k
+2][
m
] );

2173 
k
 = 
grid_pošts
[2]-3;

2174 #´agm¨
omp
 
nowa™


2175 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2176 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2177 
m
 = 0; m < 5; m++) {

2178 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2179 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2180 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2185 
k
 = 
grid_pošts
[2]-2;

2186 #´agm¨
omp
 

2187 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2188 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2189 
m
 = 0; m < 5; m++) {

2190 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2191 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2192 5.0*
u
[
i
][
j
][
k
][
m
] );

2197 #´agm¨
omp
 

2198 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2199 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2200 
m
 = 0; m < 5; m++) {

2201 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2202 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2207 
	}
}

2212 
	$£t_cÚ¡ªts
() {

2217 
û
[0][0] = 2.0;

2218 
û
[0][1] = 0.0;

2219 
û
[0][2] = 0.0;

2220 
û
[0][3] = 4.0;

2221 
û
[0][4] = 5.0;

2222 
û
[0][5] = 3.0;

2223 
û
[0][6] = 0.5;

2224 
û
[0][7] = 0.02;

2225 
û
[0][8] = 0.01;

2226 
û
[0][9] = 0.03;

2227 
û
[0][10] = 0.5;

2228 
û
[0][11] = 0.4;

2229 
û
[0][12] = 0.3;

2231 
û
[1][0] = 1.0;

2232 
û
[1][1] = 0.0;

2233 
û
[1][2] = 0.0;

2234 
û
[1][3] = 0.0;

2235 
û
[1][4] = 1.0;

2236 
û
[1][5] = 2.0;

2237 
û
[1][6] = 3.0;

2238 
û
[1][7] = 0.01;

2239 
û
[1][8] = 0.03;

2240 
û
[1][9] = 0.02;

2241 
û
[1][10] = 0.4;

2242 
û
[1][11] = 0.3;

2243 
û
[1][12] = 0.5;

2245 
û
[2][0] = 2.0;

2246 
û
[2][1] = 2.0;

2247 
û
[2][2] = 0.0;

2248 
û
[2][3] = 0.0;

2249 
û
[2][4] = 0.0;

2250 
û
[2][5] = 2.0;

2251 
û
[2][6] = 3.0;

2252 
û
[2][7] = 0.04;

2253 
û
[2][8] = 0.03;

2254 
û
[2][9] = 0.05;

2255 
û
[2][10] = 0.3;

2256 
û
[2][11] = 0.5;

2257 
û
[2][12] = 0.4;

2259 
û
[3][0] = 2.0;

2260 
û
[3][1] = 2.0;

2261 
û
[3][2] = 0.0;

2262 
û
[3][3] = 0.0;

2263 
û
[3][4] = 0.0;

2264 
û
[3][5] = 2.0;

2265 
û
[3][6] = 3.0;

2266 
û
[3][7] = 0.03;

2267 
û
[3][8] = 0.05;

2268 
û
[3][9] = 0.04;

2269 
û
[3][10] = 0.2;

2270 
û
[3][11] = 0.1;

2271 
û
[3][12] = 0.3;

2273 
û
[4][0] = 5.0;

2274 
û
[4][1] = 4.0;

2275 
û
[4][2] = 3.0;

2276 
û
[4][3] = 2.0;

2277 
û
[4][4] = 0.1;

2278 
û
[4][5] = 0.4;

2279 
û
[4][6] = 0.3;

2280 
û
[4][7] = 0.05;

2281 
û
[4][8] = 0.04;

2282 
û
[4][9] = 0.03;

2283 
û
[4][10] = 0.1;

2284 
û
[4][11] = 0.3;

2285 
û
[4][12] = 0.2;

2287 
c1
 = 1.4;

2288 
c2
 = 0.4;

2289 
c3
 = 0.1;

2290 
c4
 = 1.0;

2291 
c5
 = 1.4;

2293 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2294 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2295 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2297 
c1c2
 = 
c1
 * 
c2
;

2298 
c1c5
 = 
c1
 * 
c5
;

2299 
c3c4
 = 
c3
 * 
c4
;

2300 
c1345
 = 
c1c5
 * 
c3c4
;

2302 
cÚz1
 = (1.0-
c1c5
);

2304 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2305 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2306 
tx3
 = 1.0 / 
dnxm1
;

2308 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2309 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2310 
ty3
 = 1.0 / 
dnym1
;

2312 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2313 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2314 
tz3
 = 1.0 / 
dnzm1
;

2316 
dx1
 = 0.75;

2317 
dx2
 = 0.75;

2318 
dx3
 = 0.75;

2319 
dx4
 = 0.75;

2320 
dx5
 = 0.75;

2322 
dy1
 = 0.75;

2323 
dy2
 = 0.75;

2324 
dy3
 = 0.75;

2325 
dy4
 = 0.75;

2326 
dy5
 = 0.75;

2328 
dz1
 = 1.0;

2329 
dz2
 = 1.0;

2330 
dz3
 = 1.0;

2331 
dz4
 = 1.0;

2332 
dz5
 = 1.0;

2334 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2335 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2336 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2338 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2340 
c4ds¥
 = 4.0 * 
ds¥
;

2341 
c5ds¥
 = 5.0 * 
ds¥
;

2343 
d‰x1
 = 
dt
*
tx1
;

2344 
d‰x2
 = 
dt
*
tx2
;

2345 
d‰y1
 = 
dt
*
ty1
;

2346 
d‰y2
 = 
dt
*
ty2
;

2347 
d‰z1
 = 
dt
*
tz1
;

2348 
d‰z2
 = 
dt
*
tz2
;

2350 
c2d‰x1
 = 2.0*
d‰x1
;

2351 
c2d‰y1
 = 2.0*
d‰y1
;

2352 
c2d‰z1
 = 2.0*
d‰z1
;

2354 
dtds¥
 = 
dt
*
ds¥
;

2356 
comz1
 = 
dtds¥
;

2357 
comz4
 = 4.0*
dtds¥
;

2358 
comz5
 = 5.0*
dtds¥
;

2359 
comz6
 = 6.0*
dtds¥
;

2361 
c3c4tx3
 = 
c3c4
*
tx3
;

2362 
c3c4ty3
 = 
c3c4
*
ty3
;

2363 
c3c4tz3
 = 
c3c4
*
tz3
;

2365 
dx1tx1
 = 
dx1
*
tx1
;

2366 
dx2tx1
 = 
dx2
*
tx1
;

2367 
dx3tx1
 = 
dx3
*
tx1
;

2368 
dx4tx1
 = 
dx4
*
tx1
;

2369 
dx5tx1
 = 
dx5
*
tx1
;

2371 
dy1ty1
 = 
dy1
*
ty1
;

2372 
dy2ty1
 = 
dy2
*
ty1
;

2373 
dy3ty1
 = 
dy3
*
ty1
;

2374 
dy4ty1
 = 
dy4
*
ty1
;

2375 
dy5ty1
 = 
dy5
*
ty1
;

2377 
dz1tz1
 = 
dz1
*
tz1
;

2378 
dz2tz1
 = 
dz2
*
tz1
;

2379 
dz3tz1
 = 
dz3
*
tz1
;

2380 
dz4tz1
 = 
dz4
*
tz1
;

2381 
dz5tz1
 = 
dz5
*
tz1
;

2383 
c2iv
 = 2.5;

2384 
cÚ43
 = 4.0/3.0;

2385 
cÚ16
 = 1.0/6.0;

2387 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2388 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2389 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2390 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2391 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2393 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2394 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2395 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2396 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2397 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2399 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2400 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2401 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2402 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2403 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2404 
	}
}

2409 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2418 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2419 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2420 
m
;

2425 
•sÚ
 = 1.0e-08;

2431 
	`”rÜ_nÜm
(
xû
);

2432 
	`compu‹_rhs
();

2434 
	`rhs_nÜm
(
xü
);

2436 
m
 = 0; m < 5; m++) {

2437 
xü
[
m
] = xü[m] / 
dt
;

2440 *
şass
 = 'U';

2441 *
v”if›d
 = 
TRUE
;

2443 
m
 = 0; m < 5; m++) {

2444 
xü»f
[
m
] = 1.0;

2445 
xû»f
[
m
] = 1.0;

2451 ià(
grid_pošts
[0] == 12 &&

2452 
grid_pošts
[1] == 12 &&

2453 
grid_pošts
[2] == 12 &&

2454 
no_time_¡•s
 == 60) {

2456 *
şass
 = 'S';

2457 
dŒef
 = 1.0e-2;

2462 
xü»f
[0] = 1.7034283709541311e-01;

2463 
xü»f
[1] = 1.2975252070034097e-02;

2464 
xü»f
[2] = 3.2527926989486055e-02;

2465 
xü»f
[3] = 2.6436421275166801e-02;

2466 
xü»f
[4] = 1.9211784131744430e-01;

2471 
xû»f
[0] = 4.9976913345811579e-04;

2472 
xû»f
[1] = 4.5195666782961927e-05;

2473 
xû»f
[2] = 7.3973765172921357e-05;

2474 
xû»f
[3] = 7.3821238632439731e-05;

2475 
xû»f
[4] = 8.9269630987491446e-04;

2480 } ià(
grid_pošts
[0] == 24 &&

2481 
grid_pošts
[1] == 24 &&

2482 
grid_pošts
[2] == 24 &&

2483 
no_time_¡•s
 == 200) {

2485 *
şass
 = 'W';

2486 
dŒef
 = 0.8e-3;

2490 
xü»f
[0] = 0.1125590409344e+03;

2491 
xü»f
[1] = 0.1180007595731e+02;

2492 
xü»f
[2] = 0.2710329767846e+02;

2493 
xü»f
[3] = 0.2469174937669e+02;

2494 
xü»f
[4] = 0.2638427874317e+03;

2499 
xû»f
[0] = 0.4419655736008e+01;

2500 
xû»f
[1] = 0.4638531260002e+00;

2501 
xû»f
[2] = 0.1011551749967e+01;

2502 
xû»f
[3] = 0.9235878729944e+00;

2503 
xû»f
[4] = 0.1018045837718e+02;

2509 } ià(
grid_pošts
[0] == 64 &&

2510 
grid_pošts
[1] == 64 &&

2511 
grid_pošts
[2] == 64 &&

2512 
no_time_¡•s
 == 200) {

2514 *
şass
 = 'A';

2515 
dŒef
 = 0.8e-3;

2519 
xü»f
[0] = 1.0806346714637264e+02;

2520 
xü»f
[1] = 1.1319730901220813e+01;

2521 
xü»f
[2] = 2.5974354511582465e+01;

2522 
xü»f
[3] = 2.3665622544678910e+01;

2523 
xü»f
[4] = 2.5278963211748344e+02;

2528 
xû»f
[0] = 4.2348416040525025e+00;

2529 
xû»f
[1] = 4.4390282496995698e-01;

2530 
xû»f
[2] = 9.6692480136345650e-01;

2531 
xû»f
[3] = 8.8302063039765474e-01;

2532 
xû»f
[4] = 9.7379901770829278e+00;

2538 } ià(
grid_pošts
[0] == 102 &&

2539 
grid_pošts
[1] == 102 &&

2540 
grid_pošts
[2] == 102 &&

2541 
no_time_¡•s
 == 200) {

2543 *
şass
 = 'B';

2544 
dŒef
 = 3.0e-4;

2549 
xü»f
[0] = 1.4233597229287254e+03;

2550 
xü»f
[1] = 9.9330522590150238e+01;

2551 
xü»f
[2] = 3.5646025644535285e+02;

2552 
xü»f
[3] = 3.2485447959084092e+02;

2553 
xü»f
[4] = 3.2707541254659363e+03;

2558 
xû»f
[0] = 5.2969847140936856e+01;

2559 
xû»f
[1] = 4.4632896115670668e+00;

2560 
xû»f
[2] = 1.3122573342210174e+01;

2561 
xû»f
[3] = 1.2006925323559144e+01;

2562 
xû»f
[4] = 1.2459576151035986e+02;

2568 } ià(
grid_pošts
[0] == 162 &&

2569 
grid_pošts
[1] == 162 &&

2570 
grid_pošts
[2] == 162 &&

2571 
no_time_¡•s
 == 200) {

2573 *
şass
 = 'C';

2574 
dŒef
 = 1.0e-4;

2579 
xü»f
[0] = 0.62398116551764615e+04;

2580 
xü»f
[1] = 0.50793239190423964e+03;

2581 
xü»f
[2] = 0.15423530093013596e+04;

2582 
xü»f
[3] = 0.13302387929291190e+04;

2583 
xü»f
[4] = 0.11604087428436455e+05;

2588 
xû»f
[0] = 0.16462008369091265e+03;

2589 
xû»f
[1] = 0.11497107903824313e+02;

2590 
xû»f
[2] = 0.41207446207461508e+02;

2591 
xû»f
[3] = 0.37087651059694167e+02;

2592 
xû»f
[4] = 0.36211053051841265e+03;

2595 *
v”if›d
 = 
FALSE
;

2606 
m
 = 0; m < 5; m++) {

2608 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2609 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2617 ià(*
şass
 != 'U') {

2618 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2619 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2620 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2621 *
v”if›d
 = 
FALSE
;

2622 *
şass
 = 'U';

2623 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2626 
	`´štf
(" Unknown class\n");

2629 ià(*
şass
 != 'U') {

2630 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2632 
	`´štf
(" RMS-norms of„esidual\n");

2634 
m
 = 0; m < 5; m++) {

2635 ià(*
şass
 == 'U') {

2636 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2637 } ià(
xüdif
[
m
] > 
•sÚ
) {

2638 *
v”if›d
 = 
FALSE
;

2639 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2640 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2642 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2643 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2647 ià(*
şass
 != 'U') {

2648 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2650 
	`´štf
(" RMS-norms of solutionƒrror\n");

2653 
m
 = 0; m < 5; m++) {

2654 ià(*
şass
 == 'U') {

2655 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2656 } ià(
xûdif
[
m
] > 
•sÚ
) {

2657 *
v”if›d
 = 
FALSE
;

2658 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2659 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2661 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2662 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2666 ià(*
şass
 == 'U') {

2667 
	`´štf
(" No„eference values…rovided\n");

2668 
	`´štf
(" No verification…erformed\n");

2669 } ià(*
v”if›d
 =ğ
TRUE
) {

2670 
	`´štf
(" Verification Successful\n");

2672 
	`´štf
(" Verification failed\n");

2674 
	}
}

2679 
	$x_sŞve
() {

2696 
	`lhsx
();

2697 
	`x_sŞve_ûÎ
();

2698 
	`x_backsub¡™u‹
();

2699 
	}
}

2705 
	$x_backsub¡™u‹
() {

2717 
i
, 
j
, 
k
, 
m
, 
n
;

2719 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2720 #´agm¨
omp
 

2721 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2722 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2723 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2724 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2725 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2726 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2732 
	}
}

2737 
	$x_sŞve_ûÎ
() {

2749 
i
,
j
,
k
,
isize
;

2751 
isize
 = 
grid_pošts
[0]-1;

2756 #´agm¨
omp
 

2757 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2758 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2764 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2765 
lhs
[0][
j
][
k
][
CC
],

2766 
rhs
[0][
j
][
k
] );

2774 
i
 = 1; i < 
isize
; i++) {

2775 #´agm¨
omp
 

2776 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2777 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2782 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2783 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2788 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2789 
lhs
[
i
-1][
j
][
k
][
CC
],

2790 
lhs
[
i
][
j
][
k
][
BB
]);

2797 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2798 
lhs
[
i
][
j
][
k
][
CC
],

2799 
rhs
[
i
][
j
][
k
] );

2805 #´agm¨
omp
 

2806 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2807 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2812 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2813 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2818 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2819 
lhs
[
isize
-1][
j
][
k
][
CC
],

2820 
lhs
[
isize
][
j
][
k
][
BB
]);

2825 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2826 
rhs
[
i
][
j
][
k
] );

2830 
	}
}

2835 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2844 
i
;

2846 
i
 = 0; i < 5; i++) {

2851 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2852 - 
ablock
[
i
][1]*
avec
[1]

2853 - 
ablock
[
i
][2]*
avec
[2]

2854 - 
ablock
[
i
][3]*
avec
[3]

2855 - 
ablock
[
i
][4]*
avec
[4];

2857 
	}
}

2862 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2863 
cblock
[5][5]) {

2872 
j
;

2874 
j
 = 0; j < 5; j++) {

2875 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2876 - 
ablock
[0][1]*
bblock
[1][
j
]

2877 - 
ablock
[0][2]*
bblock
[2][
j
]

2878 - 
ablock
[0][3]*
bblock
[3][
j
]

2879 - 
ablock
[0][4]*
bblock
[4][
j
];

2880 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2881 - 
ablock
[1][1]*
bblock
[1][
j
]

2882 - 
ablock
[1][2]*
bblock
[2][
j
]

2883 - 
ablock
[1][3]*
bblock
[3][
j
]

2884 - 
ablock
[1][4]*
bblock
[4][
j
];

2885 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2886 - 
ablock
[2][1]*
bblock
[1][
j
]

2887 - 
ablock
[2][2]*
bblock
[2][
j
]

2888 - 
ablock
[2][3]*
bblock
[3][
j
]

2889 - 
ablock
[2][4]*
bblock
[4][
j
];

2890 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2891 - 
ablock
[3][1]*
bblock
[1][
j
]

2892 - 
ablock
[3][2]*
bblock
[2][
j
]

2893 - 
ablock
[3][3]*
bblock
[3][
j
]

2894 - 
ablock
[3][4]*
bblock
[4][
j
];

2895 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2896 - 
ablock
[4][1]*
bblock
[1][
j
]

2897 - 
ablock
[4][2]*
bblock
[2][
j
]

2898 - 
ablock
[4][3]*
bblock
[3][
j
]

2899 - 
ablock
[4][4]*
bblock
[4][
j
];

2901 
	}
}

2906 
	$bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]) {

2911 
pivÙ
, 
cÛff
;

2917 
pivÙ
 = 1.00/
lhs
[0][0];

2918 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

2919 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

2920 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

2921 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

2922 
c
[0][0] = c[0][0]*
pivÙ
;

2923 
c
[0][1] = c[0][1]*
pivÙ
;

2924 
c
[0][2] = c[0][2]*
pivÙ
;

2925 
c
[0][3] = c[0][3]*
pivÙ
;

2926 
c
[0][4] = c[0][4]*
pivÙ
;

2927 
r
[0] =„[0] *
pivÙ
;

2929 
cÛff
 = 
lhs
[1][0];

2930 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

2931 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

2932 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

2933 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

2934 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

2935 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

2936 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

2937 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

2938 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

2939 
r
[1] =„[1] - 
cÛff
*r[0];

2941 
cÛff
 = 
lhs
[2][0];

2942 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

2943 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

2944 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

2945 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

2946 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

2947 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

2948 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

2949 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

2950 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

2951 
r
[2] =„[2] - 
cÛff
*r[0];

2953 
cÛff
 = 
lhs
[3][0];

2954 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

2955 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

2956 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

2957 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

2958 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

2959 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

2960 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

2961 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

2962 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

2963 
r
[3] =„[3] - 
cÛff
*r[0];

2965 
cÛff
 = 
lhs
[4][0];

2966 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

2967 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

2968 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

2969 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

2970 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

2971 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

2972 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

2973 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

2974 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

2975 
r
[4] =„[4] - 
cÛff
*r[0];

2978 
pivÙ
 = 1.00/
lhs
[1][1];

2979 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

2980 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

2981 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

2982 
c
[1][0] = c[1][0]*
pivÙ
;

2983 
c
[1][1] = c[1][1]*
pivÙ
;

2984 
c
[1][2] = c[1][2]*
pivÙ
;

2985 
c
[1][3] = c[1][3]*
pivÙ
;

2986 
c
[1][4] = c[1][4]*
pivÙ
;

2987 
r
[1] =„[1] *
pivÙ
;

2989 
cÛff
 = 
lhs
[0][1];

2990 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

2991 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

2992 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

2993 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

2994 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

2995 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

2996 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

2997 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

2998 
r
[0] =„[0] - 
cÛff
*r[1];

3000 
cÛff
 = 
lhs
[2][1];

3001 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3002 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3003 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3004 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3005 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3006 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3007 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3008 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3009 
r
[2] =„[2] - 
cÛff
*r[1];

3011 
cÛff
 = 
lhs
[3][1];

3012 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3013 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3014 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3015 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3016 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3017 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3018 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3019 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3020 
r
[3] =„[3] - 
cÛff
*r[1];

3022 
cÛff
 = 
lhs
[4][1];

3023 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3024 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3025 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3026 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3027 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3028 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3029 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3030 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3031 
r
[4] =„[4] - 
cÛff
*r[1];

3034 
pivÙ
 = 1.00/
lhs
[2][2];

3035 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3036 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3037 
c
[2][0] = c[2][0]*
pivÙ
;

3038 
c
[2][1] = c[2][1]*
pivÙ
;

3039 
c
[2][2] = c[2][2]*
pivÙ
;

3040 
c
[2][3] = c[2][3]*
pivÙ
;

3041 
c
[2][4] = c[2][4]*
pivÙ
;

3042 
r
[2] =„[2] *
pivÙ
;

3044 
cÛff
 = 
lhs
[0][2];

3045 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3046 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3047 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3048 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3049 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3050 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3051 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3052 
r
[0] =„[0] - 
cÛff
*r[2];

3054 
cÛff
 = 
lhs
[1][2];

3055 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3056 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3057 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3058 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3059 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3060 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3061 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3062 
r
[1] =„[1] - 
cÛff
*r[2];

3064 
cÛff
 = 
lhs
[3][2];

3065 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3066 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3067 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3068 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3069 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3070 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3071 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3072 
r
[3] =„[3] - 
cÛff
*r[2];

3074 
cÛff
 = 
lhs
[4][2];

3075 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3076 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3077 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3078 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3079 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3080 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3081 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3082 
r
[4] =„[4] - 
cÛff
*r[2];

3085 
pivÙ
 = 1.00/
lhs
[3][3];

3086 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3087 
c
[3][0] = c[3][0]*
pivÙ
;

3088 
c
[3][1] = c[3][1]*
pivÙ
;

3089 
c
[3][2] = c[3][2]*
pivÙ
;

3090 
c
[3][3] = c[3][3]*
pivÙ
;

3091 
c
[3][4] = c[3][4]*
pivÙ
;

3092 
r
[3] =„[3] *
pivÙ
;

3094 
cÛff
 = 
lhs
[0][3];

3095 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3096 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3097 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3098 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3099 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3100 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3101 
r
[0] =„[0] - 
cÛff
*r[3];

3103 
cÛff
 = 
lhs
[1][3];

3104 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3105 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3106 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3107 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3108 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3109 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3110 
r
[1] =„[1] - 
cÛff
*r[3];

3112 
cÛff
 = 
lhs
[2][3];

3113 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3114 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3115 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3116 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3117 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3118 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3119 
r
[2] =„[2] - 
cÛff
*r[3];

3121 
cÛff
 = 
lhs
[4][3];

3122 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3123 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3124 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3125 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3126 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3127 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3128 
r
[4] =„[4] - 
cÛff
*r[3];

3131 
pivÙ
 = 1.00/
lhs
[4][4];

3132 
c
[4][0] = c[4][0]*
pivÙ
;

3133 
c
[4][1] = c[4][1]*
pivÙ
;

3134 
c
[4][2] = c[4][2]*
pivÙ
;

3135 
c
[4][3] = c[4][3]*
pivÙ
;

3136 
c
[4][4] = c[4][4]*
pivÙ
;

3137 
r
[4] =„[4] *
pivÙ
;

3139 
cÛff
 = 
lhs
[0][4];

3140 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3141 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3142 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3143 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3144 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3145 
r
[0] =„[0] - 
cÛff
*r[4];

3147 
cÛff
 = 
lhs
[1][4];

3148 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3149 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3150 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3151 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3152 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3153 
r
[1] =„[1] - 
cÛff
*r[4];

3155 
cÛff
 = 
lhs
[2][4];

3156 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3157 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3158 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3159 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3160 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3161 
r
[2] =„[2] - 
cÛff
*r[4];

3163 
cÛff
 = 
lhs
[3][4];

3164 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3165 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3166 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3167 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3168 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3169 
r
[3] =„[3] - 
cÛff
*r[4];

3170 
	}
}

3175 
	$bšvrhs
Ğ
lhs
[5][5], 
r
[5] ) {

3180 
pivÙ
, 
cÛff
;

3186 
pivÙ
 = 1.00/
lhs
[0][0];

3187 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

3188 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

3189 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

3190 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

3191 
r
[0] =„[0] *
pivÙ
;

3193 
cÛff
 = 
lhs
[1][0];

3194 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

3195 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

3196 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

3197 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

3198 
r
[1] =„[1] - 
cÛff
*r[0];

3200 
cÛff
 = 
lhs
[2][0];

3201 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3202 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3203 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3204 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3205 
r
[2] =„[2] - 
cÛff
*r[0];

3207 
cÛff
 = 
lhs
[3][0];

3208 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3209 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3210 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3211 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3212 
r
[3] =„[3] - 
cÛff
*r[0];

3214 
cÛff
 = 
lhs
[4][0];

3215 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3216 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3217 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3218 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3219 
r
[4] =„[4] - 
cÛff
*r[0];

3222 
pivÙ
 = 1.00/
lhs
[1][1];

3223 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3224 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3225 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3226 
r
[1] =„[1] *
pivÙ
;

3228 
cÛff
 = 
lhs
[0][1];

3229 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3230 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3231 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3232 
r
[0] =„[0] - 
cÛff
*r[1];

3234 
cÛff
 = 
lhs
[2][1];

3235 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3236 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3237 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3238 
r
[2] =„[2] - 
cÛff
*r[1];

3240 
cÛff
 = 
lhs
[3][1];

3241 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3242 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3243 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3244 
r
[3] =„[3] - 
cÛff
*r[1];

3246 
cÛff
 = 
lhs
[4][1];

3247 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3248 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3249 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3250 
r
[4] =„[4] - 
cÛff
*r[1];

3253 
pivÙ
 = 1.00/
lhs
[2][2];

3254 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3255 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3256 
r
[2] =„[2] *
pivÙ
;

3258 
cÛff
 = 
lhs
[0][2];

3259 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3260 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3261 
r
[0] =„[0] - 
cÛff
*r[2];

3263 
cÛff
 = 
lhs
[1][2];

3264 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3265 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3266 
r
[1] =„[1] - 
cÛff
*r[2];

3268 
cÛff
 = 
lhs
[3][2];

3269 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3270 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3271 
r
[3] =„[3] - 
cÛff
*r[2];

3273 
cÛff
 = 
lhs
[4][2];

3274 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3275 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3276 
r
[4] =„[4] - 
cÛff
*r[2];

3279 
pivÙ
 = 1.00/
lhs
[3][3];

3280 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3281 
r
[3] =„[3] *
pivÙ
;

3283 
cÛff
 = 
lhs
[0][3];

3284 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3285 
r
[0] =„[0] - 
cÛff
*r[3];

3287 
cÛff
 = 
lhs
[1][3];

3288 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3289 
r
[1] =„[1] - 
cÛff
*r[3];

3291 
cÛff
 = 
lhs
[2][3];

3292 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3293 
r
[2] =„[2] - 
cÛff
*r[3];

3295 
cÛff
 = 
lhs
[4][3];

3296 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3297 
r
[4] =„[4] - 
cÛff
*r[3];

3300 
pivÙ
 = 1.00/
lhs
[4][4];

3301 
r
[4] =„[4] *
pivÙ
;

3303 
cÛff
 = 
lhs
[0][4];

3304 
r
[0] =„[0] - 
cÛff
*r[4];

3306 
cÛff
 = 
lhs
[1][4];

3307 
r
[1] =„[1] - 
cÛff
*r[4];

3309 
cÛff
 = 
lhs
[2][4];

3310 
r
[2] =„[2] - 
cÛff
*r[4];

3312 
cÛff
 = 
lhs
[3][4];

3313 
r
[3] =„[3] - 
cÛff
*r[4];

3315 
	}
}

3320 
	$y_sŞve
() {

3335 
	`lhsy
();

3336 
	`y_sŞve_ûÎ
();

3337 
	`y_backsub¡™u‹
();

3338 
	}
}

3344 
	$y_backsub¡™u‹
() {

3356 
i
, 
j
, 
k
, 
m
, 
n
;

3358 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3359 #´agm¨
omp
 

3360 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3361 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3362 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3363 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3364 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3365 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3371 
	}
}

3376 
	$y_sŞve_ûÎ
() {

3391 
i
, 
j
, 
k
, 
jsize
;

3393 
jsize
 = 
grid_pošts
[1]-1;

3395 #´agm¨
omp
 

3396 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3397 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3403 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3404 
lhs
[
i
][0][
k
][
CC
],

3405 
rhs
[
i
][0][
k
] );

3413 
j
 = 1; j < 
jsize
; j++) {

3414 #´agm¨
omp
 

3415 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3416 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3423 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3424 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3429 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3430 
lhs
[
i
][
j
-1][
k
][
CC
],

3431 
lhs
[
i
][
j
][
k
][
BB
]);

3437 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3438 
lhs
[
i
][
j
][
k
][
CC
],

3439 
rhs
[
i
][
j
][
k
] );

3445 #´agm¨
omp
 

3446 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3447 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3452 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3453 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3460 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3461 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3462 
lhs
[
i
][
jsize
][
k
][
BB
]);

3467 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3468 
rhs
[
i
][
jsize
][
k
] );

3472 
	}
}

3478 
	$z_sŞve
() {

3493 
	`lhsz
();

3494 
	`z_sŞve_ûÎ
();

3495 
	`z_backsub¡™u‹
();

3496 
	}
}

3501 
	$z_backsub¡™u‹
() {

3513 
i
, 
j
, 
k
, 
m
, 
n
;

3515 #´agm¨
omp
 

3516 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3517 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3518 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3519 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3520 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3521 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3522 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3528 
	}
}

3533 
	$z_sŞve_ûÎ
() {

3548 
i
,
j
,
k
,
ksize
;

3550 
ksize
 = 
grid_pošts
[2]-1;

3555 #´agm¨
omp
 

3556 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3557 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3563 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3564 
lhs
[
i
][
j
][0][
CC
],

3565 
rhs
[
i
][
j
][0] );

3574 
k
 = 1; k < 
ksize
; k++) {

3575 #´agm¨
omp
 

3576 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3577 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3584 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3585 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3591 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3592 
lhs
[
i
][
j
][
k
-1][
CC
],

3593 
lhs
[
i
][
j
][
k
][
BB
]);

3599 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3600 
lhs
[
i
][
j
][
k
][
CC
],

3601 
rhs
[
i
][
j
][
k
] );

3610 #´agm¨
omp
 

3611 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3612 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3617 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3618 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3625 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3626 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3627 
lhs
[
i
][
j
][
ksize
][
BB
]);

3632 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3633 
rhs
[
i
][
j
][
ksize
] );

3637 
	}
}

	@BT/bt.old.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

37 
	~<Çutus/libccom·t.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
compu‹_rhs
();

55 
£t_cÚ¡ªts
();

56 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

57 
x_sŞve
();

58 
x_backsub¡™u‹
();

59 
x_sŞve_ûÎ
();

60 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

61 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

62 
cblock
[5][5]);

63 
bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]);

64 
bšvrhs
(
lhs
[5][5], 
r
[5]);

65 
y_sŞve
();

66 
y_backsub¡™u‹
();

67 
y_sŞve_ûÎ
();

68 
z_sŞve
();

69 
z_backsub¡™u‹
();

70 
z_sŞve_ûÎ
();

72 
´og¿m_BT
(*
buf
, * 
´iv
);

74 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

75 .
cmd
 = "nas-bt",

76 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

77 .
	ghªdËr
 = 
´og¿m_BT
,

79 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

86 
	$´og¿m_BT
(*
buf
, * 
´iv
) {

88 
n™”
, 
¡•
, 
n3
;

89 
Áh»ads
 = 1;

90 
Çvg
, 
mæİs
;

92 
tmax
;

93 
boŞ—n
 
v”if›d
;

94 
şass
;

102 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

116 
	`´štf
(" No input file inputbt.data. Using compiled defaults\n");

118 
n™”
 = 
NITER_DEFAULT
;

119 
dt
 = 
DT_DEFAULT
;

120 
grid_pošts
[0] = 
PROBLEM_SIZE
;

121 
grid_pošts
[1] = 
PROBLEM_SIZE
;

122 
grid_pošts
[2] = 
PROBLEM_SIZE
;

126 
	`´štf
(" Size: %3dx%3dx%3d\n",

127 
grid_pošts
[0], grid_points[1], grid_points[2]);

128 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

130 ià(
grid_pošts
[0] > 
IMAX
 ||

131 
grid_pošts
[1] > 
JMAX
 ||

132 
grid_pošts
[2] > 
KMAX
) {

133 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

134 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

135 
	`ex™
(1);

138 
	`£t_cÚ¡ªts
();

140 
	`š™Ÿlize
();

141 
	`lhsš™
();

143 
	`exaù_rhs
();

151 
	`adi
();

155 
	`š™Ÿlize
();

159 
	`tim”_ş—r
(1);

160 
	`tim”_¡¬t
(1);

162 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

164 ià(
¡•
%20 == 0 || step == 1) {

165 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

167 
	`adi
();

170 #´agm¨
omp
 
·¿Î–


172 #ià
	`defšed
(
_OPENMP
)

173 #´agm¨
omp
 
ma¡”


174 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

178 
	`tim”_¡İ
(1);

179 
tmax
 = 
	`tim”_»ad
(1);

181 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

183 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

184 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

185 iàĞ
tmax
 != 0.0 ) {

186 
mæİs
 = 1.0e-6*()
n™”
*

187 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

189 
mæİs
 = 0.0;

191 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

192 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

193 
tmax
, 
mæİs
, " floating…oint",

194 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

195 
CS6
, "(none)");

196 
	}
}

201 
	$add
() {

207 
i
, 
j
, 
k
, 
m
;

209 #´agm¨
omp
 

210 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

211 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

212 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

213 
m
 = 0; m < 5; m++) {

214 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

219 
	}
}

224 
	$adi
() {

225 #´agm¨
omp
 
·¿Î–


226 
	`compu‹_rhs
();

228 #´agm¨
omp
 
·¿Î–


229 
	`x_sŞve
();

231 #´agm¨
omp
 
·¿Î–


232 
	`y_sŞve
();

234 #´agm¨
omp
 
·¿Î–


235 
	`z_sŞve
();

237 #´agm¨
omp
 
·¿Î–


238 
	`add
();

239 
	}
}

244 
	$”rÜ_nÜm
(
rms
[5]) {

251 
i
, 
j
, 
k
, 
m
, 
d
;

252 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

254 
m
 = 0; m < 5; m++) {

255 
rms
[
m
] = 0.0;

258 
i
 = 0; i < 
grid_pošts
[0]; i++) {

259 
xi
 = ()
i
 * 
dnxm1
;

260 
j
 = 0; j < 
grid_pošts
[1]; j++) {

261 
‘a
 = ()
j
 * 
dnym1
;

262 
k
 = 0; k < 
grid_pošts
[2]; k++) {

263 
z‘a
 = ()
k
 * 
dnzm1
;

264 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

266 
m
 = 0; m < 5; m++) {

267 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

268 
rms
[
m
] =„ms[m] + 
add
*add;

274 
m
 = 0; m < 5; m++) {

275 
d
 = 0; d <= 2; d++) {

276 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

278 
rms
[
m
] = 
	`sq¹
(rms[m]);

280 
	}
}

285 
	$rhs_nÜm
(
rms
[5]) {

290 
i
, 
j
, 
k
, 
d
, 
m
;

291 
add
;

293 
m
 = 0; m < 5; m++) {

294 
rms
[
m
] = 0.0;

297 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

298 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

299 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

300 
m
 = 0; m < 5; m++) {

301 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

302 
rms
[
m
] =„ms[m] + 
add
*add;

308 
m
 = 0; m < 5; m++) {

309 
d
 = 0; d <= 2; d++) {

310 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

312 
rms
[
m
] = 
	`sq¹
(rms[m]);

314 
	}
}

320 
	$exaù_rhs
() {

322 #´agm¨
omp
 
·¿Î–


331 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

332 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

337 #´agm¨
omp
 

338 
i
 = 0; i < 
grid_pošts
[0]; i++) {

339 
j
 = 0; j < 
grid_pošts
[1]; j++) {

340 
k
 = 0; k < 
grid_pošts
[2]; k++) {

341 
m
 = 0; m < 5; m++) {

342 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

355 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

356 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

360 #´agm¨
omp
 

361 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

362 
‘a
 = ()
j
 * 
dnym1
;

364 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

365 
z‘a
 = ()
k
 * 
dnzm1
;

367 
i
 = 0; i < 
grid_pošts
[0]; i++) {

368 
xi
 = ()
i
 * 
dnxm1
;

370 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

371 
m
 = 0; m < 5; m++) {

372 
ue
[
i
][
m
] = 
d‹mp
[m];

374 
	`´štf
("1\n");

375 
dp
 = 1.0 / 
d‹mp
[0];

377 
m
 = 1; m <= 4; m++) {

378 
buf
[
i
][
m
] = 
dp
 * 
d‹mp
[m];

381 
	`´štf
("2\n");

382 
cuf
[
i
] = 
buf
[i][1] * buf[i][1];

383 
buf
[
i
][0] = 
cuf
[i] + buf[i][2] * buf[i][2] +

384 
buf
[
i
][3] * buf[i][3];

385 
q
[
i
] = 0.5*(
buf
[i][1]*
ue
[i][1] + buf[i][2]*ue[i][2] +

386 
buf
[
i
][3]*
ue
[i][3]);

388 
	`´štf
("3\n");

390 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

391 
im1
 = 
i
-1;

392 
1
 = 
i
+1;

394 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

395 
tx2
*(
ue
[
1
][1]-ue[
im1
][1])+

396 
dx1tx1
*(
ue
[
1
][0]-2.0*ue[
i
][0]+ue[
im1
][0]);

398 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

399 
tx2
 * ((
ue
[
1
][1]*
buf
[1][1]+
c2
*(ue[1][4]-
q
[ip1]))-

400 (
ue
[
im1
][1]*
buf
[im1][1]+
c2
*(ue[im1][4]-
q
[im1])))+

401 
xxcÚ1
*(
buf
[
1
][1]-2.0*buf[
i
][1]+buf[
im1
][1])+

402 
dx2tx1
*Ğ
ue
[
1
][1]-2.0* ue[
i
][1]+ ue[
im1
][1]);

404 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

405 
tx2
 * (
ue
[
1
][2]*
buf
[1][1]-ue[
im1
][2]*buf[im1][1])+

406 
xxcÚ2
*(
buf
[
1
][2]-2.0*buf[
i
][2]+buf[
im1
][2])+

407 
dx3tx1
*Ğ
ue
[
1
][2]-2.0* ue[
i
][2]+ ue[
im1
][2]);

409 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

410 
tx2
*(
ue
[
1
][3]*
buf
[1][1]-ue[
im1
][3]*buf[im1][1])+

411 
xxcÚ2
*(
buf
[
1
][3]-2.0*buf[
i
][3]+buf[
im1
][3])+

412 
dx4tx1
*Ğ
ue
[
1
][3]-2.0* ue[
i
][3]+ ue[
im1
][3]);

414 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

415 
tx2
*(
buf
[
1
][1]*(
c1
*
ue
[1][4]-
c2
*
q
[ip1])-

416 
buf
[
im1
][1]*(
c1
*
ue
[im1][4]-
c2
*
q
[im1]))+

417 0.5*
xxcÚ3
*(
buf
[
1
][0]-2.0*buf[
i
][0]+buf[
im1
][0])+

418 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

419 
xxcÚ5
*(
buf
[
1
][4]-2.0*buf[
i
][4]+buf[
im1
][4])+

420 
dx5tx1
*Ğ
ue
[
1
][4]-2.0* ue[
i
][4]+ ue[
im1
][4]);

423 
	`´štf
("4\n");

428 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0][0]);

429 
m
 = 0; m < 5; m++) {

430 
i
 = 1;

431 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

432 (5.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] +ue[i+2][m]);

433 
i
 = 2;

434 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

435 (-4.0*
ue
[
i
-1][
m
] + 6.0*ue[i][m] -

436 4.0*
ue
[
i
+1][
m
] + ue[i+2][m]);

438 
	`´štf
("5\n");

439 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0][0]);

440 
m
 = 0; m < 5; m++) {

441 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

442 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

443 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

444 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] + ue[i+2][m]);

447 
	`´štf
("6\n");

448 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0][0]);

449 
m
 = 0; m < 5; m++) {

450 
i
 = 
grid_pošts
[0]-3;

451 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

452 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

453 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m]);

454 
i
 = 
grid_pošts
[0]-2;

455 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

456 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] + 5.0*ue[i][m]);

458 
	`´štf
("7\n");

465 
	`´štf
("8");

469 #´agm¨
omp
 

470 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

471 
xi
 = ()
i
 * 
dnxm1
;

473 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

474 
z‘a
 = ()
k
 * 
dnzm1
;

476 
j
 = 0; j < 
grid_pošts
[1]; j++) {

477 
‘a
 = ()
j
 * 
dnym1
;

479 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

480 
m
 = 0; m < 5; m++) {

481 
ue
[
j
][
m
] = 
d‹mp
[m];

484 
dp
 = 1.0/
d‹mp
[0];

486 
m
 = 1; m <= 4; m++) {

487 
buf
[
j
][
m
] = 
dp
 * 
d‹mp
[m];

490 
cuf
[
j
] = 
buf
[j][2] * buf[j][2];

491 
buf
[
j
][0] = 
cuf
[j] + buf[j][1] * buf[j][1] +

492 
buf
[
j
][3] * buf[j][3];

493 
q
[
j
] = 0.5*(
buf
[j][1]*
ue
[j][1] + buf[j][2]*ue[j][2] +

494 
buf
[
j
][3]*
ue
[j][3]);

497 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

498 
jm1
 = 
j
-1;

499 
jp1
 = 
j
+1;

501 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

502 
ty2
*Ğ
ue
[
jp1
][2]-ue[
jm1
][2] )+

503 
dy1ty1
*(
ue
[
jp1
][0]-2.0*ue[
j
][0]+ue[
jm1
][0]);

505 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

506 
ty2
*(
ue
[
jp1
][1]*
buf
[jp1][2]-ue[
jm1
][1]*buf[jm1][2])+

507 
yycÚ2
*(
buf
[
jp1
][1]-2.0*buf[
j
][1]+buf[
jm1
][1])+

508 
dy2ty1
*Ğ
ue
[
jp1
][1]-2.0* ue[
j
][1]+ ue[
jm1
][1]);

510 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

511 
ty2
*((
ue
[
jp1
][2]*
buf
[jp1][2]+
c2
*(ue[jp1][4]-
q
[jp1]))-

512 (
ue
[
jm1
][2]*
buf
[jm1][2]+
c2
*(ue[jm1][4]-
q
[jm1])))+

513 
yycÚ1
*(
buf
[
jp1
][2]-2.0*buf[
j
][2]+buf[
jm1
][2])+

514 
dy3ty1
*Ğ
ue
[
jp1
][2]-2.0*ue[
j
][2] +ue[
jm1
][2]);

516 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

517 
ty2
*(
ue
[
jp1
][3]*
buf
[jp1][2]-ue[
jm1
][3]*buf[jm1][2])+

518 
yycÚ2
*(
buf
[
jp1
][3]-2.0*buf[
j
][3]+buf[
jm1
][3])+

519 
dy4ty1
*Ğ
ue
[
jp1
][3]-2.0*ue[
j
][3]+ ue[
jm1
][3]);

521 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

522 
ty2
*(
buf
[
jp1
][2]*(
c1
*
ue
[jp1][4]-
c2
*
q
[jp1])-

523 
buf
[
jm1
][2]*(
c1
*
ue
[jm1][4]-
c2
*
q
[jm1]))+

524 0.5*
yycÚ3
*(
buf
[
jp1
][0]-2.0*buf[
j
][0]+

525 
buf
[
jm1
][0])+

526 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

527 
yycÚ5
*(
buf
[
jp1
][4]-2.0*buf[
j
][4]+buf[
jm1
][4])+

528 
dy5ty1
*(
ue
[
jp1
][4]-2.0*ue[
j
][4]+ue[
jm1
][4]);

531 
	`´štf
("9\n");

536 
m
 = 0; m < 5; m++) {

537 
j
 = 1;

538 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

539 (5.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] +ue[j+2][m]);

540 
j
 = 2;

541 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

542 (-4.0*
ue
[
j
-1][
m
] + 6.0*ue[j][m] -

543 4.0*
ue
[
j
+1][
m
] + ue[j+2][m]);

546 
	`´štf
("9.1\n");

547 
m
 = 0; m < 5; m++) {

548 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

549 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

550 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

551 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] + ue[j+2][m]);

555 
	`´štf
("9.2\n");

556 
m
 = 0; m < 5; m++) {

557 
j
 = 
grid_pošts
[1]-3;

558 
	`´štf
("9.21\n");

562 
	`´štf
("9.22\n");

564 
j
 = 
grid_pošts
[1]-2;

565 
	`´štf
("9.23\n");

569 
	`´štf
("9.24\n");

573 
	`´štf
("9.3\n");

578 
	`´štf
("10\n");

583 #´agm¨
omp
 

584 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

585 
xi
 = ()
i
 * 
dnxm1
;

587 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

588 
‘a
 = ()
j
 * 
dnym1
;

590 
k
 = 0; k < 
grid_pošts
[2]; k++) {

591 
z‘a
 = ()
k
 * 
dnzm1
;

593 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

594 
m
 = 0; m < 5; m++) {

595 
ue
[
k
][
m
] = 
d‹mp
[m];

598 
dp
 = 1.0/
d‹mp
[0];

600 
m
 = 1; m <= 4; m++) {

601 
buf
[
k
][
m
] = 
dp
 * 
d‹mp
[m];

604 
cuf
[
k
] = 
buf
[k][3] * buf[k][3];

605 
buf
[
k
][0] = 
cuf
[k] + buf[k][1] * buf[k][1] +

606 
buf
[
k
][2] * buf[k][2];

607 
q
[
k
] = 0.5*(
buf
[k][1]*
ue
[k][1] + buf[k][2]*ue[k][2] +

608 
buf
[
k
][3]*
ue
[k][3]);

611 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

612 
km1
 = 
k
-1;

613 
kp1
 = 
k
+1;

615 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

616 
tz2
*Ğ
ue
[
kp1
][3]-ue[
km1
][3] )+

617 
dz1tz1
*(
ue
[
kp1
][0]-2.0*ue[
k
][0]+ue[
km1
][0]);

619 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

620 
tz2
 * (
ue
[
kp1
][1]*
buf
[kp1][3]-ue[
km1
][1]*buf[km1][3])+

621 
zzcÚ2
*(
buf
[
kp1
][1]-2.0*buf[
k
][1]+buf[
km1
][1])+

622 
dz2tz1
*Ğ
ue
[
kp1
][1]-2.0* ue[
k
][1]+ ue[
km1
][1]);

624 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

625 
tz2
 * (
ue
[
kp1
][2]*
buf
[kp1][3]-ue[
km1
][2]*buf[km1][3])+

626 
zzcÚ2
*(
buf
[
kp1
][2]-2.0*buf[
k
][2]+buf[
km1
][2])+

627 
dz3tz1
*(
ue
[
kp1
][2]-2.0*ue[
k
][2]+ue[
km1
][2]);

629 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

630 
tz2
 * ((
ue
[
kp1
][3]*
buf
[kp1][3]+
c2
*(ue[kp1][4]-
q
[kp1]))-

631 (
ue
[
km1
][3]*
buf
[km1][3]+
c2
*(ue[km1][4]-
q
[km1])))+

632 
zzcÚ1
*(
buf
[
kp1
][3]-2.0*buf[
k
][3]+buf[
km1
][3])+

633 
dz4tz1
*Ğ
ue
[
kp1
][3]-2.0*ue[
k
][3] +ue[
km1
][3]);

635 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

636 
tz2
 * (
buf
[
kp1
][3]*(
c1
*
ue
[kp1][4]-
c2
*
q
[kp1])-

637 
buf
[
km1
][3]*(
c1
*
ue
[km1][4]-
c2
*
q
[km1]))+

638 0.5*
zzcÚ3
*(
buf
[
kp1
][0]-2.0*buf[
k
][0]

639 +
buf
[
km1
][0])+

640 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

641 
zzcÚ5
*(
buf
[
kp1
][4]-2.0*buf[
k
][4]+buf[
km1
][4])+

642 
dz5tz1
*Ğ
ue
[
kp1
][4]-2.0*ue[
k
][4]+ ue[
km1
][4]);

645 
	`´štf
("11\n");

649 
m
 = 0; m < 5; m++) {

650 
k
 = 1;

651 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

652 (5.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] +ue[k+2][m]);

653 
k
 = 2;

654 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

655 (-4.0*
ue
[
k
-1][
m
] + 6.0*ue[k][m] -

656 4.0*
ue
[
k
+1][
m
] + ue[k+2][m]);

659 
m
 = 0; m < 5; m++) {

660 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

661 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

662 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

663 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] + ue[k+2][m]);

667 
m
 = 0; m < 5; m++) {

668 
k
 = 
grid_pošts
[2]-3;

669 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

670 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

671 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m]);

672 
k
 = 
grid_pošts
[2]-2;

673 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

674 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] + 5.0*ue[k][m]);

685 #´agm¨
omp
 

686 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

687 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

688 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

689 
m
 = 0; m < 5; m++) {

690 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

697 
	}
}

701 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

702 
d‹mp
[5]) {

711 
m
;

713 
m
 = 0; m < 5; m++) {

714 
d‹mp
[
m
] = 
û
[m][0] +

715 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

716 + 
xi
*
û
[
m
][10]))) +

717 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

718 + 
‘a
*
û
[
m
][11])))+

719 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

720 
z‘a
*
û
[
m
][12])));

722 
	}
}

727 
	$š™Ÿlize
() {

729 #´agm¨
omp
 
·¿Î–


739 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

740 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

748 #´agm¨
omp
 

749 
i
 = 0; i < 
IMAX
; i++) {

750 
j
 = 0; j < 
IMAX
; j++) {

751 
k
 = 0; k < 
IMAX
; k++) {

752 
m
 = 0; m < 5; m++) {

753 
u
[
i
][
j
][
k
][
m
] = 1.0;

763 #´agm¨
omp
 

764 
i
 = 0; i < 
grid_pošts
[0]; i++) {

765 
xi
 = ()
i
 * 
dnxm1
;

767 
j
 = 0; j < 
grid_pošts
[1]; j++) {

768 
‘a
 = ()
j
 * 
dnym1
;

770 
k
 = 0; k < 
grid_pošts
[2]; k++) {

771 
z‘a
 = ()
k
 * 
dnzm1
;

773 
ix
 = 0; ix < 2; ix++) {

774 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

775 &(
Pçû
[
ix
][0][0]));

778 
iy
 = 0; iy < 2; iy++) {

779 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

780 &
Pçû
[
iy
][1][0]);

783 
iz
 = 0; iz < 2; iz++) {

784 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

785 &
Pçû
[
iz
][2][0]);

788 
m
 = 0; m < 5; m++) {

789 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

790 (1.0-
xi
è* 
Pçû
[0][0][
m
];

791 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

792 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

793 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

794 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

796 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

797 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

798 
Pxi
*
P‘a
*
Pz‘a
;

811 
i
 = 0;

812 
xi
 = 0.0;

813 #´agm¨
omp
 
nowa™


814 
j
 = 0; j < 
grid_pošts
[1]; j++) {

815 
‘a
 = ()
j
 * 
dnym1
;

816 
k
 = 0; k < 
grid_pošts
[2]; k++) {

817 
z‘a
 = ()
k
 * 
dnzm1
;

818 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

819 
m
 = 0; m < 5; m++) {

820 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

829 
i
 = 
grid_pošts
[0]-1;

830 
xi
 = 1.0;

831 #´agm¨
omp
 

832 
j
 = 0; j < 
grid_pošts
[1]; j++) {

833 
‘a
 = ()
j
 * 
dnym1
;

834 
k
 = 0; k < 
grid_pošts
[2]; k++) {

835 
z‘a
 = ()
k
 * 
dnzm1
;

836 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

837 
m
 = 0; m < 5; m++) {

838 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

846 
j
 = 0;

847 
‘a
 = 0.0;

848 #´agm¨
omp
 
nowa™


849 
i
 = 0; i < 
grid_pošts
[0]; i++) {

850 
xi
 = ()
i
 * 
dnxm1
;

851 
k
 = 0; k < 
grid_pošts
[2]; k++) {

852 
z‘a
 = ()
k
 * 
dnzm1
;

853 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

854 
m
 = 0; m < 5; m++) {

855 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

863 
j
 = 
grid_pošts
[1]-1;

864 
‘a
 = 1.0;

865 #´agm¨
omp
 

866 
i
 = 0; i < 
grid_pošts
[0]; i++) {

867 
xi
 = ()
i
 * 
dnxm1
;

868 
k
 = 0; k < 
grid_pošts
[2]; k++) {

869 
z‘a
 = ()
k
 * 
dnzm1
;

870 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

871 
m
 = 0; m < 5; m++) {

872 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

880 
k
 = 0;

881 
z‘a
 = 0.0;

882 #´agm¨
omp
 
nowa™


883 
i
 = 0; i < 
grid_pošts
[0]; i++) {

884 
xi
 = ()
i
 *
dnxm1
;

885 
j
 = 0; j < 
grid_pošts
[1]; j++) {

886 
‘a
 = ()
j
 * 
dnym1
;

887 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

888 
m
 = 0; m < 5; m++) {

889 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

897 
k
 = 
grid_pošts
[2]-1;

898 
z‘a
 = 1.0;

899 #´agm¨
omp
 

900 
i
 = 0; i < 
grid_pošts
[0]; i++) {

901 
xi
 = ()
i
 * 
dnxm1
;

902 
j
 = 0; j < 
grid_pošts
[1]; j++) {

903 
‘a
 = ()
j
 * 
dnym1
;

904 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

905 
m
 = 0; m < 5; m++) {

906 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

912 
	}
}

916 
	$lhsš™
() {

918 #´agm¨
omp
 
·¿Î–


920 
i
, 
j
, 
k
, 
m
, 
n
;

928 #´agm¨
omp
 

929 
i
 = 0; i < 
grid_pošts
[0]; i++) {

930 
j
 = 0; j < 
grid_pošts
[1]; j++) {

931 
k
 = 0; k < 
grid_pošts
[2]; k++) {

932 
m
 = 0; m < 5; m++) {

933 
n
 = 0;‚ < 5;‚++) {

934 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

935 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

936 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

946 #´agm¨
omp
 

947 
i
 = 0; i < 
grid_pošts
[0]; i++) {

948 
j
 = 0; j < 
grid_pošts
[1]; j++) {

949 
k
 = 0; k < 
grid_pošts
[2]; k++) {

950 
m
 = 0; m < 5; m++) {

951 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

958 
	}
}

962 
	$lhsx
() {

971 
i
, 
j
, 
k
;

976 #´agm¨
omp
 

977 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

978 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

979 
i
 = 0; i < 
grid_pošts
[0]; i++) {

981 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

982 
tmp2
 = 
tmp1
 *mp1;

983 
tmp3
 = 
tmp1
 * 
tmp2
;

987 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

988 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

989 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

990 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

991 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

993 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

994 
u
[
i
][
j
][
k
][1])

995 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

996 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

997 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

998 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

999 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

1000 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

1001 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

1002 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

1004 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

1005 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

1006 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

1007 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

1008 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1010 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

1011 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

1012 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

1013 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

1014 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1016 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1017 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1018 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


1019 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1020 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

1021 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1022 - 0.50 * 
c2


1023 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1024 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1025 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

1026 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

1027 * 
tmp2
;

1028 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

1029 * 
tmp2
;

1030 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

1032 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1033 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1034 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1035 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1036 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1038 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1039 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1040 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1041 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1042 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1044 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1045 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1046 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1047 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1048 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1050 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1051 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1052 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1053 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1054 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1056 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1057 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1058 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1059 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1060 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1062 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1063 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1064 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1065 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1066 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1072 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1074 
tmp1
 = 
dt
 * 
tx1
;

1075 
tmp2
 = 
dt
 * 
tx2
;

1077 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1078 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1079 - 
tmp1
 * 
dx1
;

1080 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1081 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1082 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1083 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1084 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1085 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1086 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1087 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1089 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1090 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1091 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1092 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1093 - 
tmp1
 * 
dx2
;

1094 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1095 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1096 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1097 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1098 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1099 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1101 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1102 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1103 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1104 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1105 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1106 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1107 - 
tmp1
 * 
dx3
;

1108 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1109 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1110 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1111 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1113 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1114 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1115 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1116 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1117 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1118 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1119 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1120 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1121 - 
tmp1
 * 
dx4
;

1122 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1123 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1125 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1126 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1127 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1128 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1129 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1130 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1131 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1132 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1133 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1134 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1135 - 
tmp1
 * 
dx5
;

1137 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1138 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1139 + 
tmp1
 * 2.0 * 
dx1
;

1140 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1141 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1142 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1143 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1145 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1146 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1147 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1148 + 
tmp1
 * 2.0 * 
dx2
;

1149 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1150 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1151 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1153 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1154 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1155 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1156 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1157 + 
tmp1
 * 2.0 * 
dx3
;

1158 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1159 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1161 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1162 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1163 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1164 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1165 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1166 + 
tmp1
 * 2.0 * 
dx4
;

1167 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1169 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1170 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1171 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1172 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1173 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1174 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1175 + 
tmp1
 * 2.0 * 
dx5
;

1177 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1178 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1179 - 
tmp1
 * 
dx1
;

1180 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1181 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1182 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1183 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1184 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1185 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1186 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1187 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1189 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1190 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1191 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1192 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1193 - 
tmp1
 * 
dx2
;

1194 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1195 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1196 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1197 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1198 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1199 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1201 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1202 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1203 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1204 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1205 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1206 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1207 - 
tmp1
 * 
dx3
;

1208 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1209 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1210 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1211 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1213 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1214 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1215 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1216 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1217 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1218 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1219 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1220 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1221 - 
tmp1
 * 
dx4
;

1222 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1223 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1225 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1226 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1227 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1228 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1229 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1230 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1231 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1232 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1233 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1234 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1235 - 
tmp1
 * 
dx5
;

1240 
	}
}

1245 
	$lhsy
() {

1254 
i
, 
j
, 
k
;

1260 #´agm¨
omp
 

1261 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1262 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1263 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1265 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1266 
tmp2
 = 
tmp1
 *mp1;

1267 
tmp3
 = 
tmp1
 * 
tmp2
;

1269 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1270 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1271 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1272 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1273 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1275 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1276 * 
tmp2
;

1277 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1278 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1279 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1280 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1282 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1283 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1284 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1285 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1286 * 
tmp2
 );

1287 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1288 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1289 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1290 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1291 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1293 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1294 * 
tmp2
;

1295 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1296 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1297 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1298 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1300 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1301 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1302 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1303 * 
tmp2


1304 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1305 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1306 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1307 * 
tmp2
;

1308 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1309 - 0.50 * 
c2


1310 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1311 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1312 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1313 * 
tmp2
 );

1314 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1315 * 
tmp2
;

1316 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1318 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1319 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1320 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1321 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1322 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1324 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1325 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1326 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1327 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1328 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1330 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1331 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1332 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1333 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1334 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1336 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1337 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1338 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1339 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1340 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1342 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1343 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1344 - ( 
cÚ43
 * 
c3c4


1345 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1346 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1347 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1349 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1350 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1351 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1352 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1353 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1362 #´agm¨
omp
 

1363 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1364 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1365 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1367 
tmp1
 = 
dt
 * 
ty1
;

1368 
tmp2
 = 
dt
 * 
ty2
;

1370 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1371 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1372 - 
tmp1
 * 
dy1
;

1373 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1374 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1375 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1376 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1377 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1378 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1379 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1380 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1382 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1383 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1384 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1385 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1386 - 
tmp1
 * 
dy2
;

1387 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1388 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1389 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1390 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1391 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1392 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1394 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1395 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1396 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1397 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1398 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1399 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1400 - 
tmp1
 * 
dy3
;

1401 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1402 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1403 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1404 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1406 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1407 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1408 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1409 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1410 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1411 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1412 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1413 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1414 - 
tmp1
 * 
dy4
;

1415 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1416 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1418 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1419 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1420 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1421 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1422 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1423 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1424 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1425 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1426 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1427 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1428 - 
tmp1
 * 
dy5
;

1430 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1431 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1432 + 
tmp1
 * 2.0 * 
dy1
;

1433 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1434 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1435 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1436 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1438 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1439 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1440 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1441 + 
tmp1
 * 2.0 * 
dy2
;

1442 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1443 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1444 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1446 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1447 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1448 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1449 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1450 + 
tmp1
 * 2.0 * 
dy3
;

1451 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1452 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1454 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1455 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1456 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1457 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1458 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1459 + 
tmp1
 * 2.0 * 
dy4
;

1460 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1462 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1463 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1464 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1465 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1466 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1467 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1468 + 
tmp1
 * 2.0 * 
dy5
;

1470 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1471 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1472 - 
tmp1
 * 
dy1
;

1473 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1474 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1475 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1476 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1477 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1478 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1479 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1480 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1482 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1483 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1484 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1485 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1486 - 
tmp1
 * 
dy2
;

1487 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1488 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1489 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1490 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1491 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1492 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1494 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1495 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1496 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1497 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1498 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1499 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1500 - 
tmp1
 * 
dy3
;

1501 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1502 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1503 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1504 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1506 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1507 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1508 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1509 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1510 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1511 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1512 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1513 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1514 - 
tmp1
 * 
dy4
;

1515 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1516 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1518 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1519 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1520 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1521 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1522 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1523 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1524 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1525 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1526 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1527 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1528 - 
tmp1
 * 
dy5
;

1533 
	}
}

1539 
	$lhsz
() {

1548 
i
, 
j
, 
k
;

1554 #´agm¨
omp
 

1555 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1556 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1557 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1559 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1560 
tmp2
 = 
tmp1
 *mp1;

1561 
tmp3
 = 
tmp1
 * 
tmp2
;

1563 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1564 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1565 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1566 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1567 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1569 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1570 * 
tmp2
;

1571 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1572 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1573 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1574 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1576 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1577 * 
tmp2
;

1578 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1579 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1580 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1581 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1583 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1584 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1585 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1586 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1587 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1588 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1589 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1590 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1591 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1593 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1594 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1595 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1596 * 
tmp2


1597 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1598 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1599 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1600 * 
tmp2
;

1601 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1602 * 
tmp2
;

1603 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1604 - 0.50 * 
c2


1605 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1606 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1607 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1608 * 
tmp2
 );

1609 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1611 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1612 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1613 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1614 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1615 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1617 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1618 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1619 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1620 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1621 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1623 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1624 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1625 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1626 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1627 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1629 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1630 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1631 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1632 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1633 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1635 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1636 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1637 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1638 - ( 
cÚ43
 * 
c3c4


1639 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1640 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1642 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1643 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1644 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1645 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1646 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1655 #´agm¨
omp
 

1656 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1657 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1658 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1660 
tmp1
 = 
dt
 * 
tz1
;

1661 
tmp2
 = 
dt
 * 
tz2
;

1663 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1664 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1665 - 
tmp1
 * 
dz1
;

1666 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1667 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1668 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1669 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1670 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1671 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1672 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1673 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1675 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1676 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1677 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1678 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1679 - 
tmp1
 * 
dz2
;

1680 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1681 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1682 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1683 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1684 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1685 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1687 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1688 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1689 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1690 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1691 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1692 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1693 - 
tmp1
 * 
dz3
;

1694 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1695 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1696 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1697 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1699 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1700 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1701 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1702 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1703 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1704 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1705 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1706 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1707 - 
tmp1
 * 
dz4
;

1708 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1709 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1711 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1712 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1713 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1714 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1715 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1716 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1717 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1718 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1719 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1720 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1721 - 
tmp1
 * 
dz5
;

1723 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1724 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1725 + 
tmp1
 * 2.0 * 
dz1
;

1726 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1727 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1728 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1729 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1731 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1732 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1733 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1734 + 
tmp1
 * 2.0 * 
dz2
;

1735 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1736 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1737 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1739 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1740 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1741 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1742 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1743 + 
tmp1
 * 2.0 * 
dz3
;

1744 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1745 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1747 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1748 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1749 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1750 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1751 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1752 + 
tmp1
 * 2.0 * 
dz4
;

1753 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1755 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1756 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1757 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1758 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1759 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1760 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1761 + 
tmp1
 * 2.0 * 
dz5
;

1763 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1764 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1765 - 
tmp1
 * 
dz1
;

1766 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1767 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1768 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1769 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1770 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1771 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1772 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1773 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1775 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1776 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1777 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1778 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1779 - 
tmp1
 * 
dz2
;

1780 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1781 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1782 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1783 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1784 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1785 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1787 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1788 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1789 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1790 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1791 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1792 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1793 - 
tmp1
 * 
dz3
;

1794 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1795 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1796 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1797 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1799 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1800 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1801 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1802 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1803 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1804 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1805 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1806 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1807 - 
tmp1
 * 
dz4
;

1808 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1809 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1811 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1812 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1813 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1814 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1815 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1816 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1817 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1818 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1819 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1820 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1821 - 
tmp1
 * 
dz5
;

1826 
	}
}

1831 
	$compu‹_rhs
() {

1833 
i
, 
j
, 
k
, 
m
;

1834 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1840 #´agm¨
omp
 
nowa™


1841 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1842 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1843 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1844 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1845 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1846 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1847 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1848 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1849 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1850 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1851 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1852 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1863 #´agm¨
omp
 

1864 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1865 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1866 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1867 
m
 = 0; m < 5; m++) {

1868 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1877 #´agm¨
omp
 

1878 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1879 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1880 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1881 
uijk
 = 
us
[
i
][
j
][
k
];

1882 
up1
 = 
us
[
i
+1][
j
][
k
];

1883 
um1
 = 
us
[
i
-1][
j
][
k
];

1885 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1886 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1887 
u
[
i
-1][
j
][
k
][0]) -

1888 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1890 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1891 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1892 
u
[
i
-1][
j
][
k
][1]) +

1893 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1894 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1895 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1896 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1897 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1898 
c2
);

1900 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1901 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1902 
u
[
i
-1][
j
][
k
][2]) +

1903 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1904 
vs
[
i
-1][
j
][
k
]) -

1905 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1906 
u
[
i
-1][
j
][
k
][2]*
um1
);

1908 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1909 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1910 
u
[
i
-1][
j
][
k
][3]) +

1911 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1912 
ws
[
i
-1][
j
][
k
]) -

1913 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1914 
u
[
i
-1][
j
][
k
][3]*
um1
);

1916 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1917 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1918 
u
[
i
-1][
j
][
k
][4]) +

1919 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1920 
qs
[
i
-1][
j
][
k
]) +

1921 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1922 
um1
*um1) +

1923 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1924 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1925 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1926 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1927 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1928 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1929 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1937 
i
 = 1;

1938 #´agm¨
omp
 
nowa™


1939 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1940 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1941 
m
 = 0; m < 5; m++) {

1942 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1943 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1944 
u
[
i
+2][
j
][
k
][
m
]);

1949 
i
 = 2;

1950 #´agm¨
omp
 
nowa™


1951 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1952 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1953 
m
 = 0; m < 5; m++) {

1954 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1955 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1956 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1961 #´agm¨
omp
 
nowa™


1962 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1963 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1964 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1965 
m
 = 0; m < 5; m++) {

1966 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1967 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1968 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1969 
u
[
i
+2][
j
][
k
][
m
] );

1975 
i
 = 
grid_pošts
[0]-3;

1976 #´agm¨
omp
 
nowa™


1977 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1978 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1979 
m
 = 0; m < 5; m++) {

1980 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1981 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1982 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

1987 
i
 = 
grid_pošts
[0]-2;

1988 #´agm¨
omp
 

1989 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1990 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1991 
m
 = 0; m < 5; m++) {

1992 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1993 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

1994 5.0*
u
[
i
][
j
][
k
][
m
] );

2002 #´agm¨
omp
 

2003 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2004 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2005 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2006 
vijk
 = 
vs
[
i
][
j
][
k
];

2007 
vp1
 = 
vs
[
i
][
j
+1][
k
];

2008 
vm1
 = 
vs
[
i
][
j
-1][
k
];

2009 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

2010 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

2011 
u
[
i
][
j
-1][
k
][0]) -

2012 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

2013 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

2014 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

2015 
u
[
i
][
j
-1][
k
][1]) +

2016 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

2017 
us
[
i
][
j
-1][
k
]) -

2018 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

2019 
u
[
i
][
j
-1][
k
][1]*
vm1
);

2020 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

2021 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

2022 
u
[
i
][
j
-1][
k
][2]) +

2023 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

2024 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

2025 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

2026 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

2027 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

2028 *
c2
);

2029 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

2030 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

2031 
u
[
i
][
j
-1][
k
][3]) +

2032 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

2033 
ws
[
i
][
j
-1][
k
]) -

2034 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

2035 
u
[
i
][
j
-1][
k
][3]*
vm1
);

2036 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

2037 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

2038 
u
[
i
][
j
-1][
k
][4]) +

2039 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

2040 
qs
[
i
][
j
-1][
k
]) +

2041 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

2042 
vm1
*vm1) +

2043 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2044 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2045 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2046 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2047 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2048 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2049 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2057 
j
 = 1;

2058 #´agm¨
omp
 
nowa™


2059 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2060 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2061 
m
 = 0; m < 5; m++) {

2062 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2063 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2064 
u
[
i
][
j
+2][
k
][
m
]);

2069 
j
 = 2;

2070 #´agm¨
omp
 
nowa™


2071 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2072 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2073 
m
 = 0; m < 5; m++) {

2074 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2075 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2076 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2081 #´agm¨
omp
 
nowa™


2082 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2083 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2084 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2085 
m
 = 0; m < 5; m++) {

2086 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2087 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2088 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2089 
u
[
i
][
j
+2][
k
][
m
] );

2095 
j
 = 
grid_pošts
[1]-3;

2096 #´agm¨
omp
 
nowa™


2097 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2098 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2099 
m
 = 0; m < 5; m++) {

2100 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2101 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2102 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2107 
j
 = 
grid_pošts
[1]-2;

2108 #´agm¨
omp
 

2109 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2110 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2111 
m
 = 0; m < 5; m++) {

2112 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2113 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2114 5.*
u
[
i
][
j
][
k
][
m
] );

2122 #´agm¨
omp
 

2123 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2124 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2125 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2126 
wijk
 = 
ws
[
i
][
j
][
k
];

2127 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2128 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2130 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2131 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2132 
u
[
i
][
j
][
k
-1][0]) -

2133 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2134 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2135 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2136 
u
[
i
][
j
][
k
-1][1]) +

2137 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2138 
us
[
i
][
j
][
k
-1]) -

2139 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2140 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2141 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2142 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2143 
u
[
i
][
j
][
k
-1][2]) +

2144 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2145 
vs
[
i
][
j
][
k
-1]) -

2146 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2147 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2148 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2149 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2150 
u
[
i
][
j
][
k
-1][3]) +

2151 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2152 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2153 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2154 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2155 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2156 *
c2
);

2157 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2158 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2159 
u
[
i
][
j
][
k
-1][4]) +

2160 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2161 
qs
[
i
][
j
][
k
-1]) +

2162 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2163 
wm1
*wm1) +

2164 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2165 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2166 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2167 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2168 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2169 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2170 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2178 
k
 = 1;

2179 #´agm¨
omp
 
nowa™


2180 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2181 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2182 
m
 = 0; m < 5; m++) {

2183 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2184 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2185 
u
[
i
][
j
][
k
+2][
m
]);

2190 
k
 = 2;

2191 #´agm¨
omp
 
nowa™


2192 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2193 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2194 
m
 = 0; m < 5; m++) {

2195 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2196 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2197 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2202 #´agm¨
omp
 
nowa™


2203 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2204 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2205 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2206 
m
 = 0; m < 5; m++) {

2207 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2208 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2209 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2210 
u
[
i
][
j
][
k
+2][
m
] );

2216 
k
 = 
grid_pošts
[2]-3;

2217 #´agm¨
omp
 
nowa™


2218 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2219 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2220 
m
 = 0; m < 5; m++) {

2221 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2222 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2223 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2228 
k
 = 
grid_pošts
[2]-2;

2229 #´agm¨
omp
 

2230 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2231 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2232 
m
 = 0; m < 5; m++) {

2233 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2234 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2235 5.0*
u
[
i
][
j
][
k
][
m
] );

2240 #´agm¨
omp
 

2241 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2242 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2243 
m
 = 0; m < 5; m++) {

2244 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2245 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2250 
	}
}

2255 
	$£t_cÚ¡ªts
() {

2260 
û
[0][0] = 2.0;

2261 
û
[0][1] = 0.0;

2262 
û
[0][2] = 0.0;

2263 
û
[0][3] = 4.0;

2264 
û
[0][4] = 5.0;

2265 
û
[0][5] = 3.0;

2266 
û
[0][6] = 0.5;

2267 
û
[0][7] = 0.02;

2268 
û
[0][8] = 0.01;

2269 
û
[0][9] = 0.03;

2270 
û
[0][10] = 0.5;

2271 
û
[0][11] = 0.4;

2272 
û
[0][12] = 0.3;

2274 
û
[1][0] = 1.0;

2275 
û
[1][1] = 0.0;

2276 
û
[1][2] = 0.0;

2277 
û
[1][3] = 0.0;

2278 
û
[1][4] = 1.0;

2279 
û
[1][5] = 2.0;

2280 
û
[1][6] = 3.0;

2281 
û
[1][7] = 0.01;

2282 
û
[1][8] = 0.03;

2283 
û
[1][9] = 0.02;

2284 
û
[1][10] = 0.4;

2285 
û
[1][11] = 0.3;

2286 
û
[1][12] = 0.5;

2288 
û
[2][0] = 2.0;

2289 
û
[2][1] = 2.0;

2290 
û
[2][2] = 0.0;

2291 
û
[2][3] = 0.0;

2292 
û
[2][4] = 0.0;

2293 
û
[2][5] = 2.0;

2294 
û
[2][6] = 3.0;

2295 
û
[2][7] = 0.04;

2296 
û
[2][8] = 0.03;

2297 
û
[2][9] = 0.05;

2298 
û
[2][10] = 0.3;

2299 
û
[2][11] = 0.5;

2300 
û
[2][12] = 0.4;

2302 
û
[3][0] = 2.0;

2303 
û
[3][1] = 2.0;

2304 
û
[3][2] = 0.0;

2305 
û
[3][3] = 0.0;

2306 
û
[3][4] = 0.0;

2307 
û
[3][5] = 2.0;

2308 
û
[3][6] = 3.0;

2309 
û
[3][7] = 0.03;

2310 
û
[3][8] = 0.05;

2311 
û
[3][9] = 0.04;

2312 
û
[3][10] = 0.2;

2313 
û
[3][11] = 0.1;

2314 
û
[3][12] = 0.3;

2316 
û
[4][0] = 5.0;

2317 
û
[4][1] = 4.0;

2318 
û
[4][2] = 3.0;

2319 
û
[4][3] = 2.0;

2320 
û
[4][4] = 0.1;

2321 
û
[4][5] = 0.4;

2322 
û
[4][6] = 0.3;

2323 
û
[4][7] = 0.05;

2324 
û
[4][8] = 0.04;

2325 
û
[4][9] = 0.03;

2326 
û
[4][10] = 0.1;

2327 
û
[4][11] = 0.3;

2328 
û
[4][12] = 0.2;

2330 
c1
 = 1.4;

2331 
c2
 = 0.4;

2332 
c3
 = 0.1;

2333 
c4
 = 1.0;

2334 
c5
 = 1.4;

2336 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2337 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2338 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2340 
c1c2
 = 
c1
 * 
c2
;

2341 
c1c5
 = 
c1
 * 
c5
;

2342 
c3c4
 = 
c3
 * 
c4
;

2343 
c1345
 = 
c1c5
 * 
c3c4
;

2345 
cÚz1
 = (1.0-
c1c5
);

2347 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2348 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2349 
tx3
 = 1.0 / 
dnxm1
;

2351 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2352 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2353 
ty3
 = 1.0 / 
dnym1
;

2355 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2356 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2357 
tz3
 = 1.0 / 
dnzm1
;

2359 
dx1
 = 0.75;

2360 
dx2
 = 0.75;

2361 
dx3
 = 0.75;

2362 
dx4
 = 0.75;

2363 
dx5
 = 0.75;

2365 
dy1
 = 0.75;

2366 
dy2
 = 0.75;

2367 
dy3
 = 0.75;

2368 
dy4
 = 0.75;

2369 
dy5
 = 0.75;

2371 
dz1
 = 1.0;

2372 
dz2
 = 1.0;

2373 
dz3
 = 1.0;

2374 
dz4
 = 1.0;

2375 
dz5
 = 1.0;

2377 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2378 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2379 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2381 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2383 
c4ds¥
 = 4.0 * 
ds¥
;

2384 
c5ds¥
 = 5.0 * 
ds¥
;

2386 
d‰x1
 = 
dt
*
tx1
;

2387 
d‰x2
 = 
dt
*
tx2
;

2388 
d‰y1
 = 
dt
*
ty1
;

2389 
d‰y2
 = 
dt
*
ty2
;

2390 
d‰z1
 = 
dt
*
tz1
;

2391 
d‰z2
 = 
dt
*
tz2
;

2393 
c2d‰x1
 = 2.0*
d‰x1
;

2394 
c2d‰y1
 = 2.0*
d‰y1
;

2395 
c2d‰z1
 = 2.0*
d‰z1
;

2397 
dtds¥
 = 
dt
*
ds¥
;

2399 
comz1
 = 
dtds¥
;

2400 
comz4
 = 4.0*
dtds¥
;

2401 
comz5
 = 5.0*
dtds¥
;

2402 
comz6
 = 6.0*
dtds¥
;

2404 
c3c4tx3
 = 
c3c4
*
tx3
;

2405 
c3c4ty3
 = 
c3c4
*
ty3
;

2406 
c3c4tz3
 = 
c3c4
*
tz3
;

2408 
dx1tx1
 = 
dx1
*
tx1
;

2409 
dx2tx1
 = 
dx2
*
tx1
;

2410 
dx3tx1
 = 
dx3
*
tx1
;

2411 
dx4tx1
 = 
dx4
*
tx1
;

2412 
dx5tx1
 = 
dx5
*
tx1
;

2414 
dy1ty1
 = 
dy1
*
ty1
;

2415 
dy2ty1
 = 
dy2
*
ty1
;

2416 
dy3ty1
 = 
dy3
*
ty1
;

2417 
dy4ty1
 = 
dy4
*
ty1
;

2418 
dy5ty1
 = 
dy5
*
ty1
;

2420 
dz1tz1
 = 
dz1
*
tz1
;

2421 
dz2tz1
 = 
dz2
*
tz1
;

2422 
dz3tz1
 = 
dz3
*
tz1
;

2423 
dz4tz1
 = 
dz4
*
tz1
;

2424 
dz5tz1
 = 
dz5
*
tz1
;

2426 
c2iv
 = 2.5;

2427 
cÚ43
 = 4.0/3.0;

2428 
cÚ16
 = 1.0/6.0;

2430 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2431 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2432 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2433 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2434 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2436 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2437 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2438 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2439 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2440 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2442 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2443 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2444 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2445 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2446 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2447 
	}
}

2452 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2461 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2462 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2463 
m
;

2468 
•sÚ
 = 1.0e-08;

2474 
	`”rÜ_nÜm
(
xû
);

2475 
	`compu‹_rhs
();

2477 
	`rhs_nÜm
(
xü
);

2479 
m
 = 0; m < 5; m++) {

2480 
xü
[
m
] = xü[m] / 
dt
;

2483 *
şass
 = 'U';

2484 *
v”if›d
 = 
TRUE
;

2486 
m
 = 0; m < 5; m++) {

2487 
xü»f
[
m
] = 1.0;

2488 
xû»f
[
m
] = 1.0;

2494 ià(
grid_pošts
[0] == 12 &&

2495 
grid_pošts
[1] == 12 &&

2496 
grid_pošts
[2] == 12 &&

2497 
no_time_¡•s
 == 60) {

2499 *
şass
 = 'S';

2500 
dŒef
 = 1.0e-2;

2505 
xü»f
[0] = 1.7034283709541311e-01;

2506 
xü»f
[1] = 1.2975252070034097e-02;

2507 
xü»f
[2] = 3.2527926989486055e-02;

2508 
xü»f
[3] = 2.6436421275166801e-02;

2509 
xü»f
[4] = 1.9211784131744430e-01;

2514 
xû»f
[0] = 4.9976913345811579e-04;

2515 
xû»f
[1] = 4.5195666782961927e-05;

2516 
xû»f
[2] = 7.3973765172921357e-05;

2517 
xû»f
[3] = 7.3821238632439731e-05;

2518 
xû»f
[4] = 8.9269630987491446e-04;

2523 } ià(
grid_pošts
[0] == 24 &&

2524 
grid_pošts
[1] == 24 &&

2525 
grid_pošts
[2] == 24 &&

2526 
no_time_¡•s
 == 200) {

2528 *
şass
 = 'W';

2529 
dŒef
 = 0.8e-3;

2533 
xü»f
[0] = 0.1125590409344e+03;

2534 
xü»f
[1] = 0.1180007595731e+02;

2535 
xü»f
[2] = 0.2710329767846e+02;

2536 
xü»f
[3] = 0.2469174937669e+02;

2537 
xü»f
[4] = 0.2638427874317e+03;

2542 
xû»f
[0] = 0.4419655736008e+01;

2543 
xû»f
[1] = 0.4638531260002e+00;

2544 
xû»f
[2] = 0.1011551749967e+01;

2545 
xû»f
[3] = 0.9235878729944e+00;

2546 
xû»f
[4] = 0.1018045837718e+02;

2552 } ià(
grid_pošts
[0] == 64 &&

2553 
grid_pošts
[1] == 64 &&

2554 
grid_pošts
[2] == 64 &&

2555 
no_time_¡•s
 == 200) {

2557 *
şass
 = 'A';

2558 
dŒef
 = 0.8e-3;

2562 
xü»f
[0] = 1.0806346714637264e+02;

2563 
xü»f
[1] = 1.1319730901220813e+01;

2564 
xü»f
[2] = 2.5974354511582465e+01;

2565 
xü»f
[3] = 2.3665622544678910e+01;

2566 
xü»f
[4] = 2.5278963211748344e+02;

2571 
xû»f
[0] = 4.2348416040525025e+00;

2572 
xû»f
[1] = 4.4390282496995698e-01;

2573 
xû»f
[2] = 9.6692480136345650e-01;

2574 
xû»f
[3] = 8.8302063039765474e-01;

2575 
xû»f
[4] = 9.7379901770829278e+00;

2581 } ià(
grid_pošts
[0] == 102 &&

2582 
grid_pošts
[1] == 102 &&

2583 
grid_pošts
[2] == 102 &&

2584 
no_time_¡•s
 == 200) {

2586 *
şass
 = 'B';

2587 
dŒef
 = 3.0e-4;

2592 
xü»f
[0] = 1.4233597229287254e+03;

2593 
xü»f
[1] = 9.9330522590150238e+01;

2594 
xü»f
[2] = 3.5646025644535285e+02;

2595 
xü»f
[3] = 3.2485447959084092e+02;

2596 
xü»f
[4] = 3.2707541254659363e+03;

2601 
xû»f
[0] = 5.2969847140936856e+01;

2602 
xû»f
[1] = 4.4632896115670668e+00;

2603 
xû»f
[2] = 1.3122573342210174e+01;

2604 
xû»f
[3] = 1.2006925323559144e+01;

2605 
xû»f
[4] = 1.2459576151035986e+02;

2611 } ià(
grid_pošts
[0] == 162 &&

2612 
grid_pošts
[1] == 162 &&

2613 
grid_pošts
[2] == 162 &&

2614 
no_time_¡•s
 == 200) {

2616 *
şass
 = 'C';

2617 
dŒef
 = 1.0e-4;

2622 
xü»f
[0] = 0.62398116551764615e+04;

2623 
xü»f
[1] = 0.50793239190423964e+03;

2624 
xü»f
[2] = 0.15423530093013596e+04;

2625 
xü»f
[3] = 0.13302387929291190e+04;

2626 
xü»f
[4] = 0.11604087428436455e+05;

2631 
xû»f
[0] = 0.16462008369091265e+03;

2632 
xû»f
[1] = 0.11497107903824313e+02;

2633 
xû»f
[2] = 0.41207446207461508e+02;

2634 
xû»f
[3] = 0.37087651059694167e+02;

2635 
xû»f
[4] = 0.36211053051841265e+03;

2638 *
v”if›d
 = 
FALSE
;

2649 
m
 = 0; m < 5; m++) {

2651 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2652 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2660 ià(*
şass
 != 'U') {

2661 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2662 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2663 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2664 *
v”if›d
 = 
FALSE
;

2665 *
şass
 = 'U';

2666 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2669 
	`´štf
(" Unknown class\n");

2672 ià(*
şass
 != 'U') {

2673 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2675 
	`´štf
(" RMS-norms of„esidual\n");

2677 
m
 = 0; m < 5; m++) {

2678 ià(*
şass
 == 'U') {

2679 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2680 } ià(
xüdif
[
m
] > 
•sÚ
) {

2681 *
v”if›d
 = 
FALSE
;

2682 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2683 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2685 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2686 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2690 ià(*
şass
 != 'U') {

2691 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2693 
	`´štf
(" RMS-norms of solutionƒrror\n");

2696 
m
 = 0; m < 5; m++) {

2697 ià(*
şass
 == 'U') {

2698 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2699 } ià(
xûdif
[
m
] > 
•sÚ
) {

2700 *
v”if›d
 = 
FALSE
;

2701 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2702 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2704 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2705 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2709 ià(*
şass
 == 'U') {

2710 
	`´štf
(" No„eference values…rovided\n");

2711 
	`´štf
(" No verification…erformed\n");

2712 } ià(*
v”if›d
 =ğ
TRUE
) {

2713 
	`´štf
(" Verification Successful\n");

2715 
	`´štf
(" Verification failed\n");

2717 
	}
}

2722 
	$x_sŞve
() {

2739 
	`lhsx
();

2740 
	`x_sŞve_ûÎ
();

2741 
	`x_backsub¡™u‹
();

2742 
	}
}

2748 
	$x_backsub¡™u‹
() {

2760 
i
, 
j
, 
k
, 
m
, 
n
;

2762 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2763 #´agm¨
omp
 

2764 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2765 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2766 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2767 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2768 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2769 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2775 
	}
}

2780 
	$x_sŞve_ûÎ
() {

2792 
i
,
j
,
k
,
isize
;

2794 
isize
 = 
grid_pošts
[0]-1;

2799 #´agm¨
omp
 

2800 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2801 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2807 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2808 
lhs
[0][
j
][
k
][
CC
],

2809 
rhs
[0][
j
][
k
] );

2817 
i
 = 1; i < 
isize
; i++) {

2818 #´agm¨
omp
 

2819 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2820 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2825 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2826 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2831 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2832 
lhs
[
i
-1][
j
][
k
][
CC
],

2833 
lhs
[
i
][
j
][
k
][
BB
]);

2840 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2841 
lhs
[
i
][
j
][
k
][
CC
],

2842 
rhs
[
i
][
j
][
k
] );

2848 #´agm¨
omp
 

2849 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2850 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2855 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2856 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2861 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2862 
lhs
[
isize
-1][
j
][
k
][
CC
],

2863 
lhs
[
isize
][
j
][
k
][
BB
]);

2868 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2869 
rhs
[
i
][
j
][
k
] );

2873 
	}
}

2878 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2887 
i
;

2889 
i
 = 0; i < 5; i++) {

2894 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2895 - 
ablock
[
i
][1]*
avec
[1]

2896 - 
ablock
[
i
][2]*
avec
[2]

2897 - 
ablock
[
i
][3]*
avec
[3]

2898 - 
ablock
[
i
][4]*
avec
[4];

2900 
	}
}

2905 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2906 
cblock
[5][5]) {

2915 
j
;

2917 
j
 = 0; j < 5; j++) {

2918 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2919 - 
ablock
[0][1]*
bblock
[1][
j
]

2920 - 
ablock
[0][2]*
bblock
[2][
j
]

2921 - 
ablock
[0][3]*
bblock
[3][
j
]

2922 - 
ablock
[0][4]*
bblock
[4][
j
];

2923 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2924 - 
ablock
[1][1]*
bblock
[1][
j
]

2925 - 
ablock
[1][2]*
bblock
[2][
j
]

2926 - 
ablock
[1][3]*
bblock
[3][
j
]

2927 - 
ablock
[1][4]*
bblock
[4][
j
];

2928 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2929 - 
ablock
[2][1]*
bblock
[1][
j
]

2930 - 
ablock
[2][2]*
bblock
[2][
j
]

2931 - 
ablock
[2][3]*
bblock
[3][
j
]

2932 - 
ablock
[2][4]*
bblock
[4][
j
];

2933 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2934 - 
ablock
[3][1]*
bblock
[1][
j
]

2935 - 
ablock
[3][2]*
bblock
[2][
j
]

2936 - 
ablock
[3][3]*
bblock
[3][
j
]

2937 - 
ablock
[3][4]*
bblock
[4][
j
];

2938 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2939 - 
ablock
[4][1]*
bblock
[1][
j
]

2940 - 
ablock
[4][2]*
bblock
[2][
j
]

2941 - 
ablock
[4][3]*
bblock
[3][
j
]

2942 - 
ablock
[4][4]*
bblock
[4][
j
];

2944 
	}
}

2949 
	$bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]) {

2954 
pivÙ
, 
cÛff
;

2960 
pivÙ
 = 1.00/
lhs
[0][0];

2961 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

2962 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

2963 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

2964 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

2965 
c
[0][0] = c[0][0]*
pivÙ
;

2966 
c
[0][1] = c[0][1]*
pivÙ
;

2967 
c
[0][2] = c[0][2]*
pivÙ
;

2968 
c
[0][3] = c[0][3]*
pivÙ
;

2969 
c
[0][4] = c[0][4]*
pivÙ
;

2970 
r
[0] =„[0] *
pivÙ
;

2972 
cÛff
 = 
lhs
[1][0];

2973 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

2974 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

2975 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

2976 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

2977 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

2978 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

2979 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

2980 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

2981 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

2982 
r
[1] =„[1] - 
cÛff
*r[0];

2984 
cÛff
 = 
lhs
[2][0];

2985 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

2986 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

2987 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

2988 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

2989 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

2990 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

2991 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

2992 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

2993 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

2994 
r
[2] =„[2] - 
cÛff
*r[0];

2996 
cÛff
 = 
lhs
[3][0];

2997 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

2998 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

2999 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3000 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3001 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

3002 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

3003 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

3004 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

3005 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

3006 
r
[3] =„[3] - 
cÛff
*r[0];

3008 
cÛff
 = 
lhs
[4][0];

3009 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3010 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3011 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3012 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3013 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

3014 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

3015 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

3016 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

3017 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

3018 
r
[4] =„[4] - 
cÛff
*r[0];

3021 
pivÙ
 = 1.00/
lhs
[1][1];

3022 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3023 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3024 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3025 
c
[1][0] = c[1][0]*
pivÙ
;

3026 
c
[1][1] = c[1][1]*
pivÙ
;

3027 
c
[1][2] = c[1][2]*
pivÙ
;

3028 
c
[1][3] = c[1][3]*
pivÙ
;

3029 
c
[1][4] = c[1][4]*
pivÙ
;

3030 
r
[1] =„[1] *
pivÙ
;

3032 
cÛff
 = 
lhs
[0][1];

3033 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3034 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3035 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3036 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

3037 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

3038 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

3039 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

3040 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

3041 
r
[0] =„[0] - 
cÛff
*r[1];

3043 
cÛff
 = 
lhs
[2][1];

3044 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3045 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3046 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3047 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3048 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3049 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3050 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3051 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3052 
r
[2] =„[2] - 
cÛff
*r[1];

3054 
cÛff
 = 
lhs
[3][1];

3055 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3056 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3057 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3058 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3059 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3060 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3061 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3062 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3063 
r
[3] =„[3] - 
cÛff
*r[1];

3065 
cÛff
 = 
lhs
[4][1];

3066 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3067 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3068 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3069 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3070 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3071 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3072 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3073 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3074 
r
[4] =„[4] - 
cÛff
*r[1];

3077 
pivÙ
 = 1.00/
lhs
[2][2];

3078 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3079 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3080 
c
[2][0] = c[2][0]*
pivÙ
;

3081 
c
[2][1] = c[2][1]*
pivÙ
;

3082 
c
[2][2] = c[2][2]*
pivÙ
;

3083 
c
[2][3] = c[2][3]*
pivÙ
;

3084 
c
[2][4] = c[2][4]*
pivÙ
;

3085 
r
[2] =„[2] *
pivÙ
;

3087 
cÛff
 = 
lhs
[0][2];

3088 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3089 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3090 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3091 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3092 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3093 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3094 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3095 
r
[0] =„[0] - 
cÛff
*r[2];

3097 
cÛff
 = 
lhs
[1][2];

3098 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3099 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3100 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3101 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3102 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3103 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3104 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3105 
r
[1] =„[1] - 
cÛff
*r[2];

3107 
cÛff
 = 
lhs
[3][2];

3108 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3109 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3110 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3111 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3112 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3113 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3114 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3115 
r
[3] =„[3] - 
cÛff
*r[2];

3117 
cÛff
 = 
lhs
[4][2];

3118 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3119 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3120 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3121 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3122 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3123 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3124 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3125 
r
[4] =„[4] - 
cÛff
*r[2];

3128 
pivÙ
 = 1.00/
lhs
[3][3];

3129 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3130 
c
[3][0] = c[3][0]*
pivÙ
;

3131 
c
[3][1] = c[3][1]*
pivÙ
;

3132 
c
[3][2] = c[3][2]*
pivÙ
;

3133 
c
[3][3] = c[3][3]*
pivÙ
;

3134 
c
[3][4] = c[3][4]*
pivÙ
;

3135 
r
[3] =„[3] *
pivÙ
;

3137 
cÛff
 = 
lhs
[0][3];

3138 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3139 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3140 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3141 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3142 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3143 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3144 
r
[0] =„[0] - 
cÛff
*r[3];

3146 
cÛff
 = 
lhs
[1][3];

3147 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3148 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3149 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3150 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3151 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3152 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3153 
r
[1] =„[1] - 
cÛff
*r[3];

3155 
cÛff
 = 
lhs
[2][3];

3156 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3157 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3158 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3159 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3160 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3161 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3162 
r
[2] =„[2] - 
cÛff
*r[3];

3164 
cÛff
 = 
lhs
[4][3];

3165 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3166 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3167 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3168 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3169 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3170 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3171 
r
[4] =„[4] - 
cÛff
*r[3];

3174 
pivÙ
 = 1.00/
lhs
[4][4];

3175 
c
[4][0] = c[4][0]*
pivÙ
;

3176 
c
[4][1] = c[4][1]*
pivÙ
;

3177 
c
[4][2] = c[4][2]*
pivÙ
;

3178 
c
[4][3] = c[4][3]*
pivÙ
;

3179 
c
[4][4] = c[4][4]*
pivÙ
;

3180 
r
[4] =„[4] *
pivÙ
;

3182 
cÛff
 = 
lhs
[0][4];

3183 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3184 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3185 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3186 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3187 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3188 
r
[0] =„[0] - 
cÛff
*r[4];

3190 
cÛff
 = 
lhs
[1][4];

3191 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3192 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3193 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3194 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3195 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3196 
r
[1] =„[1] - 
cÛff
*r[4];

3198 
cÛff
 = 
lhs
[2][4];

3199 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3200 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3201 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3202 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3203 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3204 
r
[2] =„[2] - 
cÛff
*r[4];

3206 
cÛff
 = 
lhs
[3][4];

3207 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3208 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3209 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3210 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3211 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3212 
r
[3] =„[3] - 
cÛff
*r[4];

3213 
	}
}

3218 
	$bšvrhs
Ğ
lhs
[5][5], 
r
[5] ) {

3223 
pivÙ
, 
cÛff
;

3229 
pivÙ
 = 1.00/
lhs
[0][0];

3230 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

3231 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

3232 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

3233 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

3234 
r
[0] =„[0] *
pivÙ
;

3236 
cÛff
 = 
lhs
[1][0];

3237 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

3238 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

3239 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

3240 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

3241 
r
[1] =„[1] - 
cÛff
*r[0];

3243 
cÛff
 = 
lhs
[2][0];

3244 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3245 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3246 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3247 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3248 
r
[2] =„[2] - 
cÛff
*r[0];

3250 
cÛff
 = 
lhs
[3][0];

3251 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3252 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3253 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3254 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3255 
r
[3] =„[3] - 
cÛff
*r[0];

3257 
cÛff
 = 
lhs
[4][0];

3258 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3259 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3260 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3261 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3262 
r
[4] =„[4] - 
cÛff
*r[0];

3265 
pivÙ
 = 1.00/
lhs
[1][1];

3266 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3267 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3268 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3269 
r
[1] =„[1] *
pivÙ
;

3271 
cÛff
 = 
lhs
[0][1];

3272 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3273 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3274 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3275 
r
[0] =„[0] - 
cÛff
*r[1];

3277 
cÛff
 = 
lhs
[2][1];

3278 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3279 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3280 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3281 
r
[2] =„[2] - 
cÛff
*r[1];

3283 
cÛff
 = 
lhs
[3][1];

3284 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3285 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3286 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3287 
r
[3] =„[3] - 
cÛff
*r[1];

3289 
cÛff
 = 
lhs
[4][1];

3290 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3291 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3292 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3293 
r
[4] =„[4] - 
cÛff
*r[1];

3296 
pivÙ
 = 1.00/
lhs
[2][2];

3297 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3298 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3299 
r
[2] =„[2] *
pivÙ
;

3301 
cÛff
 = 
lhs
[0][2];

3302 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3303 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3304 
r
[0] =„[0] - 
cÛff
*r[2];

3306 
cÛff
 = 
lhs
[1][2];

3307 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3308 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3309 
r
[1] =„[1] - 
cÛff
*r[2];

3311 
cÛff
 = 
lhs
[3][2];

3312 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3313 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3314 
r
[3] =„[3] - 
cÛff
*r[2];

3316 
cÛff
 = 
lhs
[4][2];

3317 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3318 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3319 
r
[4] =„[4] - 
cÛff
*r[2];

3322 
pivÙ
 = 1.00/
lhs
[3][3];

3323 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3324 
r
[3] =„[3] *
pivÙ
;

3326 
cÛff
 = 
lhs
[0][3];

3327 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3328 
r
[0] =„[0] - 
cÛff
*r[3];

3330 
cÛff
 = 
lhs
[1][3];

3331 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3332 
r
[1] =„[1] - 
cÛff
*r[3];

3334 
cÛff
 = 
lhs
[2][3];

3335 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3336 
r
[2] =„[2] - 
cÛff
*r[3];

3338 
cÛff
 = 
lhs
[4][3];

3339 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3340 
r
[4] =„[4] - 
cÛff
*r[3];

3343 
pivÙ
 = 1.00/
lhs
[4][4];

3344 
r
[4] =„[4] *
pivÙ
;

3346 
cÛff
 = 
lhs
[0][4];

3347 
r
[0] =„[0] - 
cÛff
*r[4];

3349 
cÛff
 = 
lhs
[1][4];

3350 
r
[1] =„[1] - 
cÛff
*r[4];

3352 
cÛff
 = 
lhs
[2][4];

3353 
r
[2] =„[2] - 
cÛff
*r[4];

3355 
cÛff
 = 
lhs
[3][4];

3356 
r
[3] =„[3] - 
cÛff
*r[4];

3358 
	}
}

3363 
	$y_sŞve
() {

3378 
	`lhsy
();

3379 
	`y_sŞve_ûÎ
();

3380 
	`y_backsub¡™u‹
();

3381 
	}
}

3387 
	$y_backsub¡™u‹
() {

3399 
i
, 
j
, 
k
, 
m
, 
n
;

3401 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3402 #´agm¨
omp
 

3403 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3404 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3405 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3406 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3407 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3408 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3414 
	}
}

3419 
	$y_sŞve_ûÎ
() {

3434 
i
, 
j
, 
k
, 
jsize
;

3436 
jsize
 = 
grid_pošts
[1]-1;

3438 #´agm¨
omp
 

3439 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3440 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3446 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3447 
lhs
[
i
][0][
k
][
CC
],

3448 
rhs
[
i
][0][
k
] );

3456 
j
 = 1; j < 
jsize
; j++) {

3457 #´agm¨
omp
 

3458 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3459 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3466 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3467 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3472 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3473 
lhs
[
i
][
j
-1][
k
][
CC
],

3474 
lhs
[
i
][
j
][
k
][
BB
]);

3480 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3481 
lhs
[
i
][
j
][
k
][
CC
],

3482 
rhs
[
i
][
j
][
k
] );

3488 #´agm¨
omp
 

3489 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3490 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3495 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3496 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3503 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3504 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3505 
lhs
[
i
][
jsize
][
k
][
BB
]);

3510 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3511 
rhs
[
i
][
jsize
][
k
] );

3515 
	}
}

3521 
	$z_sŞve
() {

3536 
	`lhsz
();

3537 
	`z_sŞve_ûÎ
();

3538 
	`z_backsub¡™u‹
();

3539 
	}
}

3544 
	$z_backsub¡™u‹
() {

3556 
i
, 
j
, 
k
, 
m
, 
n
;

3558 #´agm¨
omp
 

3559 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3560 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3561 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3562 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3563 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3564 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3565 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3571 
	}
}

3576 
	$z_sŞve_ûÎ
() {

3591 
i
,
j
,
k
,
ksize
;

3593 
ksize
 = 
grid_pošts
[2]-1;

3598 #´agm¨
omp
 

3599 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3600 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3606 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3607 
lhs
[
i
][
j
][0][
CC
],

3608 
rhs
[
i
][
j
][0] );

3617 
k
 = 1; k < 
ksize
; k++) {

3618 #´agm¨
omp
 

3619 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3620 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3627 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3628 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3634 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3635 
lhs
[
i
][
j
][
k
-1][
CC
],

3636 
lhs
[
i
][
j
][
k
][
BB
]);

3642 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3643 
lhs
[
i
][
j
][
k
][
CC
],

3644 
rhs
[
i
][
j
][
k
] );

3653 #´agm¨
omp
 

3654 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3655 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3660 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3661 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3668 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3669 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3670 
lhs
[
i
][
j
][
ksize
][
BB
]);

3675 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3676 
rhs
[
i
][
j
][
ksize
] );

3680 
	}
}

	@BT/bt.old2.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
compu‹_rhs
();

55 
£t_cÚ¡ªts
();

56 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

57 
x_sŞve
();

58 
x_backsub¡™u‹
();

59 
x_sŞve_ûÎ
();

60 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

61 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

62 
cblock
[5][5]);

63 
bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]);

64 
bšvrhs
(
lhs
[5][5], 
r
[5]);

65 
y_sŞve
();

66 
y_backsub¡™u‹
();

67 
y_sŞve_ûÎ
();

68 
z_sŞve
();

69 
z_backsub¡™u‹
();

70 
z_sŞve_ûÎ
();

72 
´og¿m_BT
(*
__buf
, * 
__´iv
);

74 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

75 .
cmd
 = "nas-bt",

76 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

77 .
	ghªdËr
 = 
´og¿m_BT
,

79 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

86 
	$´og¿m_BT
(*
__buf
, * 
__´iv
) {

88 
n™”
, 
¡•
, 
n3
;

89 
Áh»ads
 = 1;

90 
Çvg
, 
mæİs
;

92 
tmax
;

93 
boŞ—n
 
v”if›d
;

94 
şass
;

102 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

116 
	`´štf
(" No input file inputbt.data. Using compiled defaults\n");

118 
n™”
 = 
NITER_DEFAULT
;

119 
dt
 = 
DT_DEFAULT
;

120 
grid_pošts
[0] = 
PROBLEM_SIZE
;

121 
grid_pošts
[1] = 
PROBLEM_SIZE
;

122 
grid_pošts
[2] = 
PROBLEM_SIZE
;

126 
	`´štf
(" Size: %3dx%3dx%3d\n",

127 
grid_pošts
[0], grid_points[1], grid_points[2]);

128 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

130 ià(
grid_pošts
[0] > 
IMAX
 ||

131 
grid_pošts
[1] > 
JMAX
 ||

132 
grid_pošts
[2] > 
KMAX
) {

133 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

134 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

135 
	`ex™
(1);

138 
i
,
j
;

139 
i
=0;i<
PROBLEM_SIZE
;i++){

140 
j
=0;j<5;j++){

141 
	`´štf
("u%àbuà%f\n", 
buf
[
i
*
PROBLEM_SIZE
+
j
]);

145 
	`£t_cÚ¡ªts
();

147 
	`š™Ÿlize
();

148 
	`lhsš™
();

150 
	`exaù_rhs
();

157 
	`adi
();

159 
	`š™Ÿlize
();

161 
	`tim”_ş—r
(1);

162 
	`tim”_¡¬t
(1);

164 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

166 ià(
¡•
%20 == 0 || step == 1) {

167 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

169 
	`adi
();

172 #´agm¨
omp
 
·¿Î–


174 #ià
	`defšed
(
_OPENMP
)

175 #´agm¨
omp
 
ma¡”


176 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

180 
	`tim”_¡İ
(1);

181 
tmax
 = 
	`tim”_»ad
(1);

183 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

185 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

186 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

187 iàĞ
tmax
 != 0.0 ) {

188 
mæİs
 = 1.0e-6*()
n™”
*

189 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

191 
mæİs
 = 0.0;

193 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

194 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

195 
tmax
, 
mæİs
, " floating…oint",

196 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

197 
CS6
, "(none)");

198 
	}
}

203 
	$add
() {

209 
i
, 
j
, 
k
, 
m
;

211 #´agm¨
omp
 

212 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

213 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

214 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

215 
m
 = 0; m < 5; m++) {

216 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

221 
	}
}

226 
	$adi
() {

227 #´agm¨
omp
 
·¿Î–


228 
	`compu‹_rhs
();

230 #´agm¨
omp
 
·¿Î–


231 
	`x_sŞve
();

233 #´agm¨
omp
 
·¿Î–


234 
	`y_sŞve
();

236 #´agm¨
omp
 
·¿Î–


237 
	`z_sŞve
();

239 #´agm¨
omp
 
·¿Î–


240 
	`add
();

241 
	}
}

246 
	$”rÜ_nÜm
(
rms
[5]) {

253 
i
, 
j
, 
k
, 
m
, 
d
;

254 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

256 
m
 = 0; m < 5; m++) {

257 
rms
[
m
] = 0.0;

260 
i
 = 0; i < 
grid_pošts
[0]; i++) {

261 
xi
 = ()
i
 * 
dnxm1
;

262 
j
 = 0; j < 
grid_pošts
[1]; j++) {

263 
‘a
 = ()
j
 * 
dnym1
;

264 
k
 = 0; k < 
grid_pošts
[2]; k++) {

265 
z‘a
 = ()
k
 * 
dnzm1
;

266 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

268 
m
 = 0; m < 5; m++) {

269 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

270 
rms
[
m
] =„ms[m] + 
add
*add;

276 
m
 = 0; m < 5; m++) {

277 
d
 = 0; d <= 2; d++) {

278 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

280 
rms
[
m
] = 
	`sq¹
(rms[m]);

282 
	}
}

287 
	$rhs_nÜm
(
rms
[5]) {

292 
i
, 
j
, 
k
, 
d
, 
m
;

293 
add
;

295 
m
 = 0; m < 5; m++) {

296 
rms
[
m
] = 0.0;

299 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

300 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

301 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

302 
m
 = 0; m < 5; m++) {

303 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

304 
rms
[
m
] =„ms[m] + 
add
*add;

310 
m
 = 0; m < 5; m++) {

311 
d
 = 0; d <= 2; d++) {

312 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

314 
rms
[
m
] = 
	`sq¹
(rms[m]);

316 
	}
}

322 
	$exaù_rhs
() {

324 #´agm¨
omp
 
·¿Î–


333 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

334 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

339 #´agm¨
omp
 

340 
i
 = 0; i < 
grid_pošts
[0]; i++) {

341 
j
 = 0; j < 
grid_pošts
[1]; j++) {

342 
k
 = 0; k < 
grid_pošts
[2]; k++) {

343 
m
 = 0; m < 5; m++) {

344 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

360 #´agm¨
omp
 

361 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

362 
‘a
 = ()
j
 * 
dnym1
;

364 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

365 
z‘a
 = ()
k
 * 
dnzm1
;

367 
i
 = 0; i < 
grid_pošts
[0]; i++) {

368 
xi
 = ()
i
 * 
dnxm1
;

370 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

371 
m
 = 0; m < 5; m++) {

372 
ue
[(
i
)*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

374 
	`´štf
("1\n");

375 
dp
 = 1.0 / 
d‹mp
[0];

377 
m
 = 1; m <= 4; m++) {

378 
buf
[
i
*
PROBLEM_SIZE
+
m
] = 
dp
 * 
d‹mp
[m];

381 
	`´štf
("2\n");

383 
cuf
[
i
] = 
buf
[i*
PROBLEM_SIZE
+1] * buf[i*PROBLEM_SIZE+1];

385 
buf
[
i
*
PROBLEM_SIZE
+0] = 
cuf
[i] + buf[i*PROBLEM_SIZE+2] * buf[i*PROBLEM_SIZE+2] +

386 
buf
[
i
*
PROBLEM_SIZE
+3] * buf[i*PROBLEM_SIZE+3];

388 
q
[
i
] = 0.5*(
buf
[i*
PROBLEM_SIZE
+1]*
ue
[(i)*PROBLEM_SIZE+1] + buf[i*PROBLEM_SIZE+2]*ue[(i)*PROBLEM_SIZE+2] +

389 
buf
[
i
*
PROBLEM_SIZE
+3]*
ue
[(i)*PROBLEM_SIZE+3]);

391 
	`´štf
("3\n");

393 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

394 
im1
 = 
i
-1;

395 
1
 = 
i
+1;

397 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

398 
tx2
*(
ue
[
1
*
PROBLEM_SIZE
+1]-ue[
im1
*PROBLEM_SIZE+1])+

399 
dx1tx1
*(
ue
[
1
*
PROBLEM_SIZE
+0]-2.0*ue[(
i
)*PROBLEM_SIZE+0]+ue[
im1
*PROBLEM_SIZE+0]);

401 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

402 
tx2
 * ((
ue
[
1
*
PROBLEM_SIZE
+1]*
buf
[1*PROBLEM_SIZE+1]+
c2
*(ue[1*PROBLEM_SIZE+4]-
q
[ip1]))-

403 (
ue
[
im1
*
PROBLEM_SIZE
+1]*
buf
[im1*PROBLEM_SIZE+1]+
c2
*(ue[im1*PROBLEM_SIZE+4]-
q
[im1])))+

404 
xxcÚ1
*(
buf
[
1
*
PROBLEM_SIZE
+1]-2.0*buf[
i
*PROBLEM_SIZE+1]+buf[
im1
*PROBLEM_SIZE+1])+

405 
dx2tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+1]-2.0* ue[(
i
)*PROBLEM_SIZE+1]+ ue[
im1
*PROBLEM_SIZE+1]);

407 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

408 
tx2
 * (
ue
[
1
*
PROBLEM_SIZE
+2]*
buf
[1*PROBLEM_SIZE+1]-ue[
im1
*PROBLEM_SIZE+2]*buf[im1*PROBLEM_SIZE+1])+

409 
xxcÚ2
*(
buf
[
1
*
PROBLEM_SIZE
+2]-2.0*buf[
i
*PROBLEM_SIZE+2]+buf[
im1
*PROBLEM_SIZE+2])+

410 
dx3tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+2]-2.0* ue[(
i
)*PROBLEM_SIZE+2]+ ue[
im1
*PROBLEM_SIZE+2]);

412 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

413 
tx2
*(
ue
[
1
*
PROBLEM_SIZE
+3]*
buf
[1*PROBLEM_SIZE+1]-ue[
im1
*PROBLEM_SIZE+3]*buf[im1*PROBLEM_SIZE+1])+

414 
xxcÚ2
*(
buf
[
1
*
PROBLEM_SIZE
+3]-2.0*buf[
i
*PROBLEM_SIZE+3]+buf[
im1
*PROBLEM_SIZE+3])+

415 
dx4tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+3]-2.0* ue[(
i
)*PROBLEM_SIZE+3]+ ue[
im1
*PROBLEM_SIZE+3]);

417 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

418 
tx2
*(
buf
[
1
*
PROBLEM_SIZE
+1]*(
c1
*
ue
[1*PROBLEM_SIZE+4]-
c2
*
q
[ip1])-

419 
buf
[
im1
*
PROBLEM_SIZE
+1]*(
c1
*
ue
[im1*PROBLEM_SIZE+4]-
c2
*
q
[im1]))+

420 0.5*
xxcÚ3
*(
buf
[
1
*
PROBLEM_SIZE
+0]-2.0*buf[
i
*PROBLEM_SIZE+0]+buf[
im1
*PROBLEM_SIZE+0])+

421 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

422 
xxcÚ5
*(
buf
[
1
*
PROBLEM_SIZE
+4]-2.0*buf[
i
*PROBLEM_SIZE+4]+buf[
im1
*PROBLEM_SIZE+4])+

423 
dx5tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+4]-2.0* ue[(
i
)*PROBLEM_SIZE+4]+ ue[
im1
*PROBLEM_SIZE+4]);

426 
	`´štf
("4\n");

431 
m
 = 0; m < 5; m++) {

432 
i
 = 1;

433 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

434 (5.0*
ue
[(
i
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m] +ue[(i+2)*PROBLEM_SIZE+m]);

435 
i
 = 2;

436 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

437 (-4.0*
ue
[(
i
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[(i)*PROBLEM_SIZE+m] -

438 4.0*
ue
[(
i
+1)*
PROBLEM_SIZE
+
m
] + ue[(i+2)*PROBLEM_SIZE+m]);

440 
	`´štf
("5\n");

442 
m
 = 0; m < 5; m++) {

443 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

444 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

445 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] +

446 6.0*
ue
[(
i
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m] + ue[(i+2)*PROBLEM_SIZE+m]);

449 
	`´štf
("6\n");

451 
m
 = 0; m < 5; m++) {

452 
i
 = 
grid_pošts
[0]-3;

458 
	`´štf
("¡¬ˆ˜%d, m %d\n", 
i
, 
m
);

465 
‹mp1
 = (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] +

466 6.0*
ue
[(
i
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m]);

467 
	`´štf
("‹mp1 %à\n", 
‹mp1
);

468 
	`´štf
("fÜcšg %à\n", 
fÜcšg
[
i
][
j
][
k
][
m
]);

469 
‹mp
 = 
fÜcšg
[
i
][
j
][
k
][
m
] - 
ds¥
 *

470 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] +

471 6.0*
ue
[(
i
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m]);

473 
	`´štf
("this one\n");

475 
i
 = 
grid_pošts
[0]-2;

476 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

477 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] + 5.0*ue[(i)*PROBLEM_SIZE+m]);

479 
	`´štf
("7\n");

486 
	`´štf
("8");

490 #´agm¨
omp
 

491 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

492 
xi
 = ()
i
 * 
dnxm1
;

494 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

495 
z‘a
 = ()
k
 * 
dnzm1
;

497 
j
 = 0; j < 
grid_pošts
[1]; j++) {

498 
‘a
 = ()
j
 * 
dnym1
;

500 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

501 
m
 = 0; m < 5; m++) {

502 
ue
[(
j
)*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

505 
dp
 = 1.0/
d‹mp
[0];

507 
m
 = 1; m <= 4; m++) {

508 
buf
[
j
*
PROBLEM_SIZE
+
m
] = 
dp
 * 
d‹mp
[m];

511 
cuf
[
j
] = 
buf
[j*
PROBLEM_SIZE
+2] * buf[j*PROBLEM_SIZE+2];

512 
buf
[
j
*
PROBLEM_SIZE
+0] = 
cuf
[j] + buf[j*PROBLEM_SIZE+1] * buf[j*PROBLEM_SIZE+1] +

513 
buf
[
j
*
PROBLEM_SIZE
+3] * buf[j*PROBLEM_SIZE+3];

514 
q
[
j
] = 0.5*(
buf
[j*
PROBLEM_SIZE
+1]*
ue
[(j)*PROBLEM_SIZE+1] + buf[j*PROBLEM_SIZE+2]*ue[(j)*PROBLEM_SIZE+2] +

515 
buf
[
j
*
PROBLEM_SIZE
+3]*
ue
[(j)*PROBLEM_SIZE+3]);

518 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

519 
jm1
 = 
j
-1;

520 
jp1
 = 
j
+1;

522 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

523 
ty2
*Ğ
ue
[(
jp1
)*
PROBLEM_SIZE
+2]-ue[
jm1
*PROBLEM_SIZE+2] )+

524 
dy1ty1
*(
ue
[(
jp1
)*
PROBLEM_SIZE
+0]-2.0*ue[(
j
)*PROBLEM_SIZE+0]+ue[
jm1
*PROBLEM_SIZE+0]);

526 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

527 
ty2
*(
ue
[(
jp1
)*
PROBLEM_SIZE
+1]*
buf
[(jp1)*PROBLEM_SIZE+2]-ue[
jm1
*PROBLEM_SIZE+1]*buf[jm1*PROBLEM_SIZE+2])+

528 
yycÚ2
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+1]-2.0*buf[
j
*PROBLEM_SIZE+1]+buf[
jm1
*PROBLEM_SIZE+1])+

529 
dy2ty1
*Ğ
ue
[(
jp1
)*
PROBLEM_SIZE
+1]-2.0* ue[(
j
)*PROBLEM_SIZE+1]+ ue[
jm1
*PROBLEM_SIZE+1]);

531 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

532 
ty2
*((
ue
[(
jp1
)*
PROBLEM_SIZE
+2]*
buf
[(jp1)*PROBLEM_SIZE+2]+
c2
*(ue[(jp1)*PROBLEM_SIZE+4]-
q
[jp1]))-

533 (
ue
[
jm1
*
PROBLEM_SIZE
+2]*
buf
[jm1*PROBLEM_SIZE+2]+
c2
*(ue[jm1*PROBLEM_SIZE+4]-
q
[jm1])))+

534 
yycÚ1
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+2]-2.0*buf[
j
*PROBLEM_SIZE+2]+buf[
jm1
*PROBLEM_SIZE+2])+

535 
dy3ty1
*Ğ
ue
[(
jp1
)*
PROBLEM_SIZE
+2]-2.0*ue[(
j
)*PROBLEM_SIZE+2] +ue[
jm1
*PROBLEM_SIZE+2]);

537 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

538 
ty2
*(
ue
[(
jp1
)*
PROBLEM_SIZE
+3]*
buf
[(jp1)*PROBLEM_SIZE+2]-ue[
jm1
*PROBLEM_SIZE+3]*buf[jm1*PROBLEM_SIZE+2])+

539 
yycÚ2
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+3]-2.0*buf[
j
*PROBLEM_SIZE+3]+buf[
jm1
*PROBLEM_SIZE+3])+

540 
dy4ty1
*Ğ
ue
[(
jp1
)*
PROBLEM_SIZE
+3]-2.0*ue[(
j
)*PROBLEM_SIZE+3]+ ue[
jm1
*PROBLEM_SIZE+3]);

542 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

543 
ty2
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+2]*(
c1
*
ue
[(jp1)*PROBLEM_SIZE+4]-
c2
*
q
[jp1])-

544 
buf
[
jm1
*
PROBLEM_SIZE
+2]*(
c1
*
ue
[jm1*PROBLEM_SIZE+4]-
c2
*
q
[jm1]))+

545 0.5*
yycÚ3
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+0]-2.0*buf[
j
*PROBLEM_SIZE+0]+

546 
buf
[
jm1
*
PROBLEM_SIZE
+0])+

547 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

548 
yycÚ5
*(
buf
[(
jp1
)*
PROBLEM_SIZE
+4]-2.0*buf[
j
*PROBLEM_SIZE+4]+buf[
jm1
*PROBLEM_SIZE+4])+

549 
dy5ty1
*(
ue
[(
jp1
)*
PROBLEM_SIZE
+4]-2.0*ue[(
j
)*PROBLEM_SIZE+4]+ue[
jm1
*PROBLEM_SIZE+4]);

552 
	`´štf
("9\n");

557 
m
 = 0; m < 5; m++) {

558 
j
 = 1;

559 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

560 (5.0*
ue
[(
j
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j+1)*PROBLEM_SIZE+m] +ue[(j+2)*PROBLEM_SIZE+m]);

561 
j
 = 2;

562 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

563 (-4.0*
ue
[(
j
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[(j)*PROBLEM_SIZE+m] -

564 4.0*
ue
[(
j
+1)*
PROBLEM_SIZE
+
m
] + ue[(j+2)*PROBLEM_SIZE+m]);

567 
	`´štf
("9.1\n");

568 
m
 = 0; m < 5; m++) {

569 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

570 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

571 (
ue
[(
j
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j-1)*PROBLEM_SIZE+m] +

572 6.0*
ue
[(
j
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j+1)*PROBLEM_SIZE+m] + ue[(j+2)*PROBLEM_SIZE+m]);

576 
	`´štf
("9.2\n");

577 
m
 = 0; m < 5; m++) {

578 
j
 = 
grid_pošts
[1]-3;

579 
	`´štf
("9.21\n");

580 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

581 (
ue
[(
j
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j-1)*PROBLEM_SIZE+m] +

582 6.0*
ue
[(
j
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j+1)*PROBLEM_SIZE+m]);

583 
	`´štf
("9.22\n");

585 
j
 = 
grid_pošts
[1]-2;

586 
	`´štf
("9.23\n");

588 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

589 (
ue
[(
j
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j-1)*PROBLEM_SIZE+m] + 5.0*ue[(j)*PROBLEM_SIZE+m]);

590 
	`´štf
("9.24\n");

594 
	`´štf
("9.3\n");

599 
	`´štf
("10\n");

604 #´agm¨
omp
 

605 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

606 
xi
 = ()
i
 * 
dnxm1
;

608 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

609 
‘a
 = ()
j
 * 
dnym1
;

611 
k
 = 0; k < 
grid_pošts
[2]; k++) {

612 
z‘a
 = ()
k
 * 
dnzm1
;

614 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

615 
m
 = 0; m < 5; m++) {

616 
ue
[(
k
)*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

619 
dp
 = 1.0/
d‹mp
[0];

621 
m
 = 1; m <= 4; m++) {

622 
buf
[(
k
)*
PROBLEM_SIZE
+
m
] = 
dp
 * 
d‹mp
[m];

625 
cuf
[
k
] = 
buf
[(k)*
PROBLEM_SIZE
+3] * buf[(k)*PROBLEM_SIZE+3];

626 
buf
[(
k
)*
PROBLEM_SIZE
+0] = 
cuf
[k] + buf[(k)*PROBLEM_SIZE+1] * buf[(k)*PROBLEM_SIZE+1] +

627 
buf
[(
k
)*
PROBLEM_SIZE
+2] * buf[(k)*PROBLEM_SIZE+2];

628 
q
[
k
] = 0.5*(
buf
[(k)*
PROBLEM_SIZE
+1]*
ue
[(k)*PROBLEM_SIZE+1] + buf[(k)*PROBLEM_SIZE+2]*ue[(k)*PROBLEM_SIZE+2] +

629 
buf
[(
k
)*
PROBLEM_SIZE
+3]*
ue
[(k)*PROBLEM_SIZE+3]);

632 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

633 
km1
 = 
k
-1;

634 
kp1
 = 
k
+1;

636 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

637 
tz2
*Ğ
ue
[(
kp1
)*
PROBLEM_SIZE
+3]-ue[(
km1
)*PROBLEM_SIZE+3] )+

638 
dz1tz1
*(
ue
[(
kp1
)*
PROBLEM_SIZE
+0]-2.0*ue[(
k
)*PROBLEM_SIZE+0]+ue[(
km1
)*PROBLEM_SIZE+0]);

640 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

641 
tz2
 * (
ue
[(
kp1
)*
PROBLEM_SIZE
+1]*
buf
[(kp1)*PROBLEM_SIZE+3]-ue[(
km1
)*PROBLEM_SIZE+1]*buf[(km1)*PROBLEM_SIZE+3])+

642 
zzcÚ2
*(
buf
[(
kp1
)*
PROBLEM_SIZE
+1]-2.0*buf[(
k
)*PROBLEM_SIZE+1]+buf[(
km1
)*PROBLEM_SIZE+1])+

643 
dz2tz1
*Ğ
ue
[(
kp1
)*
PROBLEM_SIZE
+1]-2.0* ue[(
k
)*PROBLEM_SIZE+1]+ ue[(
km1
)*PROBLEM_SIZE+1]);

645 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

646 
tz2
 * (
ue
[(
kp1
)*
PROBLEM_SIZE
+2]*
buf
[(kp1)*PROBLEM_SIZE+3]-ue[(
km1
)*PROBLEM_SIZE+2]*buf[(km1)*PROBLEM_SIZE+3])+

647 
zzcÚ2
*(
buf
[(
kp1
)*
PROBLEM_SIZE
+2]-2.0*buf[(
k
)*PROBLEM_SIZE+2]+buf[(
km1
)*PROBLEM_SIZE+2])+

648 
dz3tz1
*(
ue
[(
kp1
)*
PROBLEM_SIZE
+2]-2.0*ue[(
k
)*PROBLEM_SIZE+2]+ue[(
km1
)*PROBLEM_SIZE+2]);

650 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

651 
tz2
 * ((
ue
[(
kp1
)*
PROBLEM_SIZE
+3]*
buf
[(kp1)*PROBLEM_SIZE+3]+
c2
*(ue[(kp1)*PROBLEM_SIZE+4]-
q
[kp1]))-

652 (
ue
[(
km1
)*
PROBLEM_SIZE
+3]*
buf
[(km1)*PROBLEM_SIZE+3]+
c2
*(ue[(km1)*PROBLEM_SIZE+4]-
q
[km1])))+

653 
zzcÚ1
*(
buf
[(
kp1
)*
PROBLEM_SIZE
+3]-2.0*buf[(
k
)*PROBLEM_SIZE+3]+buf[(
km1
)*PROBLEM_SIZE+3])+

654 
dz4tz1
*Ğ
ue
[(
kp1
)*
PROBLEM_SIZE
+3]-2.0*ue[(
k
)*PROBLEM_SIZE+3] +ue[(
km1
)*PROBLEM_SIZE+3]);

656 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

657 
tz2
 * (
buf
[(
kp1
)*
PROBLEM_SIZE
+3]*(
c1
*
ue
[(kp1)*PROBLEM_SIZE+4]-
c2
*
q
[kp1])-

658 
buf
[(
km1
)*
PROBLEM_SIZE
+3]*(
c1
*
ue
[(km1)*PROBLEM_SIZE+4]-
c2
*
q
[km1]))+

659 0.5*
zzcÚ3
*(
buf
[(
kp1
)*
PROBLEM_SIZE
+0]-2.0*buf[(
k
)*PROBLEM_SIZE+0]

660 +
buf
[(
km1
)*
PROBLEM_SIZE
+0])+

661 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

662 
zzcÚ5
*(
buf
[(
kp1
)*
PROBLEM_SIZE
+4]-2.0*buf[(
k
)*PROBLEM_SIZE+4]+buf[(
km1
)*PROBLEM_SIZE+4])+

663 
dz5tz1
*Ğ
ue
[(
kp1
)*
PROBLEM_SIZE
+4]-2.0*ue[(
k
)*PROBLEM_SIZE+4]+ ue[(
km1
)*PROBLEM_SIZE+4]);

666 
	`´štf
("11\n");

670 
m
 = 0; m < 5; m++) {

671 
k
 = 1;

672 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

673 (5.0*
ue
[(
k
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m] +ue[(k+2)*PROBLEM_SIZE+m]);

674 
k
 = 2;

675 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

676 (-4.0*
ue
[(
k
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[(k)*PROBLEM_SIZE+m] -

677 4.0*
ue
[(
k
+1)*
PROBLEM_SIZE
+
m
] + ue[(k+2)*PROBLEM_SIZE+m]);

680 
m
 = 0; m < 5; m++) {

681 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

682 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

683 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] +

684 6.0*
ue
[(
k
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m] + ue[(k+2)*PROBLEM_SIZE+m]);

688 
m
 = 0; m < 5; m++) {

689 
k
 = 
grid_pošts
[2]-3;

690 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

691 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] +

692 6.0*
ue
[(
k
)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m]);

693 
k
 = 
grid_pošts
[2]-2;

694 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

695 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] + 5.0*ue[(k)*PROBLEM_SIZE+m]);

706 #´agm¨
omp
 

707 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

708 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

709 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

710 
m
 = 0; m < 5; m++) {

711 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

718 
	}
}

722 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

723 
d‹mp
[5]) {

732 
m
;

734 
m
 = 0; m < 5; m++) {

735 
d‹mp
[
m
] = 
û
[m][0] +

736 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

737 + 
xi
*
û
[
m
][10]))) +

738 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

739 + 
‘a
*
û
[
m
][11])))+

740 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

741 
z‘a
*
û
[
m
][12])));

743 
	}
}

748 
	$š™Ÿlize
() {

750 #´agm¨
omp
 
·¿Î–


760 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

761 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

769 #´agm¨
omp
 

770 
i
 = 0; i < 
IMAX
; i++) {

771 
j
 = 0; j < 
IMAX
; j++) {

772 
k
 = 0; k < 
IMAX
; k++) {

773 
m
 = 0; m < 5; m++) {

774 
u
[
i
][
j
][
k
][
m
] = 1.0;

784 #´agm¨
omp
 

785 
i
 = 0; i < 
grid_pošts
[0]; i++) {

786 
xi
 = ()
i
 * 
dnxm1
;

788 
j
 = 0; j < 
grid_pošts
[1]; j++) {

789 
‘a
 = ()
j
 * 
dnym1
;

791 
k
 = 0; k < 
grid_pošts
[2]; k++) {

792 
z‘a
 = ()
k
 * 
dnzm1
;

794 
ix
 = 0; ix < 2; ix++) {

795 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

796 &(
Pçû
[
ix
][0][0]));

799 
iy
 = 0; iy < 2; iy++) {

800 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

801 &
Pçû
[
iy
][1][0]);

804 
iz
 = 0; iz < 2; iz++) {

805 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

806 &
Pçû
[
iz
][2][0]);

809 
m
 = 0; m < 5; m++) {

810 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

811 (1.0-
xi
è* 
Pçû
[0][0][
m
];

812 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

813 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

814 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

815 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

817 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

818 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

819 
Pxi
*
P‘a
*
Pz‘a
;

832 
i
 = 0;

833 
xi
 = 0.0;

834 #´agm¨
omp
 
nowa™


835 
j
 = 0; j < 
grid_pošts
[1]; j++) {

836 
‘a
 = ()
j
 * 
dnym1
;

837 
k
 = 0; k < 
grid_pošts
[2]; k++) {

838 
z‘a
 = ()
k
 * 
dnzm1
;

839 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

840 
m
 = 0; m < 5; m++) {

841 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

850 
i
 = 
grid_pošts
[0]-1;

851 
xi
 = 1.0;

852 #´agm¨
omp
 

853 
j
 = 0; j < 
grid_pošts
[1]; j++) {

854 
‘a
 = ()
j
 * 
dnym1
;

855 
k
 = 0; k < 
grid_pošts
[2]; k++) {

856 
z‘a
 = ()
k
 * 
dnzm1
;

857 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

858 
m
 = 0; m < 5; m++) {

859 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

867 
j
 = 0;

868 
‘a
 = 0.0;

869 #´agm¨
omp
 
nowa™


870 
i
 = 0; i < 
grid_pošts
[0]; i++) {

871 
xi
 = ()
i
 * 
dnxm1
;

872 
k
 = 0; k < 
grid_pošts
[2]; k++) {

873 
z‘a
 = ()
k
 * 
dnzm1
;

874 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

875 
m
 = 0; m < 5; m++) {

876 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

884 
j
 = 
grid_pošts
[1]-1;

885 
‘a
 = 1.0;

886 #´agm¨
omp
 

887 
i
 = 0; i < 
grid_pošts
[0]; i++) {

888 
xi
 = ()
i
 * 
dnxm1
;

889 
k
 = 0; k < 
grid_pošts
[2]; k++) {

890 
z‘a
 = ()
k
 * 
dnzm1
;

891 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

892 
m
 = 0; m < 5; m++) {

893 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

901 
k
 = 0;

902 
z‘a
 = 0.0;

903 #´agm¨
omp
 
nowa™


904 
i
 = 0; i < 
grid_pošts
[0]; i++) {

905 
xi
 = ()
i
 *
dnxm1
;

906 
j
 = 0; j < 
grid_pošts
[1]; j++) {

907 
‘a
 = ()
j
 * 
dnym1
;

908 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

909 
m
 = 0; m < 5; m++) {

910 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

918 
k
 = 
grid_pošts
[2]-1;

919 
z‘a
 = 1.0;

920 #´agm¨
omp
 

921 
i
 = 0; i < 
grid_pošts
[0]; i++) {

922 
xi
 = ()
i
 * 
dnxm1
;

923 
j
 = 0; j < 
grid_pošts
[1]; j++) {

924 
‘a
 = ()
j
 * 
dnym1
;

925 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

926 
m
 = 0; m < 5; m++) {

927 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

933 
	}
}

937 
	$lhsš™
() {

939 #´agm¨
omp
 
·¿Î–


941 
i
, 
j
, 
k
, 
m
, 
n
;

949 #´agm¨
omp
 

950 
i
 = 0; i < 
grid_pošts
[0]; i++) {

951 
j
 = 0; j < 
grid_pošts
[1]; j++) {

952 
k
 = 0; k < 
grid_pošts
[2]; k++) {

953 
m
 = 0; m < 5; m++) {

954 
n
 = 0;‚ < 5;‚++) {

955 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

956 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

957 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

967 #´agm¨
omp
 

968 
i
 = 0; i < 
grid_pošts
[0]; i++) {

969 
j
 = 0; j < 
grid_pošts
[1]; j++) {

970 
k
 = 0; k < 
grid_pošts
[2]; k++) {

971 
m
 = 0; m < 5; m++) {

972 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

979 
	}
}

983 
	$lhsx
() {

992 
i
, 
j
, 
k
;

997 #´agm¨
omp
 

998 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

999 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1000 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1002 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1003 
tmp2
 = 
tmp1
 *mp1;

1004 
tmp3
 = 
tmp1
 * 
tmp2
;

1008 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1009 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

1010 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

1011 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1012 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1014 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

1015 
u
[
i
][
j
][
k
][1])

1016 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1017 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1018 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

1019 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

1020 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

1021 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

1022 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

1023 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

1025 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

1026 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

1027 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

1028 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

1029 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1031 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

1032 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

1033 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

1034 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

1035 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1037 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1038 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1039 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


1040 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1041 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

1042 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1043 - 0.50 * 
c2


1044 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1045 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1046 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

1047 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

1048 * 
tmp2
;

1049 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

1050 * 
tmp2
;

1051 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

1053 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1054 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1055 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1056 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1057 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1059 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1060 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1061 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1062 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1063 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1065 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1066 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1067 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1068 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1069 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1071 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1072 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1073 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1074 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1075 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1077 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1078 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1079 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1080 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1081 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1083 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1084 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1085 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1086 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1087 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1093 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1095 
tmp1
 = 
dt
 * 
tx1
;

1096 
tmp2
 = 
dt
 * 
tx2
;

1098 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1099 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1100 - 
tmp1
 * 
dx1
;

1101 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1102 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1103 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1104 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1105 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1106 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1107 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1108 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1110 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1111 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1112 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1113 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1114 - 
tmp1
 * 
dx2
;

1115 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1116 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1117 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1118 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1119 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1120 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1122 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1123 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1124 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1125 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1126 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1127 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1128 - 
tmp1
 * 
dx3
;

1129 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1130 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1131 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1132 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1134 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1135 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1136 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1137 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1138 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1139 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1140 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1141 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1142 - 
tmp1
 * 
dx4
;

1143 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1144 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1146 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1147 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1148 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1149 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1150 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1151 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1152 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1153 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1154 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1155 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1156 - 
tmp1
 * 
dx5
;

1158 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1159 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1160 + 
tmp1
 * 2.0 * 
dx1
;

1161 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1162 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1163 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1164 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1166 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1167 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1168 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1169 + 
tmp1
 * 2.0 * 
dx2
;

1170 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1171 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1172 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1174 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1175 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1176 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1177 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1178 + 
tmp1
 * 2.0 * 
dx3
;

1179 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1180 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1182 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1183 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1184 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1185 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1186 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1187 + 
tmp1
 * 2.0 * 
dx4
;

1188 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1190 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1191 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1192 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1193 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1194 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1195 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1196 + 
tmp1
 * 2.0 * 
dx5
;

1198 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1199 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1200 - 
tmp1
 * 
dx1
;

1201 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1202 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1203 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1204 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1205 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1206 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1207 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1208 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1210 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1211 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1212 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1213 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1214 - 
tmp1
 * 
dx2
;

1215 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1216 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1217 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1218 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1219 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1220 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1222 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1223 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1224 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1225 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1226 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1227 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1228 - 
tmp1
 * 
dx3
;

1229 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1230 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1231 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1232 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1234 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1235 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1236 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1237 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1238 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1239 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1240 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1241 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1242 - 
tmp1
 * 
dx4
;

1243 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1244 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1246 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1247 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1248 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1249 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1250 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1251 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1252 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1253 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1254 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1255 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1256 - 
tmp1
 * 
dx5
;

1261 
	}
}

1266 
	$lhsy
() {

1275 
i
, 
j
, 
k
;

1281 #´agm¨
omp
 

1282 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1283 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1284 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1286 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1287 
tmp2
 = 
tmp1
 *mp1;

1288 
tmp3
 = 
tmp1
 * 
tmp2
;

1290 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1291 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1292 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1293 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1294 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1296 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1297 * 
tmp2
;

1298 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1299 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1300 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1301 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1303 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1304 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1305 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1306 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1307 * 
tmp2
 );

1308 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1309 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1310 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1311 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1312 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1314 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1315 * 
tmp2
;

1316 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1317 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1318 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1319 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1321 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1322 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1323 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1324 * 
tmp2


1325 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1326 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1327 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1328 * 
tmp2
;

1329 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1330 - 0.50 * 
c2


1331 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1332 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1333 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1334 * 
tmp2
 );

1335 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1336 * 
tmp2
;

1337 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1339 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1340 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1341 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1342 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1343 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1345 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1346 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1347 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1348 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1349 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1351 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1352 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1353 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1354 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1355 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1357 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1358 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1359 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1360 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1361 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1363 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1364 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1365 - ( 
cÚ43
 * 
c3c4


1366 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1367 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1368 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1370 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1371 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1372 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1373 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1374 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1383 #´agm¨
omp
 

1384 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1385 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1386 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1388 
tmp1
 = 
dt
 * 
ty1
;

1389 
tmp2
 = 
dt
 * 
ty2
;

1391 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1392 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1393 - 
tmp1
 * 
dy1
;

1394 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1395 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1396 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1397 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1398 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1399 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1400 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1401 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1403 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1404 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1405 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1406 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1407 - 
tmp1
 * 
dy2
;

1408 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1409 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1410 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1411 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1412 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1413 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1415 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1416 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1417 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1418 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1419 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1420 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1421 - 
tmp1
 * 
dy3
;

1422 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1423 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1424 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1425 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1427 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1428 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1429 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1430 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1431 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1432 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1433 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1434 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1435 - 
tmp1
 * 
dy4
;

1436 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1437 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1439 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1440 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1441 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1442 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1443 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1444 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1445 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1446 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1447 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1448 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1449 - 
tmp1
 * 
dy5
;

1451 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1452 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1453 + 
tmp1
 * 2.0 * 
dy1
;

1454 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1455 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1456 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1457 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1459 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1460 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1461 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1462 + 
tmp1
 * 2.0 * 
dy2
;

1463 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1464 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1465 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1467 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1468 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1469 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1470 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1471 + 
tmp1
 * 2.0 * 
dy3
;

1472 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1473 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1475 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1476 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1477 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1478 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1479 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1480 + 
tmp1
 * 2.0 * 
dy4
;

1481 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1483 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1484 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1485 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1486 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1487 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1488 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1489 + 
tmp1
 * 2.0 * 
dy5
;

1491 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1492 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1493 - 
tmp1
 * 
dy1
;

1494 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1495 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1496 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1497 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1498 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1499 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1500 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1501 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1503 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1504 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1505 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1506 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1507 - 
tmp1
 * 
dy2
;

1508 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1509 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1510 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1511 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1512 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1513 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1515 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1516 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1517 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1518 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1519 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1520 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1521 - 
tmp1
 * 
dy3
;

1522 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1523 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1524 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1525 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1527 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1528 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1529 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1530 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1531 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1532 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1533 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1534 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1535 - 
tmp1
 * 
dy4
;

1536 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1537 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1539 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1540 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1541 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1542 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1543 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1544 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1545 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1546 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1547 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1548 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1549 - 
tmp1
 * 
dy5
;

1554 
	}
}

1560 
	$lhsz
() {

1569 
i
, 
j
, 
k
;

1575 #´agm¨
omp
 

1576 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1577 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1578 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1580 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1581 
tmp2
 = 
tmp1
 *mp1;

1582 
tmp3
 = 
tmp1
 * 
tmp2
;

1584 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1585 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1586 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1587 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1588 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1590 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1591 * 
tmp2
;

1592 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1593 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1594 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1595 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1597 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1598 * 
tmp2
;

1599 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1600 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1601 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1602 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1604 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1605 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1606 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1607 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1608 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1609 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1610 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1611 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1612 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1614 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1615 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1616 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1617 * 
tmp2


1618 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1619 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1620 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1621 * 
tmp2
;

1622 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1623 * 
tmp2
;

1624 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1625 - 0.50 * 
c2


1626 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1627 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1628 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1629 * 
tmp2
 );

1630 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1632 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1633 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1634 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1635 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1636 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1638 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1639 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1640 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1641 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1642 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1644 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1645 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1646 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1647 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1648 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1650 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1651 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1652 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1653 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1654 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1656 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1657 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1658 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1659 - ( 
cÚ43
 * 
c3c4


1660 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1661 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1663 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1664 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1665 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1666 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1667 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1676 #´agm¨
omp
 

1677 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1678 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1679 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1681 
tmp1
 = 
dt
 * 
tz1
;

1682 
tmp2
 = 
dt
 * 
tz2
;

1684 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1685 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1686 - 
tmp1
 * 
dz1
;

1687 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1688 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1689 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1690 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1691 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1692 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1693 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1694 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1696 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1697 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1698 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1699 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1700 - 
tmp1
 * 
dz2
;

1701 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1702 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1703 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1704 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1705 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1706 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1708 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1709 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1710 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1711 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1712 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1713 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1714 - 
tmp1
 * 
dz3
;

1715 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1716 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1717 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1718 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1720 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1721 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1722 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1723 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1724 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1725 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1726 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1727 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1728 - 
tmp1
 * 
dz4
;

1729 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1730 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1732 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1733 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1734 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1735 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1736 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1737 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1738 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1739 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1740 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1741 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1742 - 
tmp1
 * 
dz5
;

1744 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1745 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1746 + 
tmp1
 * 2.0 * 
dz1
;

1747 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1748 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1749 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1750 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1752 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1753 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1754 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1755 + 
tmp1
 * 2.0 * 
dz2
;

1756 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1757 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1758 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1760 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1761 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1762 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1763 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1764 + 
tmp1
 * 2.0 * 
dz3
;

1765 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1766 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1768 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1769 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1770 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1771 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1772 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1773 + 
tmp1
 * 2.0 * 
dz4
;

1774 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1776 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1777 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1778 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1779 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1780 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1781 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1782 + 
tmp1
 * 2.0 * 
dz5
;

1784 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1785 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1786 - 
tmp1
 * 
dz1
;

1787 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1788 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1789 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1790 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1791 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1792 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1793 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1794 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1796 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1797 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1798 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1799 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1800 - 
tmp1
 * 
dz2
;

1801 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1802 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1803 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1804 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1805 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1806 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1808 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1809 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1810 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1811 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1812 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1813 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1814 - 
tmp1
 * 
dz3
;

1815 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1816 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1817 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1818 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1820 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1821 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1822 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1823 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1824 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1825 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1826 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1827 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1828 - 
tmp1
 * 
dz4
;

1829 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1830 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1832 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1833 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1834 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1835 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1836 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1837 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1838 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1839 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1840 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1841 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1842 - 
tmp1
 * 
dz5
;

1847 
	}
}

1852 
	$compu‹_rhs
() {

1854 
i
, 
j
, 
k
, 
m
;

1855 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1861 #´agm¨
omp
 
nowa™


1862 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1863 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1864 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1865 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1866 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1867 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1868 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1869 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1870 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1871 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1872 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1873 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1884 #´agm¨
omp
 

1885 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1886 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1887 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1888 
m
 = 0; m < 5; m++) {

1889 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1898 #´agm¨
omp
 

1899 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1900 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1901 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1902 
uijk
 = 
us
[
i
][
j
][
k
];

1903 
up1
 = 
us
[
i
+1][
j
][
k
];

1904 
um1
 = 
us
[
i
-1][
j
][
k
];

1906 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1907 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1908 
u
[
i
-1][
j
][
k
][0]) -

1909 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1911 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1912 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1913 
u
[
i
-1][
j
][
k
][1]) +

1914 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1915 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1916 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1917 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1918 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1919 
c2
);

1921 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1922 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1923 
u
[
i
-1][
j
][
k
][2]) +

1924 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1925 
vs
[
i
-1][
j
][
k
]) -

1926 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1927 
u
[
i
-1][
j
][
k
][2]*
um1
);

1929 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1930 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1931 
u
[
i
-1][
j
][
k
][3]) +

1932 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1933 
ws
[
i
-1][
j
][
k
]) -

1934 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1935 
u
[
i
-1][
j
][
k
][3]*
um1
);

1937 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1938 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1939 
u
[
i
-1][
j
][
k
][4]) +

1940 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1941 
qs
[
i
-1][
j
][
k
]) +

1942 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1943 
um1
*um1) +

1944 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1945 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1946 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1947 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1948 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1949 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1950 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1958 
i
 = 1;

1959 #´agm¨
omp
 
nowa™


1960 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1961 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1962 
m
 = 0; m < 5; m++) {

1963 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1964 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1965 
u
[
i
+2][
j
][
k
][
m
]);

1970 
i
 = 2;

1971 #´agm¨
omp
 
nowa™


1972 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1973 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1974 
m
 = 0; m < 5; m++) {

1975 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1976 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1977 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1982 #´agm¨
omp
 
nowa™


1983 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1984 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1985 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1986 
m
 = 0; m < 5; m++) {

1987 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1988 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1989 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1990 
u
[
i
+2][
j
][
k
][
m
] );

1996 
i
 = 
grid_pošts
[0]-3;

1997 #´agm¨
omp
 
nowa™


1998 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1999 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2000 
m
 = 0; m < 5; m++) {

2001 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2002 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

2003 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

2008 
i
 = 
grid_pošts
[0]-2;

2009 #´agm¨
omp
 

2010 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2011 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2012 
m
 = 0; m < 5; m++) {

2013 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2014 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

2015 5.0*
u
[
i
][
j
][
k
][
m
] );

2023 #´agm¨
omp
 

2024 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2025 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2026 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2027 
vijk
 = 
vs
[
i
][
j
][
k
];

2028 
vp1
 = 
vs
[
i
][
j
+1][
k
];

2029 
vm1
 = 
vs
[
i
][
j
-1][
k
];

2030 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

2031 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

2032 
u
[
i
][
j
-1][
k
][0]) -

2033 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

2034 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

2035 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

2036 
u
[
i
][
j
-1][
k
][1]) +

2037 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

2038 
us
[
i
][
j
-1][
k
]) -

2039 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

2040 
u
[
i
][
j
-1][
k
][1]*
vm1
);

2041 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

2042 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

2043 
u
[
i
][
j
-1][
k
][2]) +

2044 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

2045 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

2046 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

2047 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

2048 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

2049 *
c2
);

2050 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

2051 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

2052 
u
[
i
][
j
-1][
k
][3]) +

2053 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

2054 
ws
[
i
][
j
-1][
k
]) -

2055 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

2056 
u
[
i
][
j
-1][
k
][3]*
vm1
);

2057 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

2058 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

2059 
u
[
i
][
j
-1][
k
][4]) +

2060 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

2061 
qs
[
i
][
j
-1][
k
]) +

2062 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

2063 
vm1
*vm1) +

2064 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2065 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2066 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2067 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2068 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2069 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2070 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2078 
j
 = 1;

2079 #´agm¨
omp
 
nowa™


2080 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2081 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2082 
m
 = 0; m < 5; m++) {

2083 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2084 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2085 
u
[
i
][
j
+2][
k
][
m
]);

2090 
j
 = 2;

2091 #´agm¨
omp
 
nowa™


2092 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2093 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2094 
m
 = 0; m < 5; m++) {

2095 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2096 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2097 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2102 #´agm¨
omp
 
nowa™


2103 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2104 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2105 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2106 
m
 = 0; m < 5; m++) {

2107 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2108 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2109 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2110 
u
[
i
][
j
+2][
k
][
m
] );

2116 
j
 = 
grid_pošts
[1]-3;

2117 #´agm¨
omp
 
nowa™


2118 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2119 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2120 
m
 = 0; m < 5; m++) {

2121 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2122 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2123 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2128 
j
 = 
grid_pošts
[1]-2;

2129 #´agm¨
omp
 

2130 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2131 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2132 
m
 = 0; m < 5; m++) {

2133 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2134 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2135 5.*
u
[
i
][
j
][
k
][
m
] );

2143 #´agm¨
omp
 

2144 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2145 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2146 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2147 
wijk
 = 
ws
[
i
][
j
][
k
];

2148 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2149 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2151 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2152 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2153 
u
[
i
][
j
][
k
-1][0]) -

2154 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2155 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2156 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2157 
u
[
i
][
j
][
k
-1][1]) +

2158 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2159 
us
[
i
][
j
][
k
-1]) -

2160 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2161 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2162 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2163 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2164 
u
[
i
][
j
][
k
-1][2]) +

2165 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2166 
vs
[
i
][
j
][
k
-1]) -

2167 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2168 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2169 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2170 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2171 
u
[
i
][
j
][
k
-1][3]) +

2172 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2173 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2174 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2175 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2176 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2177 *
c2
);

2178 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2179 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2180 
u
[
i
][
j
][
k
-1][4]) +

2181 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2182 
qs
[
i
][
j
][
k
-1]) +

2183 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2184 
wm1
*wm1) +

2185 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2186 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2187 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2188 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2189 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2190 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2191 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2199 
k
 = 1;

2200 #´agm¨
omp
 
nowa™


2201 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2202 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2203 
m
 = 0; m < 5; m++) {

2204 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2205 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2206 
u
[
i
][
j
][
k
+2][
m
]);

2211 
k
 = 2;

2212 #´agm¨
omp
 
nowa™


2213 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2214 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2215 
m
 = 0; m < 5; m++) {

2216 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2217 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2218 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2223 #´agm¨
omp
 
nowa™


2224 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2225 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2226 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2227 
m
 = 0; m < 5; m++) {

2228 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2229 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2230 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2231 
u
[
i
][
j
][
k
+2][
m
] );

2237 
k
 = 
grid_pošts
[2]-3;

2238 #´agm¨
omp
 
nowa™


2239 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2240 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2241 
m
 = 0; m < 5; m++) {

2242 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2243 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2244 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2249 
k
 = 
grid_pošts
[2]-2;

2250 #´agm¨
omp
 

2251 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2252 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2253 
m
 = 0; m < 5; m++) {

2254 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2255 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2256 5.0*
u
[
i
][
j
][
k
][
m
] );

2261 #´agm¨
omp
 

2262 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2263 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2264 
m
 = 0; m < 5; m++) {

2265 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2266 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2271 
	}
}

2276 
	$£t_cÚ¡ªts
() {

2281 
û
[0][0] = 2.0;

2282 
û
[0][1] = 0.0;

2283 
û
[0][2] = 0.0;

2284 
û
[0][3] = 4.0;

2285 
û
[0][4] = 5.0;

2286 
û
[0][5] = 3.0;

2287 
û
[0][6] = 0.5;

2288 
û
[0][7] = 0.02;

2289 
û
[0][8] = 0.01;

2290 
û
[0][9] = 0.03;

2291 
û
[0][10] = 0.5;

2292 
û
[0][11] = 0.4;

2293 
û
[0][12] = 0.3;

2295 
û
[1][0] = 1.0;

2296 
û
[1][1] = 0.0;

2297 
û
[1][2] = 0.0;

2298 
û
[1][3] = 0.0;

2299 
û
[1][4] = 1.0;

2300 
û
[1][5] = 2.0;

2301 
û
[1][6] = 3.0;

2302 
û
[1][7] = 0.01;

2303 
û
[1][8] = 0.03;

2304 
û
[1][9] = 0.02;

2305 
û
[1][10] = 0.4;

2306 
û
[1][11] = 0.3;

2307 
û
[1][12] = 0.5;

2309 
û
[2][0] = 2.0;

2310 
û
[2][1] = 2.0;

2311 
û
[2][2] = 0.0;

2312 
û
[2][3] = 0.0;

2313 
û
[2][4] = 0.0;

2314 
û
[2][5] = 2.0;

2315 
û
[2][6] = 3.0;

2316 
û
[2][7] = 0.04;

2317 
û
[2][8] = 0.03;

2318 
û
[2][9] = 0.05;

2319 
û
[2][10] = 0.3;

2320 
û
[2][11] = 0.5;

2321 
û
[2][12] = 0.4;

2323 
û
[3][0] = 2.0;

2324 
û
[3][1] = 2.0;

2325 
û
[3][2] = 0.0;

2326 
û
[3][3] = 0.0;

2327 
û
[3][4] = 0.0;

2328 
û
[3][5] = 2.0;

2329 
û
[3][6] = 3.0;

2330 
û
[3][7] = 0.03;

2331 
û
[3][8] = 0.05;

2332 
û
[3][9] = 0.04;

2333 
û
[3][10] = 0.2;

2334 
û
[3][11] = 0.1;

2335 
û
[3][12] = 0.3;

2337 
û
[4][0] = 5.0;

2338 
û
[4][1] = 4.0;

2339 
û
[4][2] = 3.0;

2340 
û
[4][3] = 2.0;

2341 
û
[4][4] = 0.1;

2342 
û
[4][5] = 0.4;

2343 
û
[4][6] = 0.3;

2344 
û
[4][7] = 0.05;

2345 
û
[4][8] = 0.04;

2346 
û
[4][9] = 0.03;

2347 
û
[4][10] = 0.1;

2348 
û
[4][11] = 0.3;

2349 
û
[4][12] = 0.2;

2351 
c1
 = 1.4;

2352 
c2
 = 0.4;

2353 
c3
 = 0.1;

2354 
c4
 = 1.0;

2355 
c5
 = 1.4;

2357 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2358 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2359 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2361 
c1c2
 = 
c1
 * 
c2
;

2362 
c1c5
 = 
c1
 * 
c5
;

2363 
c3c4
 = 
c3
 * 
c4
;

2364 
c1345
 = 
c1c5
 * 
c3c4
;

2366 
cÚz1
 = (1.0-
c1c5
);

2368 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2369 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2370 
tx3
 = 1.0 / 
dnxm1
;

2372 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2373 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2374 
ty3
 = 1.0 / 
dnym1
;

2376 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2377 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2378 
tz3
 = 1.0 / 
dnzm1
;

2380 
dx1
 = 0.75;

2381 
dx2
 = 0.75;

2382 
dx3
 = 0.75;

2383 
dx4
 = 0.75;

2384 
dx5
 = 0.75;

2386 
dy1
 = 0.75;

2387 
dy2
 = 0.75;

2388 
dy3
 = 0.75;

2389 
dy4
 = 0.75;

2390 
dy5
 = 0.75;

2392 
dz1
 = 1.0;

2393 
dz2
 = 1.0;

2394 
dz3
 = 1.0;

2395 
dz4
 = 1.0;

2396 
dz5
 = 1.0;

2398 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2399 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2400 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2402 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2404 
c4ds¥
 = 4.0 * 
ds¥
;

2405 
c5ds¥
 = 5.0 * 
ds¥
;

2407 
d‰x1
 = 
dt
*
tx1
;

2408 
d‰x2
 = 
dt
*
tx2
;

2409 
d‰y1
 = 
dt
*
ty1
;

2410 
d‰y2
 = 
dt
*
ty2
;

2411 
d‰z1
 = 
dt
*
tz1
;

2412 
d‰z2
 = 
dt
*
tz2
;

2414 
c2d‰x1
 = 2.0*
d‰x1
;

2415 
c2d‰y1
 = 2.0*
d‰y1
;

2416 
c2d‰z1
 = 2.0*
d‰z1
;

2418 
dtds¥
 = 
dt
*
ds¥
;

2420 
comz1
 = 
dtds¥
;

2421 
comz4
 = 4.0*
dtds¥
;

2422 
comz5
 = 5.0*
dtds¥
;

2423 
comz6
 = 6.0*
dtds¥
;

2425 
c3c4tx3
 = 
c3c4
*
tx3
;

2426 
c3c4ty3
 = 
c3c4
*
ty3
;

2427 
c3c4tz3
 = 
c3c4
*
tz3
;

2429 
dx1tx1
 = 
dx1
*
tx1
;

2430 
dx2tx1
 = 
dx2
*
tx1
;

2431 
dx3tx1
 = 
dx3
*
tx1
;

2432 
dx4tx1
 = 
dx4
*
tx1
;

2433 
dx5tx1
 = 
dx5
*
tx1
;

2435 
dy1ty1
 = 
dy1
*
ty1
;

2436 
dy2ty1
 = 
dy2
*
ty1
;

2437 
dy3ty1
 = 
dy3
*
ty1
;

2438 
dy4ty1
 = 
dy4
*
ty1
;

2439 
dy5ty1
 = 
dy5
*
ty1
;

2441 
dz1tz1
 = 
dz1
*
tz1
;

2442 
dz2tz1
 = 
dz2
*
tz1
;

2443 
dz3tz1
 = 
dz3
*
tz1
;

2444 
dz4tz1
 = 
dz4
*
tz1
;

2445 
dz5tz1
 = 
dz5
*
tz1
;

2447 
c2iv
 = 2.5;

2448 
cÚ43
 = 4.0/3.0;

2449 
cÚ16
 = 1.0/6.0;

2451 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2452 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2453 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2454 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2455 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2457 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2458 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2459 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2460 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2461 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2463 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2464 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2465 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2466 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2467 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2468 
	}
}

2473 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2482 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2483 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2484 
m
;

2489 
•sÚ
 = 1.0e-08;

2495 
	`”rÜ_nÜm
(
xû
);

2496 
	`compu‹_rhs
();

2498 
	`rhs_nÜm
(
xü
);

2500 
m
 = 0; m < 5; m++) {

2501 
xü
[
m
] = xü[m] / 
dt
;

2504 *
şass
 = 'U';

2505 *
v”if›d
 = 
TRUE
;

2507 
m
 = 0; m < 5; m++) {

2508 
xü»f
[
m
] = 1.0;

2509 
xû»f
[
m
] = 1.0;

2515 ià(
grid_pošts
[0] == 12 &&

2516 
grid_pošts
[1] == 12 &&

2517 
grid_pošts
[2] == 12 &&

2518 
no_time_¡•s
 == 60) {

2520 *
şass
 = 'S';

2521 
dŒef
 = 1.0e-2;

2526 
xü»f
[0] = 1.7034283709541311e-01;

2527 
xü»f
[1] = 1.2975252070034097e-02;

2528 
xü»f
[2] = 3.2527926989486055e-02;

2529 
xü»f
[3] = 2.6436421275166801e-02;

2530 
xü»f
[4] = 1.9211784131744430e-01;

2535 
xû»f
[0] = 4.9976913345811579e-04;

2536 
xû»f
[1] = 4.5195666782961927e-05;

2537 
xû»f
[2] = 7.3973765172921357e-05;

2538 
xû»f
[3] = 7.3821238632439731e-05;

2539 
xû»f
[4] = 8.9269630987491446e-04;

2544 } ià(
grid_pošts
[0] == 24 &&

2545 
grid_pošts
[1] == 24 &&

2546 
grid_pošts
[2] == 24 &&

2547 
no_time_¡•s
 == 200) {

2549 *
şass
 = 'W';

2550 
dŒef
 = 0.8e-3;

2554 
xü»f
[0] = 0.1125590409344e+03;

2555 
xü»f
[1] = 0.1180007595731e+02;

2556 
xü»f
[2] = 0.2710329767846e+02;

2557 
xü»f
[3] = 0.2469174937669e+02;

2558 
xü»f
[4] = 0.2638427874317e+03;

2563 
xû»f
[0] = 0.4419655736008e+01;

2564 
xû»f
[1] = 0.4638531260002e+00;

2565 
xû»f
[2] = 0.1011551749967e+01;

2566 
xû»f
[3] = 0.9235878729944e+00;

2567 
xû»f
[4] = 0.1018045837718e+02;

2573 } ià(
grid_pošts
[0] == 64 &&

2574 
grid_pošts
[1] == 64 &&

2575 
grid_pošts
[2] == 64 &&

2576 
no_time_¡•s
 == 200) {

2578 *
şass
 = 'A';

2579 
dŒef
 = 0.8e-3;

2583 
xü»f
[0] = 1.0806346714637264e+02;

2584 
xü»f
[1] = 1.1319730901220813e+01;

2585 
xü»f
[2] = 2.5974354511582465e+01;

2586 
xü»f
[3] = 2.3665622544678910e+01;

2587 
xü»f
[4] = 2.5278963211748344e+02;

2592 
xû»f
[0] = 4.2348416040525025e+00;

2593 
xû»f
[1] = 4.4390282496995698e-01;

2594 
xû»f
[2] = 9.6692480136345650e-01;

2595 
xû»f
[3] = 8.8302063039765474e-01;

2596 
xû»f
[4] = 9.7379901770829278e+00;

2602 } ià(
grid_pošts
[0] == 102 &&

2603 
grid_pošts
[1] == 102 &&

2604 
grid_pošts
[2] == 102 &&

2605 
no_time_¡•s
 == 200) {

2607 *
şass
 = 'B';

2608 
dŒef
 = 3.0e-4;

2613 
xü»f
[0] = 1.4233597229287254e+03;

2614 
xü»f
[1] = 9.9330522590150238e+01;

2615 
xü»f
[2] = 3.5646025644535285e+02;

2616 
xü»f
[3] = 3.2485447959084092e+02;

2617 
xü»f
[4] = 3.2707541254659363e+03;

2622 
xû»f
[0] = 5.2969847140936856e+01;

2623 
xû»f
[1] = 4.4632896115670668e+00;

2624 
xû»f
[2] = 1.3122573342210174e+01;

2625 
xû»f
[3] = 1.2006925323559144e+01;

2626 
xû»f
[4] = 1.2459576151035986e+02;

2632 } ià(
grid_pošts
[0] == 162 &&

2633 
grid_pošts
[1] == 162 &&

2634 
grid_pošts
[2] == 162 &&

2635 
no_time_¡•s
 == 200) {

2637 *
şass
 = 'C';

2638 
dŒef
 = 1.0e-4;

2643 
xü»f
[0] = 0.62398116551764615e+04;

2644 
xü»f
[1] = 0.50793239190423964e+03;

2645 
xü»f
[2] = 0.15423530093013596e+04;

2646 
xü»f
[3] = 0.13302387929291190e+04;

2647 
xü»f
[4] = 0.11604087428436455e+05;

2652 
xû»f
[0] = 0.16462008369091265e+03;

2653 
xû»f
[1] = 0.11497107903824313e+02;

2654 
xû»f
[2] = 0.41207446207461508e+02;

2655 
xû»f
[3] = 0.37087651059694167e+02;

2656 
xû»f
[4] = 0.36211053051841265e+03;

2659 *
v”if›d
 = 
FALSE
;

2670 
m
 = 0; m < 5; m++) {

2672 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2673 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2681 ià(*
şass
 != 'U') {

2682 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2683 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2684 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2685 *
v”if›d
 = 
FALSE
;

2686 *
şass
 = 'U';

2687 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2690 
	`´štf
(" Unknown class\n");

2693 ià(*
şass
 != 'U') {

2694 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2696 
	`´štf
(" RMS-norms of„esidual\n");

2698 
m
 = 0; m < 5; m++) {

2699 ià(*
şass
 == 'U') {

2700 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2701 } ià(
xüdif
[
m
] > 
•sÚ
) {

2702 *
v”if›d
 = 
FALSE
;

2703 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2704 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2706 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2707 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2711 ià(*
şass
 != 'U') {

2712 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2714 
	`´štf
(" RMS-norms of solutionƒrror\n");

2717 
m
 = 0; m < 5; m++) {

2718 ià(*
şass
 == 'U') {

2719 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2720 } ià(
xûdif
[
m
] > 
•sÚ
) {

2721 *
v”if›d
 = 
FALSE
;

2722 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2723 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2725 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2726 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2730 ià(*
şass
 == 'U') {

2731 
	`´štf
(" No„eference values…rovided\n");

2732 
	`´štf
(" No verification…erformed\n");

2733 } ià(*
v”if›d
 =ğ
TRUE
) {

2734 
	`´štf
(" Verification Successful\n");

2736 
	`´štf
(" Verification failed\n");

2738 
	}
}

2743 
	$x_sŞve
() {

2760 
	`lhsx
();

2761 
	`x_sŞve_ûÎ
();

2762 
	`x_backsub¡™u‹
();

2763 
	}
}

2769 
	$x_backsub¡™u‹
() {

2781 
i
, 
j
, 
k
, 
m
, 
n
;

2783 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2784 #´agm¨
omp
 

2785 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2786 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2787 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2788 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2789 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2790 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2796 
	}
}

2801 
	$x_sŞve_ûÎ
() {

2813 
i
,
j
,
k
,
isize
;

2815 
isize
 = 
grid_pošts
[0]-1;

2820 #´agm¨
omp
 

2821 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2822 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2828 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2829 
lhs
[0][
j
][
k
][
CC
],

2830 
rhs
[0][
j
][
k
] );

2838 
i
 = 1; i < 
isize
; i++) {

2839 #´agm¨
omp
 

2840 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2841 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2846 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2847 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2852 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2853 
lhs
[
i
-1][
j
][
k
][
CC
],

2854 
lhs
[
i
][
j
][
k
][
BB
]);

2861 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2862 
lhs
[
i
][
j
][
k
][
CC
],

2863 
rhs
[
i
][
j
][
k
] );

2869 #´agm¨
omp
 

2870 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2871 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2876 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2877 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2882 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2883 
lhs
[
isize
-1][
j
][
k
][
CC
],

2884 
lhs
[
isize
][
j
][
k
][
BB
]);

2889 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2890 
rhs
[
i
][
j
][
k
] );

2894 
	}
}

2899 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2908 
i
;

2910 
i
 = 0; i < 5; i++) {

2915 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2916 - 
ablock
[
i
][1]*
avec
[1]

2917 - 
ablock
[
i
][2]*
avec
[2]

2918 - 
ablock
[
i
][3]*
avec
[3]

2919 - 
ablock
[
i
][4]*
avec
[4];

2921 
	}
}

2926 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2927 
cblock
[5][5]) {

2936 
j
;

2938 
j
 = 0; j < 5; j++) {

2939 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2940 - 
ablock
[0][1]*
bblock
[1][
j
]

2941 - 
ablock
[0][2]*
bblock
[2][
j
]

2942 - 
ablock
[0][3]*
bblock
[3][
j
]

2943 - 
ablock
[0][4]*
bblock
[4][
j
];

2944 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2945 - 
ablock
[1][1]*
bblock
[1][
j
]

2946 - 
ablock
[1][2]*
bblock
[2][
j
]

2947 - 
ablock
[1][3]*
bblock
[3][
j
]

2948 - 
ablock
[1][4]*
bblock
[4][
j
];

2949 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2950 - 
ablock
[2][1]*
bblock
[1][
j
]

2951 - 
ablock
[2][2]*
bblock
[2][
j
]

2952 - 
ablock
[2][3]*
bblock
[3][
j
]

2953 - 
ablock
[2][4]*
bblock
[4][
j
];

2954 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2955 - 
ablock
[3][1]*
bblock
[1][
j
]

2956 - 
ablock
[3][2]*
bblock
[2][
j
]

2957 - 
ablock
[3][3]*
bblock
[3][
j
]

2958 - 
ablock
[3][4]*
bblock
[4][
j
];

2959 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2960 - 
ablock
[4][1]*
bblock
[1][
j
]

2961 - 
ablock
[4][2]*
bblock
[2][
j
]

2962 - 
ablock
[4][3]*
bblock
[3][
j
]

2963 - 
ablock
[4][4]*
bblock
[4][
j
];

2965 
	}
}

2970 
	$bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]) {

2975 
pivÙ
, 
cÛff
;

2981 
pivÙ
 = 1.00/
lhs
[0][0];

2982 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

2983 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

2984 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

2985 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

2986 
c
[0][0] = c[0][0]*
pivÙ
;

2987 
c
[0][1] = c[0][1]*
pivÙ
;

2988 
c
[0][2] = c[0][2]*
pivÙ
;

2989 
c
[0][3] = c[0][3]*
pivÙ
;

2990 
c
[0][4] = c[0][4]*
pivÙ
;

2991 
r
[0] =„[0] *
pivÙ
;

2993 
cÛff
 = 
lhs
[1][0];

2994 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

2995 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

2996 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

2997 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

2998 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

2999 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

3000 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

3001 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

3002 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

3003 
r
[1] =„[1] - 
cÛff
*r[0];

3005 
cÛff
 = 
lhs
[2][0];

3006 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3007 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3008 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3009 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3010 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

3011 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

3012 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

3013 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

3014 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

3015 
r
[2] =„[2] - 
cÛff
*r[0];

3017 
cÛff
 = 
lhs
[3][0];

3018 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3019 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3020 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3021 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3022 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

3023 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

3024 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

3025 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

3026 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

3027 
r
[3] =„[3] - 
cÛff
*r[0];

3029 
cÛff
 = 
lhs
[4][0];

3030 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3031 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3032 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3033 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3034 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

3035 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

3036 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

3037 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

3038 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

3039 
r
[4] =„[4] - 
cÛff
*r[0];

3042 
pivÙ
 = 1.00/
lhs
[1][1];

3043 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3044 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3045 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3046 
c
[1][0] = c[1][0]*
pivÙ
;

3047 
c
[1][1] = c[1][1]*
pivÙ
;

3048 
c
[1][2] = c[1][2]*
pivÙ
;

3049 
c
[1][3] = c[1][3]*
pivÙ
;

3050 
c
[1][4] = c[1][4]*
pivÙ
;

3051 
r
[1] =„[1] *
pivÙ
;

3053 
cÛff
 = 
lhs
[0][1];

3054 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3055 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3056 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3057 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

3058 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

3059 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

3060 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

3061 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

3062 
r
[0] =„[0] - 
cÛff
*r[1];

3064 
cÛff
 = 
lhs
[2][1];

3065 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3066 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3067 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3068 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3069 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3070 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3071 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3072 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3073 
r
[2] =„[2] - 
cÛff
*r[1];

3075 
cÛff
 = 
lhs
[3][1];

3076 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3077 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3078 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3079 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3080 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3081 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3082 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3083 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3084 
r
[3] =„[3] - 
cÛff
*r[1];

3086 
cÛff
 = 
lhs
[4][1];

3087 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3088 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3089 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3090 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3091 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3092 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3093 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3094 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3095 
r
[4] =„[4] - 
cÛff
*r[1];

3098 
pivÙ
 = 1.00/
lhs
[2][2];

3099 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3100 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3101 
c
[2][0] = c[2][0]*
pivÙ
;

3102 
c
[2][1] = c[2][1]*
pivÙ
;

3103 
c
[2][2] = c[2][2]*
pivÙ
;

3104 
c
[2][3] = c[2][3]*
pivÙ
;

3105 
c
[2][4] = c[2][4]*
pivÙ
;

3106 
r
[2] =„[2] *
pivÙ
;

3108 
cÛff
 = 
lhs
[0][2];

3109 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3110 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3111 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3112 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3113 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3114 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3115 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3116 
r
[0] =„[0] - 
cÛff
*r[2];

3118 
cÛff
 = 
lhs
[1][2];

3119 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3120 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3121 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3122 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3123 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3124 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3125 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3126 
r
[1] =„[1] - 
cÛff
*r[2];

3128 
cÛff
 = 
lhs
[3][2];

3129 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3130 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3131 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3132 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3133 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3134 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3135 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3136 
r
[3] =„[3] - 
cÛff
*r[2];

3138 
cÛff
 = 
lhs
[4][2];

3139 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3140 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3141 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3142 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3143 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3144 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3145 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3146 
r
[4] =„[4] - 
cÛff
*r[2];

3149 
pivÙ
 = 1.00/
lhs
[3][3];

3150 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3151 
c
[3][0] = c[3][0]*
pivÙ
;

3152 
c
[3][1] = c[3][1]*
pivÙ
;

3153 
c
[3][2] = c[3][2]*
pivÙ
;

3154 
c
[3][3] = c[3][3]*
pivÙ
;

3155 
c
[3][4] = c[3][4]*
pivÙ
;

3156 
r
[3] =„[3] *
pivÙ
;

3158 
cÛff
 = 
lhs
[0][3];

3159 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3160 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3161 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3162 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3163 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3164 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3165 
r
[0] =„[0] - 
cÛff
*r[3];

3167 
cÛff
 = 
lhs
[1][3];

3168 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3169 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3170 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3171 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3172 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3173 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3174 
r
[1] =„[1] - 
cÛff
*r[3];

3176 
cÛff
 = 
lhs
[2][3];

3177 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3178 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3179 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3180 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3181 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3182 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3183 
r
[2] =„[2] - 
cÛff
*r[3];

3185 
cÛff
 = 
lhs
[4][3];

3186 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3187 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3188 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3189 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3190 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3191 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3192 
r
[4] =„[4] - 
cÛff
*r[3];

3195 
pivÙ
 = 1.00/
lhs
[4][4];

3196 
c
[4][0] = c[4][0]*
pivÙ
;

3197 
c
[4][1] = c[4][1]*
pivÙ
;

3198 
c
[4][2] = c[4][2]*
pivÙ
;

3199 
c
[4][3] = c[4][3]*
pivÙ
;

3200 
c
[4][4] = c[4][4]*
pivÙ
;

3201 
r
[4] =„[4] *
pivÙ
;

3203 
cÛff
 = 
lhs
[0][4];

3204 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3205 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3206 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3207 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3208 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3209 
r
[0] =„[0] - 
cÛff
*r[4];

3211 
cÛff
 = 
lhs
[1][4];

3212 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3213 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3214 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3215 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3216 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3217 
r
[1] =„[1] - 
cÛff
*r[4];

3219 
cÛff
 = 
lhs
[2][4];

3220 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3221 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3222 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3223 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3224 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3225 
r
[2] =„[2] - 
cÛff
*r[4];

3227 
cÛff
 = 
lhs
[3][4];

3228 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3229 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3230 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3231 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3232 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3233 
r
[3] =„[3] - 
cÛff
*r[4];

3234 
	}
}

3239 
	$bšvrhs
Ğ
lhs
[5][5], 
r
[5] ) {

3244 
pivÙ
, 
cÛff
;

3250 
pivÙ
 = 1.00/
lhs
[0][0];

3251 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

3252 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

3253 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

3254 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

3255 
r
[0] =„[0] *
pivÙ
;

3257 
cÛff
 = 
lhs
[1][0];

3258 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

3259 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

3260 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

3261 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

3262 
r
[1] =„[1] - 
cÛff
*r[0];

3264 
cÛff
 = 
lhs
[2][0];

3265 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3266 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3267 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3268 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3269 
r
[2] =„[2] - 
cÛff
*r[0];

3271 
cÛff
 = 
lhs
[3][0];

3272 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3273 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3274 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3275 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3276 
r
[3] =„[3] - 
cÛff
*r[0];

3278 
cÛff
 = 
lhs
[4][0];

3279 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3280 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3281 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3282 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3283 
r
[4] =„[4] - 
cÛff
*r[0];

3286 
pivÙ
 = 1.00/
lhs
[1][1];

3287 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3288 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3289 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3290 
r
[1] =„[1] *
pivÙ
;

3292 
cÛff
 = 
lhs
[0][1];

3293 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3294 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3295 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3296 
r
[0] =„[0] - 
cÛff
*r[1];

3298 
cÛff
 = 
lhs
[2][1];

3299 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3300 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3301 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3302 
r
[2] =„[2] - 
cÛff
*r[1];

3304 
cÛff
 = 
lhs
[3][1];

3305 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3306 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3307 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3308 
r
[3] =„[3] - 
cÛff
*r[1];

3310 
cÛff
 = 
lhs
[4][1];

3311 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3312 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3313 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3314 
r
[4] =„[4] - 
cÛff
*r[1];

3317 
pivÙ
 = 1.00/
lhs
[2][2];

3318 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3319 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3320 
r
[2] =„[2] *
pivÙ
;

3322 
cÛff
 = 
lhs
[0][2];

3323 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3324 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3325 
r
[0] =„[0] - 
cÛff
*r[2];

3327 
cÛff
 = 
lhs
[1][2];

3328 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3329 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3330 
r
[1] =„[1] - 
cÛff
*r[2];

3332 
cÛff
 = 
lhs
[3][2];

3333 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3334 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3335 
r
[3] =„[3] - 
cÛff
*r[2];

3337 
cÛff
 = 
lhs
[4][2];

3338 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3339 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3340 
r
[4] =„[4] - 
cÛff
*r[2];

3343 
pivÙ
 = 1.00/
lhs
[3][3];

3344 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3345 
r
[3] =„[3] *
pivÙ
;

3347 
cÛff
 = 
lhs
[0][3];

3348 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3349 
r
[0] =„[0] - 
cÛff
*r[3];

3351 
cÛff
 = 
lhs
[1][3];

3352 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3353 
r
[1] =„[1] - 
cÛff
*r[3];

3355 
cÛff
 = 
lhs
[2][3];

3356 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3357 
r
[2] =„[2] - 
cÛff
*r[3];

3359 
cÛff
 = 
lhs
[4][3];

3360 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3361 
r
[4] =„[4] - 
cÛff
*r[3];

3364 
pivÙ
 = 1.00/
lhs
[4][4];

3365 
r
[4] =„[4] *
pivÙ
;

3367 
cÛff
 = 
lhs
[0][4];

3368 
r
[0] =„[0] - 
cÛff
*r[4];

3370 
cÛff
 = 
lhs
[1][4];

3371 
r
[1] =„[1] - 
cÛff
*r[4];

3373 
cÛff
 = 
lhs
[2][4];

3374 
r
[2] =„[2] - 
cÛff
*r[4];

3376 
cÛff
 = 
lhs
[3][4];

3377 
r
[3] =„[3] - 
cÛff
*r[4];

3379 
	}
}

3384 
	$y_sŞve
() {

3399 
	`lhsy
();

3400 
	`y_sŞve_ûÎ
();

3401 
	`y_backsub¡™u‹
();

3402 
	}
}

3408 
	$y_backsub¡™u‹
() {

3420 
i
, 
j
, 
k
, 
m
, 
n
;

3422 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3423 #´agm¨
omp
 

3424 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3425 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3426 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3427 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3428 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3429 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3435 
	}
}

3440 
	$y_sŞve_ûÎ
() {

3455 
i
, 
j
, 
k
, 
jsize
;

3457 
jsize
 = 
grid_pošts
[1]-1;

3459 #´agm¨
omp
 

3460 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3461 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3467 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3468 
lhs
[
i
][0][
k
][
CC
],

3469 
rhs
[
i
][0][
k
] );

3477 
j
 = 1; j < 
jsize
; j++) {

3478 #´agm¨
omp
 

3479 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3480 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3487 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3488 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3493 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3494 
lhs
[
i
][
j
-1][
k
][
CC
],

3495 
lhs
[
i
][
j
][
k
][
BB
]);

3501 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3502 
lhs
[
i
][
j
][
k
][
CC
],

3503 
rhs
[
i
][
j
][
k
] );

3509 #´agm¨
omp
 

3510 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3511 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3516 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3517 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3524 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3525 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3526 
lhs
[
i
][
jsize
][
k
][
BB
]);

3531 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3532 
rhs
[
i
][
jsize
][
k
] );

3536 
	}
}

3542 
	$z_sŞve
() {

3557 
	`lhsz
();

3558 
	`z_sŞve_ûÎ
();

3559 
	`z_backsub¡™u‹
();

3560 
	}
}

3565 
	$z_backsub¡™u‹
() {

3577 
i
, 
j
, 
k
, 
m
, 
n
;

3579 #´agm¨
omp
 

3580 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3581 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3582 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3583 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3584 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3585 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3586 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3592 
	}
}

3597 
	$z_sŞve_ûÎ
() {

3612 
i
,
j
,
k
,
ksize
;

3614 
ksize
 = 
grid_pošts
[2]-1;

3619 #´agm¨
omp
 

3620 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3621 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3627 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3628 
lhs
[
i
][
j
][0][
CC
],

3629 
rhs
[
i
][
j
][0] );

3638 
k
 = 1; k < 
ksize
; k++) {

3639 #´agm¨
omp
 

3640 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3641 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3648 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3649 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3655 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3656 
lhs
[
i
][
j
][
k
-1][
CC
],

3657 
lhs
[
i
][
j
][
k
][
BB
]);

3663 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3664 
lhs
[
i
][
j
][
k
][
CC
],

3665 
rhs
[
i
][
j
][
k
] );

3674 #´agm¨
omp
 

3675 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3676 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3681 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3682 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3689 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3690 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3691 
lhs
[
i
][
j
][
ksize
][
BB
]);

3696 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3697 
rhs
[
i
][
j
][
ksize
] );

3701 
	}
}

	@BT/bt.swap.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

37 
	~<Çutus/libccom·t.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
compu‹_rhs
();

55 
£t_cÚ¡ªts
();

56 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

57 
x_sŞve
();

58 
x_backsub¡™u‹
();

59 
x_sŞve_ûÎ
();

60 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

61 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

62 
cblock
[5][5]);

63 
bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]);

64 
bšvrhs
(
lhs
[5][5], 
r
[5]);

65 
y_sŞve
();

66 
y_backsub¡™u‹
();

67 
y_sŞve_ûÎ
();

68 
z_sŞve
();

69 
z_backsub¡™u‹
();

70 
z_sŞve_ûÎ
();

72 
´og¿m_BT
(*
buf
, * 
´iv
);

74 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

75 .
cmd
 = "nas-bt",

76 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

77 .
	ghªdËr
 = 
´og¿m_BT
,

79 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

86 
	$´og¿m_BT
(*
buf
, * 
´iv
) {

88 
n™”
, 
¡•
, 
n3
;

89 
Áh»ads
 = 1;

90 
Çvg
, 
mæİs
;

92 
tmax
;

93 
boŞ—n
 
v”if›d
;

94 
şass
;

102 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

116 
	`´štf
(" No input file inputbt.data. Using compiled defaults\n");

118 
n™”
 = 
NITER_DEFAULT
;

119 
dt
 = 
DT_DEFAULT
;

120 
grid_pošts
[0] = 
PROBLEM_SIZE
;

121 
grid_pošts
[1] = 
PROBLEM_SIZE
;

122 
grid_pošts
[2] = 
PROBLEM_SIZE
;

126 
	`´štf
(" Size: %3dx%3dx%3d\n",

127 
grid_pošts
[0], grid_points[1], grid_points[2]);

128 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

130 ià(
grid_pošts
[0] > 
IMAX
 ||

131 
grid_pošts
[1] > 
JMAX
 ||

132 
grid_pošts
[2] > 
KMAX
) {

133 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

134 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

135 
	`ex™
(1);

138 
	`£t_cÚ¡ªts
();

140 
	`š™Ÿlize
();

141 
	`lhsš™
();

143 
	`exaù_rhs
();

151 
	`adi
();

155 
	`š™Ÿlize
();

159 
	`tim”_ş—r
(1);

160 
	`tim”_¡¬t
(1);

162 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

164 ià(
¡•
%20 == 0 || step == 1) {

165 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

167 
	`adi
();

170 #´agm¨
omp
 
·¿Î–


172 #ià
	`defšed
(
_OPENMP
)

173 #´agm¨
omp
 
ma¡”


174 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

178 
	`tim”_¡İ
(1);

179 
tmax
 = 
	`tim”_»ad
(1);

181 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

183 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

184 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

185 iàĞ
tmax
 != 0.0 ) {

186 
mæİs
 = 1.0e-6*()
n™”
*

187 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

189 
mæİs
 = 0.0;

191 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

192 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

193 
tmax
, 
mæİs
, " floating…oint",

194 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

195 
CS6
, "(none)");

196 
	}
}

201 
	$add
() {

207 
i
, 
j
, 
k
, 
m
;

209 #´agm¨
omp
 

210 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

211 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

212 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

213 
m
 = 0; m < 5; m++) {

214 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

219 
	}
}

224 
	$adi
() {

225 #´agm¨
omp
 
·¿Î–


226 
	`compu‹_rhs
();

228 #´agm¨
omp
 
·¿Î–


229 
	`x_sŞve
();

231 #´agm¨
omp
 
·¿Î–


232 
	`y_sŞve
();

234 #´agm¨
omp
 
·¿Î–


235 
	`z_sŞve
();

237 #´agm¨
omp
 
·¿Î–


238 
	`add
();

239 
	}
}

244 
	$”rÜ_nÜm
(
rms
[5]) {

251 
i
, 
j
, 
k
, 
m
, 
d
;

252 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

254 
m
 = 0; m < 5; m++) {

255 
rms
[
m
] = 0.0;

258 
i
 = 0; i < 
grid_pošts
[0]; i++) {

259 
xi
 = ()
i
 * 
dnxm1
;

260 
j
 = 0; j < 
grid_pošts
[1]; j++) {

261 
‘a
 = ()
j
 * 
dnym1
;

262 
k
 = 0; k < 
grid_pošts
[2]; k++) {

263 
z‘a
 = ()
k
 * 
dnzm1
;

264 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

266 
m
 = 0; m < 5; m++) {

267 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

268 
rms
[
m
] =„ms[m] + 
add
*add;

274 
m
 = 0; m < 5; m++) {

275 
d
 = 0; d <= 2; d++) {

276 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

278 
rms
[
m
] = 
	`sq¹
(rms[m]);

280 
	}
}

285 
	$rhs_nÜm
(
rms
[5]) {

290 
i
, 
j
, 
k
, 
d
, 
m
;

291 
add
;

293 
m
 = 0; m < 5; m++) {

294 
rms
[
m
] = 0.0;

297 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

298 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

299 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

300 
m
 = 0; m < 5; m++) {

301 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

302 
rms
[
m
] =„ms[m] + 
add
*add;

308 
m
 = 0; m < 5; m++) {

309 
d
 = 0; d <= 2; d++) {

310 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

312 
rms
[
m
] = 
	`sq¹
(rms[m]);

314 
	}
}

320 
	$exaù_rhs
() {

322 #´agm¨
omp
 
·¿Î–


331 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

332 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

337 #´agm¨
omp
 

338 
i
 = 0; i < 
grid_pošts
[0]; i++) {

339 
j
 = 0; j < 
grid_pošts
[1]; j++) {

340 
k
 = 0; k < 
grid_pošts
[2]; k++) {

341 
m
 = 0; m < 5; m++) {

342 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

355 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

356 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

360 #´agm¨
omp
 

361 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

362 
‘a
 = ()
j
 * 
dnym1
;

364 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

365 
z‘a
 = ()
k
 * 
dnzm1
;

367 
i
 = 0; i < 
grid_pošts
[0]; i++) {

368 
xi
 = ()
i
 * 
dnxm1
;

370 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

371 
m
 = 0; m < 5; m++) {

372 
ue
[
i
*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

374 
	`´štf
("1\n");

375 
dp
 = 1.0 / 
d‹mp
[0];

377 
m
 = 1; m <= 4; m++) {

378 
buf
[
i
][
m
] = 
dp
 * 
d‹mp
[m];

381 
	`´štf
("2\n");

382 
cuf
[
i
] = 
buf
[i][1] * buf[i][1];

383 
buf
[
i
][0] = 
cuf
[i] + buf[i][2] * buf[i][2] +

384 
buf
[
i
][3] * buf[i][3];

385 
q
[
i
] = 0.5*(
buf
[i][1]*
ue
[i*
PROBLEM_SIZE
+1] + buf[i][2]*ue[i*PROBLEM_SIZE+2] +

386 
buf
[
i
][3]*
ue
[i*
PROBLEM_SIZE
+3]);

388 
	`´štf
("3\n");

390 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

391 
im1
 = 
i
-1;

392 
1
 = 
i
+1;

394 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

395 
tx2
*(
ue
[
1
*
PROBLEM_SIZE
+1]-ue[
im1
*PROBLEM_SIZE+1])+

396 
dx1tx1
*(
ue
[
1
*
PROBLEM_SIZE
+0]-2.0*ue[
i
*PROBLEM_SIZE+0]+ue[
im1
*PROBLEM_SIZE+0]);

398 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

399 
tx2
 * ((
ue
[
1
*
PROBLEM_SIZE
+1]*
buf
[1][1]+
c2
*(ue[1*PROBLEM_SIZE+4]-
q
[ip1]))-

400 (
ue
[
im1
*
PROBLEM_SIZE
+1]*
buf
[im1][1]+
c2
*(ue[im1*PROBLEM_SIZE+4]-
q
[im1])))+

401 
xxcÚ1
*(
buf
[
1
][1]-2.0*buf[
i
][1]+buf[
im1
][1])+

402 
dx2tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+1]-2.0* ue[
i
*PROBLEM_SIZE+1]+ ue[
im1
*PROBLEM_SIZE+1]);

404 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

405 
tx2
 * (
ue
[
1
*
PROBLEM_SIZE
+2]*
buf
[1][1]-ue[
im1
*PROBLEM_SIZE+2]*buf[im1][1])+

406 
xxcÚ2
*(
buf
[
1
][2]-2.0*buf[
i
][2]+buf[
im1
][2])+

407 
dx3tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+2]-2.0* ue[
i
*PROBLEM_SIZE+2]+ ue[
im1
*PROBLEM_SIZE+2]);

409 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

410 
tx2
*(
ue
[
1
*
PROBLEM_SIZE
+3]*
buf
[1][1]-ue[
im1
*PROBLEM_SIZE+3]*buf[im1][1])+

411 
xxcÚ2
*(
buf
[
1
][3]-2.0*buf[
i
][3]+buf[
im1
][3])+

412 
dx4tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+3]-2.0* ue[
i
*PROBLEM_SIZE+3]+ ue[
im1
*PROBLEM_SIZE+3]);

414 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

415 
tx2
*(
buf
[
1
][1]*(
c1
*
ue
[1*
PROBLEM_SIZE
+4]-
c2
*
q
[ip1])-

416 
buf
[
im1
][1]*(
c1
*
ue
[im1*
PROBLEM_SIZE
+4]-
c2
*
q
[im1]))+

417 0.5*
xxcÚ3
*(
buf
[
1
][0]-2.0*buf[
i
][0]+buf[
im1
][0])+

418 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

419 
xxcÚ5
*(
buf
[
1
][4]-2.0*buf[
i
][4]+buf[
im1
][4])+

420 
dx5tx1
*Ğ
ue
[
1
*
PROBLEM_SIZE
+4]-2.0* ue[
i
*PROBLEM_SIZE+4]+ ue[
im1
*PROBLEM_SIZE+4]);

423 
	`´štf
("4\n");

428 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0*
PROBLEM_SIZE
+0]);

429 
m
 = 0; m < 5; m++) {

430 
i
 = 1;

431 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

432 (5.0*
ue
[
i
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m] +ue[(i+2)*PROBLEM_SIZE+m]);

433 
i
 = 2;

434 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

435 (-4.0*
ue
[(
i
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[i*PROBLEM_SIZE+m] -

436 4.0*
ue
[(
i
+1)*
PROBLEM_SIZE
+
m
] + ue[(i+2)*PROBLEM_SIZE+m]);

438 
	`´štf
("5\n");

439 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0*
PROBLEM_SIZE
+0]);

440 
m
 = 0; m < 5; m++) {

441 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

442 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

443 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] +

444 6.0*
ue
[
i
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m] + ue[(i+2)*PROBLEM_SIZE+m]);

447 
	`´štf
("6\n");

448 
	`´štf
("acûs tØth»ad´iv©u%à\n", 
ue
[0*
PROBLEM_SIZE
+0]);

449 
m
 = 0; m < 5; m++) {

450 
i
 = 
grid_pošts
[0]-3;

451 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

452 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] +

453 6.0*
ue
[
i
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i+1)*PROBLEM_SIZE+m]);

454 
i
 = 
grid_pošts
[0]-2;

455 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

456 (
ue
[(
i
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(i-1)*PROBLEM_SIZE+m] + 5.0*ue[i*PROBLEM_SIZE+m]);

458 
	`´štf
("7\n");

465 
	`´štf
("8");

469 #´agm¨
omp
 

470 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

471 
xi
 = ()
i
 * 
dnxm1
;

473 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

474 
z‘a
 = ()
k
 * 
dnzm1
;

476 
j
 = 0; j < 
grid_pošts
[1]; j++) {

477 
‘a
 = ()
j
 * 
dnym1
;

479 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

480 
m
 = 0; m < 5; m++) {

481 
ue
[
j
*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

484 
dp
 = 1.0/
d‹mp
[0];

486 
m
 = 1; m <= 4; m++) {

487 
buf
[
j
][
m
] = 
dp
 * 
d‹mp
[m];

490 
cuf
[
j
] = 
buf
[j][2] * buf[j][2];

491 
buf
[
j
][0] = 
cuf
[j] + buf[j][1] * buf[j][1] +

492 
buf
[
j
][3] * buf[j][3];

493 
q
[
j
] = 0.5*(
buf
[j][1]*
ue
[j*
PROBLEM_SIZE
+1] + buf[j][2]*ue[j*PROBLEM_SIZE+2] +

494 
buf
[
j
][3]*
ue
[j*
PROBLEM_SIZE
+3]);

497 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

498 
jm1
 = 
j
-1;

499 
jp1
 = 
j
+1;

501 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

502 
ty2
*Ğ
ue
[
jp1
*
PROBLEM_SIZE
+2]-ue[
jm1
*PROBLEM_SIZE+2] )+

503 
dy1ty1
*(
ue
[
jp1
*
PROBLEM_SIZE
+0]-2.0*ue[
j
*PROBLEM_SIZE+0]+ue[
jm1
*PROBLEM_SIZE+0]);

505 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

506 
ty2
*(
ue
[
jp1
*
PROBLEM_SIZE
+1]*
buf
[jp1][2]-ue[
jm1
*PROBLEM_SIZE+1]*buf[jm1][2])+

507 
yycÚ2
*(
buf
[
jp1
][1]-2.0*buf[
j
][1]+buf[
jm1
][1])+

508 
dy2ty1
*Ğ
ue
[
jp1
*
PROBLEM_SIZE
+1]-2.0* ue[
j
*PROBLEM_SIZE+1]+ ue[
jm1
*PROBLEM_SIZE+1]);

510 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

511 
ty2
*((
ue
[
jp1
*
PROBLEM_SIZE
+2]*
buf
[jp1][2]+
c2
*(ue[jp1*PROBLEM_SIZE+4]-
q
[jp1]))-

512 (
ue
[
jm1
*
PROBLEM_SIZE
+2]*
buf
[jm1][2]+
c2
*(ue[jm1*PROBLEM_SIZE+4]-
q
[jm1])))+

513 
yycÚ1
*(
buf
[
jp1
][2]-2.0*buf[
j
][2]+buf[
jm1
][2])+

514 
dy3ty1
*Ğ
ue
[
jp1
*
PROBLEM_SIZE
+2]-2.0*ue[
j
*PROBLEM_SIZE+2] +ue[
jm1
*PROBLEM_SIZE+2]);

516 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

517 
ty2
*(
ue
[
jp1
*
PROBLEM_SIZE
+3]*
buf
[jp1][2]-ue[
jm1
*PROBLEM_SIZE+3]*buf[jm1][2])+

518 
yycÚ2
*(
buf
[
jp1
][3]-2.0*buf[
j
][3]+buf[
jm1
][3])+

519 
dy4ty1
*Ğ
ue
[
jp1
*
PROBLEM_SIZE
+3]-2.0*ue[
j
*PROBLEM_SIZE+3]+ ue[
jm1
*PROBLEM_SIZE+3]);

521 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

522 
ty2
*(
buf
[
jp1
][2]*(
c1
*
ue
[jp1*
PROBLEM_SIZE
+4]-
c2
*
q
[jp1])-

523 
buf
[
jm1
][2]*(
c1
*
ue
[jm1*
PROBLEM_SIZE
+4]-
c2
*
q
[jm1]))+

524 0.5*
yycÚ3
*(
buf
[
jp1
][0]-2.0*buf[
j
][0]+

525 
buf
[
jm1
][0])+

526 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

527 
yycÚ5
*(
buf
[
jp1
][4]-2.0*buf[
j
][4]+buf[
jm1
][4])+

528 
dy5ty1
*(
ue
[
jp1
*
PROBLEM_SIZE
+4]-2.0*ue[
j
*PROBLEM_SIZE+4]+ue[
jm1
*PROBLEM_SIZE+4]);

531 
	`´štf
("9\n");

536 
m
 = 0; m < 5; m++) {

537 
j
 = 1;

538 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

539 (5.0*
ue
[
j
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j+1)*PROBLEM_SIZE+m] +ue[(j+2)*PROBLEM_SIZE+m]);

540 
j
 = 2;

541 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

542 (-4.0*
ue
[(
j
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[j*PROBLEM_SIZE+m] -

543 4.0*
ue
[(
j
+1)*
PROBLEM_SIZE
+
m
] + ue[(j+2)*PROBLEM_SIZE+m]);

546 
	`´štf
("9.1\n");

547 
m
 = 0; m < 5; m++) {

548 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

549 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

550 (
ue
[(
j
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j-1)*PROBLEM_SIZE+m] +

551 6.0*
ue
[
j
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(j+1)*PROBLEM_SIZE+m] + ue[(j+2)*PROBLEM_SIZE+m]);

555 
	`´štf
("9.2\n");

556 
m
 = 0; m < 5; m++) {

557 
j
 = 
grid_pošts
[1]-3;

558 
	`´štf
("9.21\n");

562 
	`´štf
("9.22\n");

564 
j
 = 
grid_pošts
[1]-2;

565 
	`´štf
("9.23\n");

569 
	`´štf
("9.24\n");

573 
	`´štf
("9.3\n");

578 
	`´štf
("10\n");

583 #´agm¨
omp
 

584 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

585 
xi
 = ()
i
 * 
dnxm1
;

587 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

588 
‘a
 = ()
j
 * 
dnym1
;

590 
k
 = 0; k < 
grid_pošts
[2]; k++) {

591 
z‘a
 = ()
k
 * 
dnzm1
;

593 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

594 
m
 = 0; m < 5; m++) {

595 
ue
[
k
*
PROBLEM_SIZE
+
m
] = 
d‹mp
[m];

598 
dp
 = 1.0/
d‹mp
[0];

600 
m
 = 1; m <= 4; m++) {

601 
buf
[
k
][
m
] = 
dp
 * 
d‹mp
[m];

604 
cuf
[
k
] = 
buf
[k][3] * buf[k][3];

605 
buf
[
k
][0] = 
cuf
[k] + buf[k][1] * buf[k][1] +

606 
buf
[
k
][2] * buf[k][2];

607 
q
[
k
] = 0.5*(
buf
[k][1]*
ue
[k*
PROBLEM_SIZE
+1] + buf[k][2]*ue[k*PROBLEM_SIZE+2] +

608 
buf
[
k
][3]*
ue
[k*
PROBLEM_SIZE
+3]);

611 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

612 
km1
 = 
k
-1;

613 
kp1
 = 
k
+1;

615 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

616 
tz2
*Ğ
ue
[
kp1
*
PROBLEM_SIZE
+3]-ue[
km1
*PROBLEM_SIZE+3] )+

617 
dz1tz1
*(
ue
[
kp1
*
PROBLEM_SIZE
+0]-2.0*ue[
k
*PROBLEM_SIZE+0]+ue[
km1
*PROBLEM_SIZE+0]);

619 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

620 
tz2
 * (
ue
[
kp1
*
PROBLEM_SIZE
+1]*
buf
[kp1][3]-ue[
km1
*PROBLEM_SIZE+1]*buf[km1][3])+

621 
zzcÚ2
*(
buf
[
kp1
][1]-2.0*buf[
k
][1]+buf[
km1
][1])+

622 
dz2tz1
*Ğ
ue
[
kp1
*
PROBLEM_SIZE
+1]-2.0* ue[
k
*PROBLEM_SIZE+1]+ ue[
km1
*PROBLEM_SIZE+1]);

624 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

625 
tz2
 * (
ue
[
kp1
*
PROBLEM_SIZE
+2]*
buf
[kp1][3]-ue[
km1
*PROBLEM_SIZE+2]*buf[km1][3])+

626 
zzcÚ2
*(
buf
[
kp1
][2]-2.0*buf[
k
][2]+buf[
km1
][2])+

627 
dz3tz1
*(
ue
[
kp1
*
PROBLEM_SIZE
+2]-2.0*ue[
k
*PROBLEM_SIZE+2]+ue[
km1
*PROBLEM_SIZE+2]);

629 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

630 
tz2
 * ((
ue
[
kp1
*
PROBLEM_SIZE
+3]*
buf
[kp1][3]+
c2
*(ue[kp1*PROBLEM_SIZE+4]-
q
[kp1]))-

631 (
ue
[
km1
*
PROBLEM_SIZE
+3]*
buf
[km1][3]+
c2
*(ue[km1*PROBLEM_SIZE+4]-
q
[km1])))+

632 
zzcÚ1
*(
buf
[
kp1
][3]-2.0*buf[
k
][3]+buf[
km1
][3])+

633 
dz4tz1
*Ğ
ue
[
kp1
*
PROBLEM_SIZE
+3]-2.0*ue[
k
*PROBLEM_SIZE+3] +ue[
km1
*PROBLEM_SIZE+3]);

635 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

636 
tz2
 * (
buf
[
kp1
][3]*(
c1
*
ue
[kp1*
PROBLEM_SIZE
+4]-
c2
*
q
[kp1])-

637 
buf
[
km1
][3]*(
c1
*
ue
[km1*
PROBLEM_SIZE
+4]-
c2
*
q
[km1]))+

638 0.5*
zzcÚ3
*(
buf
[
kp1
][0]-2.0*buf[
k
][0]

639 +
buf
[
km1
][0])+

640 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

641 
zzcÚ5
*(
buf
[
kp1
][4]-2.0*buf[
k
][4]+buf[
km1
][4])+

642 
dz5tz1
*Ğ
ue
[
kp1
*
PROBLEM_SIZE
+4]-2.0*ue[
k
*PROBLEM_SIZE+4]+ ue[
km1
*PROBLEM_SIZE+4]);

645 
	`´štf
("11\n");

649 
m
 = 0; m < 5; m++) {

650 
k
 = 1;

651 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

652 (5.0*
ue
[
k
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m] +ue[(k+2)*PROBLEM_SIZE+m]);

653 
k
 = 2;

654 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

655 (-4.0*
ue
[(
k
-1)*
PROBLEM_SIZE
+
m
] + 6.0*ue[k*PROBLEM_SIZE+m] -

656 4.0*
ue
[(
k
+1)*
PROBLEM_SIZE
+
m
] + ue[(k+2)*PROBLEM_SIZE+m]);

659 
m
 = 0; m < 5; m++) {

660 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

661 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

662 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] +

663 6.0*
ue
[
k
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m] + ue[(k+2)*PROBLEM_SIZE+m]);

667 
m
 = 0; m < 5; m++) {

668 
k
 = 
grid_pošts
[2]-3;

669 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

670 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] +

671 6.0*
ue
[
k
*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k+1)*PROBLEM_SIZE+m]);

672 
k
 = 
grid_pošts
[2]-2;

673 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

674 (
ue
[(
k
-2)*
PROBLEM_SIZE
+
m
] - 4.0*ue[(k-1)*PROBLEM_SIZE+m] + 5.0*ue[k*PROBLEM_SIZE+m]);

685 #´agm¨
omp
 

686 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

687 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

688 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

689 
m
 = 0; m < 5; m++) {

690 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

697 
	}
}

701 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

702 
d‹mp
[5]) {

711 
m
;

713 
m
 = 0; m < 5; m++) {

714 
d‹mp
[
m
] = 
û
[m][0] +

715 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

716 + 
xi
*
û
[
m
][10]))) +

717 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

718 + 
‘a
*
û
[
m
][11])))+

719 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

720 
z‘a
*
û
[
m
][12])));

722 
	}
}

727 
	$š™Ÿlize
() {

729 #´agm¨
omp
 
·¿Î–


739 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

740 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

748 #´agm¨
omp
 

749 
i
 = 0; i < 
IMAX
; i++) {

750 
j
 = 0; j < 
IMAX
; j++) {

751 
k
 = 0; k < 
IMAX
; k++) {

752 
m
 = 0; m < 5; m++) {

753 
u
[
i
][
j
][
k
][
m
] = 1.0;

763 #´agm¨
omp
 

764 
i
 = 0; i < 
grid_pošts
[0]; i++) {

765 
xi
 = ()
i
 * 
dnxm1
;

767 
j
 = 0; j < 
grid_pošts
[1]; j++) {

768 
‘a
 = ()
j
 * 
dnym1
;

770 
k
 = 0; k < 
grid_pošts
[2]; k++) {

771 
z‘a
 = ()
k
 * 
dnzm1
;

773 
ix
 = 0; ix < 2; ix++) {

774 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

775 &(
Pçû
[
ix
][0][0]));

778 
iy
 = 0; iy < 2; iy++) {

779 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

780 &
Pçû
[
iy
][1][0]);

783 
iz
 = 0; iz < 2; iz++) {

784 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

785 &
Pçû
[
iz
][2][0]);

788 
m
 = 0; m < 5; m++) {

789 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

790 (1.0-
xi
è* 
Pçû
[0][0][
m
];

791 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

792 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

793 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

794 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

796 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

797 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

798 
Pxi
*
P‘a
*
Pz‘a
;

811 
i
 = 0;

812 
xi
 = 0.0;

813 #´agm¨
omp
 
nowa™


814 
j
 = 0; j < 
grid_pošts
[1]; j++) {

815 
‘a
 = ()
j
 * 
dnym1
;

816 
k
 = 0; k < 
grid_pošts
[2]; k++) {

817 
z‘a
 = ()
k
 * 
dnzm1
;

818 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

819 
m
 = 0; m < 5; m++) {

820 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

829 
i
 = 
grid_pošts
[0]-1;

830 
xi
 = 1.0;

831 #´agm¨
omp
 

832 
j
 = 0; j < 
grid_pošts
[1]; j++) {

833 
‘a
 = ()
j
 * 
dnym1
;

834 
k
 = 0; k < 
grid_pošts
[2]; k++) {

835 
z‘a
 = ()
k
 * 
dnzm1
;

836 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

837 
m
 = 0; m < 5; m++) {

838 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

846 
j
 = 0;

847 
‘a
 = 0.0;

848 #´agm¨
omp
 
nowa™


849 
i
 = 0; i < 
grid_pošts
[0]; i++) {

850 
xi
 = ()
i
 * 
dnxm1
;

851 
k
 = 0; k < 
grid_pošts
[2]; k++) {

852 
z‘a
 = ()
k
 * 
dnzm1
;

853 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

854 
m
 = 0; m < 5; m++) {

855 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

863 
j
 = 
grid_pošts
[1]-1;

864 
‘a
 = 1.0;

865 #´agm¨
omp
 

866 
i
 = 0; i < 
grid_pošts
[0]; i++) {

867 
xi
 = ()
i
 * 
dnxm1
;

868 
k
 = 0; k < 
grid_pošts
[2]; k++) {

869 
z‘a
 = ()
k
 * 
dnzm1
;

870 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

871 
m
 = 0; m < 5; m++) {

872 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

880 
k
 = 0;

881 
z‘a
 = 0.0;

882 #´agm¨
omp
 
nowa™


883 
i
 = 0; i < 
grid_pošts
[0]; i++) {

884 
xi
 = ()
i
 *
dnxm1
;

885 
j
 = 0; j < 
grid_pošts
[1]; j++) {

886 
‘a
 = ()
j
 * 
dnym1
;

887 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

888 
m
 = 0; m < 5; m++) {

889 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

897 
k
 = 
grid_pošts
[2]-1;

898 
z‘a
 = 1.0;

899 #´agm¨
omp
 

900 
i
 = 0; i < 
grid_pošts
[0]; i++) {

901 
xi
 = ()
i
 * 
dnxm1
;

902 
j
 = 0; j < 
grid_pošts
[1]; j++) {

903 
‘a
 = ()
j
 * 
dnym1
;

904 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

905 
m
 = 0; m < 5; m++) {

906 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

912 
	}
}

916 
	$lhsš™
() {

918 #´agm¨
omp
 
·¿Î–


920 
i
, 
j
, 
k
, 
m
, 
n
;

928 #´agm¨
omp
 

929 
i
 = 0; i < 
grid_pošts
[0]; i++) {

930 
j
 = 0; j < 
grid_pošts
[1]; j++) {

931 
k
 = 0; k < 
grid_pošts
[2]; k++) {

932 
m
 = 0; m < 5; m++) {

933 
n
 = 0;‚ < 5;‚++) {

934 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

935 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

936 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

946 #´agm¨
omp
 

947 
i
 = 0; i < 
grid_pošts
[0]; i++) {

948 
j
 = 0; j < 
grid_pošts
[1]; j++) {

949 
k
 = 0; k < 
grid_pošts
[2]; k++) {

950 
m
 = 0; m < 5; m++) {

951 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

958 
	}
}

962 
	$lhsx
() {

971 
i
, 
j
, 
k
;

976 #´agm¨
omp
 

977 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

978 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

979 
i
 = 0; i < 
grid_pošts
[0]; i++) {

981 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

982 
tmp2
 = 
tmp1
 *mp1;

983 
tmp3
 = 
tmp1
 * 
tmp2
;

987 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

988 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

989 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

990 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

991 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

993 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

994 
u
[
i
][
j
][
k
][1])

995 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

996 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

997 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

998 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

999 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

1000 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

1001 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

1002 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

1004 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

1005 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

1006 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

1007 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

1008 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1010 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

1011 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

1012 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

1013 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

1014 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1016 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1017 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1018 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


1019 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1020 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

1021 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1022 - 0.50 * 
c2


1023 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1024 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1025 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

1026 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

1027 * 
tmp2
;

1028 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

1029 * 
tmp2
;

1030 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

1032 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1033 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1034 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1035 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1036 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1038 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1039 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1040 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1041 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1042 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1044 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1045 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1046 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1047 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1048 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1050 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1051 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1052 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1053 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1054 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1056 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1057 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1058 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1059 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1060 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1062 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1063 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1064 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1065 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1066 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1072 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1074 
tmp1
 = 
dt
 * 
tx1
;

1075 
tmp2
 = 
dt
 * 
tx2
;

1077 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1078 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1079 - 
tmp1
 * 
dx1
;

1080 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1081 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1082 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1083 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1084 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1085 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1086 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1087 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1089 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1090 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1091 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1092 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1093 - 
tmp1
 * 
dx2
;

1094 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1095 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1096 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1097 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1098 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1099 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1101 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1102 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1103 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1104 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1105 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1106 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1107 - 
tmp1
 * 
dx3
;

1108 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1109 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1110 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1111 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1113 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1114 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1115 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1116 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1117 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1118 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1119 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1120 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1121 - 
tmp1
 * 
dx4
;

1122 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1123 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1125 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1126 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1127 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1128 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1129 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1130 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1131 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1132 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1133 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1134 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1135 - 
tmp1
 * 
dx5
;

1137 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1138 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1139 + 
tmp1
 * 2.0 * 
dx1
;

1140 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1141 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1142 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1143 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1145 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1146 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1147 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1148 + 
tmp1
 * 2.0 * 
dx2
;

1149 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1150 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1151 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1153 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1154 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1155 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1156 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1157 + 
tmp1
 * 2.0 * 
dx3
;

1158 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1159 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1161 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1162 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1163 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1164 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1165 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1166 + 
tmp1
 * 2.0 * 
dx4
;

1167 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1169 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1170 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1171 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1172 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1173 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1174 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1175 + 
tmp1
 * 2.0 * 
dx5
;

1177 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1178 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1179 - 
tmp1
 * 
dx1
;

1180 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1181 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1182 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1183 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1184 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1185 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1186 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1187 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1189 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1190 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1191 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1192 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1193 - 
tmp1
 * 
dx2
;

1194 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1195 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1196 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1197 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1198 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1199 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1201 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1202 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1203 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1204 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1205 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1206 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1207 - 
tmp1
 * 
dx3
;

1208 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1209 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1210 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1211 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1213 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1214 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1215 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1216 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1217 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1218 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1219 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1220 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1221 - 
tmp1
 * 
dx4
;

1222 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1223 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1225 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1226 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1227 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1228 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1229 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1230 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1231 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1232 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1233 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1234 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1235 - 
tmp1
 * 
dx5
;

1240 
	}
}

1245 
	$lhsy
() {

1254 
i
, 
j
, 
k
;

1260 #´agm¨
omp
 

1261 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1262 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1263 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1265 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1266 
tmp2
 = 
tmp1
 *mp1;

1267 
tmp3
 = 
tmp1
 * 
tmp2
;

1269 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1270 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1271 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1272 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1273 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1275 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1276 * 
tmp2
;

1277 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1278 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1279 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1280 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1282 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1283 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1284 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1285 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1286 * 
tmp2
 );

1287 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1288 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1289 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1290 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1291 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1293 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1294 * 
tmp2
;

1295 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1296 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1297 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1298 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1300 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1301 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1302 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1303 * 
tmp2


1304 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1305 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1306 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1307 * 
tmp2
;

1308 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1309 - 0.50 * 
c2


1310 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1311 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1312 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1313 * 
tmp2
 );

1314 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1315 * 
tmp2
;

1316 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1318 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1319 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1320 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1321 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1322 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1324 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1325 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1326 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1327 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1328 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1330 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1331 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1332 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1333 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1334 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1336 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1337 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1338 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1339 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1340 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1342 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1343 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1344 - ( 
cÚ43
 * 
c3c4


1345 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1346 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1347 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1349 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1350 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1351 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1352 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1353 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1362 #´agm¨
omp
 

1363 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1364 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1365 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1367 
tmp1
 = 
dt
 * 
ty1
;

1368 
tmp2
 = 
dt
 * 
ty2
;

1370 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1371 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1372 - 
tmp1
 * 
dy1
;

1373 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1374 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1375 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1376 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1377 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1378 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1379 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1380 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1382 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1383 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1384 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1385 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1386 - 
tmp1
 * 
dy2
;

1387 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1388 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1389 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1390 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1391 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1392 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1394 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1395 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1396 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1397 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1398 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1399 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1400 - 
tmp1
 * 
dy3
;

1401 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1402 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1403 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1404 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1406 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1407 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1408 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1409 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1410 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1411 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1412 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1413 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1414 - 
tmp1
 * 
dy4
;

1415 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1416 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1418 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1419 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1420 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1421 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1422 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1423 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1424 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1425 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1426 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1427 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1428 - 
tmp1
 * 
dy5
;

1430 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1431 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1432 + 
tmp1
 * 2.0 * 
dy1
;

1433 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1434 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1435 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1436 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1438 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1439 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1440 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1441 + 
tmp1
 * 2.0 * 
dy2
;

1442 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1443 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1444 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1446 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1447 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1448 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1449 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1450 + 
tmp1
 * 2.0 * 
dy3
;

1451 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1452 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1454 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1455 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1456 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1457 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1458 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1459 + 
tmp1
 * 2.0 * 
dy4
;

1460 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1462 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1463 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1464 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1465 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1466 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1467 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1468 + 
tmp1
 * 2.0 * 
dy5
;

1470 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1471 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1472 - 
tmp1
 * 
dy1
;

1473 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1474 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1475 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1476 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1477 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1478 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1479 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1480 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1482 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1483 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1484 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1485 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1486 - 
tmp1
 * 
dy2
;

1487 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1488 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1489 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1490 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1491 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1492 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1494 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1495 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1496 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1497 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1498 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1499 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1500 - 
tmp1
 * 
dy3
;

1501 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1502 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1503 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1504 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1506 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1507 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1508 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1509 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1510 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1511 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1512 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1513 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1514 - 
tmp1
 * 
dy4
;

1515 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1516 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1518 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1519 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1520 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1521 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1522 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1523 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1524 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1525 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1526 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1527 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1528 - 
tmp1
 * 
dy5
;

1533 
	}
}

1539 
	$lhsz
() {

1548 
i
, 
j
, 
k
;

1554 #´agm¨
omp
 

1555 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1556 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1557 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1559 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1560 
tmp2
 = 
tmp1
 *mp1;

1561 
tmp3
 = 
tmp1
 * 
tmp2
;

1563 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1564 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1565 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1566 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1567 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1569 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1570 * 
tmp2
;

1571 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1572 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1573 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1574 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1576 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1577 * 
tmp2
;

1578 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1579 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1580 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1581 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1583 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1584 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1585 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1586 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1587 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1588 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1589 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1590 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1591 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1593 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1594 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1595 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1596 * 
tmp2


1597 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1598 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1599 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1600 * 
tmp2
;

1601 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1602 * 
tmp2
;

1603 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1604 - 0.50 * 
c2


1605 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1606 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1607 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1608 * 
tmp2
 );

1609 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1611 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1612 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1613 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1614 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1615 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1617 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1618 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1619 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1620 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1621 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1623 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1624 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1625 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1626 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1627 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1629 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1630 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1631 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1632 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1633 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1635 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1636 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1637 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1638 - ( 
cÚ43
 * 
c3c4


1639 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1640 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1642 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1643 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1644 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1645 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1646 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1655 #´agm¨
omp
 

1656 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1657 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1658 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1660 
tmp1
 = 
dt
 * 
tz1
;

1661 
tmp2
 = 
dt
 * 
tz2
;

1663 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1664 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1665 - 
tmp1
 * 
dz1
;

1666 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1667 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1668 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1669 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1670 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1671 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1672 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1673 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1675 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1676 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1677 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1678 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1679 - 
tmp1
 * 
dz2
;

1680 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1681 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1682 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1683 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1684 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1685 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1687 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1688 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1689 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1690 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1691 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1692 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1693 - 
tmp1
 * 
dz3
;

1694 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1695 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1696 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1697 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1699 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1700 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1701 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1702 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1703 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1704 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1705 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1706 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1707 - 
tmp1
 * 
dz4
;

1708 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1709 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1711 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1712 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1713 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1714 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1715 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1716 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1717 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1718 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1719 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1720 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1721 - 
tmp1
 * 
dz5
;

1723 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1724 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1725 + 
tmp1
 * 2.0 * 
dz1
;

1726 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1727 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1728 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1729 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1731 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1732 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1733 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1734 + 
tmp1
 * 2.0 * 
dz2
;

1735 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1736 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1737 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1739 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1740 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1741 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1742 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1743 + 
tmp1
 * 2.0 * 
dz3
;

1744 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1745 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1747 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1748 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1749 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1750 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1751 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1752 + 
tmp1
 * 2.0 * 
dz4
;

1753 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1755 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1756 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1757 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1758 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1759 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1760 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1761 + 
tmp1
 * 2.0 * 
dz5
;

1763 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1764 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1765 - 
tmp1
 * 
dz1
;

1766 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1767 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1768 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1769 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1770 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1771 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1772 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1773 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1775 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1776 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1777 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1778 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1779 - 
tmp1
 * 
dz2
;

1780 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1781 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1782 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1783 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1784 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1785 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1787 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1788 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1789 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1790 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1791 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1792 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1793 - 
tmp1
 * 
dz3
;

1794 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1795 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1796 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1797 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1799 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1800 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1801 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1802 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1803 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1804 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1805 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1806 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1807 - 
tmp1
 * 
dz4
;

1808 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1809 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1811 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1812 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1813 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1814 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1815 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1816 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1817 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1818 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1819 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1820 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1821 - 
tmp1
 * 
dz5
;

1826 
	}
}

1831 
	$compu‹_rhs
() {

1833 
i
, 
j
, 
k
, 
m
;

1834 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1840 #´agm¨
omp
 
nowa™


1841 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1842 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1843 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1844 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1845 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1846 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1847 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1848 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1849 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1850 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1851 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1852 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1863 #´agm¨
omp
 

1864 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1865 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1866 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1867 
m
 = 0; m < 5; m++) {

1868 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1877 #´agm¨
omp
 

1878 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1879 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1880 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1881 
uijk
 = 
us
[
i
][
j
][
k
];

1882 
up1
 = 
us
[
i
+1][
j
][
k
];

1883 
um1
 = 
us
[
i
-1][
j
][
k
];

1885 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1886 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1887 
u
[
i
-1][
j
][
k
][0]) -

1888 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1890 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1891 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1892 
u
[
i
-1][
j
][
k
][1]) +

1893 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1894 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1895 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1896 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1897 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1898 
c2
);

1900 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1901 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1902 
u
[
i
-1][
j
][
k
][2]) +

1903 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1904 
vs
[
i
-1][
j
][
k
]) -

1905 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1906 
u
[
i
-1][
j
][
k
][2]*
um1
);

1908 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1909 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1910 
u
[
i
-1][
j
][
k
][3]) +

1911 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1912 
ws
[
i
-1][
j
][
k
]) -

1913 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1914 
u
[
i
-1][
j
][
k
][3]*
um1
);

1916 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1917 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1918 
u
[
i
-1][
j
][
k
][4]) +

1919 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1920 
qs
[
i
-1][
j
][
k
]) +

1921 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1922 
um1
*um1) +

1923 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1924 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1925 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1926 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1927 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1928 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1929 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1937 
i
 = 1;

1938 #´agm¨
omp
 
nowa™


1939 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1940 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1941 
m
 = 0; m < 5; m++) {

1942 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1943 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1944 
u
[
i
+2][
j
][
k
][
m
]);

1949 
i
 = 2;

1950 #´agm¨
omp
 
nowa™


1951 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1952 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1953 
m
 = 0; m < 5; m++) {

1954 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1955 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1956 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1961 #´agm¨
omp
 
nowa™


1962 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1963 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1964 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1965 
m
 = 0; m < 5; m++) {

1966 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1967 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1968 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1969 
u
[
i
+2][
j
][
k
][
m
] );

1975 
i
 = 
grid_pošts
[0]-3;

1976 #´agm¨
omp
 
nowa™


1977 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1978 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1979 
m
 = 0; m < 5; m++) {

1980 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1981 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1982 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

1987 
i
 = 
grid_pošts
[0]-2;

1988 #´agm¨
omp
 

1989 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1990 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1991 
m
 = 0; m < 5; m++) {

1992 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1993 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

1994 5.0*
u
[
i
][
j
][
k
][
m
] );

2002 #´agm¨
omp
 

2003 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2004 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2005 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2006 
vijk
 = 
vs
[
i
][
j
][
k
];

2007 
vp1
 = 
vs
[
i
][
j
+1][
k
];

2008 
vm1
 = 
vs
[
i
][
j
-1][
k
];

2009 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

2010 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

2011 
u
[
i
][
j
-1][
k
][0]) -

2012 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

2013 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

2014 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

2015 
u
[
i
][
j
-1][
k
][1]) +

2016 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

2017 
us
[
i
][
j
-1][
k
]) -

2018 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

2019 
u
[
i
][
j
-1][
k
][1]*
vm1
);

2020 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

2021 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

2022 
u
[
i
][
j
-1][
k
][2]) +

2023 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

2024 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

2025 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

2026 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

2027 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

2028 *
c2
);

2029 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

2030 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

2031 
u
[
i
][
j
-1][
k
][3]) +

2032 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

2033 
ws
[
i
][
j
-1][
k
]) -

2034 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

2035 
u
[
i
][
j
-1][
k
][3]*
vm1
);

2036 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

2037 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

2038 
u
[
i
][
j
-1][
k
][4]) +

2039 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

2040 
qs
[
i
][
j
-1][
k
]) +

2041 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

2042 
vm1
*vm1) +

2043 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2044 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2045 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2046 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2047 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2048 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2049 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2057 
j
 = 1;

2058 #´agm¨
omp
 
nowa™


2059 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2060 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2061 
m
 = 0; m < 5; m++) {

2062 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2063 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2064 
u
[
i
][
j
+2][
k
][
m
]);

2069 
j
 = 2;

2070 #´agm¨
omp
 
nowa™


2071 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2072 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2073 
m
 = 0; m < 5; m++) {

2074 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2075 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2076 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2081 #´agm¨
omp
 
nowa™


2082 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2083 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2084 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2085 
m
 = 0; m < 5; m++) {

2086 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2087 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2088 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2089 
u
[
i
][
j
+2][
k
][
m
] );

2095 
j
 = 
grid_pošts
[1]-3;

2096 #´agm¨
omp
 
nowa™


2097 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2098 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2099 
m
 = 0; m < 5; m++) {

2100 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2101 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2102 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2107 
j
 = 
grid_pošts
[1]-2;

2108 #´agm¨
omp
 

2109 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2110 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2111 
m
 = 0; m < 5; m++) {

2112 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2113 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2114 5.*
u
[
i
][
j
][
k
][
m
] );

2122 #´agm¨
omp
 

2123 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2124 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2125 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2126 
wijk
 = 
ws
[
i
][
j
][
k
];

2127 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2128 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2130 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2131 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2132 
u
[
i
][
j
][
k
-1][0]) -

2133 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2134 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2135 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2136 
u
[
i
][
j
][
k
-1][1]) +

2137 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2138 
us
[
i
][
j
][
k
-1]) -

2139 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2140 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2141 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2142 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2143 
u
[
i
][
j
][
k
-1][2]) +

2144 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2145 
vs
[
i
][
j
][
k
-1]) -

2146 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2147 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2148 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2149 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2150 
u
[
i
][
j
][
k
-1][3]) +

2151 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2152 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2153 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2154 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2155 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2156 *
c2
);

2157 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2158 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2159 
u
[
i
][
j
][
k
-1][4]) +

2160 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2161 
qs
[
i
][
j
][
k
-1]) +

2162 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2163 
wm1
*wm1) +

2164 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2165 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2166 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2167 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2168 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2169 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2170 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2178 
k
 = 1;

2179 #´agm¨
omp
 
nowa™


2180 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2181 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2182 
m
 = 0; m < 5; m++) {

2183 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2184 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2185 
u
[
i
][
j
][
k
+2][
m
]);

2190 
k
 = 2;

2191 #´agm¨
omp
 
nowa™


2192 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2193 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2194 
m
 = 0; m < 5; m++) {

2195 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2196 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2197 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2202 #´agm¨
omp
 
nowa™


2203 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2204 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2205 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2206 
m
 = 0; m < 5; m++) {

2207 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2208 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2209 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2210 
u
[
i
][
j
][
k
+2][
m
] );

2216 
k
 = 
grid_pošts
[2]-3;

2217 #´agm¨
omp
 
nowa™


2218 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2219 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2220 
m
 = 0; m < 5; m++) {

2221 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2222 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2223 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2228 
k
 = 
grid_pošts
[2]-2;

2229 #´agm¨
omp
 

2230 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2231 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2232 
m
 = 0; m < 5; m++) {

2233 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2234 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2235 5.0*
u
[
i
][
j
][
k
][
m
] );

2240 #´agm¨
omp
 

2241 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2242 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2243 
m
 = 0; m < 5; m++) {

2244 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2245 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2250 
	}
}

2255 
	$£t_cÚ¡ªts
() {

2260 
û
[0][0] = 2.0;

2261 
û
[0][1] = 0.0;

2262 
û
[0][2] = 0.0;

2263 
û
[0][3] = 4.0;

2264 
û
[0][4] = 5.0;

2265 
û
[0][5] = 3.0;

2266 
û
[0][6] = 0.5;

2267 
û
[0][7] = 0.02;

2268 
û
[0][8] = 0.01;

2269 
û
[0][9] = 0.03;

2270 
û
[0][10] = 0.5;

2271 
û
[0][11] = 0.4;

2272 
û
[0][12] = 0.3;

2274 
û
[1][0] = 1.0;

2275 
û
[1][1] = 0.0;

2276 
û
[1][2] = 0.0;

2277 
û
[1][3] = 0.0;

2278 
û
[1][4] = 1.0;

2279 
û
[1][5] = 2.0;

2280 
û
[1][6] = 3.0;

2281 
û
[1][7] = 0.01;

2282 
û
[1][8] = 0.03;

2283 
û
[1][9] = 0.02;

2284 
û
[1][10] = 0.4;

2285 
û
[1][11] = 0.3;

2286 
û
[1][12] = 0.5;

2288 
û
[2][0] = 2.0;

2289 
û
[2][1] = 2.0;

2290 
û
[2][2] = 0.0;

2291 
û
[2][3] = 0.0;

2292 
û
[2][4] = 0.0;

2293 
û
[2][5] = 2.0;

2294 
û
[2][6] = 3.0;

2295 
û
[2][7] = 0.04;

2296 
û
[2][8] = 0.03;

2297 
û
[2][9] = 0.05;

2298 
û
[2][10] = 0.3;

2299 
û
[2][11] = 0.5;

2300 
û
[2][12] = 0.4;

2302 
û
[3][0] = 2.0;

2303 
û
[3][1] = 2.0;

2304 
û
[3][2] = 0.0;

2305 
û
[3][3] = 0.0;

2306 
û
[3][4] = 0.0;

2307 
û
[3][5] = 2.0;

2308 
û
[3][6] = 3.0;

2309 
û
[3][7] = 0.03;

2310 
û
[3][8] = 0.05;

2311 
û
[3][9] = 0.04;

2312 
û
[3][10] = 0.2;

2313 
û
[3][11] = 0.1;

2314 
û
[3][12] = 0.3;

2316 
û
[4][0] = 5.0;

2317 
û
[4][1] = 4.0;

2318 
û
[4][2] = 3.0;

2319 
û
[4][3] = 2.0;

2320 
û
[4][4] = 0.1;

2321 
û
[4][5] = 0.4;

2322 
û
[4][6] = 0.3;

2323 
û
[4][7] = 0.05;

2324 
û
[4][8] = 0.04;

2325 
û
[4][9] = 0.03;

2326 
û
[4][10] = 0.1;

2327 
û
[4][11] = 0.3;

2328 
û
[4][12] = 0.2;

2330 
c1
 = 1.4;

2331 
c2
 = 0.4;

2332 
c3
 = 0.1;

2333 
c4
 = 1.0;

2334 
c5
 = 1.4;

2336 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2337 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2338 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2340 
c1c2
 = 
c1
 * 
c2
;

2341 
c1c5
 = 
c1
 * 
c5
;

2342 
c3c4
 = 
c3
 * 
c4
;

2343 
c1345
 = 
c1c5
 * 
c3c4
;

2345 
cÚz1
 = (1.0-
c1c5
);

2347 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2348 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2349 
tx3
 = 1.0 / 
dnxm1
;

2351 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2352 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2353 
ty3
 = 1.0 / 
dnym1
;

2355 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2356 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2357 
tz3
 = 1.0 / 
dnzm1
;

2359 
dx1
 = 0.75;

2360 
dx2
 = 0.75;

2361 
dx3
 = 0.75;

2362 
dx4
 = 0.75;

2363 
dx5
 = 0.75;

2365 
dy1
 = 0.75;

2366 
dy2
 = 0.75;

2367 
dy3
 = 0.75;

2368 
dy4
 = 0.75;

2369 
dy5
 = 0.75;

2371 
dz1
 = 1.0;

2372 
dz2
 = 1.0;

2373 
dz3
 = 1.0;

2374 
dz4
 = 1.0;

2375 
dz5
 = 1.0;

2377 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2378 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2379 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2381 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2383 
c4ds¥
 = 4.0 * 
ds¥
;

2384 
c5ds¥
 = 5.0 * 
ds¥
;

2386 
d‰x1
 = 
dt
*
tx1
;

2387 
d‰x2
 = 
dt
*
tx2
;

2388 
d‰y1
 = 
dt
*
ty1
;

2389 
d‰y2
 = 
dt
*
ty2
;

2390 
d‰z1
 = 
dt
*
tz1
;

2391 
d‰z2
 = 
dt
*
tz2
;

2393 
c2d‰x1
 = 2.0*
d‰x1
;

2394 
c2d‰y1
 = 2.0*
d‰y1
;

2395 
c2d‰z1
 = 2.0*
d‰z1
;

2397 
dtds¥
 = 
dt
*
ds¥
;

2399 
comz1
 = 
dtds¥
;

2400 
comz4
 = 4.0*
dtds¥
;

2401 
comz5
 = 5.0*
dtds¥
;

2402 
comz6
 = 6.0*
dtds¥
;

2404 
c3c4tx3
 = 
c3c4
*
tx3
;

2405 
c3c4ty3
 = 
c3c4
*
ty3
;

2406 
c3c4tz3
 = 
c3c4
*
tz3
;

2408 
dx1tx1
 = 
dx1
*
tx1
;

2409 
dx2tx1
 = 
dx2
*
tx1
;

2410 
dx3tx1
 = 
dx3
*
tx1
;

2411 
dx4tx1
 = 
dx4
*
tx1
;

2412 
dx5tx1
 = 
dx5
*
tx1
;

2414 
dy1ty1
 = 
dy1
*
ty1
;

2415 
dy2ty1
 = 
dy2
*
ty1
;

2416 
dy3ty1
 = 
dy3
*
ty1
;

2417 
dy4ty1
 = 
dy4
*
ty1
;

2418 
dy5ty1
 = 
dy5
*
ty1
;

2420 
dz1tz1
 = 
dz1
*
tz1
;

2421 
dz2tz1
 = 
dz2
*
tz1
;

2422 
dz3tz1
 = 
dz3
*
tz1
;

2423 
dz4tz1
 = 
dz4
*
tz1
;

2424 
dz5tz1
 = 
dz5
*
tz1
;

2426 
c2iv
 = 2.5;

2427 
cÚ43
 = 4.0/3.0;

2428 
cÚ16
 = 1.0/6.0;

2430 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2431 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2432 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2433 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2434 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2436 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2437 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2438 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2439 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2440 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2442 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2443 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2444 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2445 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2446 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2447 
	}
}

2452 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2461 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2462 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2463 
m
;

2468 
•sÚ
 = 1.0e-08;

2474 
	`”rÜ_nÜm
(
xû
);

2475 
	`compu‹_rhs
();

2477 
	`rhs_nÜm
(
xü
);

2479 
m
 = 0; m < 5; m++) {

2480 
xü
[
m
] = xü[m] / 
dt
;

2483 *
şass
 = 'U';

2484 *
v”if›d
 = 
TRUE
;

2486 
m
 = 0; m < 5; m++) {

2487 
xü»f
[
m
] = 1.0;

2488 
xû»f
[
m
] = 1.0;

2494 ià(
grid_pošts
[0] == 12 &&

2495 
grid_pošts
[1] == 12 &&

2496 
grid_pošts
[2] == 12 &&

2497 
no_time_¡•s
 == 60) {

2499 *
şass
 = 'S';

2500 
dŒef
 = 1.0e-2;

2505 
xü»f
[0] = 1.7034283709541311e-01;

2506 
xü»f
[1] = 1.2975252070034097e-02;

2507 
xü»f
[2] = 3.2527926989486055e-02;

2508 
xü»f
[3] = 2.6436421275166801e-02;

2509 
xü»f
[4] = 1.9211784131744430e-01;

2514 
xû»f
[0] = 4.9976913345811579e-04;

2515 
xû»f
[1] = 4.5195666782961927e-05;

2516 
xû»f
[2] = 7.3973765172921357e-05;

2517 
xû»f
[3] = 7.3821238632439731e-05;

2518 
xû»f
[4] = 8.9269630987491446e-04;

2523 } ià(
grid_pošts
[0] == 24 &&

2524 
grid_pošts
[1] == 24 &&

2525 
grid_pošts
[2] == 24 &&

2526 
no_time_¡•s
 == 200) {

2528 *
şass
 = 'W';

2529 
dŒef
 = 0.8e-3;

2533 
xü»f
[0] = 0.1125590409344e+03;

2534 
xü»f
[1] = 0.1180007595731e+02;

2535 
xü»f
[2] = 0.2710329767846e+02;

2536 
xü»f
[3] = 0.2469174937669e+02;

2537 
xü»f
[4] = 0.2638427874317e+03;

2542 
xû»f
[0] = 0.4419655736008e+01;

2543 
xû»f
[1] = 0.4638531260002e+00;

2544 
xû»f
[2] = 0.1011551749967e+01;

2545 
xû»f
[3] = 0.9235878729944e+00;

2546 
xû»f
[4] = 0.1018045837718e+02;

2552 } ià(
grid_pošts
[0] == 64 &&

2553 
grid_pošts
[1] == 64 &&

2554 
grid_pošts
[2] == 64 &&

2555 
no_time_¡•s
 == 200) {

2557 *
şass
 = 'A';

2558 
dŒef
 = 0.8e-3;

2562 
xü»f
[0] = 1.0806346714637264e+02;

2563 
xü»f
[1] = 1.1319730901220813e+01;

2564 
xü»f
[2] = 2.5974354511582465e+01;

2565 
xü»f
[3] = 2.3665622544678910e+01;

2566 
xü»f
[4] = 2.5278963211748344e+02;

2571 
xû»f
[0] = 4.2348416040525025e+00;

2572 
xû»f
[1] = 4.4390282496995698e-01;

2573 
xû»f
[2] = 9.6692480136345650e-01;

2574 
xû»f
[3] = 8.8302063039765474e-01;

2575 
xû»f
[4] = 9.7379901770829278e+00;

2581 } ià(
grid_pošts
[0] == 102 &&

2582 
grid_pošts
[1] == 102 &&

2583 
grid_pošts
[2] == 102 &&

2584 
no_time_¡•s
 == 200) {

2586 *
şass
 = 'B';

2587 
dŒef
 = 3.0e-4;

2592 
xü»f
[0] = 1.4233597229287254e+03;

2593 
xü»f
[1] = 9.9330522590150238e+01;

2594 
xü»f
[2] = 3.5646025644535285e+02;

2595 
xü»f
[3] = 3.2485447959084092e+02;

2596 
xü»f
[4] = 3.2707541254659363e+03;

2601 
xû»f
[0] = 5.2969847140936856e+01;

2602 
xû»f
[1] = 4.4632896115670668e+00;

2603 
xû»f
[2] = 1.3122573342210174e+01;

2604 
xû»f
[3] = 1.2006925323559144e+01;

2605 
xû»f
[4] = 1.2459576151035986e+02;

2611 } ià(
grid_pošts
[0] == 162 &&

2612 
grid_pošts
[1] == 162 &&

2613 
grid_pošts
[2] == 162 &&

2614 
no_time_¡•s
 == 200) {

2616 *
şass
 = 'C';

2617 
dŒef
 = 1.0e-4;

2622 
xü»f
[0] = 0.62398116551764615e+04;

2623 
xü»f
[1] = 0.50793239190423964e+03;

2624 
xü»f
[2] = 0.15423530093013596e+04;

2625 
xü»f
[3] = 0.13302387929291190e+04;

2626 
xü»f
[4] = 0.11604087428436455e+05;

2631 
xû»f
[0] = 0.16462008369091265e+03;

2632 
xû»f
[1] = 0.11497107903824313e+02;

2633 
xû»f
[2] = 0.41207446207461508e+02;

2634 
xû»f
[3] = 0.37087651059694167e+02;

2635 
xû»f
[4] = 0.36211053051841265e+03;

2638 *
v”if›d
 = 
FALSE
;

2649 
m
 = 0; m < 5; m++) {

2651 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2652 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2660 ià(*
şass
 != 'U') {

2661 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2662 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2663 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2664 *
v”if›d
 = 
FALSE
;

2665 *
şass
 = 'U';

2666 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2669 
	`´štf
(" Unknown class\n");

2672 ià(*
şass
 != 'U') {

2673 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2675 
	`´štf
(" RMS-norms of„esidual\n");

2677 
m
 = 0; m < 5; m++) {

2678 ià(*
şass
 == 'U') {

2679 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2680 } ià(
xüdif
[
m
] > 
•sÚ
) {

2681 *
v”if›d
 = 
FALSE
;

2682 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2683 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2685 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2686 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2690 ià(*
şass
 != 'U') {

2691 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2693 
	`´štf
(" RMS-norms of solutionƒrror\n");

2696 
m
 = 0; m < 5; m++) {

2697 ià(*
şass
 == 'U') {

2698 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2699 } ià(
xûdif
[
m
] > 
•sÚ
) {

2700 *
v”if›d
 = 
FALSE
;

2701 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2702 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2704 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2705 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2709 ià(*
şass
 == 'U') {

2710 
	`´štf
(" No„eference values…rovided\n");

2711 
	`´štf
(" No verification…erformed\n");

2712 } ià(*
v”if›d
 =ğ
TRUE
) {

2713 
	`´štf
(" Verification Successful\n");

2715 
	`´štf
(" Verification failed\n");

2717 
	}
}

2722 
	$x_sŞve
() {

2739 
	`lhsx
();

2740 
	`x_sŞve_ûÎ
();

2741 
	`x_backsub¡™u‹
();

2742 
	}
}

2748 
	$x_backsub¡™u‹
() {

2760 
i
, 
j
, 
k
, 
m
, 
n
;

2762 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2763 #´agm¨
omp
 

2764 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2765 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2766 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2767 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2768 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2769 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2775 
	}
}

2780 
	$x_sŞve_ûÎ
() {

2792 
i
,
j
,
k
,
isize
;

2794 
isize
 = 
grid_pošts
[0]-1;

2799 #´agm¨
omp
 

2800 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2801 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2807 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2808 
lhs
[0][
j
][
k
][
CC
],

2809 
rhs
[0][
j
][
k
] );

2817 
i
 = 1; i < 
isize
; i++) {

2818 #´agm¨
omp
 

2819 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2820 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2825 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2826 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2831 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2832 
lhs
[
i
-1][
j
][
k
][
CC
],

2833 
lhs
[
i
][
j
][
k
][
BB
]);

2840 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2841 
lhs
[
i
][
j
][
k
][
CC
],

2842 
rhs
[
i
][
j
][
k
] );

2848 #´agm¨
omp
 

2849 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2850 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2855 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2856 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2861 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2862 
lhs
[
isize
-1][
j
][
k
][
CC
],

2863 
lhs
[
isize
][
j
][
k
][
BB
]);

2868 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2869 
rhs
[
i
][
j
][
k
] );

2873 
	}
}

2878 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2887 
i
;

2889 
i
 = 0; i < 5; i++) {

2894 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2895 - 
ablock
[
i
][1]*
avec
[1]

2896 - 
ablock
[
i
][2]*
avec
[2]

2897 - 
ablock
[
i
][3]*
avec
[3]

2898 - 
ablock
[
i
][4]*
avec
[4];

2900 
	}
}

2905 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2906 
cblock
[5][5]) {

2915 
j
;

2917 
j
 = 0; j < 5; j++) {

2918 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2919 - 
ablock
[0][1]*
bblock
[1][
j
]

2920 - 
ablock
[0][2]*
bblock
[2][
j
]

2921 - 
ablock
[0][3]*
bblock
[3][
j
]

2922 - 
ablock
[0][4]*
bblock
[4][
j
];

2923 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2924 - 
ablock
[1][1]*
bblock
[1][
j
]

2925 - 
ablock
[1][2]*
bblock
[2][
j
]

2926 - 
ablock
[1][3]*
bblock
[3][
j
]

2927 - 
ablock
[1][4]*
bblock
[4][
j
];

2928 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2929 - 
ablock
[2][1]*
bblock
[1][
j
]

2930 - 
ablock
[2][2]*
bblock
[2][
j
]

2931 - 
ablock
[2][3]*
bblock
[3][
j
]

2932 - 
ablock
[2][4]*
bblock
[4][
j
];

2933 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2934 - 
ablock
[3][1]*
bblock
[1][
j
]

2935 - 
ablock
[3][2]*
bblock
[2][
j
]

2936 - 
ablock
[3][3]*
bblock
[3][
j
]

2937 - 
ablock
[3][4]*
bblock
[4][
j
];

2938 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2939 - 
ablock
[4][1]*
bblock
[1][
j
]

2940 - 
ablock
[4][2]*
bblock
[2][
j
]

2941 - 
ablock
[4][3]*
bblock
[3][
j
]

2942 - 
ablock
[4][4]*
bblock
[4][
j
];

2944 
	}
}

2949 
	$bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]) {

2954 
pivÙ
, 
cÛff
;

2960 
pivÙ
 = 1.00/
lhs
[0][0];

2961 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

2962 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

2963 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

2964 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

2965 
c
[0][0] = c[0][0]*
pivÙ
;

2966 
c
[0][1] = c[0][1]*
pivÙ
;

2967 
c
[0][2] = c[0][2]*
pivÙ
;

2968 
c
[0][3] = c[0][3]*
pivÙ
;

2969 
c
[0][4] = c[0][4]*
pivÙ
;

2970 
r
[0] =„[0] *
pivÙ
;

2972 
cÛff
 = 
lhs
[1][0];

2973 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

2974 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

2975 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

2976 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

2977 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

2978 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

2979 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

2980 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

2981 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

2982 
r
[1] =„[1] - 
cÛff
*r[0];

2984 
cÛff
 = 
lhs
[2][0];

2985 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

2986 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

2987 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

2988 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

2989 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

2990 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

2991 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

2992 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

2993 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

2994 
r
[2] =„[2] - 
cÛff
*r[0];

2996 
cÛff
 = 
lhs
[3][0];

2997 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

2998 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

2999 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3000 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3001 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

3002 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

3003 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

3004 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

3005 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

3006 
r
[3] =„[3] - 
cÛff
*r[0];

3008 
cÛff
 = 
lhs
[4][0];

3009 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3010 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3011 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3012 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3013 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

3014 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

3015 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

3016 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

3017 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

3018 
r
[4] =„[4] - 
cÛff
*r[0];

3021 
pivÙ
 = 1.00/
lhs
[1][1];

3022 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3023 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3024 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3025 
c
[1][0] = c[1][0]*
pivÙ
;

3026 
c
[1][1] = c[1][1]*
pivÙ
;

3027 
c
[1][2] = c[1][2]*
pivÙ
;

3028 
c
[1][3] = c[1][3]*
pivÙ
;

3029 
c
[1][4] = c[1][4]*
pivÙ
;

3030 
r
[1] =„[1] *
pivÙ
;

3032 
cÛff
 = 
lhs
[0][1];

3033 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3034 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3035 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3036 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

3037 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

3038 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

3039 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

3040 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

3041 
r
[0] =„[0] - 
cÛff
*r[1];

3043 
cÛff
 = 
lhs
[2][1];

3044 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3045 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3046 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3047 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3048 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3049 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3050 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3051 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3052 
r
[2] =„[2] - 
cÛff
*r[1];

3054 
cÛff
 = 
lhs
[3][1];

3055 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3056 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3057 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3058 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3059 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3060 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3061 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3062 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3063 
r
[3] =„[3] - 
cÛff
*r[1];

3065 
cÛff
 = 
lhs
[4][1];

3066 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3067 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3068 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3069 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3070 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3071 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3072 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3073 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3074 
r
[4] =„[4] - 
cÛff
*r[1];

3077 
pivÙ
 = 1.00/
lhs
[2][2];

3078 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3079 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3080 
c
[2][0] = c[2][0]*
pivÙ
;

3081 
c
[2][1] = c[2][1]*
pivÙ
;

3082 
c
[2][2] = c[2][2]*
pivÙ
;

3083 
c
[2][3] = c[2][3]*
pivÙ
;

3084 
c
[2][4] = c[2][4]*
pivÙ
;

3085 
r
[2] =„[2] *
pivÙ
;

3087 
cÛff
 = 
lhs
[0][2];

3088 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3089 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3090 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3091 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3092 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3093 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3094 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3095 
r
[0] =„[0] - 
cÛff
*r[2];

3097 
cÛff
 = 
lhs
[1][2];

3098 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3099 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3100 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3101 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3102 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3103 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3104 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3105 
r
[1] =„[1] - 
cÛff
*r[2];

3107 
cÛff
 = 
lhs
[3][2];

3108 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3109 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3110 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3111 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3112 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3113 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3114 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3115 
r
[3] =„[3] - 
cÛff
*r[2];

3117 
cÛff
 = 
lhs
[4][2];

3118 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3119 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3120 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3121 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3122 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3123 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3124 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3125 
r
[4] =„[4] - 
cÛff
*r[2];

3128 
pivÙ
 = 1.00/
lhs
[3][3];

3129 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3130 
c
[3][0] = c[3][0]*
pivÙ
;

3131 
c
[3][1] = c[3][1]*
pivÙ
;

3132 
c
[3][2] = c[3][2]*
pivÙ
;

3133 
c
[3][3] = c[3][3]*
pivÙ
;

3134 
c
[3][4] = c[3][4]*
pivÙ
;

3135 
r
[3] =„[3] *
pivÙ
;

3137 
cÛff
 = 
lhs
[0][3];

3138 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3139 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3140 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3141 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3142 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3143 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3144 
r
[0] =„[0] - 
cÛff
*r[3];

3146 
cÛff
 = 
lhs
[1][3];

3147 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3148 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3149 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3150 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3151 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3152 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3153 
r
[1] =„[1] - 
cÛff
*r[3];

3155 
cÛff
 = 
lhs
[2][3];

3156 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3157 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3158 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3159 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3160 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3161 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3162 
r
[2] =„[2] - 
cÛff
*r[3];

3164 
cÛff
 = 
lhs
[4][3];

3165 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3166 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3167 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3168 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3169 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3170 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3171 
r
[4] =„[4] - 
cÛff
*r[3];

3174 
pivÙ
 = 1.00/
lhs
[4][4];

3175 
c
[4][0] = c[4][0]*
pivÙ
;

3176 
c
[4][1] = c[4][1]*
pivÙ
;

3177 
c
[4][2] = c[4][2]*
pivÙ
;

3178 
c
[4][3] = c[4][3]*
pivÙ
;

3179 
c
[4][4] = c[4][4]*
pivÙ
;

3180 
r
[4] =„[4] *
pivÙ
;

3182 
cÛff
 = 
lhs
[0][4];

3183 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3184 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3185 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3186 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3187 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3188 
r
[0] =„[0] - 
cÛff
*r[4];

3190 
cÛff
 = 
lhs
[1][4];

3191 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3192 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3193 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3194 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3195 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3196 
r
[1] =„[1] - 
cÛff
*r[4];

3198 
cÛff
 = 
lhs
[2][4];

3199 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3200 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3201 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3202 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3203 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3204 
r
[2] =„[2] - 
cÛff
*r[4];

3206 
cÛff
 = 
lhs
[3][4];

3207 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3208 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3209 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3210 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3211 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3212 
r
[3] =„[3] - 
cÛff
*r[4];

3213 
	}
}

3218 
	$bšvrhs
Ğ
lhs
[5][5], 
r
[5] ) {

3223 
pivÙ
, 
cÛff
;

3229 
pivÙ
 = 1.00/
lhs
[0][0];

3230 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

3231 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

3232 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

3233 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

3234 
r
[0] =„[0] *
pivÙ
;

3236 
cÛff
 = 
lhs
[1][0];

3237 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

3238 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

3239 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

3240 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

3241 
r
[1] =„[1] - 
cÛff
*r[0];

3243 
cÛff
 = 
lhs
[2][0];

3244 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3245 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3246 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3247 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3248 
r
[2] =„[2] - 
cÛff
*r[0];

3250 
cÛff
 = 
lhs
[3][0];

3251 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3252 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3253 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3254 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3255 
r
[3] =„[3] - 
cÛff
*r[0];

3257 
cÛff
 = 
lhs
[4][0];

3258 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3259 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3260 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3261 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3262 
r
[4] =„[4] - 
cÛff
*r[0];

3265 
pivÙ
 = 1.00/
lhs
[1][1];

3266 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3267 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3268 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3269 
r
[1] =„[1] *
pivÙ
;

3271 
cÛff
 = 
lhs
[0][1];

3272 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3273 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3274 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3275 
r
[0] =„[0] - 
cÛff
*r[1];

3277 
cÛff
 = 
lhs
[2][1];

3278 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3279 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3280 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3281 
r
[2] =„[2] - 
cÛff
*r[1];

3283 
cÛff
 = 
lhs
[3][1];

3284 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3285 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3286 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3287 
r
[3] =„[3] - 
cÛff
*r[1];

3289 
cÛff
 = 
lhs
[4][1];

3290 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3291 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3292 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3293 
r
[4] =„[4] - 
cÛff
*r[1];

3296 
pivÙ
 = 1.00/
lhs
[2][2];

3297 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3298 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3299 
r
[2] =„[2] *
pivÙ
;

3301 
cÛff
 = 
lhs
[0][2];

3302 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3303 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3304 
r
[0] =„[0] - 
cÛff
*r[2];

3306 
cÛff
 = 
lhs
[1][2];

3307 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3308 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3309 
r
[1] =„[1] - 
cÛff
*r[2];

3311 
cÛff
 = 
lhs
[3][2];

3312 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3313 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3314 
r
[3] =„[3] - 
cÛff
*r[2];

3316 
cÛff
 = 
lhs
[4][2];

3317 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3318 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3319 
r
[4] =„[4] - 
cÛff
*r[2];

3322 
pivÙ
 = 1.00/
lhs
[3][3];

3323 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3324 
r
[3] =„[3] *
pivÙ
;

3326 
cÛff
 = 
lhs
[0][3];

3327 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3328 
r
[0] =„[0] - 
cÛff
*r[3];

3330 
cÛff
 = 
lhs
[1][3];

3331 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3332 
r
[1] =„[1] - 
cÛff
*r[3];

3334 
cÛff
 = 
lhs
[2][3];

3335 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3336 
r
[2] =„[2] - 
cÛff
*r[3];

3338 
cÛff
 = 
lhs
[4][3];

3339 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3340 
r
[4] =„[4] - 
cÛff
*r[3];

3343 
pivÙ
 = 1.00/
lhs
[4][4];

3344 
r
[4] =„[4] *
pivÙ
;

3346 
cÛff
 = 
lhs
[0][4];

3347 
r
[0] =„[0] - 
cÛff
*r[4];

3349 
cÛff
 = 
lhs
[1][4];

3350 
r
[1] =„[1] - 
cÛff
*r[4];

3352 
cÛff
 = 
lhs
[2][4];

3353 
r
[2] =„[2] - 
cÛff
*r[4];

3355 
cÛff
 = 
lhs
[3][4];

3356 
r
[3] =„[3] - 
cÛff
*r[4];

3358 
	}
}

3363 
	$y_sŞve
() {

3378 
	`lhsy
();

3379 
	`y_sŞve_ûÎ
();

3380 
	`y_backsub¡™u‹
();

3381 
	}
}

3387 
	$y_backsub¡™u‹
() {

3399 
i
, 
j
, 
k
, 
m
, 
n
;

3401 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3402 #´agm¨
omp
 

3403 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3404 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3405 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3406 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3407 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3408 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3414 
	}
}

3419 
	$y_sŞve_ûÎ
() {

3434 
i
, 
j
, 
k
, 
jsize
;

3436 
jsize
 = 
grid_pošts
[1]-1;

3438 #´agm¨
omp
 

3439 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3440 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3446 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3447 
lhs
[
i
][0][
k
][
CC
],

3448 
rhs
[
i
][0][
k
] );

3456 
j
 = 1; j < 
jsize
; j++) {

3457 #´agm¨
omp
 

3458 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3459 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3466 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3467 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3472 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3473 
lhs
[
i
][
j
-1][
k
][
CC
],

3474 
lhs
[
i
][
j
][
k
][
BB
]);

3480 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3481 
lhs
[
i
][
j
][
k
][
CC
],

3482 
rhs
[
i
][
j
][
k
] );

3488 #´agm¨
omp
 

3489 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3490 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3495 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3496 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3503 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3504 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3505 
lhs
[
i
][
jsize
][
k
][
BB
]);

3510 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3511 
rhs
[
i
][
jsize
][
k
] );

3515 
	}
}

3521 
	$z_sŞve
() {

3536 
	`lhsz
();

3537 
	`z_sŞve_ûÎ
();

3538 
	`z_backsub¡™u‹
();

3539 
	}
}

3544 
	$z_backsub¡™u‹
() {

3556 
i
, 
j
, 
k
, 
m
, 
n
;

3558 #´agm¨
omp
 

3559 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3560 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3561 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3562 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3563 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3564 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3565 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3571 
	}
}

3576 
	$z_sŞve_ûÎ
() {

3591 
i
,
j
,
k
,
ksize
;

3593 
ksize
 = 
grid_pošts
[2]-1;

3598 #´agm¨
omp
 

3599 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3600 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3606 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3607 
lhs
[
i
][
j
][0][
CC
],

3608 
rhs
[
i
][
j
][0] );

3617 
k
 = 1; k < 
ksize
; k++) {

3618 #´agm¨
omp
 

3619 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3620 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3627 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3628 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3634 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3635 
lhs
[
i
][
j
][
k
-1][
CC
],

3636 
lhs
[
i
][
j
][
k
][
BB
]);

3642 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3643 
lhs
[
i
][
j
][
k
][
CC
],

3644 
rhs
[
i
][
j
][
k
] );

3653 #´agm¨
omp
 

3654 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3655 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3660 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3661 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3668 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3669 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3670 
lhs
[
i
][
j
][
ksize
][
BB
]);

3675 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3676 
rhs
[
i
][
j
][
ksize
] );

3680 
	}
}

	@BT/header.h

19 #iâdeà
_HEADER_H_


20 
	#_HEADER_H_


	)

22 
	~"Åb·¿ms.h
"

23 
	~"../m©h/Çs_m©h.h
"

24 
	#AA
 0

	)

25 
	#BB
 1

	)

26 
	#CC
 2

	)

27 
	#BLOCK_SIZE
 5

	)

30 
	ggrid_pošts
[3];

33 
	gtx1
, 
	gtx2
, 
	gtx3
, 
	gty1
, 
	gty2
, 
	gty3
, 
	gtz1
, 
	gtz2
, 
	gtz3
;

34 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
;

35 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
, 
	gdy5
;

36 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
;

37 
	gds¥
, 
	gdt
;

38 
	gû
[5][13];

39 
	gdxmax
, 
	gdymax
, 
	gdzmax
;

40 
	gxxcÚ1
, 
	gxxcÚ2
, 
	gxxcÚ3
, 
	gxxcÚ4
, 
	gxxcÚ5
;

41 
	gdx1tx1
, 
	gdx2tx1
, 
	gdx3tx1
, 
	gdx4tx1
, 
	gdx5tx1
;

42 
	gyycÚ1
, 
	gyycÚ2
, 
	gyycÚ3
, 
	gyycÚ4
, 
	gyycÚ5
;

43 
	gdy1ty1
, 
	gdy2ty1
, 
	gdy3ty1
, 
	gdy4ty1
, 
	gdy5ty1
;

44 
	gzzcÚ1
, 
	gzzcÚ2
, 
	gzzcÚ3
, 
	gzzcÚ4
, 
	gzzcÚ5
;

45 
	gdz1tz1
, 
	gdz2tz1
, 
	gdz3tz1
, 
	gdz4tz1
, 
	gdz5tz1
;

46 
	gdnxm1
, 
	gdnym1
, 
	gdnzm1
, 
	gc1c2
, 
	gc1c5
, 
	gc3c4
, 
	gc1345
;

47 
	gcÚz1
, 
	gc1
, 
	gc2
, 
	gc3
, 
	gc4
, 
	gc5
, 
	gc4ds¥
, 
	gc5ds¥
, 
	gdtds¥
;

48 
	gd‰x1
, 
	gd‰x2
, 
	gd‰y1
, 
	gd‰y2
, 
	gd‰z1
, 
	gd‰z2
;

49 
	gc2d‰x1
, 
	gc2d‰y1
, 
	gc2d‰z1
, 
	gcomz1
, 
	gcomz4
, 
	gcomz5
, 
	gcomz6
;

50 
	gc3c4tx3
, 
	gc3c4ty3
, 
	gc3c4tz3
, 
	gc2iv
, 
	gcÚ43
, 
	gcÚ16
;

52 
	#IMAX
 
PROBLEM_SIZE


	)

53 
	#JMAX
 
PROBLEM_SIZE


	)

54 
	#KMAX
 
PROBLEM_SIZE


	)

62 
	gus
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

63 
	gvs
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

64 
	gws
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

65 
	gqs
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

66 
	grho_i
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

67 
	gsqu¬e
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

68 
	gfÜcšg
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][5+1];

69 
	gu
[(
IMAX
+1)/2*2+1][(
JMAX
+1)/2*2+1][(
KMAX
+1)/2*2+1][5];

70 
	grhs
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][5];

71 
	glhs
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1][3][5][5];

74 
	gcuf
[
PROBLEM_SIZE
];

75 
	gq
[
PROBLEM_SIZE
];

76 
	gue
[
PROBLEM_SIZE
][5];

77 
	gbuf
[
PROBLEM_SIZE
][5];

78 #´agm¨
omp
 
th»ad´iv©e
(
cuf
, 
q
, 
ue
, 
buf
)

86 
	gfjac
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
-1+1][5][5];

88 
	gnjac
[
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
-1+1][5][5];

90 
	gtmp1
, 
	gtmp2
, 
	gtmp3
;

	@BT/npbparams.h

9 
	#PROBLEM_SIZE
 12

	)

10 
	#NITER_DEFAULT
 60

	)

11 
	#DT_DEFAULT
 0.010

	)

12 
	#CONVERTDOUBLE
 
FALSE


	)

13 
	#COMPILETIME
 "21 S• 2020"

	)

14 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

15 
	#CS1
 "cc"

	)

16 
	#CS2
 "cc"

	)

17 
	#CS3
 "ÒÚe)"

	)

18 
	#CS4
 "-I../commÚ"

	)

19 
	#CS5
 "-O3 "

	)

20 
	#CS6
 "ÒÚe)"

	)

21 
	#CS7
 "¿nddp"

	)

	@BT/old.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
compu‹_rhs
();

55 
£t_cÚ¡ªts
();

56 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

57 
x_sŞve
();

58 
x_backsub¡™u‹
();

59 
x_sŞve_ûÎ
();

60 
m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]);

61 
m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

62 
cblock
[5][5]);

63 
bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]);

64 
bšvrhs
(
lhs
[5][5], 
r
[5]);

65 
y_sŞve
();

66 
y_backsub¡™u‹
();

67 
y_sŞve_ûÎ
();

68 
z_sŞve
();

69 
z_backsub¡™u‹
();

70 
z_sŞve_ûÎ
();

72 
´og¿m_BT
(*
buf
, * 
´iv
);

74 
sh–l_cmd_im¶
 
	gÇs_bt_im¶
 = {

75 .
cmd
 = "nas-bt",

76 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

77 .
	ghªdËr
 = 
´og¿m_BT
,

79 
nk_»gi¡”_sh–l_cmd
(
Çs_bt_im¶
);

86 
	$´og¿m_BT
(*
buf
, * 
´iv
) {

90 
___x
 = 
	`sq¹
(2);

91 
	`´štf
("sq¹ oà2 %f\n", 
___x
);

96 
n™”
, 
¡•
, 
n3
;

97 
Áh»ads
 = 1;

98 
Çvg
, 
mæİs
;

100 
tmax
;

101 
boŞ—n
 
v”if›d
;

102 
şass
;

110 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

124 
	`´štf
(" No input file inputbt.data. Using compiled defaults\n");

126 
n™”
 = 
NITER_DEFAULT
;

127 
dt
 = 
DT_DEFAULT
;

128 
grid_pošts
[0] = 
PROBLEM_SIZE
;

129 
grid_pošts
[1] = 
PROBLEM_SIZE
;

130 
grid_pošts
[2] = 
PROBLEM_SIZE
;

134 
	`´štf
(" Size: %3dx%3dx%3d\n",

135 
grid_pošts
[0], grid_points[1], grid_points[2]);

136 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

138 ià(
grid_pošts
[0] > 
IMAX
 ||

139 
grid_pošts
[1] > 
JMAX
 ||

140 
grid_pošts
[2] > 
KMAX
) {

141 
	`´štf
(" %dx%dx%d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

142 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

143 
	`ex™
(1);

146 
	`£t_cÚ¡ªts
();

148 
	`š™Ÿlize
();

149 
	`lhsš™
();

151 
	`exaù_rhs
();

159 
	`adi
();

163 
	`š™Ÿlize
();

167 
	`tim”_ş—r
(1);

168 
	`tim”_¡¬t
(1);

170 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

172 ià(
¡•
%20 == 0 || step == 1) {

173 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

175 
	`adi
();

178 #´agm¨
omp
 
·¿Î–


180 #ià
	`defšed
(
_OPENMP
)

181 #´agm¨
omp
 
ma¡”


182 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

186 
	`tim”_¡İ
(1);

187 
tmax
 = 
	`tim”_»ad
(1);

189 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

191 
n3
 = 
grid_pošts
[0]*grid_points[1]*grid_points[2];

192 
Çvg
 = (
grid_pošts
[0]+grid_points[1]+grid_points[2])/3.0;

193 iàĞ
tmax
 != 0.0 ) {

194 
mæİs
 = 1.0e-6*()
n™”
*

195 (3478.8*()
n3
-17655.7*
	`pow2
(
Çvg
)+28023.7*Çvgè/ 
tmax
;

197 
mæİs
 = 0.0;

199 
	`c_´št_»suÉs
("BT", 
şass
, 
grid_pošts
[0],

200 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

201 
tmax
, 
mæİs
, " floating…oint",

202 
v”if›d
, 
NPBVERSION
,
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

203 
CS6
, "(none)");

204 
	}
}

209 
	$add
() {

215 
i
, 
j
, 
k
, 
m
;

217 #´agm¨
omp
 

218 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

219 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

220 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

221 
m
 = 0; m < 5; m++) {

222 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m] + 
rhs
[i][j][k][m];

227 
	}
}

232 
	$adi
() {

233 #´agm¨
omp
 
·¿Î–


234 
	`compu‹_rhs
();

236 #´agm¨
omp
 
·¿Î–


237 
	`x_sŞve
();

239 #´agm¨
omp
 
·¿Î–


240 
	`y_sŞve
();

242 #´agm¨
omp
 
·¿Î–


243 
	`z_sŞve
();

245 #´agm¨
omp
 
·¿Î–


246 
	`add
();

247 
	}
}

252 
	$”rÜ_nÜm
(
rms
[5]) {

259 
i
, 
j
, 
k
, 
m
, 
d
;

260 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

262 
m
 = 0; m < 5; m++) {

263 
rms
[
m
] = 0.0;

266 
i
 = 0; i < 
grid_pošts
[0]; i++) {

267 
xi
 = ()
i
 * 
dnxm1
;

268 
j
 = 0; j < 
grid_pošts
[1]; j++) {

269 
‘a
 = ()
j
 * 
dnym1
;

270 
k
 = 0; k < 
grid_pošts
[2]; k++) {

271 
z‘a
 = ()
k
 * 
dnzm1
;

272 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

274 
m
 = 0; m < 5; m++) {

275 
add
 = 
u
[
i
][
j
][
k
][
m
] - 
u_exaù
[m];

276 
rms
[
m
] =„ms[m] + 
add
*add;

282 
m
 = 0; m < 5; m++) {

283 
d
 = 0; d <= 2; d++) {

284 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

286 
rms
[
m
] = 
	`sq¹
(rms[m]);

288 
	}
}

293 
	$rhs_nÜm
(
rms
[5]) {

298 
i
, 
j
, 
k
, 
d
, 
m
;

299 
add
;

301 
m
 = 0; m < 5; m++) {

302 
rms
[
m
] = 0.0;

305 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

306 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

307 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

308 
m
 = 0; m < 5; m++) {

309 
add
 = 
rhs
[
i
][
j
][
k
][
m
];

310 
rms
[
m
] =„ms[m] + 
add
*add;

316 
m
 = 0; m < 5; m++) {

317 
d
 = 0; d <= 2; d++) {

318 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

320 
rms
[
m
] = 
	`sq¹
(rms[m]);

322 
	}
}

328 
	$exaù_rhs
() {

330 #´agm¨
omp
 
·¿Î–


339 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

340 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

345 #´agm¨
omp
 

346 
i
 = 0; i < 
grid_pošts
[0]; i++) {

347 
j
 = 0; j < 
grid_pošts
[1]; j++) {

348 
k
 = 0; k < 
grid_pošts
[2]; k++) {

349 
m
 = 0; m < 5; m++) {

350 
fÜcšg
[
i
][
j
][
k
][
m
] = 0.0;

364 #´agm¨
omp
 

365 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

366 
‘a
 = ()
j
 * 
dnym1
;

368 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

369 
z‘a
 = ()
k
 * 
dnzm1
;

371 
i
 = 0; i < 
grid_pošts
[0]; i++) {

372 
xi
 = ()
i
 * 
dnxm1
;

374 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

375 
m
 = 0; m < 5; m++) {

376 
ue
[
i
][
m
] = 
d‹mp
[m];

378 
dp
 = 1.0 / 
d‹mp
[0];

380 
m
 = 1; m <= 4; m++) {

381 
buf
[
i
][
m
] = 
dp
 * 
d‹mp
[m];

384 
cuf
[
i
] = 
buf
[i][1] * buf[i][1];

385 
buf
[
i
][0] = 
cuf
[i] + buf[i][2] * buf[i][2] +

386 
buf
[
i
][3] * buf[i][3];

387 
q
[
i
] = 0.5*(
buf
[i][1]*
ue
[i][1] + buf[i][2]*ue[i][2] +

388 
buf
[
i
][3]*
ue
[i][3]);

391 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

392 
im1
 = 
i
-1;

393 
1
 = 
i
+1;

395 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

396 
tx2
*(
ue
[
1
][1]-ue[
im1
][1])+

397 
dx1tx1
*(
ue
[
1
][0]-2.0*ue[
i
][0]+ue[
im1
][0]);

399 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

400 
tx2
 * ((
ue
[
1
][1]*
buf
[1][1]+
c2
*(ue[1][4]-
q
[ip1]))-

401 (
ue
[
im1
][1]*
buf
[im1][1]+
c2
*(ue[im1][4]-
q
[im1])))+

402 
xxcÚ1
*(
buf
[
1
][1]-2.0*buf[
i
][1]+buf[
im1
][1])+

403 
dx2tx1
*Ğ
ue
[
1
][1]-2.0* ue[
i
][1]+ ue[
im1
][1]);

405 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

406 
tx2
 * (
ue
[
1
][2]*
buf
[1][1]-ue[
im1
][2]*buf[im1][1])+

407 
xxcÚ2
*(
buf
[
1
][2]-2.0*buf[
i
][2]+buf[
im1
][2])+

408 
dx3tx1
*Ğ
ue
[
1
][2]-2.0* ue[
i
][2]+ ue[
im1
][2]);

410 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

411 
tx2
*(
ue
[
1
][3]*
buf
[1][1]-ue[
im1
][3]*buf[im1][1])+

412 
xxcÚ2
*(
buf
[
1
][3]-2.0*buf[
i
][3]+buf[
im1
][3])+

413 
dx4tx1
*Ğ
ue
[
1
][3]-2.0* ue[
i
][3]+ ue[
im1
][3]);

415 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

416 
tx2
*(
buf
[
1
][1]*(
c1
*
ue
[1][4]-
c2
*
q
[ip1])-

417 
buf
[
im1
][1]*(
c1
*
ue
[im1][4]-
c2
*
q
[im1]))+

418 0.5*
xxcÚ3
*(
buf
[
1
][0]-2.0*buf[
i
][0]+buf[
im1
][0])+

419 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

420 
xxcÚ5
*(
buf
[
1
][4]-2.0*buf[
i
][4]+buf[
im1
][4])+

421 
dx5tx1
*Ğ
ue
[
1
][4]-2.0* ue[
i
][4]+ ue[
im1
][4]);

428 
m
 = 0; m < 5; m++) {

429 
i
 = 1;

430 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

431 (5.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] +ue[i+2][m]);

432 
i
 = 2;

433 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

434 (-4.0*
ue
[
i
-1][
m
] + 6.0*ue[i][m] -

435 4.0*
ue
[
i
+1][
m
] + ue[i+2][m]);

437 
m
 = 0; m < 5; m++) {

438 
i
 = 1*3; i <ğ
grid_pošts
[0]-3*1-1; i++) {

439 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

440 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

441 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m] + ue[i+2][m]);

444 
m
 = 0; m < 5; m++) {

445 
i
 = 
grid_pošts
[0]-3;

446 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

447 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] +

448 6.0*
ue
[
i
][
m
] - 4.0*ue[i+1][m]);

449 
i
 = 
grid_pošts
[0]-2;

450 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

451 (
ue
[
i
-2][
m
] - 4.0*ue[i-1][m] + 5.0*ue[i][m]);

461 #´agm¨
omp
 

462 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

463 
xi
 = ()
i
 * 
dnxm1
;

465 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

466 
z‘a
 = ()
k
 * 
dnzm1
;

468 
j
 = 0; j < 
grid_pošts
[1]; j++) {

469 
‘a
 = ()
j
 * 
dnym1
;

471 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

472 
m
 = 0; m < 5; m++) {

473 
ue
[
j
][
m
] = 
d‹mp
[m];

476 
dp
 = 1.0/
d‹mp
[0];

478 
m
 = 1; m <= 4; m++) {

479 
buf
[
j
][
m
] = 
dp
 * 
d‹mp
[m];

482 
cuf
[
j
] = 
buf
[j][2] * buf[j][2];

483 
buf
[
j
][0] = 
cuf
[j] + buf[j][1] * buf[j][1] +

484 
buf
[
j
][3] * buf[j][3];

485 
q
[
j
] = 0.5*(
buf
[j][1]*
ue
[j][1] + buf[j][2]*ue[j][2] +

486 
buf
[
j
][3]*
ue
[j][3]);

489 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

490 
jm1
 = 
j
-1;

491 
jp1
 = 
j
+1;

493 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

494 
ty2
*Ğ
ue
[
jp1
][2]-ue[
jm1
][2] )+

495 
dy1ty1
*(
ue
[
jp1
][0]-2.0*ue[
j
][0]+ue[
jm1
][0]);

497 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

498 
ty2
*(
ue
[
jp1
][1]*
buf
[jp1][2]-ue[
jm1
][1]*buf[jm1][2])+

499 
yycÚ2
*(
buf
[
jp1
][1]-2.0*buf[
j
][1]+buf[
jm1
][1])+

500 
dy2ty1
*Ğ
ue
[
jp1
][1]-2.0* ue[
j
][1]+ ue[
jm1
][1]);

502 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

503 
ty2
*((
ue
[
jp1
][2]*
buf
[jp1][2]+
c2
*(ue[jp1][4]-
q
[jp1]))-

504 (
ue
[
jm1
][2]*
buf
[jm1][2]+
c2
*(ue[jm1][4]-
q
[jm1])))+

505 
yycÚ1
*(
buf
[
jp1
][2]-2.0*buf[
j
][2]+buf[
jm1
][2])+

506 
dy3ty1
*Ğ
ue
[
jp1
][2]-2.0*ue[
j
][2] +ue[
jm1
][2]);

508 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

509 
ty2
*(
ue
[
jp1
][3]*
buf
[jp1][2]-ue[
jm1
][3]*buf[jm1][2])+

510 
yycÚ2
*(
buf
[
jp1
][3]-2.0*buf[
j
][3]+buf[
jm1
][3])+

511 
dy4ty1
*Ğ
ue
[
jp1
][3]-2.0*ue[
j
][3]+ ue[
jm1
][3]);

513 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

514 
ty2
*(
buf
[
jp1
][2]*(
c1
*
ue
[jp1][4]-
c2
*
q
[jp1])-

515 
buf
[
jm1
][2]*(
c1
*
ue
[jm1][4]-
c2
*
q
[jm1]))+

516 0.5*
yycÚ3
*(
buf
[
jp1
][0]-2.0*buf[
j
][0]+

517 
buf
[
jm1
][0])+

518 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

519 
yycÚ5
*(
buf
[
jp1
][4]-2.0*buf[
j
][4]+buf[
jm1
][4])+

520 
dy5ty1
*(
ue
[
jp1
][4]-2.0*ue[
j
][4]+ue[
jm1
][4]);

527 
m
 = 0; m < 5; m++) {

528 
j
 = 1;

529 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

530 (5.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] +ue[j+2][m]);

531 
j
 = 2;

532 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

533 (-4.0*
ue
[
j
-1][
m
] + 6.0*ue[j][m] -

534 4.0*
ue
[
j
+1][
m
] + ue[j+2][m]);

537 
m
 = 0; m < 5; m++) {

538 
j
 = 1*3; j <ğ
grid_pošts
[1]-3*1-1; j++) {

539 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

540 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

541 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m] + ue[j+2][m]);

545 
m
 = 0; m < 5; m++) {

546 
j
 = 
grid_pošts
[1]-3;

547 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

548 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] +

549 6.0*
ue
[
j
][
m
] - 4.0*ue[j+1][m]);

551 
j
 = 
grid_pošts
[1]-2;

553 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

554 (
ue
[
j
-2][
m
] - 4.0*ue[j-1][m] + 5.0*ue[j][m]);

566 #´agm¨
omp
 

567 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

568 
xi
 = ()
i
 * 
dnxm1
;

570 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

571 
‘a
 = ()
j
 * 
dnym1
;

573 
k
 = 0; k < 
grid_pošts
[2]; k++) {

574 
z‘a
 = ()
k
 * 
dnzm1
;

576 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

577 
m
 = 0; m < 5; m++) {

578 
ue
[
k
][
m
] = 
d‹mp
[m];

581 
dp
 = 1.0/
d‹mp
[0];

583 
m
 = 1; m <= 4; m++) {

584 
buf
[
k
][
m
] = 
dp
 * 
d‹mp
[m];

587 
cuf
[
k
] = 
buf
[k][3] * buf[k][3];

588 
buf
[
k
][0] = 
cuf
[k] + buf[k][1] * buf[k][1] +

589 
buf
[
k
][2] * buf[k][2];

590 
q
[
k
] = 0.5*(
buf
[k][1]*
ue
[k][1] + buf[k][2]*ue[k][2] +

591 
buf
[
k
][3]*
ue
[k][3]);

594 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

595 
km1
 = 
k
-1;

596 
kp1
 = 
k
+1;

598 
fÜcšg
[
i
][
j
][
k
][0] = forcing[i][j][k][0] -

599 
tz2
*Ğ
ue
[
kp1
][3]-ue[
km1
][3] )+

600 
dz1tz1
*(
ue
[
kp1
][0]-2.0*ue[
k
][0]+ue[
km1
][0]);

602 
fÜcšg
[
i
][
j
][
k
][1] = forcing[i][j][k][1] -

603 
tz2
 * (
ue
[
kp1
][1]*
buf
[kp1][3]-ue[
km1
][1]*buf[km1][3])+

604 
zzcÚ2
*(
buf
[
kp1
][1]-2.0*buf[
k
][1]+buf[
km1
][1])+

605 
dz2tz1
*Ğ
ue
[
kp1
][1]-2.0* ue[
k
][1]+ ue[
km1
][1]);

607 
fÜcšg
[
i
][
j
][
k
][2] = forcing[i][j][k][2] -

608 
tz2
 * (
ue
[
kp1
][2]*
buf
[kp1][3]-ue[
km1
][2]*buf[km1][3])+

609 
zzcÚ2
*(
buf
[
kp1
][2]-2.0*buf[
k
][2]+buf[
km1
][2])+

610 
dz3tz1
*(
ue
[
kp1
][2]-2.0*ue[
k
][2]+ue[
km1
][2]);

612 
fÜcšg
[
i
][
j
][
k
][3] = forcing[i][j][k][3] -

613 
tz2
 * ((
ue
[
kp1
][3]*
buf
[kp1][3]+
c2
*(ue[kp1][4]-
q
[kp1]))-

614 (
ue
[
km1
][3]*
buf
[km1][3]+
c2
*(ue[km1][4]-
q
[km1])))+

615 
zzcÚ1
*(
buf
[
kp1
][3]-2.0*buf[
k
][3]+buf[
km1
][3])+

616 
dz4tz1
*Ğ
ue
[
kp1
][3]-2.0*ue[
k
][3] +ue[
km1
][3]);

618 
fÜcšg
[
i
][
j
][
k
][4] = forcing[i][j][k][4] -

619 
tz2
 * (
buf
[
kp1
][3]*(
c1
*
ue
[kp1][4]-
c2
*
q
[kp1])-

620 
buf
[
km1
][3]*(
c1
*
ue
[km1][4]-
c2
*
q
[km1]))+

621 0.5*
zzcÚ3
*(
buf
[
kp1
][0]-2.0*buf[
k
][0]

622 +
buf
[
km1
][0])+

623 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

624 
zzcÚ5
*(
buf
[
kp1
][4]-2.0*buf[
k
][4]+buf[
km1
][4])+

625 
dz5tz1
*Ğ
ue
[
kp1
][4]-2.0*ue[
k
][4]+ ue[
km1
][4]);

631 
m
 = 0; m < 5; m++) {

632 
k
 = 1;

633 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

634 (5.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] +ue[k+2][m]);

635 
k
 = 2;

636 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

637 (-4.0*
ue
[
k
-1][
m
] + 6.0*ue[k][m] -

638 4.0*
ue
[
k
+1][
m
] + ue[k+2][m]);

641 
m
 = 0; m < 5; m++) {

642 
k
 = 1*3; k <ğ
grid_pošts
[2]-3*1-1; k++) {

643 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
*

644 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

645 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m] + ue[k+2][m]);

649 
m
 = 0; m < 5; m++) {

650 
k
 = 
grid_pošts
[2]-3;

651 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

652 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] +

653 6.0*
ue
[
k
][
m
] - 4.0*ue[k+1][m]);

654 
k
 = 
grid_pošts
[2]-2;

655 
fÜcšg
[
i
][
j
][
k
][
m
] = fÜcšg[i][j][k][m] - 
ds¥
 *

656 (
ue
[
k
-2][
m
] - 4.0*ue[k-1][m] + 5.0*ue[k][m]);

667 #´agm¨
omp
 

668 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

669 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

670 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

671 
m
 = 0; m < 5; m++) {

672 
fÜcšg
[
i
][
j
][
k
][
m
] = -1.0 * forcing[i][j][k][m];

679 
	}
}

683 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

684 
d‹mp
[5]) {

693 
m
;

695 
m
 = 0; m < 5; m++) {

696 
d‹mp
[
m
] = 
û
[m][0] +

697 
xi
*(
û
[
m
][1] + xi*(ce[m][4] + xi*(ce[m][7]

698 + 
xi
*
û
[
m
][10]))) +

699 
‘a
*(
û
[
m
][2] +ƒta*(ce[m][5] +ƒta*(ce[m][8]

700 + 
‘a
*
û
[
m
][11])))+

701 
z‘a
*(
û
[
m
][3] + zeta*(ce[m][6] + zeta*(ce[m][9] +

702 
z‘a
*
û
[
m
][12])));

704 
	}
}

709 
	$š™Ÿlize
() {

711 #´agm¨
omp
 
·¿Î–


721 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

722 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

730 #´agm¨
omp
 

731 
i
 = 0; i < 
IMAX
; i++) {

732 
j
 = 0; j < 
IMAX
; j++) {

733 
k
 = 0; k < 
IMAX
; k++) {

734 
m
 = 0; m < 5; m++) {

735 
u
[
i
][
j
][
k
][
m
] = 1.0;

745 #´agm¨
omp
 

746 
i
 = 0; i < 
grid_pošts
[0]; i++) {

747 
xi
 = ()
i
 * 
dnxm1
;

749 
j
 = 0; j < 
grid_pošts
[1]; j++) {

750 
‘a
 = ()
j
 * 
dnym1
;

752 
k
 = 0; k < 
grid_pošts
[2]; k++) {

753 
z‘a
 = ()
k
 * 
dnzm1
;

755 
ix
 = 0; ix < 2; ix++) {

756 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

757 &(
Pçû
[
ix
][0][0]));

760 
iy
 = 0; iy < 2; iy++) {

761 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

762 &
Pçû
[
iy
][1][0]);

765 
iz
 = 0; iz < 2; iz++) {

766 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

767 &
Pçû
[
iz
][2][0]);

770 
m
 = 0; m < 5; m++) {

771 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

772 (1.0-
xi
è* 
Pçû
[0][0][
m
];

773 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

774 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

775 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

776 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

778 
u
[
i
][
j
][
k
][
m
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

779 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

780 
Pxi
*
P‘a
*
Pz‘a
;

793 
i
 = 0;

794 
xi
 = 0.0;

795 #´agm¨
omp
 
nowa™


796 
j
 = 0; j < 
grid_pošts
[1]; j++) {

797 
‘a
 = ()
j
 * 
dnym1
;

798 
k
 = 0; k < 
grid_pošts
[2]; k++) {

799 
z‘a
 = ()
k
 * 
dnzm1
;

800 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

801 
m
 = 0; m < 5; m++) {

802 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

811 
i
 = 
grid_pošts
[0]-1;

812 
xi
 = 1.0;

813 #´agm¨
omp
 

814 
j
 = 0; j < 
grid_pošts
[1]; j++) {

815 
‘a
 = ()
j
 * 
dnym1
;

816 
k
 = 0; k < 
grid_pošts
[2]; k++) {

817 
z‘a
 = ()
k
 * 
dnzm1
;

818 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

819 
m
 = 0; m < 5; m++) {

820 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

828 
j
 = 0;

829 
‘a
 = 0.0;

830 #´agm¨
omp
 
nowa™


831 
i
 = 0; i < 
grid_pošts
[0]; i++) {

832 
xi
 = ()
i
 * 
dnxm1
;

833 
k
 = 0; k < 
grid_pošts
[2]; k++) {

834 
z‘a
 = ()
k
 * 
dnzm1
;

835 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

836 
m
 = 0; m < 5; m++) {

837 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

845 
j
 = 
grid_pošts
[1]-1;

846 
‘a
 = 1.0;

847 #´agm¨
omp
 

848 
i
 = 0; i < 
grid_pošts
[0]; i++) {

849 
xi
 = ()
i
 * 
dnxm1
;

850 
k
 = 0; k < 
grid_pošts
[2]; k++) {

851 
z‘a
 = ()
k
 * 
dnzm1
;

852 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

853 
m
 = 0; m < 5; m++) {

854 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

862 
k
 = 0;

863 
z‘a
 = 0.0;

864 #´agm¨
omp
 
nowa™


865 
i
 = 0; i < 
grid_pošts
[0]; i++) {

866 
xi
 = ()
i
 *
dnxm1
;

867 
j
 = 0; j < 
grid_pošts
[1]; j++) {

868 
‘a
 = ()
j
 * 
dnym1
;

869 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

870 
m
 = 0; m < 5; m++) {

871 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

879 
k
 = 
grid_pošts
[2]-1;

880 
z‘a
 = 1.0;

881 #´agm¨
omp
 

882 
i
 = 0; i < 
grid_pošts
[0]; i++) {

883 
xi
 = ()
i
 * 
dnxm1
;

884 
j
 = 0; j < 
grid_pošts
[1]; j++) {

885 
‘a
 = ()
j
 * 
dnym1
;

886 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

887 
m
 = 0; m < 5; m++) {

888 
u
[
i
][
j
][
k
][
m
] = 
‹mp
[m];

894 
	}
}

898 
	$lhsš™
() {

900 #´agm¨
omp
 
·¿Î–


902 
i
, 
j
, 
k
, 
m
, 
n
;

910 #´agm¨
omp
 

911 
i
 = 0; i < 
grid_pošts
[0]; i++) {

912 
j
 = 0; j < 
grid_pošts
[1]; j++) {

913 
k
 = 0; k < 
grid_pošts
[2]; k++) {

914 
m
 = 0; m < 5; m++) {

915 
n
 = 0;‚ < 5;‚++) {

916 
lhs
[
i
][
j
][
k
][0][
m
][
n
] = 0.0;

917 
lhs
[
i
][
j
][
k
][1][
m
][
n
] = 0.0;

918 
lhs
[
i
][
j
][
k
][2][
m
][
n
] = 0.0;

928 #´agm¨
omp
 

929 
i
 = 0; i < 
grid_pošts
[0]; i++) {

930 
j
 = 0; j < 
grid_pošts
[1]; j++) {

931 
k
 = 0; k < 
grid_pošts
[2]; k++) {

932 
m
 = 0; m < 5; m++) {

933 
lhs
[
i
][
j
][
k
][1][
m
][m] = 1.0;

940 
	}
}

944 
	$lhsx
() {

953 
i
, 
j
, 
k
;

958 #´agm¨
omp
 

959 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

960 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

961 
i
 = 0; i < 
grid_pošts
[0]; i++) {

963 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

964 
tmp2
 = 
tmp1
 *mp1;

965 
tmp3
 = 
tmp1
 * 
tmp2
;

969 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

970 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 1.0;

971 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 0.0;

972 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

973 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

975 
fjac
[ 
i
][ 
j
][ 
k
][1][0] = -(
u
[i][j][k][1] * 
tmp2
 *

976 
u
[
i
][
j
][
k
][1])

977 + 
c2
 * 0.50 * (
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

978 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

979 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
;

980 
fjac
[
i
][
j
][
k
][1][1] = ( 2.0 - 
c2
 )

981 * ( 
u
[
i
][
j
][
k
][1] / u[i][j][k][0] );

982 
fjac
[
i
][
j
][
k
][1][2] = - 
c2
 * ( 
u
[i][j][k][2] * 
tmp1
 );

983 
fjac
[
i
][
j
][
k
][1][3] = - 
c2
 * ( 
u
[i][j][k][3] * 
tmp1
 );

984 
fjac
[
i
][
j
][
k
][1][4] = 
c2
;

986 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] ) * 
tmp2
;

987 
fjac
[
i
][
j
][
k
][2][1] = 
u
[i][j][k][2] * 
tmp1
;

988 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][1] * 
tmp1
;

989 
fjac
[
i
][
j
][
k
][2][3] = 0.0;

990 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

992 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] ) * 
tmp2
;

993 
fjac
[
i
][
j
][
k
][3][1] = 
u
[i][j][k][3] * 
tmp1
;

994 
fjac
[
i
][
j
][
k
][3][2] = 0.0;

995 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][1] * 
tmp1
;

996 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

998 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

999 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1000 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2


1001 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1002 * ( 
u
[
i
][
j
][
k
][1] * 
tmp1
 );

1003 
fjac
[
i
][
j
][
k
][4][1] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1004 - 0.50 * 
c2


1005 * ( 3.0*
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1006 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1007 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
tmp2
;

1008 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][1] )

1009 * 
tmp2
;

1010 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][3]*u[i][j][k][1] )

1011 * 
tmp2
;

1012 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * ( 
u
[i][j][k][1] * 
tmp1
 );

1014 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1015 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1016 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1017 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1018 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1020 
njac
[
i
][
j
][
k
][1][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1021 
njac
[
i
][
j
][
k
][1][1] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1022 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1023 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1024 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1026 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1027 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1028 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1029 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1030 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1032 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1033 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1034 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1035 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1036 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1038 
njac
[
i
][
j
][
k
][4][0] = - ( 
cÚ43
 * 
c3c4


1039 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1040 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1041 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1042 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1044 
njac
[
i
][
j
][
k
][4][1] = ( 
cÚ43
 * 
c3c4


1045 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1];

1046 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1047 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1048 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1054 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1056 
tmp1
 = 
dt
 * 
tx1
;

1057 
tmp2
 = 
dt
 * 
tx2
;

1059 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i-1][j][k][0][0]

1060 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][0]

1061 - 
tmp1
 * 
dx1
;

1062 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i-1][j][k][0][1]

1063 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][1];

1064 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i-1][j][k][0][2]

1065 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][2];

1066 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i-1][j][k][0][3]

1067 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][3];

1068 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i-1][j][k][0][4]

1069 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][0][4];

1071 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i-1][j][k][1][0]

1072 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][0];

1073 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i-1][j][k][1][1]

1074 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][1]

1075 - 
tmp1
 * 
dx2
;

1076 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i-1][j][k][1][2]

1077 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][2];

1078 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i-1][j][k][1][3]

1079 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][3];

1080 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i-1][j][k][1][4]

1081 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][1][4];

1083 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i-1][j][k][2][0]

1084 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][0];

1085 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i-1][j][k][2][1]

1086 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][1];

1087 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i-1][j][k][2][2]

1088 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][2]

1089 - 
tmp1
 * 
dx3
;

1090 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i-1][j][k][2][3]

1091 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][3];

1092 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i-1][j][k][2][4]

1093 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][2][4];

1095 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i-1][j][k][3][0]

1096 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][0];

1097 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i-1][j][k][3][1]

1098 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][1];

1099 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i-1][j][k][3][2]

1100 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][2];

1101 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i-1][j][k][3][3]

1102 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][3]

1103 - 
tmp1
 * 
dx4
;

1104 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i-1][j][k][3][4]

1105 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][3][4];

1107 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i-1][j][k][4][0]

1108 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][0];

1109 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i-1][j][k][4][1]

1110 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][1];

1111 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i-1][j][k][4][2]

1112 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][2];

1113 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i-1][j][k][4][3]

1114 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][3];

1115 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i-1][j][k][4][4]

1116 - 
tmp1
 * 
njac
[
i
-1][
j
][
k
][4][4]

1117 - 
tmp1
 * 
dx5
;

1119 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1120 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1121 + 
tmp1
 * 2.0 * 
dx1
;

1122 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1123 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1124 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1125 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1127 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1128 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1129 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1130 + 
tmp1
 * 2.0 * 
dx2
;

1131 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1132 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1133 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1135 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1136 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1137 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1138 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1139 + 
tmp1
 * 2.0 * 
dx3
;

1140 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1141 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1143 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1144 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1145 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1146 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1147 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1148 + 
tmp1
 * 2.0 * 
dx4
;

1149 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1151 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1152 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1153 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1154 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1155 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1156 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1157 + 
tmp1
 * 2.0 * 
dx5
;

1159 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i+1][j][k][0][0]

1160 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][0]

1161 - 
tmp1
 * 
dx1
;

1162 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i+1][j][k][0][1]

1163 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][1];

1164 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i+1][j][k][0][2]

1165 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][2];

1166 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i+1][j][k][0][3]

1167 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][3];

1168 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i+1][j][k][0][4]

1169 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][0][4];

1171 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i+1][j][k][1][0]

1172 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][0];

1173 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i+1][j][k][1][1]

1174 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][1]

1175 - 
tmp1
 * 
dx2
;

1176 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i+1][j][k][1][2]

1177 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][2];

1178 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i+1][j][k][1][3]

1179 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][3];

1180 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i+1][j][k][1][4]

1181 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][1][4];

1183 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i+1][j][k][2][0]

1184 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][0];

1185 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i+1][j][k][2][1]

1186 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][1];

1187 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i+1][j][k][2][2]

1188 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][2]

1189 - 
tmp1
 * 
dx3
;

1190 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i+1][j][k][2][3]

1191 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][3];

1192 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i+1][j][k][2][4]

1193 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][2][4];

1195 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i+1][j][k][3][0]

1196 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][0];

1197 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i+1][j][k][3][1]

1198 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][1];

1199 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i+1][j][k][3][2]

1200 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][2];

1201 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i+1][j][k][3][3]

1202 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][3]

1203 - 
tmp1
 * 
dx4
;

1204 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i+1][j][k][3][4]

1205 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][3][4];

1207 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i+1][j][k][4][0]

1208 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][0];

1209 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i+1][j][k][4][1]

1210 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][1];

1211 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i+1][j][k][4][2]

1212 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][2];

1213 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i+1][j][k][4][3]

1214 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][3];

1215 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i+1][j][k][4][4]

1216 - 
tmp1
 * 
njac
[
i
+1][
j
][
k
][4][4]

1217 - 
tmp1
 * 
dx5
;

1222 
	}
}

1227 
	$lhsy
() {

1236 
i
, 
j
, 
k
;

1242 #´agm¨
omp
 

1243 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1244 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1245 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1247 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1248 
tmp2
 = 
tmp1
 *mp1;

1249 
tmp3
 = 
tmp1
 * 
tmp2
;

1251 
fjac
[ 
i
][ 
j
][ 
k
][0][0] = 0.0;

1252 
fjac
[ 
i
][ 
j
][ 
k
][0][1] = 0.0;

1253 
fjac
[ 
i
][ 
j
][ 
k
][0][2] = 1.0;

1254 
fjac
[ 
i
][ 
j
][ 
k
][0][3] = 0.0;

1255 
fjac
[ 
i
][ 
j
][ 
k
][0][4] = 0.0;

1257 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][2] )

1258 * 
tmp2
;

1259 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][2] * 
tmp1
;

1260 
fjac
[
i
][
j
][
k
][1][2] = 
u
[i][j][k][1] * 
tmp1
;

1261 
fjac
[
i
][
j
][
k
][1][3] = 0.0;

1262 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1264 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][2]*
tmp2
)

1265 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1266 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1267 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1268 * 
tmp2
 );

1269 
fjac
[
i
][
j
][
k
][2][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1270 
fjac
[
i
][
j
][
k
][2][2] = ( 2.0 - 
c2
 )

1271 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1272 
fjac
[
i
][
j
][
k
][2][3] = - 
c2
 * 
u
[i][j][k][3] * 
tmp1
;

1273 
fjac
[
i
][
j
][
k
][2][4] = 
c2
;

1275 
fjac
[
i
][
j
][
k
][3][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1276 * 
tmp2
;

1277 
fjac
[
i
][
j
][
k
][3][1] = 0.0;

1278 
fjac
[
i
][
j
][
k
][3][2] = 
u
[i][j][k][3] * 
tmp1
;

1279 
fjac
[
i
][
j
][
k
][3][3] = 
u
[i][j][k][2] * 
tmp1
;

1280 
fjac
[
i
][
j
][
k
][3][4] = 0.0;

1282 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1283 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1284 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1285 * 
tmp2


1286 - 
c1
 * 
u
[
i
][
j
][
k
][4] * 
tmp1
 )

1287 * 
u
[
i
][
j
][
k
][2] * 
tmp1
;

1288 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * 
u
[i][j][k][1]*u[i][j][k][2]

1289 * 
tmp2
;

1290 
fjac
[
i
][
j
][
k
][4][2] = 
c1
 * 
u
[i][j][k][4] * 
tmp1


1291 - 0.50 * 
c2


1292 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1293 + 3.0 * 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1294 + 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1295 * 
tmp2
 );

1296 
fjac
[
i
][
j
][
k
][4][3] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1297 * 
tmp2
;

1298 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][2] * 
tmp1
;

1300 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1301 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1302 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1303 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1304 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1306 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1307 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1308 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1309 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1310 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1312 
njac
[
i
][
j
][
k
][2][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1313 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1314 
njac
[
i
][
j
][
k
][2][2] = 
cÚ43
 * 
c3c4
 * 
tmp1
;

1315 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1316 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1318 
njac
[
i
][
j
][
k
][3][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1319 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1320 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1321 
njac
[
i
][
j
][
k
][3][3] = 
c3c4
 * 
tmp1
;

1322 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1324 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1325 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1326 - ( 
cÚ43
 * 
c3c4


1327 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1328 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1329 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1331 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1332 
njac
[
i
][
j
][
k
][4][2] = ( 
cÚ43
 * 
c3c4


1333 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2];

1334 
njac
[
i
][
j
][
k
][4][3] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][3];

1335 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 ) * 
tmp1
;

1344 #´agm¨
omp
 

1345 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1346 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1347 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1349 
tmp1
 = 
dt
 * 
ty1
;

1350 
tmp2
 = 
dt
 * 
ty2
;

1352 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j-1][k][0][0]

1353 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][0]

1354 - 
tmp1
 * 
dy1
;

1355 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j-1][k][0][1]

1356 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][1];

1357 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j-1][k][0][2]

1358 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][2];

1359 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j-1][k][0][3]

1360 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][3];

1361 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j-1][k][0][4]

1362 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][0][4];

1364 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j-1][k][1][0]

1365 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][0];

1366 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j-1][k][1][1]

1367 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][1]

1368 - 
tmp1
 * 
dy2
;

1369 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j-1][k][1][2]

1370 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][2];

1371 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j-1][k][1][3]

1372 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][3];

1373 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j-1][k][1][4]

1374 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][1][4];

1376 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j-1][k][2][0]

1377 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][0];

1378 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j-1][k][2][1]

1379 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][1];

1380 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j-1][k][2][2]

1381 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][2]

1382 - 
tmp1
 * 
dy3
;

1383 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j-1][k][2][3]

1384 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][3];

1385 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j-1][k][2][4]

1386 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][2][4];

1388 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j-1][k][3][0]

1389 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][0];

1390 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j-1][k][3][1]

1391 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][1];

1392 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j-1][k][3][2]

1393 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][2];

1394 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j-1][k][3][3]

1395 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][3]

1396 - 
tmp1
 * 
dy4
;

1397 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j-1][k][3][4]

1398 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][3][4];

1400 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j-1][k][4][0]

1401 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][0];

1402 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j-1][k][4][1]

1403 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][1];

1404 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j-1][k][4][2]

1405 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][2];

1406 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j-1][k][4][3]

1407 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][3];

1408 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j-1][k][4][4]

1409 - 
tmp1
 * 
njac
[
i
][
j
-1][
k
][4][4]

1410 - 
tmp1
 * 
dy5
;

1412 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1413 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1414 + 
tmp1
 * 2.0 * 
dy1
;

1415 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1416 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1417 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1418 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1420 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1421 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1422 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1423 + 
tmp1
 * 2.0 * 
dy2
;

1424 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1425 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1426 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1428 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1429 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1430 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1431 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1432 + 
tmp1
 * 2.0 * 
dy3
;

1433 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1434 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1436 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1437 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1438 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1439 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1440 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1441 + 
tmp1
 * 2.0 * 
dy4
;

1442 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1444 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1445 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1446 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1447 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1448 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1449 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1450 + 
tmp1
 * 2.0 * 
dy5
;

1452 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j+1][k][0][0]

1453 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][0]

1454 - 
tmp1
 * 
dy1
;

1455 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j+1][k][0][1]

1456 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][1];

1457 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j+1][k][0][2]

1458 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][2];

1459 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j+1][k][0][3]

1460 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][3];

1461 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j+1][k][0][4]

1462 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][0][4];

1464 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j+1][k][1][0]

1465 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][0];

1466 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j+1][k][1][1]

1467 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][1]

1468 - 
tmp1
 * 
dy2
;

1469 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j+1][k][1][2]

1470 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][2];

1471 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j+1][k][1][3]

1472 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][3];

1473 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j+1][k][1][4]

1474 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][1][4];

1476 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j+1][k][2][0]

1477 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][0];

1478 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j+1][k][2][1]

1479 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][1];

1480 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j+1][k][2][2]

1481 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][2]

1482 - 
tmp1
 * 
dy3
;

1483 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j+1][k][2][3]

1484 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][3];

1485 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j+1][k][2][4]

1486 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][2][4];

1488 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j+1][k][3][0]

1489 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][0];

1490 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j+1][k][3][1]

1491 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][1];

1492 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j+1][k][3][2]

1493 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][2];

1494 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j+1][k][3][3]

1495 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][3]

1496 - 
tmp1
 * 
dy4
;

1497 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j+1][k][3][4]

1498 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][3][4];

1500 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j+1][k][4][0]

1501 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][0];

1502 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j+1][k][4][1]

1503 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][1];

1504 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j+1][k][4][2]

1505 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][2];

1506 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j+1][k][4][3]

1507 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][3];

1508 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j+1][k][4][4]

1509 - 
tmp1
 * 
njac
[
i
][
j
+1][
k
][4][4]

1510 - 
tmp1
 * 
dy5
;

1515 
	}
}

1521 
	$lhsz
() {

1530 
i
, 
j
, 
k
;

1536 #´agm¨
omp
 

1537 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1538 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1539 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1541 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1542 
tmp2
 = 
tmp1
 *mp1;

1543 
tmp3
 = 
tmp1
 * 
tmp2
;

1545 
fjac
[
i
][
j
][
k
][0][0] = 0.0;

1546 
fjac
[
i
][
j
][
k
][0][1] = 0.0;

1547 
fjac
[
i
][
j
][
k
][0][2] = 0.0;

1548 
fjac
[
i
][
j
][
k
][0][3] = 1.0;

1549 
fjac
[
i
][
j
][
k
][0][4] = 0.0;

1551 
fjac
[
i
][
j
][
k
][1][0] = - ( 
u
[i][j][k][1]*u[i][j][k][3] )

1552 * 
tmp2
;

1553 
fjac
[
i
][
j
][
k
][1][1] = 
u
[i][j][k][3] * 
tmp1
;

1554 
fjac
[
i
][
j
][
k
][1][2] = 0.0;

1555 
fjac
[
i
][
j
][
k
][1][3] = 
u
[i][j][k][1] * 
tmp1
;

1556 
fjac
[
i
][
j
][
k
][1][4] = 0.0;

1558 
fjac
[
i
][
j
][
k
][2][0] = - ( 
u
[i][j][k][2]*u[i][j][k][3] )

1559 * 
tmp2
;

1560 
fjac
[
i
][
j
][
k
][2][1] = 0.0;

1561 
fjac
[
i
][
j
][
k
][2][2] = 
u
[i][j][k][3] * 
tmp1
;

1562 
fjac
[
i
][
j
][
k
][2][3] = 
u
[i][j][k][2] * 
tmp1
;

1563 
fjac
[
i
][
j
][
k
][2][4] = 0.0;

1565 
fjac
[
i
][
j
][
k
][3][0] = - (
u
[i][j][k][3]*u[i][j][k][3] * 
tmp2
 )

1566 + 0.50 * 
c2
 * ( ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

1567 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1568 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] ) * 
tmp2
 );

1569 
fjac
[
i
][
j
][
k
][3][1] = - 
c2
 * 
u
[i][j][k][1] * 
tmp1
;

1570 
fjac
[
i
][
j
][
k
][3][2] = - 
c2
 * 
u
[i][j][k][2] * 
tmp1
;

1571 
fjac
[
i
][
j
][
k
][3][3] = ( 2.0 - 
c2
 )

1572 * 
u
[
i
][
j
][
k
][3] * 
tmp1
;

1573 
fjac
[
i
][
j
][
k
][3][4] = 
c2
;

1575 
fjac
[
i
][
j
][
k
][4][0] = ( 
c2
 * ( 
u
[i][j][k][1] * u[i][j][k][1]

1576 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

1577 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

1578 * 
tmp2


1579 - 
c1
 * ( 
u
[
i
][
j
][
k
][4] * 
tmp1
 ) )

1580 * ( 
u
[
i
][
j
][
k
][3] * 
tmp1
 );

1581 
fjac
[
i
][
j
][
k
][4][1] = - 
c2
 * ( 
u
[i][j][k][1]*u[i][j][k][3] )

1582 * 
tmp2
;

1583 
fjac
[
i
][
j
][
k
][4][2] = - 
c2
 * ( 
u
[i][j][k][2]*u[i][j][k][3] )

1584 * 
tmp2
;

1585 
fjac
[
i
][
j
][
k
][4][3] = 
c1
 * ( 
u
[i][j][k][4] * 
tmp1
 )

1586 - 0.50 * 
c2


1587 * ( ( 
u
[
i
][
j
][
k
][1]*u[i][j][k][1]

1588 + 
u
[
i
][
j
][
k
][2]*u[i][j][k][2]

1589 + 3.0*
u
[
i
][
j
][
k
][3]*u[i][j][k][3] )

1590 * 
tmp2
 );

1591 
fjac
[
i
][
j
][
k
][4][4] = 
c1
 * 
u
[i][j][k][3] * 
tmp1
;

1593 
njac
[
i
][
j
][
k
][0][0] = 0.0;

1594 
njac
[
i
][
j
][
k
][0][1] = 0.0;

1595 
njac
[
i
][
j
][
k
][0][2] = 0.0;

1596 
njac
[
i
][
j
][
k
][0][3] = 0.0;

1597 
njac
[
i
][
j
][
k
][0][4] = 0.0;

1599 
njac
[
i
][
j
][
k
][1][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][1];

1600 
njac
[
i
][
j
][
k
][1][1] = 
c3c4
 * 
tmp1
;

1601 
njac
[
i
][
j
][
k
][1][2] = 0.0;

1602 
njac
[
i
][
j
][
k
][1][3] = 0.0;

1603 
njac
[
i
][
j
][
k
][1][4] = 0.0;

1605 
njac
[
i
][
j
][
k
][2][0] = - 
c3c4
 * 
tmp2
 * 
u
[i][j][k][2];

1606 
njac
[
i
][
j
][
k
][2][1] = 0.0;

1607 
njac
[
i
][
j
][
k
][2][2] = 
c3c4
 * 
tmp1
;

1608 
njac
[
i
][
j
][
k
][2][3] = 0.0;

1609 
njac
[
i
][
j
][
k
][2][4] = 0.0;

1611 
njac
[
i
][
j
][
k
][3][0] = - 
cÚ43
 * 
c3c4
 * 
tmp2
 * 
u
[i][j][k][3];

1612 
njac
[
i
][
j
][
k
][3][1] = 0.0;

1613 
njac
[
i
][
j
][
k
][3][2] = 0.0;

1614 
njac
[
i
][
j
][
k
][3][3] = 
cÚ43
 * 
c3
 * 
c4
 * 
tmp1
;

1615 
njac
[
i
][
j
][
k
][3][4] = 0.0;

1617 
njac
[
i
][
j
][
k
][4][0] = - ( 
c3c4


1618 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][1]))

1619 - ( 
c3c4
 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][2]))

1620 - ( 
cÚ43
 * 
c3c4


1621 - 
c1345
 ) * 
tmp3
 * (
	`pow2
(
u
[
i
][
j
][
k
][3]))

1622 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
][4];

1624 
njac
[
i
][
j
][
k
][4][1] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][1];

1625 
njac
[
i
][
j
][
k
][4][2] = ( 
c3c4
 - 
c1345
 ) * 
tmp2
 * 
u
[i][j][k][2];

1626 
njac
[
i
][
j
][
k
][4][3] = ( 
cÚ43
 * 
c3c4


1627 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3];

1628 
njac
[
i
][
j
][
k
][4][4] = ( 
c1345
 )* 
tmp1
;

1637 #´agm¨
omp
 

1638 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1639 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1640 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1642 
tmp1
 = 
dt
 * 
tz1
;

1643 
tmp2
 = 
dt
 * 
tz2
;

1645 
lhs
[
i
][
j
][
k
][
AA
][0][0] = - 
tmp2
 * 
fjac
[i][j][k-1][0][0]

1646 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][0]

1647 - 
tmp1
 * 
dz1
;

1648 
lhs
[
i
][
j
][
k
][
AA
][0][1] = - 
tmp2
 * 
fjac
[i][j][k-1][0][1]

1649 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][1];

1650 
lhs
[
i
][
j
][
k
][
AA
][0][2] = - 
tmp2
 * 
fjac
[i][j][k-1][0][2]

1651 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][2];

1652 
lhs
[
i
][
j
][
k
][
AA
][0][3] = - 
tmp2
 * 
fjac
[i][j][k-1][0][3]

1653 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][3];

1654 
lhs
[
i
][
j
][
k
][
AA
][0][4] = - 
tmp2
 * 
fjac
[i][j][k-1][0][4]

1655 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][0][4];

1657 
lhs
[
i
][
j
][
k
][
AA
][1][0] = - 
tmp2
 * 
fjac
[i][j][k-1][1][0]

1658 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][0];

1659 
lhs
[
i
][
j
][
k
][
AA
][1][1] = - 
tmp2
 * 
fjac
[i][j][k-1][1][1]

1660 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][1]

1661 - 
tmp1
 * 
dz2
;

1662 
lhs
[
i
][
j
][
k
][
AA
][1][2] = - 
tmp2
 * 
fjac
[i][j][k-1][1][2]

1663 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][2];

1664 
lhs
[
i
][
j
][
k
][
AA
][1][3] = - 
tmp2
 * 
fjac
[i][j][k-1][1][3]

1665 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][3];

1666 
lhs
[
i
][
j
][
k
][
AA
][1][4] = - 
tmp2
 * 
fjac
[i][j][k-1][1][4]

1667 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][1][4];

1669 
lhs
[
i
][
j
][
k
][
AA
][2][0] = - 
tmp2
 * 
fjac
[i][j][k-1][2][0]

1670 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][0];

1671 
lhs
[
i
][
j
][
k
][
AA
][2][1] = - 
tmp2
 * 
fjac
[i][j][k-1][2][1]

1672 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][1];

1673 
lhs
[
i
][
j
][
k
][
AA
][2][2] = - 
tmp2
 * 
fjac
[i][j][k-1][2][2]

1674 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][2]

1675 - 
tmp1
 * 
dz3
;

1676 
lhs
[
i
][
j
][
k
][
AA
][2][3] = - 
tmp2
 * 
fjac
[i][j][k-1][2][3]

1677 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][3];

1678 
lhs
[
i
][
j
][
k
][
AA
][2][4] = - 
tmp2
 * 
fjac
[i][j][k-1][2][4]

1679 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][2][4];

1681 
lhs
[
i
][
j
][
k
][
AA
][3][0] = - 
tmp2
 * 
fjac
[i][j][k-1][3][0]

1682 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][0];

1683 
lhs
[
i
][
j
][
k
][
AA
][3][1] = - 
tmp2
 * 
fjac
[i][j][k-1][3][1]

1684 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][1];

1685 
lhs
[
i
][
j
][
k
][
AA
][3][2] = - 
tmp2
 * 
fjac
[i][j][k-1][3][2]

1686 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][2];

1687 
lhs
[
i
][
j
][
k
][
AA
][3][3] = - 
tmp2
 * 
fjac
[i][j][k-1][3][3]

1688 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][3]

1689 - 
tmp1
 * 
dz4
;

1690 
lhs
[
i
][
j
][
k
][
AA
][3][4] = - 
tmp2
 * 
fjac
[i][j][k-1][3][4]

1691 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][3][4];

1693 
lhs
[
i
][
j
][
k
][
AA
][4][0] = - 
tmp2
 * 
fjac
[i][j][k-1][4][0]

1694 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][0];

1695 
lhs
[
i
][
j
][
k
][
AA
][4][1] = - 
tmp2
 * 
fjac
[i][j][k-1][4][1]

1696 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][1];

1697 
lhs
[
i
][
j
][
k
][
AA
][4][2] = - 
tmp2
 * 
fjac
[i][j][k-1][4][2]

1698 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][2];

1699 
lhs
[
i
][
j
][
k
][
AA
][4][3] = - 
tmp2
 * 
fjac
[i][j][k-1][4][3]

1700 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][3];

1701 
lhs
[
i
][
j
][
k
][
AA
][4][4] = - 
tmp2
 * 
fjac
[i][j][k-1][4][4]

1702 - 
tmp1
 * 
njac
[
i
][
j
][
k
-1][4][4]

1703 - 
tmp1
 * 
dz5
;

1705 
lhs
[
i
][
j
][
k
][
BB
][0][0] = 1.0

1706 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][0][0]

1707 + 
tmp1
 * 2.0 * 
dz1
;

1708 
lhs
[
i
][
j
][
k
][
BB
][0][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][1];

1709 
lhs
[
i
][
j
][
k
][
BB
][0][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][2];

1710 
lhs
[
i
][
j
][
k
][
BB
][0][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][3];

1711 
lhs
[
i
][
j
][
k
][
BB
][0][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][0][4];

1713 
lhs
[
i
][
j
][
k
][
BB
][1][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][0];

1714 
lhs
[
i
][
j
][
k
][
BB
][1][1] = 1.0

1715 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][1][1]

1716 + 
tmp1
 * 2.0 * 
dz2
;

1717 
lhs
[
i
][
j
][
k
][
BB
][1][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][2];

1718 
lhs
[
i
][
j
][
k
][
BB
][1][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][3];

1719 
lhs
[
i
][
j
][
k
][
BB
][1][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][1][4];

1721 
lhs
[
i
][
j
][
k
][
BB
][2][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][0];

1722 
lhs
[
i
][
j
][
k
][
BB
][2][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][1];

1723 
lhs
[
i
][
j
][
k
][
BB
][2][2] = 1.0

1724 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][2][2]

1725 + 
tmp1
 * 2.0 * 
dz3
;

1726 
lhs
[
i
][
j
][
k
][
BB
][2][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][3];

1727 
lhs
[
i
][
j
][
k
][
BB
][2][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][2][4];

1729 
lhs
[
i
][
j
][
k
][
BB
][3][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][0];

1730 
lhs
[
i
][
j
][
k
][
BB
][3][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][1];

1731 
lhs
[
i
][
j
][
k
][
BB
][3][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][2];

1732 
lhs
[
i
][
j
][
k
][
BB
][3][3] = 1.0

1733 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][3][3]

1734 + 
tmp1
 * 2.0 * 
dz4
;

1735 
lhs
[
i
][
j
][
k
][
BB
][3][4] = 
tmp1
 * 2.0 * 
njac
[i][j][k][3][4];

1737 
lhs
[
i
][
j
][
k
][
BB
][4][0] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][0];

1738 
lhs
[
i
][
j
][
k
][
BB
][4][1] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][1];

1739 
lhs
[
i
][
j
][
k
][
BB
][4][2] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][2];

1740 
lhs
[
i
][
j
][
k
][
BB
][4][3] = 
tmp1
 * 2.0 * 
njac
[i][j][k][4][3];

1741 
lhs
[
i
][
j
][
k
][
BB
][4][4] = 1.0

1742 + 
tmp1
 * 2.0 * 
njac
[
i
][
j
][
k
][4][4]

1743 + 
tmp1
 * 2.0 * 
dz5
;

1745 
lhs
[
i
][
j
][
k
][
CC
][0][0] = 
tmp2
 * 
fjac
[i][j][k+1][0][0]

1746 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][0]

1747 - 
tmp1
 * 
dz1
;

1748 
lhs
[
i
][
j
][
k
][
CC
][0][1] = 
tmp2
 * 
fjac
[i][j][k+1][0][1]

1749 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][1];

1750 
lhs
[
i
][
j
][
k
][
CC
][0][2] = 
tmp2
 * 
fjac
[i][j][k+1][0][2]

1751 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][2];

1752 
lhs
[
i
][
j
][
k
][
CC
][0][3] = 
tmp2
 * 
fjac
[i][j][k+1][0][3]

1753 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][3];

1754 
lhs
[
i
][
j
][
k
][
CC
][0][4] = 
tmp2
 * 
fjac
[i][j][k+1][0][4]

1755 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][0][4];

1757 
lhs
[
i
][
j
][
k
][
CC
][1][0] = 
tmp2
 * 
fjac
[i][j][k+1][1][0]

1758 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][0];

1759 
lhs
[
i
][
j
][
k
][
CC
][1][1] = 
tmp2
 * 
fjac
[i][j][k+1][1][1]

1760 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][1]

1761 - 
tmp1
 * 
dz2
;

1762 
lhs
[
i
][
j
][
k
][
CC
][1][2] = 
tmp2
 * 
fjac
[i][j][k+1][1][2]

1763 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][2];

1764 
lhs
[
i
][
j
][
k
][
CC
][1][3] = 
tmp2
 * 
fjac
[i][j][k+1][1][3]

1765 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][3];

1766 
lhs
[
i
][
j
][
k
][
CC
][1][4] = 
tmp2
 * 
fjac
[i][j][k+1][1][4]

1767 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][1][4];

1769 
lhs
[
i
][
j
][
k
][
CC
][2][0] = 
tmp2
 * 
fjac
[i][j][k+1][2][0]

1770 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][0];

1771 
lhs
[
i
][
j
][
k
][
CC
][2][1] = 
tmp2
 * 
fjac
[i][j][k+1][2][1]

1772 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][1];

1773 
lhs
[
i
][
j
][
k
][
CC
][2][2] = 
tmp2
 * 
fjac
[i][j][k+1][2][2]

1774 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][2]

1775 - 
tmp1
 * 
dz3
;

1776 
lhs
[
i
][
j
][
k
][
CC
][2][3] = 
tmp2
 * 
fjac
[i][j][k+1][2][3]

1777 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][3];

1778 
lhs
[
i
][
j
][
k
][
CC
][2][4] = 
tmp2
 * 
fjac
[i][j][k+1][2][4]

1779 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][2][4];

1781 
lhs
[
i
][
j
][
k
][
CC
][3][0] = 
tmp2
 * 
fjac
[i][j][k+1][3][0]

1782 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][0];

1783 
lhs
[
i
][
j
][
k
][
CC
][3][1] = 
tmp2
 * 
fjac
[i][j][k+1][3][1]

1784 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][1];

1785 
lhs
[
i
][
j
][
k
][
CC
][3][2] = 
tmp2
 * 
fjac
[i][j][k+1][3][2]

1786 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][2];

1787 
lhs
[
i
][
j
][
k
][
CC
][3][3] = 
tmp2
 * 
fjac
[i][j][k+1][3][3]

1788 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][3]

1789 - 
tmp1
 * 
dz4
;

1790 
lhs
[
i
][
j
][
k
][
CC
][3][4] = 
tmp2
 * 
fjac
[i][j][k+1][3][4]

1791 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][3][4];

1793 
lhs
[
i
][
j
][
k
][
CC
][4][0] = 
tmp2
 * 
fjac
[i][j][k+1][4][0]

1794 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][0];

1795 
lhs
[
i
][
j
][
k
][
CC
][4][1] = 
tmp2
 * 
fjac
[i][j][k+1][4][1]

1796 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][1];

1797 
lhs
[
i
][
j
][
k
][
CC
][4][2] = 
tmp2
 * 
fjac
[i][j][k+1][4][2]

1798 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][2];

1799 
lhs
[
i
][
j
][
k
][
CC
][4][3] = 
tmp2
 * 
fjac
[i][j][k+1][4][3]

1800 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][3];

1801 
lhs
[
i
][
j
][
k
][
CC
][4][4] = 
tmp2
 * 
fjac
[i][j][k+1][4][4]

1802 - 
tmp1
 * 
njac
[
i
][
j
][
k
+1][4][4]

1803 - 
tmp1
 * 
dz5
;

1808 
	}
}

1813 
	$compu‹_rhs
() {

1815 
i
, 
j
, 
k
, 
m
;

1816 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
, 
wijk
, 
wp1
, 
wm1
;

1822 #´agm¨
omp
 
nowa™


1823 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1824 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1825 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1826 
rho_šv
 = 1.0/
u
[
i
][
j
][
k
][0];

1827 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1828 
us
[
i
][
j
][
k
] = 
u
[i][j][k][1] * 
rho_šv
;

1829 
vs
[
i
][
j
][
k
] = 
u
[i][j][k][2] * 
rho_šv
;

1830 
ws
[
i
][
j
][
k
] = 
u
[i][j][k][3] * 
rho_šv
;

1831 
squ¬e
[
i
][
j
][
k
] = 0.5 * (
u
[i][j][k][1]*u[i][j][k][1] +

1832 
u
[
i
][
j
][
k
][2]*u[i][j][k][2] +

1833 
u
[
i
][
j
][
k
][3]*u[i][j][k][3] ) * 
rho_šv
;

1834 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1845 #´agm¨
omp
 

1846 
i
 = 0; i < 
grid_pošts
[0]; i++) {

1847 
j
 = 0; j < 
grid_pošts
[1]; j++) {

1848 
k
 = 0; k < 
grid_pošts
[2]; k++) {

1849 
m
 = 0; m < 5; m++) {

1850 
rhs
[
i
][
j
][
k
][
m
] = 
fÜcšg
[i][j][k][m];

1859 #´agm¨
omp
 

1860 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1861 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1862 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1863 
uijk
 = 
us
[
i
][
j
][
k
];

1864 
up1
 = 
us
[
i
+1][
j
][
k
];

1865 
um1
 = 
us
[
i
-1][
j
][
k
];

1867 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dx1tx1
 *

1868 (
u
[
i
+1][
j
][
k
][0] - 2.0*u[i][j][k][0] +

1869 
u
[
i
-1][
j
][
k
][0]) -

1870 
tx2
 * (
u
[
i
+1][
j
][
k
][1] - u[i-1][j][k][1]);

1872 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dx2tx1
 *

1873 (
u
[
i
+1][
j
][
k
][1] - 2.0*u[i][j][k][1] +

1874 
u
[
i
-1][
j
][
k
][1]) +

1875 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1876 
tx2
 * (
u
[
i
+1][
j
][
k
][1]*
up1
 -

1877 
u
[
i
-1][
j
][
k
][1]*
um1
 +

1878 (
u
[
i
+1][
j
][
k
][4]- 
squ¬e
[i+1][j][k]-

1879 
u
[
i
-1][
j
][
k
][4]+ 
squ¬e
[i-1][j][k])*

1880 
c2
);

1882 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dx3tx1
 *

1883 (
u
[
i
+1][
j
][
k
][2] - 2.0*u[i][j][k][2] +

1884 
u
[
i
-1][
j
][
k
][2]) +

1885 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1886 
vs
[
i
-1][
j
][
k
]) -

1887 
tx2
 * (
u
[
i
+1][
j
][
k
][2]*
up1
 -

1888 
u
[
i
-1][
j
][
k
][2]*
um1
);

1890 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dx4tx1
 *

1891 (
u
[
i
+1][
j
][
k
][3] - 2.0*u[i][j][k][3] +

1892 
u
[
i
-1][
j
][
k
][3]) +

1893 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1894 
ws
[
i
-1][
j
][
k
]) -

1895 
tx2
 * (
u
[
i
+1][
j
][
k
][3]*
up1
 -

1896 
u
[
i
-1][
j
][
k
][3]*
um1
);

1898 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dx5tx1
 *

1899 (
u
[
i
+1][
j
][
k
][4] - 2.0*u[i][j][k][4] +

1900 
u
[
i
-1][
j
][
k
][4]) +

1901 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1902 
qs
[
i
-1][
j
][
k
]) +

1903 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1904 
um1
*um1) +

1905 
xxcÚ5
 * (
u
[
i
+1][
j
][
k
][4]*
rho_i
[i+1][j][k] -

1906 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

1907 
u
[
i
-1][
j
][
k
][4]*
rho_i
[i-1][j][k]) -

1908 
tx2
 * ( (
c1
*
u
[
i
+1][
j
][
k
][4] -

1909 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1910 (
c1
*
u
[
i
-1][
j
][
k
][4] -

1911 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1919 
i
 = 1;

1920 #´agm¨
omp
 
nowa™


1921 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1922 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1923 
m
 = 0; m < 5; m++) {

1924 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

1925 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1926 
u
[
i
+2][
j
][
k
][
m
]);

1931 
i
 = 2;

1932 #´agm¨
omp
 
nowa™


1933 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1934 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1935 
m
 = 0; m < 5; m++) {

1936 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1937 (-4.0*
u
[
i
-1][
j
][
k
][
m
] + 6.0*u[i][j][k][m] -

1938 4.0*
u
[
i
+1][
j
][
k
][
m
] + u[i+2][j][k][m]);

1943 #´agm¨
omp
 
nowa™


1944 
i
 = 3; i < 
grid_pošts
[0]-3; i++) {

1945 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1946 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1947 
m
 = 0; m < 5; m++) {

1948 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1949 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1950 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] +

1951 
u
[
i
+2][
j
][
k
][
m
] );

1957 
i
 = 
grid_pošts
[0]-3;

1958 #´agm¨
omp
 
nowa™


1959 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1960 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1961 
m
 = 0; m < 5; m++) {

1962 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1963 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.0*u[i-1][j][k][m] +

1964 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i+1][j][k][m] );

1969 
i
 = 
grid_pošts
[0]-2;

1970 #´agm¨
omp
 

1971 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1972 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1973 
m
 = 0; m < 5; m++) {

1974 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

1975 Ğ
u
[
i
-2][
j
][
k
][
m
] - 4.*u[i-1][j][k][m] +

1976 5.0*
u
[
i
][
j
][
k
][
m
] );

1984 #´agm¨
omp
 

1985 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

1986 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

1987 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

1988 
vijk
 = 
vs
[
i
][
j
][
k
];

1989 
vp1
 = 
vs
[
i
][
j
+1][
k
];

1990 
vm1
 = 
vs
[
i
][
j
-1][
k
];

1991 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dy1ty1
 *

1992 (
u
[
i
][
j
+1][
k
][0] - 2.0*u[i][j][k][0] +

1993 
u
[
i
][
j
-1][
k
][0]) -

1994 
ty2
 * (
u
[
i
][
j
+1][
k
][2] - u[i][j-1][k][2]);

1995 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dy2ty1
 *

1996 (
u
[
i
][
j
+1][
k
][1] - 2.0*u[i][j][k][1] +

1997 
u
[
i
][
j
-1][
k
][1]) +

1998 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

1999 
us
[
i
][
j
-1][
k
]) -

2000 
ty2
 * (
u
[
i
][
j
+1][
k
][1]*
vp1
 -

2001 
u
[
i
][
j
-1][
k
][1]*
vm1
);

2002 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dy3ty1
 *

2003 (
u
[
i
][
j
+1][
k
][2] - 2.0*u[i][j][k][2] +

2004 
u
[
i
][
j
-1][
k
][2]) +

2005 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

2006 
ty2
 * (
u
[
i
][
j
+1][
k
][2]*
vp1
 -

2007 
u
[
i
][
j
-1][
k
][2]*
vm1
 +

2008 (
u
[
i
][
j
+1][
k
][4] - 
squ¬e
[i][j+1][k] -

2009 
u
[
i
][
j
-1][
k
][4] + 
squ¬e
[i][j-1][k])

2010 *
c2
);

2011 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dy4ty1
 *

2012 (
u
[
i
][
j
+1][
k
][3] - 2.0*u[i][j][k][3] +

2013 
u
[
i
][
j
-1][
k
][3]) +

2014 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

2015 
ws
[
i
][
j
-1][
k
]) -

2016 
ty2
 * (
u
[
i
][
j
+1][
k
][3]*
vp1
 -

2017 
u
[
i
][
j
-1][
k
][3]*
vm1
);

2018 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dy5ty1
 *

2019 (
u
[
i
][
j
+1][
k
][4] - 2.0*u[i][j][k][4] +

2020 
u
[
i
][
j
-1][
k
][4]) +

2021 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

2022 
qs
[
i
][
j
-1][
k
]) +

2023 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

2024 
vm1
*vm1) +

2025 
yycÚ5
 * (
u
[
i
][
j
+1][
k
][4]*
rho_i
[i][j+1][k] -

2026 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2027 
u
[
i
][
j
-1][
k
][4]*
rho_i
[i][j-1][k]) -

2028 
ty2
 * ((
c1
*
u
[
i
][
j
+1][
k
][4] -

2029 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

2030 (
c1
*
u
[
i
][
j
-1][
k
][4] -

2031 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

2039 
j
 = 1;

2040 #´agm¨
omp
 
nowa™


2041 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2042 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2043 
m
 = 0; m < 5; m++) {

2044 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2045 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2046 
u
[
i
][
j
+2][
k
][
m
]);

2051 
j
 = 2;

2052 #´agm¨
omp
 
nowa™


2053 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2054 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2055 
m
 = 0; m < 5; m++) {

2056 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2057 (-4.0*
u
[
i
][
j
-1][
k
][
m
] + 6.0*u[i][j][k][m] -

2058 4.0*
u
[
i
][
j
+1][
k
][
m
] + u[i][j+2][k][m]);

2063 #´agm¨
omp
 
nowa™


2064 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2065 
j
 = 3; j < 
grid_pošts
[1]-3; j++) {

2066 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2067 
m
 = 0; m < 5; m++) {

2068 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2069 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2070 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] +

2071 
u
[
i
][
j
+2][
k
][
m
] );

2077 
j
 = 
grid_pošts
[1]-3;

2078 #´agm¨
omp
 
nowa™


2079 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2080 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2081 
m
 = 0; m < 5; m++) {

2082 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2083 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.0*u[i][j-1][k][m] +

2084 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j+1][k][m] );

2089 
j
 = 
grid_pošts
[1]-2;

2090 #´agm¨
omp
 

2091 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2092 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2093 
m
 = 0; m < 5; m++) {

2094 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2095 Ğ
u
[
i
][
j
-2][
k
][
m
] - 4.*u[i][j-1][k][m] +

2096 5.*
u
[
i
][
j
][
k
][
m
] );

2104 #´agm¨
omp
 

2105 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2106 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2107 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2108 
wijk
 = 
ws
[
i
][
j
][
k
];

2109 
wp1
 = 
ws
[
i
][
j
][
k
+1];

2110 
wm1
 = 
ws
[
i
][
j
][
k
-1];

2112 
rhs
[
i
][
j
][
k
][0] =„hs[i][j][k][0] + 
dz1tz1
 *

2113 (
u
[
i
][
j
][
k
+1][0] - 2.0*u[i][j][k][0] +

2114 
u
[
i
][
j
][
k
-1][0]) -

2115 
tz2
 * (
u
[
i
][
j
][
k
+1][3] - u[i][j][k-1][3]);

2116 
rhs
[
i
][
j
][
k
][1] =„hs[i][j][k][1] + 
dz2tz1
 *

2117 (
u
[
i
][
j
][
k
+1][1] - 2.0*u[i][j][k][1] +

2118 
u
[
i
][
j
][
k
-1][1]) +

2119 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

2120 
us
[
i
][
j
][
k
-1]) -

2121 
tz2
 * (
u
[
i
][
j
][
k
+1][1]*
wp1
 -

2122 
u
[
i
][
j
][
k
-1][1]*
wm1
);

2123 
rhs
[
i
][
j
][
k
][2] =„hs[i][j][k][2] + 
dz3tz1
 *

2124 (
u
[
i
][
j
][
k
+1][2] - 2.0*u[i][j][k][2] +

2125 
u
[
i
][
j
][
k
-1][2]) +

2126 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

2127 
vs
[
i
][
j
][
k
-1]) -

2128 
tz2
 * (
u
[
i
][
j
][
k
+1][2]*
wp1
 -

2129 
u
[
i
][
j
][
k
-1][2]*
wm1
);

2130 
rhs
[
i
][
j
][
k
][3] =„hs[i][j][k][3] + 
dz4tz1
 *

2131 (
u
[
i
][
j
][
k
+1][3] - 2.0*u[i][j][k][3] +

2132 
u
[
i
][
j
][
k
-1][3]) +

2133 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

2134 
tz2
 * (
u
[
i
][
j
][
k
+1][3]*
wp1
 -

2135 
u
[
i
][
j
][
k
-1][3]*
wm1
 +

2136 (
u
[
i
][
j
][
k
+1][4] - 
squ¬e
[i][j][k+1] -

2137 
u
[
i
][
j
][
k
-1][4] + 
squ¬e
[i][j][k-1])

2138 *
c2
);

2139 
rhs
[
i
][
j
][
k
][4] =„hs[i][j][k][4] + 
dz5tz1
 *

2140 (
u
[
i
][
j
][
k
+1][4] - 2.0*u[i][j][k][4] +

2141 
u
[
i
][
j
][
k
-1][4]) +

2142 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

2143 
qs
[
i
][
j
][
k
-1]) +

2144 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

2145 
wm1
*wm1) +

2146 
zzcÚ5
 * (
u
[
i
][
j
][
k
+1][4]*
rho_i
[i][j][k+1] -

2147 2.0*
u
[
i
][
j
][
k
][4]*
rho_i
[i][j][k] +

2148 
u
[
i
][
j
][
k
-1][4]*
rho_i
[i][j][k-1]) -

2149 
tz2
 * ( (
c1
*
u
[
i
][
j
][
k
+1][4] -

2150 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

2151 (
c1
*
u
[
i
][
j
][
k
-1][4] -

2152 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

2160 
k
 = 1;

2161 #´agm¨
omp
 
nowa™


2162 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2163 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2164 
m
 = 0; m < 5; m++) {

2165 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]- 
ds¥
 *

2166 Ğ5.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2167 
u
[
i
][
j
][
k
+2][
m
]);

2172 
k
 = 2;

2173 #´agm¨
omp
 
nowa™


2174 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2175 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2176 
m
 = 0; m < 5; m++) {

2177 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2178 (-4.0*
u
[
i
][
j
][
k
-1][
m
] + 6.0*u[i][j][k][m] -

2179 4.0*
u
[
i
][
j
][
k
+1][
m
] + u[i][j][k+2][m]);

2184 #´agm¨
omp
 
nowa™


2185 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2186 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2187 
k
 = 3; k < 
grid_pošts
[2]-3; k++) {

2188 
m
 = 0; m < 5; m++) {

2189 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2190 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2191 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] +

2192 
u
[
i
][
j
][
k
+2][
m
] );

2198 
k
 = 
grid_pošts
[2]-3;

2199 #´agm¨
omp
 
nowa™


2200 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2201 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2202 
m
 = 0; m < 5; m++) {

2203 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2204 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2205 6.0*
u
[
i
][
j
][
k
][
m
] - 4.0*u[i][j][k+1][m] );

2210 
k
 = 
grid_pošts
[2]-2;

2211 #´agm¨
omp
 

2212 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2213 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2214 
m
 = 0; m < 5; m++) {

2215 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] - 
ds¥
 *

2216 Ğ
u
[
i
][
j
][
k
-2][
m
] - 4.0*u[i][j][k-1][m] +

2217 5.0*
u
[
i
][
j
][
k
][
m
] );

2222 #´agm¨
omp
 

2223 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2224 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2225 
m
 = 0; m < 5; m++) {

2226 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

2227 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m] * 
dt
;

2232 
	}
}

2237 
	$£t_cÚ¡ªts
() {

2242 
û
[0][0] = 2.0;

2243 
û
[0][1] = 0.0;

2244 
û
[0][2] = 0.0;

2245 
û
[0][3] = 4.0;

2246 
û
[0][4] = 5.0;

2247 
û
[0][5] = 3.0;

2248 
û
[0][6] = 0.5;

2249 
û
[0][7] = 0.02;

2250 
û
[0][8] = 0.01;

2251 
û
[0][9] = 0.03;

2252 
û
[0][10] = 0.5;

2253 
û
[0][11] = 0.4;

2254 
û
[0][12] = 0.3;

2256 
û
[1][0] = 1.0;

2257 
û
[1][1] = 0.0;

2258 
û
[1][2] = 0.0;

2259 
û
[1][3] = 0.0;

2260 
û
[1][4] = 1.0;

2261 
û
[1][5] = 2.0;

2262 
û
[1][6] = 3.0;

2263 
û
[1][7] = 0.01;

2264 
û
[1][8] = 0.03;

2265 
û
[1][9] = 0.02;

2266 
û
[1][10] = 0.4;

2267 
û
[1][11] = 0.3;

2268 
û
[1][12] = 0.5;

2270 
û
[2][0] = 2.0;

2271 
û
[2][1] = 2.0;

2272 
û
[2][2] = 0.0;

2273 
û
[2][3] = 0.0;

2274 
û
[2][4] = 0.0;

2275 
û
[2][5] = 2.0;

2276 
û
[2][6] = 3.0;

2277 
û
[2][7] = 0.04;

2278 
û
[2][8] = 0.03;

2279 
û
[2][9] = 0.05;

2280 
û
[2][10] = 0.3;

2281 
û
[2][11] = 0.5;

2282 
û
[2][12] = 0.4;

2284 
û
[3][0] = 2.0;

2285 
û
[3][1] = 2.0;

2286 
û
[3][2] = 0.0;

2287 
û
[3][3] = 0.0;

2288 
û
[3][4] = 0.0;

2289 
û
[3][5] = 2.0;

2290 
û
[3][6] = 3.0;

2291 
û
[3][7] = 0.03;

2292 
û
[3][8] = 0.05;

2293 
û
[3][9] = 0.04;

2294 
û
[3][10] = 0.2;

2295 
û
[3][11] = 0.1;

2296 
û
[3][12] = 0.3;

2298 
û
[4][0] = 5.0;

2299 
û
[4][1] = 4.0;

2300 
û
[4][2] = 3.0;

2301 
û
[4][3] = 2.0;

2302 
û
[4][4] = 0.1;

2303 
û
[4][5] = 0.4;

2304 
û
[4][6] = 0.3;

2305 
û
[4][7] = 0.05;

2306 
û
[4][8] = 0.04;

2307 
û
[4][9] = 0.03;

2308 
û
[4][10] = 0.1;

2309 
û
[4][11] = 0.3;

2310 
û
[4][12] = 0.2;

2312 
c1
 = 1.4;

2313 
c2
 = 0.4;

2314 
c3
 = 0.1;

2315 
c4
 = 1.0;

2316 
c5
 = 1.4;

2318 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

2319 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

2320 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

2322 
c1c2
 = 
c1
 * 
c2
;

2323 
c1c5
 = 
c1
 * 
c5
;

2324 
c3c4
 = 
c3
 * 
c4
;

2325 
c1345
 = 
c1c5
 * 
c3c4
;

2327 
cÚz1
 = (1.0-
c1c5
);

2329 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

2330 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

2331 
tx3
 = 1.0 / 
dnxm1
;

2333 
ty1
 = 1.0 / (
dnym1
 * dnym1);

2334 
ty2
 = 1.0 / (2.0 * 
dnym1
);

2335 
ty3
 = 1.0 / 
dnym1
;

2337 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

2338 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

2339 
tz3
 = 1.0 / 
dnzm1
;

2341 
dx1
 = 0.75;

2342 
dx2
 = 0.75;

2343 
dx3
 = 0.75;

2344 
dx4
 = 0.75;

2345 
dx5
 = 0.75;

2347 
dy1
 = 0.75;

2348 
dy2
 = 0.75;

2349 
dy3
 = 0.75;

2350 
dy4
 = 0.75;

2351 
dy5
 = 0.75;

2353 
dz1
 = 1.0;

2354 
dz2
 = 1.0;

2355 
dz3
 = 1.0;

2356 
dz4
 = 1.0;

2357 
dz5
 = 1.0;

2359 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

2360 
dymax
 = 
	`max
(
dy2
, 
dy4
);

2361 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

2363 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

2365 
c4ds¥
 = 4.0 * 
ds¥
;

2366 
c5ds¥
 = 5.0 * 
ds¥
;

2368 
d‰x1
 = 
dt
*
tx1
;

2369 
d‰x2
 = 
dt
*
tx2
;

2370 
d‰y1
 = 
dt
*
ty1
;

2371 
d‰y2
 = 
dt
*
ty2
;

2372 
d‰z1
 = 
dt
*
tz1
;

2373 
d‰z2
 = 
dt
*
tz2
;

2375 
c2d‰x1
 = 2.0*
d‰x1
;

2376 
c2d‰y1
 = 2.0*
d‰y1
;

2377 
c2d‰z1
 = 2.0*
d‰z1
;

2379 
dtds¥
 = 
dt
*
ds¥
;

2381 
comz1
 = 
dtds¥
;

2382 
comz4
 = 4.0*
dtds¥
;

2383 
comz5
 = 5.0*
dtds¥
;

2384 
comz6
 = 6.0*
dtds¥
;

2386 
c3c4tx3
 = 
c3c4
*
tx3
;

2387 
c3c4ty3
 = 
c3c4
*
ty3
;

2388 
c3c4tz3
 = 
c3c4
*
tz3
;

2390 
dx1tx1
 = 
dx1
*
tx1
;

2391 
dx2tx1
 = 
dx2
*
tx1
;

2392 
dx3tx1
 = 
dx3
*
tx1
;

2393 
dx4tx1
 = 
dx4
*
tx1
;

2394 
dx5tx1
 = 
dx5
*
tx1
;

2396 
dy1ty1
 = 
dy1
*
ty1
;

2397 
dy2ty1
 = 
dy2
*
ty1
;

2398 
dy3ty1
 = 
dy3
*
ty1
;

2399 
dy4ty1
 = 
dy4
*
ty1
;

2400 
dy5ty1
 = 
dy5
*
ty1
;

2402 
dz1tz1
 = 
dz1
*
tz1
;

2403 
dz2tz1
 = 
dz2
*
tz1
;

2404 
dz3tz1
 = 
dz3
*
tz1
;

2405 
dz4tz1
 = 
dz4
*
tz1
;

2406 
dz5tz1
 = 
dz5
*
tz1
;

2408 
c2iv
 = 2.5;

2409 
cÚ43
 = 4.0/3.0;

2410 
cÚ16
 = 1.0/6.0;

2412 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

2413 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

2414 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

2415 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

2416 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

2418 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

2419 
yycÚ2
 = 
c3c4ty3
*
ty3
;

2420 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

2421 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

2422 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

2424 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

2425 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

2426 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

2427 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

2428 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

2429 
	}
}

2434 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2443 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2444 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2445 
m
;

2450 
•sÚ
 = 1.0e-08;

2456 
	`”rÜ_nÜm
(
xû
);

2457 
	`compu‹_rhs
();

2459 
	`rhs_nÜm
(
xü
);

2461 
m
 = 0; m < 5; m++) {

2462 
xü
[
m
] = xü[m] / 
dt
;

2465 *
şass
 = 'U';

2466 *
v”if›d
 = 
TRUE
;

2468 
m
 = 0; m < 5; m++) {

2469 
xü»f
[
m
] = 1.0;

2470 
xû»f
[
m
] = 1.0;

2476 ià(
grid_pošts
[0] == 12 &&

2477 
grid_pošts
[1] == 12 &&

2478 
grid_pošts
[2] == 12 &&

2479 
no_time_¡•s
 == 60) {

2481 *
şass
 = 'S';

2482 
dŒef
 = 1.0e-2;

2487 
xü»f
[0] = 1.7034283709541311e-01;

2488 
xü»f
[1] = 1.2975252070034097e-02;

2489 
xü»f
[2] = 3.2527926989486055e-02;

2490 
xü»f
[3] = 2.6436421275166801e-02;

2491 
xü»f
[4] = 1.9211784131744430e-01;

2496 
xû»f
[0] = 4.9976913345811579e-04;

2497 
xû»f
[1] = 4.5195666782961927e-05;

2498 
xû»f
[2] = 7.3973765172921357e-05;

2499 
xû»f
[3] = 7.3821238632439731e-05;

2500 
xû»f
[4] = 8.9269630987491446e-04;

2505 } ià(
grid_pošts
[0] == 24 &&

2506 
grid_pošts
[1] == 24 &&

2507 
grid_pošts
[2] == 24 &&

2508 
no_time_¡•s
 == 200) {

2510 *
şass
 = 'W';

2511 
dŒef
 = 0.8e-3;

2515 
xü»f
[0] = 0.1125590409344e+03;

2516 
xü»f
[1] = 0.1180007595731e+02;

2517 
xü»f
[2] = 0.2710329767846e+02;

2518 
xü»f
[3] = 0.2469174937669e+02;

2519 
xü»f
[4] = 0.2638427874317e+03;

2524 
xû»f
[0] = 0.4419655736008e+01;

2525 
xû»f
[1] = 0.4638531260002e+00;

2526 
xû»f
[2] = 0.1011551749967e+01;

2527 
xû»f
[3] = 0.9235878729944e+00;

2528 
xû»f
[4] = 0.1018045837718e+02;

2534 } ià(
grid_pošts
[0] == 64 &&

2535 
grid_pošts
[1] == 64 &&

2536 
grid_pošts
[2] == 64 &&

2537 
no_time_¡•s
 == 200) {

2539 *
şass
 = 'A';

2540 
dŒef
 = 0.8e-3;

2544 
xü»f
[0] = 1.0806346714637264e+02;

2545 
xü»f
[1] = 1.1319730901220813e+01;

2546 
xü»f
[2] = 2.5974354511582465e+01;

2547 
xü»f
[3] = 2.3665622544678910e+01;

2548 
xü»f
[4] = 2.5278963211748344e+02;

2553 
xû»f
[0] = 4.2348416040525025e+00;

2554 
xû»f
[1] = 4.4390282496995698e-01;

2555 
xû»f
[2] = 9.6692480136345650e-01;

2556 
xû»f
[3] = 8.8302063039765474e-01;

2557 
xû»f
[4] = 9.7379901770829278e+00;

2563 } ià(
grid_pošts
[0] == 102 &&

2564 
grid_pošts
[1] == 102 &&

2565 
grid_pošts
[2] == 102 &&

2566 
no_time_¡•s
 == 200) {

2568 *
şass
 = 'B';

2569 
dŒef
 = 3.0e-4;

2574 
xü»f
[0] = 1.4233597229287254e+03;

2575 
xü»f
[1] = 9.9330522590150238e+01;

2576 
xü»f
[2] = 3.5646025644535285e+02;

2577 
xü»f
[3] = 3.2485447959084092e+02;

2578 
xü»f
[4] = 3.2707541254659363e+03;

2583 
xû»f
[0] = 5.2969847140936856e+01;

2584 
xû»f
[1] = 4.4632896115670668e+00;

2585 
xû»f
[2] = 1.3122573342210174e+01;

2586 
xû»f
[3] = 1.2006925323559144e+01;

2587 
xû»f
[4] = 1.2459576151035986e+02;

2593 } ià(
grid_pošts
[0] == 162 &&

2594 
grid_pošts
[1] == 162 &&

2595 
grid_pošts
[2] == 162 &&

2596 
no_time_¡•s
 == 200) {

2598 *
şass
 = 'C';

2599 
dŒef
 = 1.0e-4;

2604 
xü»f
[0] = 0.62398116551764615e+04;

2605 
xü»f
[1] = 0.50793239190423964e+03;

2606 
xü»f
[2] = 0.15423530093013596e+04;

2607 
xü»f
[3] = 0.13302387929291190e+04;

2608 
xü»f
[4] = 0.11604087428436455e+05;

2613 
xû»f
[0] = 0.16462008369091265e+03;

2614 
xû»f
[1] = 0.11497107903824313e+02;

2615 
xû»f
[2] = 0.41207446207461508e+02;

2616 
xû»f
[3] = 0.37087651059694167e+02;

2617 
xû»f
[4] = 0.36211053051841265e+03;

2620 *
v”if›d
 = 
FALSE
;

2631 
m
 = 0; m < 5; m++) {

2633 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

2634 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2642 ià(*
şass
 != 'U') {

2643 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2644 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2645 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2646 *
v”if›d
 = 
FALSE
;

2647 *
şass
 = 'U';

2648 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2651 
	`´štf
(" Unknown class\n");

2654 ià(*
şass
 != 'U') {

2655 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2657 
	`´štf
(" RMS-norms of„esidual\n");

2659 
m
 = 0; m < 5; m++) {

2660 ià(*
şass
 == 'U') {

2661 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2662 } ià(
xüdif
[
m
] > 
•sÚ
) {

2663 *
v”if›d
 = 
FALSE
;

2664 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2665 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2667 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2668 
m
, 
xü
[m], 
xü»f
[m], 
xüdif
[m]);

2672 ià(*
şass
 != 'U') {

2673 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2675 
	`´štf
(" RMS-norms of solutionƒrror\n");

2678 
m
 = 0; m < 5; m++) {

2679 ià(*
şass
 == 'U') {

2680 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2681 } ià(
xûdif
[
m
] > 
•sÚ
) {

2682 *
v”if›d
 = 
FALSE
;

2683 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2684 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2686 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2687 
m
, 
xû
[m], 
xû»f
[m], 
xûdif
[m]);

2691 ià(*
şass
 == 'U') {

2692 
	`´štf
(" No„eference values…rovided\n");

2693 
	`´štf
(" No verification…erformed\n");

2694 } ià(*
v”if›d
 =ğ
TRUE
) {

2695 
	`´štf
(" Verification Successful\n");

2697 
	`´štf
(" Verification failed\n");

2699 
	}
}

2704 
	$x_sŞve
() {

2721 
	`lhsx
();

2722 
	`x_sŞve_ûÎ
();

2723 
	`x_backsub¡™u‹
();

2724 
	}
}

2730 
	$x_backsub¡™u‹
() {

2742 
i
, 
j
, 
k
, 
m
, 
n
;

2744 
i
 = 
grid_pošts
[0]-2; i >= 0; i--) {

2745 #´agm¨
omp
 

2746 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2747 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2748 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

2749 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

2750 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

2751 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i+1][j][k][n];

2757 
	}
}

2762 
	$x_sŞve_ûÎ
() {

2774 
i
,
j
,
k
,
isize
;

2776 
isize
 = 
grid_pošts
[0]-1;

2781 #´agm¨
omp
 

2782 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2783 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2789 
	`bšvühs
Ğ
lhs
[0][
j
][
k
][
BB
],

2790 
lhs
[0][
j
][
k
][
CC
],

2791 
rhs
[0][
j
][
k
] );

2799 
i
 = 1; i < 
isize
; i++) {

2800 #´agm¨
omp
 

2801 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2802 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2807 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2808 
rhs
[
i
-1][
j
][
k
],„hs[i][j][k]);

2813 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

2814 
lhs
[
i
-1][
j
][
k
][
CC
],

2815 
lhs
[
i
][
j
][
k
][
BB
]);

2822 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2823 
lhs
[
i
][
j
][
k
][
CC
],

2824 
rhs
[
i
][
j
][
k
] );

2830 #´agm¨
omp
 

2831 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

2832 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

2837 
	`m©vec_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2838 
rhs
[
isize
-1][
j
][
k
],„hs[isize][j][k]);

2843 
	`m©mul_sub
(
lhs
[
isize
][
j
][
k
][
AA
],

2844 
lhs
[
isize
-1][
j
][
k
][
CC
],

2845 
lhs
[
isize
][
j
][
k
][
BB
]);

2850 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

2851 
rhs
[
i
][
j
][
k
] );

2855 
	}
}

2860 
	$m©vec_sub
(
ablock
[5][5], 
avec
[5], 
bvec
[5]) {

2869 
i
;

2871 
i
 = 0; i < 5; i++) {

2876 
bvec
[
i
] = bvec[i] - 
ablock
[i][0]*
avec
[0]

2877 - 
ablock
[
i
][1]*
avec
[1]

2878 - 
ablock
[
i
][2]*
avec
[2]

2879 - 
ablock
[
i
][3]*
avec
[3]

2880 - 
ablock
[
i
][4]*
avec
[4];

2882 
	}
}

2887 
	$m©mul_sub
(
ablock
[5][5], 
bblock
[5][5],

2888 
cblock
[5][5]) {

2897 
j
;

2899 
j
 = 0; j < 5; j++) {

2900 
cblock
[0][
j
] = cblock[0][j] - 
ablock
[0][0]*
bblock
[0][j]

2901 - 
ablock
[0][1]*
bblock
[1][
j
]

2902 - 
ablock
[0][2]*
bblock
[2][
j
]

2903 - 
ablock
[0][3]*
bblock
[3][
j
]

2904 - 
ablock
[0][4]*
bblock
[4][
j
];

2905 
cblock
[1][
j
] = cblock[1][j] - 
ablock
[1][0]*
bblock
[0][j]

2906 - 
ablock
[1][1]*
bblock
[1][
j
]

2907 - 
ablock
[1][2]*
bblock
[2][
j
]

2908 - 
ablock
[1][3]*
bblock
[3][
j
]

2909 - 
ablock
[1][4]*
bblock
[4][
j
];

2910 
cblock
[2][
j
] = cblock[2][j] - 
ablock
[2][0]*
bblock
[0][j]

2911 - 
ablock
[2][1]*
bblock
[1][
j
]

2912 - 
ablock
[2][2]*
bblock
[2][
j
]

2913 - 
ablock
[2][3]*
bblock
[3][
j
]

2914 - 
ablock
[2][4]*
bblock
[4][
j
];

2915 
cblock
[3][
j
] = cblock[3][j] - 
ablock
[3][0]*
bblock
[0][j]

2916 - 
ablock
[3][1]*
bblock
[1][
j
]

2917 - 
ablock
[3][2]*
bblock
[2][
j
]

2918 - 
ablock
[3][3]*
bblock
[3][
j
]

2919 - 
ablock
[3][4]*
bblock
[4][
j
];

2920 
cblock
[4][
j
] = cblock[4][j] - 
ablock
[4][0]*
bblock
[0][j]

2921 - 
ablock
[4][1]*
bblock
[1][
j
]

2922 - 
ablock
[4][2]*
bblock
[2][
j
]

2923 - 
ablock
[4][3]*
bblock
[3][
j
]

2924 - 
ablock
[4][4]*
bblock
[4][
j
];

2926 
	}
}

2931 
	$bšvühs
(
lhs
[5][5], 
c
[5][5], 
r
[5]) {

2936 
pivÙ
, 
cÛff
;

2942 
pivÙ
 = 1.00/
lhs
[0][0];

2943 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

2944 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

2945 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

2946 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

2947 
c
[0][0] = c[0][0]*
pivÙ
;

2948 
c
[0][1] = c[0][1]*
pivÙ
;

2949 
c
[0][2] = c[0][2]*
pivÙ
;

2950 
c
[0][3] = c[0][3]*
pivÙ
;

2951 
c
[0][4] = c[0][4]*
pivÙ
;

2952 
r
[0] =„[0] *
pivÙ
;

2954 
cÛff
 = 
lhs
[1][0];

2955 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

2956 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

2957 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

2958 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

2959 
c
[1][0] = c[1][0] - 
cÛff
*c[0][0];

2960 
c
[1][1] = c[1][1] - 
cÛff
*c[0][1];

2961 
c
[1][2] = c[1][2] - 
cÛff
*c[0][2];

2962 
c
[1][3] = c[1][3] - 
cÛff
*c[0][3];

2963 
c
[1][4] = c[1][4] - 
cÛff
*c[0][4];

2964 
r
[1] =„[1] - 
cÛff
*r[0];

2966 
cÛff
 = 
lhs
[2][0];

2967 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

2968 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

2969 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

2970 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

2971 
c
[2][0] = c[2][0] - 
cÛff
*c[0][0];

2972 
c
[2][1] = c[2][1] - 
cÛff
*c[0][1];

2973 
c
[2][2] = c[2][2] - 
cÛff
*c[0][2];

2974 
c
[2][3] = c[2][3] - 
cÛff
*c[0][3];

2975 
c
[2][4] = c[2][4] - 
cÛff
*c[0][4];

2976 
r
[2] =„[2] - 
cÛff
*r[0];

2978 
cÛff
 = 
lhs
[3][0];

2979 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

2980 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

2981 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

2982 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

2983 
c
[3][0] = c[3][0] - 
cÛff
*c[0][0];

2984 
c
[3][1] = c[3][1] - 
cÛff
*c[0][1];

2985 
c
[3][2] = c[3][2] - 
cÛff
*c[0][2];

2986 
c
[3][3] = c[3][3] - 
cÛff
*c[0][3];

2987 
c
[3][4] = c[3][4] - 
cÛff
*c[0][4];

2988 
r
[3] =„[3] - 
cÛff
*r[0];

2990 
cÛff
 = 
lhs
[4][0];

2991 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

2992 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

2993 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

2994 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

2995 
c
[4][0] = c[4][0] - 
cÛff
*c[0][0];

2996 
c
[4][1] = c[4][1] - 
cÛff
*c[0][1];

2997 
c
[4][2] = c[4][2] - 
cÛff
*c[0][2];

2998 
c
[4][3] = c[4][3] - 
cÛff
*c[0][3];

2999 
c
[4][4] = c[4][4] - 
cÛff
*c[0][4];

3000 
r
[4] =„[4] - 
cÛff
*r[0];

3003 
pivÙ
 = 1.00/
lhs
[1][1];

3004 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3005 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3006 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3007 
c
[1][0] = c[1][0]*
pivÙ
;

3008 
c
[1][1] = c[1][1]*
pivÙ
;

3009 
c
[1][2] = c[1][2]*
pivÙ
;

3010 
c
[1][3] = c[1][3]*
pivÙ
;

3011 
c
[1][4] = c[1][4]*
pivÙ
;

3012 
r
[1] =„[1] *
pivÙ
;

3014 
cÛff
 = 
lhs
[0][1];

3015 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3016 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3017 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3018 
c
[0][0] = c[0][0] - 
cÛff
*c[1][0];

3019 
c
[0][1] = c[0][1] - 
cÛff
*c[1][1];

3020 
c
[0][2] = c[0][2] - 
cÛff
*c[1][2];

3021 
c
[0][3] = c[0][3] - 
cÛff
*c[1][3];

3022 
c
[0][4] = c[0][4] - 
cÛff
*c[1][4];

3023 
r
[0] =„[0] - 
cÛff
*r[1];

3025 
cÛff
 = 
lhs
[2][1];

3026 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3027 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3028 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3029 
c
[2][0] = c[2][0] - 
cÛff
*c[1][0];

3030 
c
[2][1] = c[2][1] - 
cÛff
*c[1][1];

3031 
c
[2][2] = c[2][2] - 
cÛff
*c[1][2];

3032 
c
[2][3] = c[2][3] - 
cÛff
*c[1][3];

3033 
c
[2][4] = c[2][4] - 
cÛff
*c[1][4];

3034 
r
[2] =„[2] - 
cÛff
*r[1];

3036 
cÛff
 = 
lhs
[3][1];

3037 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3038 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3039 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3040 
c
[3][0] = c[3][0] - 
cÛff
*c[1][0];

3041 
c
[3][1] = c[3][1] - 
cÛff
*c[1][1];

3042 
c
[3][2] = c[3][2] - 
cÛff
*c[1][2];

3043 
c
[3][3] = c[3][3] - 
cÛff
*c[1][3];

3044 
c
[3][4] = c[3][4] - 
cÛff
*c[1][4];

3045 
r
[3] =„[3] - 
cÛff
*r[1];

3047 
cÛff
 = 
lhs
[4][1];

3048 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3049 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3050 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3051 
c
[4][0] = c[4][0] - 
cÛff
*c[1][0];

3052 
c
[4][1] = c[4][1] - 
cÛff
*c[1][1];

3053 
c
[4][2] = c[4][2] - 
cÛff
*c[1][2];

3054 
c
[4][3] = c[4][3] - 
cÛff
*c[1][3];

3055 
c
[4][4] = c[4][4] - 
cÛff
*c[1][4];

3056 
r
[4] =„[4] - 
cÛff
*r[1];

3059 
pivÙ
 = 1.00/
lhs
[2][2];

3060 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3061 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3062 
c
[2][0] = c[2][0]*
pivÙ
;

3063 
c
[2][1] = c[2][1]*
pivÙ
;

3064 
c
[2][2] = c[2][2]*
pivÙ
;

3065 
c
[2][3] = c[2][3]*
pivÙ
;

3066 
c
[2][4] = c[2][4]*
pivÙ
;

3067 
r
[2] =„[2] *
pivÙ
;

3069 
cÛff
 = 
lhs
[0][2];

3070 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3071 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3072 
c
[0][0] = c[0][0] - 
cÛff
*c[2][0];

3073 
c
[0][1] = c[0][1] - 
cÛff
*c[2][1];

3074 
c
[0][2] = c[0][2] - 
cÛff
*c[2][2];

3075 
c
[0][3] = c[0][3] - 
cÛff
*c[2][3];

3076 
c
[0][4] = c[0][4] - 
cÛff
*c[2][4];

3077 
r
[0] =„[0] - 
cÛff
*r[2];

3079 
cÛff
 = 
lhs
[1][2];

3080 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3081 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3082 
c
[1][0] = c[1][0] - 
cÛff
*c[2][0];

3083 
c
[1][1] = c[1][1] - 
cÛff
*c[2][1];

3084 
c
[1][2] = c[1][2] - 
cÛff
*c[2][2];

3085 
c
[1][3] = c[1][3] - 
cÛff
*c[2][3];

3086 
c
[1][4] = c[1][4] - 
cÛff
*c[2][4];

3087 
r
[1] =„[1] - 
cÛff
*r[2];

3089 
cÛff
 = 
lhs
[3][2];

3090 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3091 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3092 
c
[3][0] = c[3][0] - 
cÛff
*c[2][0];

3093 
c
[3][1] = c[3][1] - 
cÛff
*c[2][1];

3094 
c
[3][2] = c[3][2] - 
cÛff
*c[2][2];

3095 
c
[3][3] = c[3][3] - 
cÛff
*c[2][3];

3096 
c
[3][4] = c[3][4] - 
cÛff
*c[2][4];

3097 
r
[3] =„[3] - 
cÛff
*r[2];

3099 
cÛff
 = 
lhs
[4][2];

3100 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3101 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3102 
c
[4][0] = c[4][0] - 
cÛff
*c[2][0];

3103 
c
[4][1] = c[4][1] - 
cÛff
*c[2][1];

3104 
c
[4][2] = c[4][2] - 
cÛff
*c[2][2];

3105 
c
[4][3] = c[4][3] - 
cÛff
*c[2][3];

3106 
c
[4][4] = c[4][4] - 
cÛff
*c[2][4];

3107 
r
[4] =„[4] - 
cÛff
*r[2];

3110 
pivÙ
 = 1.00/
lhs
[3][3];

3111 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3112 
c
[3][0] = c[3][0]*
pivÙ
;

3113 
c
[3][1] = c[3][1]*
pivÙ
;

3114 
c
[3][2] = c[3][2]*
pivÙ
;

3115 
c
[3][3] = c[3][3]*
pivÙ
;

3116 
c
[3][4] = c[3][4]*
pivÙ
;

3117 
r
[3] =„[3] *
pivÙ
;

3119 
cÛff
 = 
lhs
[0][3];

3120 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3121 
c
[0][0] = c[0][0] - 
cÛff
*c[3][0];

3122 
c
[0][1] = c[0][1] - 
cÛff
*c[3][1];

3123 
c
[0][2] = c[0][2] - 
cÛff
*c[3][2];

3124 
c
[0][3] = c[0][3] - 
cÛff
*c[3][3];

3125 
c
[0][4] = c[0][4] - 
cÛff
*c[3][4];

3126 
r
[0] =„[0] - 
cÛff
*r[3];

3128 
cÛff
 = 
lhs
[1][3];

3129 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3130 
c
[1][0] = c[1][0] - 
cÛff
*c[3][0];

3131 
c
[1][1] = c[1][1] - 
cÛff
*c[3][1];

3132 
c
[1][2] = c[1][2] - 
cÛff
*c[3][2];

3133 
c
[1][3] = c[1][3] - 
cÛff
*c[3][3];

3134 
c
[1][4] = c[1][4] - 
cÛff
*c[3][4];

3135 
r
[1] =„[1] - 
cÛff
*r[3];

3137 
cÛff
 = 
lhs
[2][3];

3138 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3139 
c
[2][0] = c[2][0] - 
cÛff
*c[3][0];

3140 
c
[2][1] = c[2][1] - 
cÛff
*c[3][1];

3141 
c
[2][2] = c[2][2] - 
cÛff
*c[3][2];

3142 
c
[2][3] = c[2][3] - 
cÛff
*c[3][3];

3143 
c
[2][4] = c[2][4] - 
cÛff
*c[3][4];

3144 
r
[2] =„[2] - 
cÛff
*r[3];

3146 
cÛff
 = 
lhs
[4][3];

3147 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3148 
c
[4][0] = c[4][0] - 
cÛff
*c[3][0];

3149 
c
[4][1] = c[4][1] - 
cÛff
*c[3][1];

3150 
c
[4][2] = c[4][2] - 
cÛff
*c[3][2];

3151 
c
[4][3] = c[4][3] - 
cÛff
*c[3][3];

3152 
c
[4][4] = c[4][4] - 
cÛff
*c[3][4];

3153 
r
[4] =„[4] - 
cÛff
*r[3];

3156 
pivÙ
 = 1.00/
lhs
[4][4];

3157 
c
[4][0] = c[4][0]*
pivÙ
;

3158 
c
[4][1] = c[4][1]*
pivÙ
;

3159 
c
[4][2] = c[4][2]*
pivÙ
;

3160 
c
[4][3] = c[4][3]*
pivÙ
;

3161 
c
[4][4] = c[4][4]*
pivÙ
;

3162 
r
[4] =„[4] *
pivÙ
;

3164 
cÛff
 = 
lhs
[0][4];

3165 
c
[0][0] = c[0][0] - 
cÛff
*c[4][0];

3166 
c
[0][1] = c[0][1] - 
cÛff
*c[4][1];

3167 
c
[0][2] = c[0][2] - 
cÛff
*c[4][2];

3168 
c
[0][3] = c[0][3] - 
cÛff
*c[4][3];

3169 
c
[0][4] = c[0][4] - 
cÛff
*c[4][4];

3170 
r
[0] =„[0] - 
cÛff
*r[4];

3172 
cÛff
 = 
lhs
[1][4];

3173 
c
[1][0] = c[1][0] - 
cÛff
*c[4][0];

3174 
c
[1][1] = c[1][1] - 
cÛff
*c[4][1];

3175 
c
[1][2] = c[1][2] - 
cÛff
*c[4][2];

3176 
c
[1][3] = c[1][3] - 
cÛff
*c[4][3];

3177 
c
[1][4] = c[1][4] - 
cÛff
*c[4][4];

3178 
r
[1] =„[1] - 
cÛff
*r[4];

3180 
cÛff
 = 
lhs
[2][4];

3181 
c
[2][0] = c[2][0] - 
cÛff
*c[4][0];

3182 
c
[2][1] = c[2][1] - 
cÛff
*c[4][1];

3183 
c
[2][2] = c[2][2] - 
cÛff
*c[4][2];

3184 
c
[2][3] = c[2][3] - 
cÛff
*c[4][3];

3185 
c
[2][4] = c[2][4] - 
cÛff
*c[4][4];

3186 
r
[2] =„[2] - 
cÛff
*r[4];

3188 
cÛff
 = 
lhs
[3][4];

3189 
c
[3][0] = c[3][0] - 
cÛff
*c[4][0];

3190 
c
[3][1] = c[3][1] - 
cÛff
*c[4][1];

3191 
c
[3][2] = c[3][2] - 
cÛff
*c[4][2];

3192 
c
[3][3] = c[3][3] - 
cÛff
*c[4][3];

3193 
c
[3][4] = c[3][4] - 
cÛff
*c[4][4];

3194 
r
[3] =„[3] - 
cÛff
*r[4];

3195 
	}
}

3200 
	$bšvrhs
Ğ
lhs
[5][5], 
r
[5] ) {

3205 
pivÙ
, 
cÛff
;

3211 
pivÙ
 = 1.00/
lhs
[0][0];

3212 
lhs
[0][1] =†hs[0][1]*
pivÙ
;

3213 
lhs
[0][2] =†hs[0][2]*
pivÙ
;

3214 
lhs
[0][3] =†hs[0][3]*
pivÙ
;

3215 
lhs
[0][4] =†hs[0][4]*
pivÙ
;

3216 
r
[0] =„[0] *
pivÙ
;

3218 
cÛff
 = 
lhs
[1][0];

3219 
lhs
[1][1]ğlhs[1][1] - 
cÛff
*lhs[0][1];

3220 
lhs
[1][2]ğlhs[1][2] - 
cÛff
*lhs[0][2];

3221 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[0][3];

3222 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[0][4];

3223 
r
[1] =„[1] - 
cÛff
*r[0];

3225 
cÛff
 = 
lhs
[2][0];

3226 
lhs
[2][1]ğlhs[2][1] - 
cÛff
*lhs[0][1];

3227 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[0][2];

3228 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[0][3];

3229 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[0][4];

3230 
r
[2] =„[2] - 
cÛff
*r[0];

3232 
cÛff
 = 
lhs
[3][0];

3233 
lhs
[3][1]ğlhs[3][1] - 
cÛff
*lhs[0][1];

3234 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[0][2];

3235 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[0][3];

3236 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[0][4];

3237 
r
[3] =„[3] - 
cÛff
*r[0];

3239 
cÛff
 = 
lhs
[4][0];

3240 
lhs
[4][1]ğlhs[4][1] - 
cÛff
*lhs[0][1];

3241 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[0][2];

3242 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[0][3];

3243 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[0][4];

3244 
r
[4] =„[4] - 
cÛff
*r[0];

3247 
pivÙ
 = 1.00/
lhs
[1][1];

3248 
lhs
[1][2] =†hs[1][2]*
pivÙ
;

3249 
lhs
[1][3] =†hs[1][3]*
pivÙ
;

3250 
lhs
[1][4] =†hs[1][4]*
pivÙ
;

3251 
r
[1] =„[1] *
pivÙ
;

3253 
cÛff
 = 
lhs
[0][1];

3254 
lhs
[0][2]ğlhs[0][2] - 
cÛff
*lhs[1][2];

3255 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[1][3];

3256 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[1][4];

3257 
r
[0] =„[0] - 
cÛff
*r[1];

3259 
cÛff
 = 
lhs
[2][1];

3260 
lhs
[2][2]ğlhs[2][2] - 
cÛff
*lhs[1][2];

3261 
lhs
[2][3]ğlhs[2][3] - 
cÛff
*lhs[1][3];

3262 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[1][4];

3263 
r
[2] =„[2] - 
cÛff
*r[1];

3265 
cÛff
 = 
lhs
[3][1];

3266 
lhs
[3][2]ğlhs[3][2] - 
cÛff
*lhs[1][2];

3267 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[1][3];

3268 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[1][4];

3269 
r
[3] =„[3] - 
cÛff
*r[1];

3271 
cÛff
 = 
lhs
[4][1];

3272 
lhs
[4][2]ğlhs[4][2] - 
cÛff
*lhs[1][2];

3273 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[1][3];

3274 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[1][4];

3275 
r
[4] =„[4] - 
cÛff
*r[1];

3278 
pivÙ
 = 1.00/
lhs
[2][2];

3279 
lhs
[2][3] =†hs[2][3]*
pivÙ
;

3280 
lhs
[2][4] =†hs[2][4]*
pivÙ
;

3281 
r
[2] =„[2] *
pivÙ
;

3283 
cÛff
 = 
lhs
[0][2];

3284 
lhs
[0][3]ğlhs[0][3] - 
cÛff
*lhs[2][3];

3285 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[2][4];

3286 
r
[0] =„[0] - 
cÛff
*r[2];

3288 
cÛff
 = 
lhs
[1][2];

3289 
lhs
[1][3]ğlhs[1][3] - 
cÛff
*lhs[2][3];

3290 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[2][4];

3291 
r
[1] =„[1] - 
cÛff
*r[2];

3293 
cÛff
 = 
lhs
[3][2];

3294 
lhs
[3][3]ğlhs[3][3] - 
cÛff
*lhs[2][3];

3295 
lhs
[3][4]ğlhs[3][4] - 
cÛff
*lhs[2][4];

3296 
r
[3] =„[3] - 
cÛff
*r[2];

3298 
cÛff
 = 
lhs
[4][2];

3299 
lhs
[4][3]ğlhs[4][3] - 
cÛff
*lhs[2][3];

3300 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[2][4];

3301 
r
[4] =„[4] - 
cÛff
*r[2];

3304 
pivÙ
 = 1.00/
lhs
[3][3];

3305 
lhs
[3][4] =†hs[3][4]*
pivÙ
;

3306 
r
[3] =„[3] *
pivÙ
;

3308 
cÛff
 = 
lhs
[0][3];

3309 
lhs
[0][4]ğlhs[0][4] - 
cÛff
*lhs[3][4];

3310 
r
[0] =„[0] - 
cÛff
*r[3];

3312 
cÛff
 = 
lhs
[1][3];

3313 
lhs
[1][4]ğlhs[1][4] - 
cÛff
*lhs[3][4];

3314 
r
[1] =„[1] - 
cÛff
*r[3];

3316 
cÛff
 = 
lhs
[2][3];

3317 
lhs
[2][4]ğlhs[2][4] - 
cÛff
*lhs[3][4];

3318 
r
[2] =„[2] - 
cÛff
*r[3];

3320 
cÛff
 = 
lhs
[4][3];

3321 
lhs
[4][4]ğlhs[4][4] - 
cÛff
*lhs[3][4];

3322 
r
[4] =„[4] - 
cÛff
*r[3];

3325 
pivÙ
 = 1.00/
lhs
[4][4];

3326 
r
[4] =„[4] *
pivÙ
;

3328 
cÛff
 = 
lhs
[0][4];

3329 
r
[0] =„[0] - 
cÛff
*r[4];

3331 
cÛff
 = 
lhs
[1][4];

3332 
r
[1] =„[1] - 
cÛff
*r[4];

3334 
cÛff
 = 
lhs
[2][4];

3335 
r
[2] =„[2] - 
cÛff
*r[4];

3337 
cÛff
 = 
lhs
[3][4];

3338 
r
[3] =„[3] - 
cÛff
*r[4];

3340 
	}
}

3345 
	$y_sŞve
() {

3360 
	`lhsy
();

3361 
	`y_sŞve_ûÎ
();

3362 
	`y_backsub¡™u‹
();

3363 
	}
}

3369 
	$y_backsub¡™u‹
() {

3381 
i
, 
j
, 
k
, 
m
, 
n
;

3383 
j
 = 
grid_pošts
[1]-2; j >= 0; j--) {

3384 #´agm¨
omp
 

3385 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3386 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3387 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3388 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3389 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3390 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j+1][k][n];

3396 
	}
}

3401 
	$y_sŞve_ûÎ
() {

3416 
i
, 
j
, 
k
, 
jsize
;

3418 
jsize
 = 
grid_pošts
[1]-1;

3420 #´agm¨
omp
 

3421 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3422 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3428 
	`bšvühs
Ğ
lhs
[
i
][0][
k
][
BB
],

3429 
lhs
[
i
][0][
k
][
CC
],

3430 
rhs
[
i
][0][
k
] );

3438 
j
 = 1; j < 
jsize
; j++) {

3439 #´agm¨
omp
 

3440 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3441 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3448 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3449 
rhs
[
i
][
j
-1][
k
],„hs[i][j][k]);

3454 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3455 
lhs
[
i
][
j
-1][
k
][
CC
],

3456 
lhs
[
i
][
j
][
k
][
BB
]);

3462 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3463 
lhs
[
i
][
j
][
k
][
CC
],

3464 
rhs
[
i
][
j
][
k
] );

3470 #´agm¨
omp
 

3471 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3472 
k
 = 1; k < 
grid_pošts
[2]-1; k++) {

3477 
	`m©vec_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3478 
rhs
[
i
][
jsize
-1][
k
],„hs[i][jsize][k]);

3485 
	`m©mul_sub
(
lhs
[
i
][
jsize
][
k
][
AA
],

3486 
lhs
[
i
][
jsize
-1][
k
][
CC
],

3487 
lhs
[
i
][
jsize
][
k
][
BB
]);

3492 
	`bšvrhs
Ğ
lhs
[
i
][
jsize
][
k
][
BB
],

3493 
rhs
[
i
][
jsize
][
k
] );

3497 
	}
}

3503 
	$z_sŞve
() {

3518 
	`lhsz
();

3519 
	`z_sŞve_ûÎ
();

3520 
	`z_backsub¡™u‹
();

3521 
	}
}

3526 
	$z_backsub¡™u‹
() {

3538 
i
, 
j
, 
k
, 
m
, 
n
;

3540 #´agm¨
omp
 

3541 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3542 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3543 
k
 = 
grid_pošts
[2]-2; k >= 0; k--) {

3544 
m
 = 0; m < 
BLOCK_SIZE
; m++) {

3545 
n
 = 0;‚ < 
BLOCK_SIZE
;‚++) {

3546 
rhs
[
i
][
j
][
k
][
m
] =„hs[i][j][k][m]

3547 - 
lhs
[
i
][
j
][
k
][
CC
][
m
][
n
]*
rhs
[i][j][k+1][n];

3553 
	}
}

3558 
	$z_sŞve_ûÎ
() {

3573 
i
,
j
,
k
,
ksize
;

3575 
ksize
 = 
grid_pošts
[2]-1;

3580 #´agm¨
omp
 

3581 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3582 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3588 
	`bšvühs
Ğ
lhs
[
i
][
j
][0][
BB
],

3589 
lhs
[
i
][
j
][0][
CC
],

3590 
rhs
[
i
][
j
][0] );

3599 
k
 = 1; k < 
ksize
; k++) {

3600 #´agm¨
omp
 

3601 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3602 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3609 
	`m©vec_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3610 
rhs
[
i
][
j
][
k
-1],„hs[i][j][k]);

3616 
	`m©mul_sub
(
lhs
[
i
][
j
][
k
][
AA
],

3617 
lhs
[
i
][
j
][
k
-1][
CC
],

3618 
lhs
[
i
][
j
][
k
][
BB
]);

3624 
	`bšvühs
Ğ
lhs
[
i
][
j
][
k
][
BB
],

3625 
lhs
[
i
][
j
][
k
][
CC
],

3626 
rhs
[
i
][
j
][
k
] );

3635 #´agm¨
omp
 

3636 
i
 = 1; i < 
grid_pošts
[0]-1; i++) {

3637 
j
 = 1; j < 
grid_pošts
[1]-1; j++) {

3642 
	`m©vec_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3643 
rhs
[
i
][
j
][
ksize
-1],„hs[i][j][ksize]);

3650 
	`m©mul_sub
(
lhs
[
i
][
j
][
ksize
][
AA
],

3651 
lhs
[
i
][
j
][
ksize
-1][
CC
],

3652 
lhs
[
i
][
j
][
ksize
][
BB
]);

3657 
	`bšvrhs
Ğ
lhs
[
i
][
j
][
ksize
][
BB
],

3658 
rhs
[
i
][
j
][
ksize
] );

3662 
	}
}

	@BT/toy.c

1 
	~<Çutus/Çutus.h
>

2 
	~<Çutus/sh–l.h
>

4 
	gsize
 = 5;

5 
	ga
[5][5];

6 
	gb
[5][5];

7 #´agm¨
omp
 
th»ad´iv©e
(
b
,
a
)

10 
toy
(*
buf
, * 
´iv
);

12 
sh–l_cmd_im¶
 
	gÇs_toy_im¶
 = {

13 .
cmd
 = "toy",

14 .
	gh–p_¡r
 = "NAS…arallel benchmark BT",

15 .
	ghªdËr
 = 
toy
,

17 
nk_»gi¡”_sh–l_cmd
(
Çs_toy_im¶
);

19 
	$toy
(*
buf
, * 
´iv
) {

21 #´agm¨
omp
 
·¿Î–


23 
i
 =0,
j
=0;

24 #´agm¨
omp
 

25 
i
 =0;i<
size
;i++){

26 
j
=0; j< 
size
;j++){

27 
a
[
i
][
j
] = i+j;

28 
b
[
i
][
j
] = i-j;

32 
i
 =0;i<
size
;i++){

33 
j
=0; j< 
size
;j++){

34 
	`´štf
("˜%d, j %d, %d %d\n", 
i
,
j
, 
a
[i][j], 
b
[i][j]);

43 
	}
}

	@CG/cg.c

47 
	~"../commÚ/Åb-C.h
"

48 
	~"Åb·¿ms.h
"

50 
	~<Çutus/Çutus.h
>

51 
	~<Çutus/sh–l.h
>

52 
	~"../m©h/Çs_m©h.h
"

54 
	#NZ
 
NA
*(
NONZER
+1)*(NONZER+1)+NA*(NONZER+2)

	)

59 
	gÇa
;

60 
	gnzz
;

61 
	gfœ¡row
;

62 
	gÏ¡row
;

63 
	gfœ¡cŞ
;

64 
	gÏ¡cŞ
;

67 
	gcŞidx
[
NZ
+1];

68 
	grow¡r
[
NA
+1+1];

69 
	giv
[2*
NA
+1+1];

70 
	g¬ow
[
NZ
+1];

71 
	gacŞ
[
NZ
+1];

74 
	gv
[
NA
+1+1];

75 
	g«É
[
NZ
+1];

76 
	ga
[
NZ
+1];

77 
	gx
[
NA
+2+1];

78 
	gz
[
NA
+2+1];

79 
	gp
[
NA
+2+1];

80 
	gq
[
NA
+2+1];

81 
	gr
[
NA
+2+1];

85 
	gamuÉ
;

86 
	gŒª
;

89 
cÚj_g¿d
 (
cŞidx
[], 
row¡r
[], 
x
[], 
z
[],

90 
a
[], 
p
[], 
q
[], 
r
[],

92 *
ºÜm
);

93 
mak—
(
n
, 
nz
, 
a
[], 
cŞidx
[], 
row¡r
[],

94 
nÚz”
, 
fœ¡row
, 
Ï¡row
, 
fœ¡cŞ
,

95 
Ï¡cŞ
, 
rcÚd
, 
¬ow
[], 
acŞ
[],

96 
«É
[], 
v
[], 
iv
[], 
shiá
 );

97 
¥¬£
(
a
[], 
cŞidx
[], 
row¡r
[], 
n
,

98 
¬ow
[], 
acŞ
[], 
«É
[],

99 
fœ¡row
, 
Ï¡row
,

100 
x
[], 
boŞ—n
 
m¬k
[], 
nzloc
[], 
Âza
);

101 
¥ºvc
(
n
, 
nz
, 
v
[], 
iv
[], 
nzloc
[],

102 
m¬k
[]);

103 
iúv¹
(
x
, 
wr2
);

104 
vec£t
(
n
, 
v
[], 
iv
[], *
nzv
, 
i
, 
v®
);

109 
´og¿m_CG
(*
__buf
, * 
__´iv
);

111 
sh–l_cmd_im¶
 
	gÇs_cg_im¶
 = {

112 .
cmd
 = "nas-cg",

113 .
	gh–p_¡r
 = "NAS…arallel benchmark CG",

114 .
	ghªdËr
 = 
´og¿m_CG
,

116 
nk_»gi¡”_sh–l_cmd
(
Çs_cg_im¶
);

120 
	$´og¿m_CG
(*
__buf
, * 
__´iv
) {

123 
i
, 
j
, 
k
, 
™
;

124 
Áh»ads
 = 1;

125 
z‘a
;

126 
ºÜm
;

127 
nÜm_‹mp11
;

128 
nÜm_‹mp12
;

129 
t
, 
mæİs
;

130 
şass
;

131 
boŞ—n
 
v”if›d
;

132 
z‘a_v”ify_v®ue
, 
•sÚ
;

134 
fœ¡row
 = 1;

135 
Ï¡row
 = 
NA
;

136 
fœ¡cŞ
 = 1;

137 
Ï¡cŞ
 = 
NA
;

139 ià(
NA
 =ğ1400 && 
NONZER
 =ğ7 && 
NITER
 =ğ15 && 
SHIFT
 == 10.0) {

140 
şass
 = 'S';

141 
z‘a_v”ify_v®ue
 = 8.5971775078648;

142 } ià(
NA
 =ğ7000 && 
NONZER
 =ğ8 && 
NITER
 =ğ15 && 
SHIFT
 == 12.0) {

143 
şass
 = 'W';

144 
z‘a_v”ify_v®ue
 = 10.362595087124;

145 } ià(
NA
 =ğ14000 && 
NONZER
 =ğ11 && 
NITER
 =ğ15 && 
SHIFT
 == 20.0) {

146 
şass
 = 'A';

147 
z‘a_v”ify_v®ue
 = 17.130235054029;

148 } ià(
NA
 =ğ75000 && 
NONZER
 =ğ13 && 
NITER
 =ğ75 && 
SHIFT
 == 60.0) {

149 
şass
 = 'B';

150 
z‘a_v”ify_v®ue
 = 22.712745482631;

151 } ià(
NA
 =ğ150000 && 
NONZER
 =ğ15 && 
NITER
 =ğ75 && 
SHIFT
 == 110.0) {

152 
şass
 = 'C';

153 
z‘a_v”ify_v®ue
 = 28.973605592845;

155 
şass
 = 'U';

158 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

160 
	`´štf
(" Size: %10d\n", 
NA
);

161 
	`´štf
(" I‹¿tiÚs: %5d\n", 
NITER
);

163 
Ça
 = 
NA
;

164 
nzz
 = 
NZ
;

169 
Œª
 = 314159265.0;

170 
amuÉ
 = 1220703125.0;

171 
z‘a
 = 
	`¿ndlc
Ğ&
Œª
, 
amuÉ
 );

176 
	`mak—
(
Ça
, 
nzz
, 
a
, 
cŞidx
, 
row¡r
, 
NONZER
,

177 
fœ¡row
, 
Ï¡row
, 
fœ¡cŞ
, 
Ï¡cŞ
,

178 
RCOND
, 
¬ow
, 
acŞ
, 
«É
, 
v
, 
iv
, 
SHIFT
);

188 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
)

190 #´agm¨
omp
 
nowa™


191 
j
 = 1; j <ğ
Ï¡row
 - 
fœ¡row
 + 1; j++) {

192 
k
 = 
row¡r
[
j
]; k <„owstr[j+1]; k++) {

193 
cŞidx
[
k
] = cŞidx[k] - 
fœ¡cŞ
 + 1;

200 #´agm¨
omp
 
nowa™


201 
i
 = 1; i <ğ
NA
+1; i++) {

202 
x
[
i
] = 1.0;

204 #´agm¨
omp
 
nowa™


205 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

206 
q
[
j
] = 0.0;

207 
z
[
j
] = 0.0;

208 
r
[
j
] = 0.0;

209 
p
[
j
] = 0.0;

212 
z‘a
 = 0.0;

220 
™
 = 1; it <= 1; it++) {

225 
	`cÚj_g¿d
 (
cŞidx
, 
row¡r
, 
x
, 
z
, 
a
, 
p
, 
q
, 
r
, &
ºÜm
);

233 
nÜm_‹mp11
 = 0.0;

234 
nÜm_‹mp12
 = 0.0;

235 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
è
	`»duùiÚ
(+:
nÜm_‹mp11
,
nÜm_‹mp12
)

236 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

237 
nÜm_‹mp11
 =‚Üm_‹mp11 + 
x
[
j
]*
z
[j];

238 
nÜm_‹mp12
 =‚Üm_‹mp12 + 
z
[
j
]*z[j];

240 
nÜm_‹mp12
 = 1.0 / 
	`sq¹
(‚orm_temp12 );

245 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

246 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

247 
x
[
j
] = 
nÜm_‹mp12
*
z
[j];

255 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

256 
i
 = 1; i <ğ
NA
+1; i++) {

257 
x
[
i
] = 1.0;

259 
z‘a
 = 0.0;

262 
	`tim”_ş—r
( 1 );

263 
	`tim”_¡¬t
( 1 );

271 
™
 = 1; iˆ<ğ
NITER
; it++) {

276 
	`cÚj_g¿d
(
cŞidx
, 
row¡r
, 
x
, 
z
, 
a
, 
p
, 
q
, 
r
 , &
ºÜm
);

284 
nÜm_‹mp11
 = 0.0;

285 
nÜm_‹mp12
 = 0.0;

287 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
è
	`»duùiÚ
(+:
nÜm_‹mp11
,
nÜm_‹mp12
)

288 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

289 
nÜm_‹mp11
 =‚Üm_‹mp11 + 
x
[
j
]*
z
[j];

290 
nÜm_‹mp12
 =‚Üm_‹mp12 + 
z
[
j
]*z[j];

293 
nÜm_‹mp12
 = 1.0 / 
	`sq¹
(‚orm_temp12 );

295 
z‘a
 = 
SHIFT
 + 1.0 / 
nÜm_‹mp11
;

297 ifĞ
™
 == 1 ) {

298 
	`´štf
(" iteration ||r|| zeta\n");

300 
	`´štf
(" %5d %20.14e%20.13e\n", 
™
, 
ºÜm
, 
z‘a
);

305 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

306 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

307 
x
[
j
] = 
nÜm_‹mp12
*
z
[j];

310 #´agm¨
omp
 
·¿Î–


312 #ià
	`defšed
(
_OPENMP
)

313 #´agm¨
omp
 
ma¡”


314 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

318 
	`tim”_¡İ
( 1 );

324 
t
 = 
	`tim”_»ad
( 1 );

326 
	`´štf
(" Benchmark completed\n");

328 
•sÚ
 = 1.0e-10;

329 ià(
şass
 != 'U') {

330 ià(
	`çbs
(
z‘a
 - 
z‘a_v”ify_v®ue
è<ğ
•sÚ
) {

331 
v”if›d
 = 
TRUE
;

332 
	`´štf
(" VERIFICATION SUCCESSFUL\n");

333 
	`´štf
(" Z‘¨i  %20.12e\n", 
z‘a
);

334 
	`´štf
(" E¼Ü i  %20.12e\n", 
z‘a
 - 
z‘a_v”ify_v®ue
);

336 
v”if›d
 = 
FALSE
;

337 
	`´štf
(" VERIFICATION FAILED\n");

338 
	`´štf
(" Z‘¨ %20.12e\n", 
z‘a
);

339 
	`´štf
(" ThcÜ»ù z‘¨i %20.12e\n", 
z‘a_v”ify_v®ue
);

342 
v”if›d
 = 
FALSE
;

343 
	`´štf
(" Problem size unknown\n");

344 
	`´štf
(" NO VERIFICATION PERFORMED\n");

347 iàĞ
t
 != 0.0 ) {

348 
mæİs
 = (2.0*
NITER
*
NA
)

349 * (3.0+(
NONZER
*(NONZER+1)) + 25.0*(5.0+(NONZER*(NONZER+1))) + 3.0 )

350 / 
t
 / 1000000.0;

352 
mæİs
 = 0.0;

355 
	`c_´št_»suÉs
("CG", 
şass
, 
NA
, 0, 0, 
NITER
, 
Áh»ads
, 
t
,

356 
mæİs
, " floating…oint",

357 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

358 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

359 
	}
}

363 
	$cÚj_g¿d
 (

364 
cŞidx
[],

365 
row¡r
[],

366 
x
[],

367 
z
[],

368 
a
[],

369 
p
[],

370 
q
[],

371 
r
[],

373 *
ºÜm
 )

382 
ÿÎcouÁ
 = 0;

383 
d
, 
sum
, 
rho
, 
rho0
, 
®pha
, 
b‘a
;

384 
i
, 
j
, 
k
;

385 
cg™
, 
cg™max
 = 25;

387 
rho
 = 0.0;

388 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
sum
è
	`sh¬ed
(
rho
,
Ça
)

394 #´agm¨
omp
 

395 
j
 = 1; j <ğ
Ça
+1; j++) {

396 
q
[
j
] = 0.0;

397 
z
[
j
] = 0.0;

398 
r
[
j
] = 
x
[j];

399 
p
[
j
] = 
r
[j];

407 #´agm¨
omp
 
	`»duùiÚ
(+:
rho
)

408 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

409 
rho
 =„hØ+ 
r
[
j
]*r[j];

417 
cg™
 = 1; cg™ <ğ
cg™max
; cgit++) {

418 
rho0
 = 
rho
;

419 
d
 = 0.0;

420 
rho
 = 0.0;

421 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
k
,
sum
,
®pha
,
b‘a
è
	`sh¬ed
(
d
,
rho0
,
rho
)

438 #´agm¨
omp
 

439 
j
 = 1; j <ğ
Ï¡row
-
fœ¡row
+1; j++) {

440 
sum
 = 0.0;

441 
k
 = 
row¡r
[
j
]; k <„owstr[j+1]; k++) {

442 
sum
 = sum + 
a
[
k
]*
p
[
cŞidx
[k]];

445 
q
[
j
] = 
sum
;

506 #´agm¨
omp
 
	`»duùiÚ
(+:
d
)

507 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

508 
d
 = d + 
p
[
j
]*
q
[j];

510 #´agm¨
omp
 
b¬r›r


515 
®pha
 = 
rho0
 / 
d
;

526 #´agm¨
omp
 
	`»duùiÚ
(+:
rho
)

527 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

528 
z
[
j
] = z[j] + 
®pha
*
p
[j];

529 
r
[
j
] =„[j] - 
®pha
*
q
[j];

539 
rho
 =„hØ+ 
r
[
j
]*r[j];

547 
b‘a
 = 
rho
 / 
rho0
;

552 #´agm¨
omp
 
nowa™


553 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

554 
p
[
j
] = 
r
[j] + 
b‘a
*p[j];

556 
ÿÎcouÁ
++;

565 
sum
 = 0.0;

567 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
,
d
è
	`sh¬ed
(
sum
)

569 #´agm¨
omp
 

570 
j
 = 1; j <ğ
Ï¡row
-
fœ¡row
+1; j++) {

571 
d
 = 0.0;

572 
k
 = 
row¡r
[
j
]; k <=„owstr[j+1]-1; k++) {

573 
d
 = d + 
a
[
k
]*
z
[
cŞidx
[k]];

575 
r
[
j
] = 
d
;

581 #´agm¨
omp
 
	`»duùiÚ
(+:
sum
)

582 
j
 = 1; j <ğ
Ï¡cŞ
-
fœ¡cŞ
+1; j++) {

583 
d
 = 
x
[
j
] - 
r
[j];

584 
sum
 = sum + 
d
*d;

587 (*
ºÜm
èğ
	`sq¹
(
sum
);

588 
	}
}

615 
	$mak—
(

616 
n
,

617 
nz
,

618 
a
[],

619 
cŞidx
[],

620 
row¡r
[],

621 
nÚz”
,

622 
fœ¡row
,

623 
Ï¡row
,

624 
fœ¡cŞ
,

625 
Ï¡cŞ
,

626 
rcÚd
,

627 
¬ow
[],

628 
acŞ
[],

629 
«É
[],

630 
v
[],

631 
iv
[],

632 
shiá
 )

634 
i
, 
Âza
, 
iou‹r
, 
iv–t
, 
iv–t1
, 
œow
, 
nzv
;

640 
size
, 
¿tio
, 
sÿË
;

641 
jcŞ
;

643 
size
 = 1.0;

644 
¿tio
 = 
	`pow
(
rcÚd
, (1.0 / ()
n
));

645 
Âza
 = 0;

651 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

652 
i
 = 1; i <ğ
n
; i++) {

653 
cŞidx
[
n
+
i
] = 0;

655 
iou‹r
 = 1; iou‹¸<ğ
n
; iouter++) {

656 
nzv
 = 
nÚz”
;

657 
	`¥ºvc
(
n
, 
nzv
, 
v
, 
iv
, &(
cŞidx
[0]), &(colidx[n]));

658 
	`vec£t
(
n
, 
v
, 
iv
, &
nzv
, 
iou‹r
, 0.5);

659 
iv–t
 = 1; iv–ˆ<ğ
nzv
; ivelt++) {

660 
jcŞ
 = 
iv
[
iv–t
];

661 ià(
jcŞ
 >ğ
fœ¡cŞ
 && jcŞ <ğ
Ï¡cŞ
) {

662 
sÿË
 = 
size
 * 
v
[
iv–t
];

663 
iv–t1
 = 1; iv–t1 <ğ
nzv
; ivelt1++) {

664 
œow
 = 
iv
[
iv–t1
];

665 ià(
œow
 >ğ
fœ¡row
 && irow <ğ
Ï¡row
) {

666 
Âza
 =‚nza + 1;

667 ià(
Âza
 > 
nz
) {

668 
	`´štf
("Space for matrixƒlementsƒxceeded in"

670 
	`´štf
("Âza,‚zmax = %d, %d\n", 
Âza
, 
nz
);

671 
	`´štf
("iou‹¸ğ%d\n", 
iou‹r
);

672 
	`ex™
(1);

674 
acŞ
[
Âza
] = 
jcŞ
;

675 
¬ow
[
Âza
] = 
œow
;

676 
«É
[
Âza
] = 
v
[
iv–t1
] * 
sÿË
;

681 
size
 = siz* 
¿tio
;

688 
i
 = 
fœ¡row
; i <ğ
Ï¡row
; i++) {

689 ià(
i
 >ğ
fœ¡cŞ
 && i <ğ
Ï¡cŞ
) {

690 
iou‹r
 = 
n
 + 
i
;

691 
Âza
 =‚nza + 1;

692 ià(
Âza
 > 
nz
) {

693 
	`´štf
("Space for matrixƒlementsƒxceeded in makea\n");

694 
	`´štf
("Âza,‚zmax = %d, %d\n", 
Âza
, 
nz
);

695 
	`´štf
("iou‹¸ğ%d\n", 
iou‹r
);

696 
	`ex™
(1);

698 
acŞ
[
Âza
] = 
i
;

699 
¬ow
[
Âza
] = 
i
;

700 
«É
[
Âza
] = 
rcÚd
 - 
shiá
;

708 
	`¥¬£
(
a
, 
cŞidx
, 
row¡r
, 
n
, 
¬ow
, 
acŞ
, 
«É
,

709 
fœ¡row
, 
Ï¡row
, 
v
, &(
iv
[0]), &(iv[
n
]), 
Âza
);

710 
	}
}

716 
	$¥¬£
(

717 
a
[],

718 
cŞidx
[],

719 
row¡r
[],

720 
n
,

721 
¬ow
[],

722 
acŞ
[],

723 
«É
[],

724 
fœ¡row
,

725 
Ï¡row
,

726 
x
[],

727 
boŞ—n
 
m¬k
[],

728 
nzloc
[],

729 
Âza
)

735 
Äows
;

736 
i
, 
j
, 
jajp1
, 
nza
, 
k
, 
nzrow
;

737 
xi
;

742 
Äows
 = 
Ï¡row
 - 
fœ¡row
 + 1;

747 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j
)

748 
j
 = 1; j <ğ
n
; j++) {

749 
row¡r
[
j
] = 0;

750 
m¬k
[
j
] = 
FALSE
;

752 
row¡r
[
n
+1] = 0;

754 
nza
 = 1;‚z¨<ğ
Âza
;‚za++) {

755 
j
 = (
¬ow
[
nza
] - 
fœ¡row
 + 1) + 1;

756 
row¡r
[
j
] =„owstr[j] + 1;

759 
row¡r
[1] = 1;

760 
j
 = 2; j <ğ
Äows
+1; j++) {

761 
row¡r
[
j
] =„owstr[j] +„owstr[j-1];

772 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
k
,
j
)

773 
j
 = 0;j <ğ
Äows
-1;j++) {

774 
k
 = 
row¡r
[
j
];k <=„owstr[j+1]-1;k++)

775 
a
[
k
] = 0.0;

780 
nza
 = 1;‚z¨<ğ
Âza
;‚za++) {

781 
j
 = 
¬ow
[
nza
] - 
fœ¡row
 + 1;

782 
k
 = 
row¡r
[
j
];

783 
a
[
k
] = 
«É
[
nza
];

784 
cŞidx
[
k
] = 
acŞ
[
nza
];

785 
row¡r
[
j
] =„owstr[j] + 1;

791 
j
 = 
Äows
; j >= 1; j--) {

792 
row¡r
[
j
+1] =„owstr[j];

794 
row¡r
[1] = 1;

799 
nza
 = 0;

800 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

801 
i
 = 1; i <ğ
n
; i++) {

802 
x
[
i
] = 0.0;

803 
m¬k
[
i
] = 
FALSE
;

806 
jajp1
 = 
row¡r
[1];

807 
j
 = 1; j <ğ
Äows
; j++) {

808 
nzrow
 = 0;

813 
k
 = 
jajp1
; k < 
row¡r
[
j
+1]; k++) {

814 
i
 = 
cŞidx
[
k
];

815 
x
[
i
] = x[i] + 
a
[
k
];

816 iàĞ
m¬k
[
i
] =ğ
FALSE
 && 
x
[i] != 0.0) {

817 
m¬k
[
i
] = 
TRUE
;

818 
nzrow
 =‚zrow + 1;

819 
nzloc
[
nzrow
] = 
i
;

826 
k
 = 1; k <ğ
nzrow
; k++) {

827 
i
 = 
nzloc
[
k
];

828 
m¬k
[
i
] = 
FALSE
;

829 
xi
 = 
x
[
i
];

830 
x
[
i
] = 0.0;

831 ià(
xi
 != 0.0) {

832 
nza
 =‚za + 1;

833 
a
[
nza
] = 
xi
;

834 
cŞidx
[
nza
] = 
i
;

837 
jajp1
 = 
row¡r
[
j
+1];

838 
row¡r
[
j
+1] = 
nza
 +„owstr[1];

840 
	}
}

851 
	$¥ºvc
(

852 
n
,

853 
nz
,

854 
v
[],

855 
iv
[],

856 
nzloc
[],

857 
m¬k
[] )

859 
Â1
;

860 
nzrow
, 
nzv
, 
ii
, 
i
;

861 
veûÉ
, 
veşoc
;

863 
nzv
 = 0;

864 
nzrow
 = 0;

865 
Â1
 = 1;

867 
Â1
 = 2 *‚n1;

868 } 
Â1
 < 
n
);

874 
nzv
 < 
nz
) {

875 
veûÉ
 = 
	`¿ndlc
(&
Œª
, 
amuÉ
);

880 
veşoc
 = 
	`¿ndlc
(&
Œª
, 
amuÉ
);

881 
i
 = 
	`iúv¹
(
veşoc
, 
Â1
) + 1;

882 ià(
i
 > 
n
) ;

887 ià(
m¬k
[
i
] == 0) {

888 
m¬k
[
i
] = 1;

889 
nzrow
 =‚zrow + 1;

890 
nzloc
[
nzrow
] = 
i
;

891 
nzv
 =‚zv + 1;

892 
v
[
nzv
] = 
veûÉ
;

893 
iv
[
nzv
] = 
i
;

897 
ii
 = 1; i˜<ğ
nzrow
; ii++) {

898 
i
 = 
nzloc
[
ii
];

899 
m¬k
[
i
] = 0;

901 
	}
}

906 
	$iúv¹
(
x
, 
wr2
) {

907  (()(
wr2
 * 
x
));

908 
	}
}

914 
	$vec£t
(

915 
n
,

916 
v
[],

917 
iv
[],

918 *
nzv
,

919 
i
,

920 
v®
)

922 
k
;

923 
boŞ—n
 
£t
;

925 
£t
 = 
FALSE
;

926 
k
 = 1; k <ğ*
nzv
; k++) {

927 ià(
iv
[
k
] =ğ
i
) {

928 
v
[
k
] = 
v®
;

929 
£t
 = 
TRUE
;

932 ià(
£t
 =ğ
FALSE
) {

933 *
nzv
 = *nzv + 1;

934 
v
[*
nzv
] = 
v®
;

935 
iv
[*
nzv
] = 
i
;

937 
	}
}

	@CG/npbparams.h

7 
	#NA
 1400

	)

8 
	#NONZER
 7

	)

9 
	#NITER
 15

	)

10 
	#SHIFT
 10.0

	)

11 
	#RCOND
 1.0e-1

	)

12 
	#CONVERTDOUBLE
 
FALSE


	)

13 
	#COMPILETIME
 "25 S• 2020"

	)

14 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

15 
	#CS1
 "şªg-10"

	)

16 
	#CS2
 "şªg-10"

	)

17 
	#CS3
 "-lm"

	)

18 
	#CS4
 "-I../commÚ "

	)

19 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

20 
	#CS6
 "-lomp"

	)

21 
	#CS7
 "¿nddp"

	)

	@EP/ep.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~"Åb·¿ms.h
"

37 
	~"../m©h/Çs_m©h.h
"

39 
	#MK
 16

	)

40 
	#MM
 (
M
 - 
MK
)

	)

41 
	#NN
 (1 << 
MM
)

	)

42 
	#NK
 (1 << 
MK
)

	)

43 
	#NQ
 10

	)

44 
	#EPSILON
 1.0e-8

	)

45 
	#A
 1220703125.0

	)

46 
	#S
 271828183.0

	)

47 
	#TIMERS_ENABLED
 
FALSE


	)

51 
	gx
[2*
NK
];

52 #´agm¨
omp
 
th»ad´iv©e
(
x
)

53 
	gq
[
NQ
];

67 
	~<Çutus/Çutus.h
>

68 
	~<Çutus/sh–l.h
>

69 
	~<Çutus/libccom·t.h
>

71 
´og¿m_EP
(*
buf
, * 
´iv
);

73 
sh–l_cmd_im¶
 
	gÇs_•_im¶
 = {

74 .
cmd
 = "nas-ep",

75 .
	gh–p_¡r
 = "NAS…arallel benchmark EP",

76 .
	ghªdËr
 = 
´og¿m_EP
,

78 
nk_»gi¡”_sh–l_cmd
(
Çs_•_im¶
);

82 
	$´og¿m_EP
(*
buf
, * 
´iv
) {

84 
Mİs
, 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
, 
sx
, 
sy
, 
tm
, 
ª
, 
‰
, 
gc
;

85 
dum
[3] = { 1.0, 1.0, 1.0 };

86 
Å
, 
›¼
, 
node
, 
no_nodes
, 
i
, 
ik
, 
kk
, 
l
, 
k
, 
n™
, 
›¼code
,

87 
no_Ïrge_nodes
, 
Å_add
, 
k_off£t
, 
j
;

88 
Áh»ads
 = 1;

89 
boŞ—n
 
v”if›d
;

90 
size
[13+1];

99 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

101 
	`¥rštf
(
size
, "%12.0f", 
	`pow
(2.0, 
M
+1));

102 
j
 = 13; j >= 1; j--) {

103 ià(
size
[
j
] == '.') size[j] = ' ';

105 
	`´štf
(" Numb” oà¿ndom‚umb” g’”©ed: %13s\n", 
size
);

107 
v”if›d
 = 
FALSE
;

114 
Å
 = 
NN
;

122 
	`v¿Æc
(0, &(
dum
[0]), dum[1], &(dum[2]));

123 
dum
[0] = 
	`¿ndlc
(&(dum[1]), dum[2]);

125 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

126 
i
 = 0; i < 2*
NK
; i++è
x
[i] = -1.0e99;

128 
Mİs
 = 0.0;

130 
	`tim”_ş—r
(1);

131 
	`tim”_ş—r
(2);

132 
	`tim”_ş—r
(3);

133 
	`tim”_¡¬t
(1);

135 
	`v¿Æc
(0, &
t1
, 
A
, 
x
);

139 
t1
 = 
A
;

141  
i
 = 1; i <ğ
MK
+1; i++) {

142 
t2
 = 
	`¿ndlc
(&
t1
,1);

145 
ª
 = 
t1
;

146 
‰
 = 
S
;

147 
gc
 = 0.0;

148 
sx
 = 0.0;

149 
sy
 = 0.0;

151  
i
 = 0; i <ğ
NQ
 - 1; i++) {

152 
q
[
i
] = 0.0;

160 
k_off£t
 = -1;

162 #´agm¨
omp
 
·¿Î–
 
	`cİyš
(
x
)

164 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
;

165 
kk
, 
i
, 
ik
, 
l
;

166 
qq
[
NQ
];

168 
i
 = 0; i < 
NQ
; i++è
qq
[i] = 0.0;

170 #´agm¨
omp
 
	`»duùiÚ
(+:
sx
,
sy
è
	`scheduË
()

171 
k
 = 1; k <ğ
Å
; k++) {

172 
kk
 = 
k_off£t
 + 
k
;

173 
t1
 = 
S
;

174 
t2
 = 
ª
;

178 
i
 = 1; i <= 100; i++) {

179 
ik
 = 
kk
 / 2;

180 ià(2 * 
ik
 !ğ
kk
è
t3
 = 
	`¿ndlc
(&
t1
, 
t2
);

181 ià(
ik
 == 0) ;

182 
t3
 = 
	`¿ndlc
(&
t2
,2);

183 
kk
 = 
ik
;

188 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(3);

189 
	`v¿Æc
(2*
NK
, &
t1
, 
A
, 
x
-1);

190 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡İ
(3);

197 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(2);

199  
i
 = 0; i < 
NK
; i++) {

200 
x1
 = 2.0 * 
x
[2*
i
] - 1.0;

201 
x2
 = 2.0 * 
x
[2*
i
+1] - 1.0;

202 
t1
 = 
	`pow2
(
x1
è+…ow2(
x2
);

203 ià(
t1
 <= 1.0) {

204 
t2
 = 
	`sq¹
(-2.0 * 
	`log
(
t1
) /1);

205 
t3
 = (
x1
 * 
t2
);

206 
t4
 = (
x2
 * 
t2
);

207 
l
 = 
	`max
(
	`çbs
(
t3
), fabs(
t4
));

208 
qq
[
l
] += 1.0;

209 
sx
 = sx + 
t3
;

210 
sy
 = sy + 
t4
;

213 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡İ
(2);

215 #´agm¨
omp
 
ü™iÿl


217 
i
 = 0; i <ğ
NQ
 - 1; i++è
q
[i] +ğ
qq
[i];

219 #ià
	`defšed
(
_OPENMP
)

220 #´agm¨
omp
 
ma¡”


221 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

225 
i
 = 0; i <ğ
NQ
-1; i++) {

226 
gc
 = gø+ 
q
[
i
];

229 
	`tim”_¡İ
(1);

230 
tm
 = 
	`tim”_»ad
(1);

232 
n™
 = 0;

233 ià(
M
 == 24) {

234 if((
	`çbs
((
sx
- (-3.247834652034740e3))/sxè<ğ
EPSILON
) &&

235 (
	`çbs
((
sy
- (-6.958407078382297e3))/syè<ğ
EPSILON
)) {

236 
v”if›d
 = 
TRUE
;

238 } ià(
M
 == 25) {

239 ià((
	`çbs
((
sx
- (-2.863319731645753e3))/sxè<ğ
EPSILON
) &&

240 (
	`çbs
((
sy
- (-6.320053679109499e3))/syè<ğ
EPSILON
)) {

241 
v”if›d
 = 
TRUE
;

243 } ià(
M
 == 28) {

244 ià((
	`çbs
((
sx
- (-4.295875165629892e3))/sxè<ğ
EPSILON
) &&

245 (
	`çbs
((
sy
- (-1.580732573678431e4))/syè<ğ
EPSILON
)) {

246 
v”if›d
 = 
TRUE
;

248 } ià(
M
 == 30) {

249 ià((
	`çbs
((
sx
- (4.033815542441498e4))/sxè<ğ
EPSILON
) &&

250 (
	`çbs
((
sy
- (-2.660669192809235e4))/syè<ğ
EPSILON
)) {

251 
v”if›d
 = 
TRUE
;

253 } ià(
M
 == 32) {

254 ià((
	`çbs
((
sx
- (4.764367927995374e4))/sxè<ğ
EPSILON
) &&

255 (
	`çbs
((
sy
- (-8.084072988043731e4))/syè<ğ
EPSILON
)) {

256 
v”if›d
 = 
TRUE
;

260 
Mİs
 = 
	`pow
(2.0, 
M
+1)/
tm
/1000000.0;

262 
	`´štf
("EP Benchmark Results: \n"

268 
tm
, 
M
, 
gc
, 
sx
, 
sy
);

269 
i
 = 0; i <ğ
NQ
-1; i++) {

270 
	`´štf
("%3d %15.0f\n", 
i
, 
q
[i]);

273 
	`c_´št_»suÉs
("EP", 
CLASS
, 
M
+1, 0, 0, 
n™
, 
Áh»ads
,

274 
tm
, 
Mİs
,

276 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

277 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

279 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

280 
	`´štf
("TÙ®ime: %f", 
	`tim”_»ad
(1));

281 
	`´štf
("GaussŸÀ·œs: %f", 
	`tim”_»ad
(2));

282 
	`´štf
("Rªdom‚umb”s: %f", 
	`tim”_»ad
(3));

284 
	}
}

	@EP/npbparams.h

7 
	#CLASS
 'S'

	)

8 
	#M
 24

	)

9 
	#CONVERTDOUBLE
 
FALSE


	)

10 
	#COMPILETIME
 "27 S• 2020"

	)

11 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

12 
	#CS1
 "şªg-10"

	)

13 
	#CS2
 "şªg-10"

	)

14 
	#CS3
 "-lm"

	)

15 
	#CS4
 "-I../commÚ "

	)

16 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

17 
	#CS6
 "-lomp"

	)

18 
	#CS7
 "¿nddp"

	)

	@FT/ft.c

34 
	~"../commÚ/Åb-C.h
"

35 
	~"../m©h/Çs_m©h.h
"

37 
	~"glob®.h
"

39 
	~<Çutus/Çutus.h
>

40 
	~<Çutus/sh–l.h
>

43 
evŞve
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], dcom¶ex 
u1
[NZ][NY][NX],

44 
t
, 
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]);

45 
compu‹_š™Ÿl_cÚd™iÚs
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], 
d
[3]);

46 
ow46
(
a
, 
expÚ’t
, *
»suÉ
);

47 
£tup
();

48 
compu‹_šdexm­
(
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]);

49 
´št_tim”s
();

50 
fá
(
dœ
, 
dcom¶ex
 
x1
[
NZ
][
NY
][
NX
], dcom¶ex 
x2
[NZ][NY][NX]);

51 
cfás1
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

52 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

53 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

54 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

55 
cfás2
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

56 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

57 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

58 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

59 
cfás3
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

60 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

61 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

62 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]);

63 
fá_š™
 (
n
);

64 
cfáz
 (
is
, 
m
, 
n
, 
dcom¶ex
 
x
[
NX
][
FFTBLOCKPAD
],

65 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]);

66 
fáz2
 (
is
, 
l
, 
m
, 
n
, 
ny
, 
ny1
,

67 
dcom¶ex
 
u
[
NX
], dcom¶ex 
x
[NX][
FFTBLOCKPAD
],

68 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]);

69 
og2
(
n
);

70 
checksum
(
i
, 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
], 
d
[3]);

71 
v”ify
 (
d1
, 
d2
, 
d3
, 
Á
,

72 
boŞ—n
 *
v”if›d
, *
şass
);

78 
´og¿m_FT
(*
_buf
, * 
_´iv
);

80 
sh–l_cmd_im¶
 
	gÇs_á_im¶
 = {

81 .
cmd
 = "nas-ft",

82 .
	gh–p_¡r
 = "NAS…arallel benchmark FT",

83 .
	ghªdËr
 = 
´og¿m_FT
,

85 
nk_»gi¡”_sh–l_cmd
(
Çs_á_im¶
);

87 
	$´og¿m_FT
(* 
_buf
, *
_´iv
) {

92 
i
, 
›¼
;

112 
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
];

113 
dcom¶ex
 
·d1
[3];

114 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
];

115 
dcom¶ex
 
·d2
[3];

116 
dcom¶ex
 
u2
[
NZ
][
NY
][
NX
];

117 
dcom¶ex
 
·d3
[3];

118 
šdexm­
[
NZ
][
NY
][
NX
];

120 
™”
;

121 
Áh»ads
 = 1;

122 
tÙ®_time
, 
mæİs
;

123 
boŞ—n
 
v”if›d
;

124 
şass
;

131 
i
 = 0; i < 
T_MAX
; i++) {

132 
	`tim”_ş—r
(
i
);

134 
	`£tup
();

136 
	`compu‹_šdexm­
(
šdexm­
, 
dims
[2]);

138 
	`compu‹_š™Ÿl_cÚd™iÚs
(
u1
, 
dims
[0]);

139 
	`fá_š™
 (
dims
[0][0]);

142 
	`fá
(1, 
u1
, 
u0
);

150 
i
 = 0; i < 
T_MAX
; i++) {

151 
	`tim”_ş—r
(
i
);

154 
	`tim”_¡¬t
(
T_TOTAL
);

155 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`tim”_¡¬t
(
T_SETUP
);

157 
	`compu‹_šdexm­
(
šdexm­
, 
dims
[2]);

159 
	`compu‹_š™Ÿl_cÚd™iÚs
(
u1
, 
dims
[0]);

160 
	`fá_š™
 (
dims
[0][0]);

163 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

164 
	`tim”_¡İ
(
T_SETUP
);

166 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

167 
	`tim”_¡¬t
(
T_FFT
);

170 
	`fá
(1, 
u1
, 
u0
);

171 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

172 
	`tim”_¡İ
(
T_FFT
);

175 
™”
 = 1; i‹¸<ğ
n™”
; iter++) {

176 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

177 
	`tim”_¡¬t
(
T_EVOLVE
);

180 
	`evŞve
(
u0
, 
u1
, 
™”
, 
šdexm­
, 
dims
[0]);

182 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

183 
	`tim”_¡İ
(
T_EVOLVE
);

185 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

186 
	`tim”_¡¬t
(
T_FFT
);

189 
	`fá
(-1, 
u1
, 
u2
);

191 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

192 
	`tim”_¡İ
(
T_FFT
);

194 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

195 
	`tim”_¡¬t
(
T_CHECKSUM
);

197 
	`checksum
(
™”
, 
u2
, 
dims
[0]);

199 ià(
TIMERS_ENABLED
 =ğ
TRUE
) {

200 
	`tim”_¡İ
(
T_CHECKSUM
);

205 
	`v”ify
(
NX
, 
NY
, 
NZ
, 
n™”
, &
v”if›d
, &
şass
);

207 #´agm¨
omp
 
·¿Î–


210 #ià
	`defšed
(
_OPENMP
)

211 #´agm¨
omp
 
ma¡”


212 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

216 
	`tim”_¡İ
(
T_TOTAL
);

217 
tÙ®_time
 = 
	`tim”_»ad
(
T_TOTAL
);

219 ifĞ
tÙ®_time
 != 0.0) {

220 
mæİs
 = 1.0e-6*()(
NTOTAL
) *

221 (14.8157+7.19641*
	`log
(()(
NTOTAL
))

222 + (5.23518+7.21113*
	`log
(()(
NTOTAL
)))*
n™”
)

223 /
tÙ®_time
;

225 
mæİs
 = 0.0;

227 
	`c_´št_»suÉs
("FT", 
şass
, 
NX
, 
NY
, 
NZ
, 
n™”
, 
Áh»ads
,

228 
tÙ®_time
, 
mæİs
, " flßtšg…ošt", 
v”if›d
,

229 
NPBVERSION
, 
COMPILETIME
,

230 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

231 ià(
TIMERS_ENABLED
 =ğ
TRUE
è
	`´št_tim”s
();

232 
	}
}

237 
	$evŞve
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], dcom¶ex 
u1
[NZ][NY][NX],

238 
t
, 
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]) {

247 
i
, 
j
, 
k
;

249 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
)

250 
k
 = 0; k < 
d
[2]; k++) {

251 
j
 = 0; j < 
d
[1]; j++) {

252 
i
 = 0; i < 
d
[0]; i++) {

253 
	`ümul
(
u1
[
k
][
j
][
i
], 
u0
[k][j][i], 
ex
[
t
*
šdexm­
[k][j][i]]);

257 
	}
}

262 
	$compu‹_š™Ÿl_cÚd™iÚs
(
dcom¶ex
 
u0
[
NZ
][
NY
][
NX
], 
d
[3]) {

272 
k
;

273 
x0
, 
¡¬t
, 
ª
, 
dummy
;

274 
tmp
[
NX
*2*
MAXDIM
+1];

275 
i
,
j
,
t
;

277 
¡¬t
 = 
SEED
;

281 
	`ow46
(
A
, (
z¡¬t
[0]-1)*2*
NX
*
NY
 + (
y¡¬t
[0]-1)*2*NX, &
ª
);

282 
dummy
 = 
	`¿ndlc
(&
¡¬t
, 
ª
);

283 
	`ow46
(
A
, 2*
NX
*
NY
, &
ª
);

288 
k
 = 0; k < 
dims
[0][2]; k++) {

289 
x0
 = 
¡¬t
;

290 
	`v¿Æc
(2*
NX
*
dims
[0][1], &
x0
, 
A
, 
tmp
);

292 
t
 = 1;

293 
j
 = 0; j < 
dims
[0][1]; j++)

294 
i
 = 0; i < 
NX
; i++) {

295 
u0
[
k
][
j
][
i
].
»®
 = 
tmp
[
t
++];

296 
u0
[
k
][
j
][
i
].
imag
 = 
tmp
[
t
++];

299 ià(
k
 !ğ
dims
[0][2]è
dummy
 = 
	`¿ndlc
(&
¡¬t
, 
ª
);

301 
	}
}

306 
	$ow46
(
a
, 
expÚ’t
, *
»suÉ
) {

315 
dummy
, 
q
, 
r
;

316 
n
, 
n2
;

323 *
»suÉ
 = 1;

324 ià(
expÚ’t
 == 0) ;

325 
q
 = 
a
;

326 
r
 = 1;

327 
n
 = 
expÚ’t
;

329 
n
 > 1) {

330 
n2
 = 
n
/2;

331 ià(
n2
 * 2 =ğ
n
) {

332 
dummy
 = 
	`¿ndlc
(&
q
, q);

333 
n
 = 
n2
;

335 
dummy
 = 
	`¿ndlc
(&
r
, 
q
);

336 
n
 =‚-1;

339 
dummy
 = 
	`¿ndlc
(&
r
, 
q
);

340 *
»suÉ
 = 
r
;

341 
	}
}

346 
	$£tup
() {

351 
›¼
, 
i
, 
j
, 
f¡©us
;

353 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

356 
n™”
 = 
NITER_DEFAULT
;

358 
	`´štf
(" Siz : %3dx%3dx%3d\n", 
NX
, 
NY
, 
NZ
);

359 
	`´štf
(" I‹¿tiÚ  : %7d\n", 
n™”
);

366 
i
 = 0;i < 3 ; i++) {

367 
dims
[
i
][0] = 
NX
;

368 
dims
[
i
][1] = 
NY
;

369 
dims
[
i
][2] = 
NZ
;

373 
i
 = 0; i < 3; i++) {

374 
x¡¬t
[
i
] = 1;

375 
x’d
[
i
] = 
NX
;

376 
y¡¬t
[
i
] = 1;

377 
y’d
[
i
] = 
NY
;

378 
z¡¬t
[
i
] = 1;

379 
z’d
[
i
] = 
NZ
;

397 
fáblock
 = 
FFTBLOCK_DEFAULT
;

398 
fáblock·d
 = 
FFTBLOCKPAD_DEFAULT
;

400 ià(
fáblock
 !ğ
FFTBLOCK_DEFAULT
è
fáblock·d
 = fftblock+3;

401 
	}
}

406 
	$compu‹_šdexm­
(
šdexm­
[
NZ
][
NY
][
NX
], 
d
[3]) {

416 
i
, 
j
, 
k
, 
ii
, 
ii2
, 
jj
, 
ij2
, 
kk
;

417 
­
;

428 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
,
ii2
,
jj
,
ij2
,
kk
)

429 
i
 = 0; i < 
dims
[2][0]; i++) {

430 
ii
 = (
i
+1+
x¡¬t
[2]-2+
NX
/2)%NX - NX/2;

431 
ii2
 = 
ii
*ii;

432 
j
 = 0; j < 
dims
[2][1]; j++) {

433 
jj
 = (
j
+1+
y¡¬t
[2]-2+
NY
/2)%NY - NY/2;

434 
ij2
 = 
jj
*jj+
ii2
;

435 
k
 = 0; k < 
dims
[2][2]; k++) {

436 
kk
 = (
k
+1+
z¡¬t
[2]-2+
NZ
/2)%NZ - NZ/2;

437 
šdexm­
[
k
][
j
][
i
] = 
kk
*kk+
ij2
;

445 
­
 = - 4.0 * 
ALPHA
 * 
PI
 * PI;

447 
ex
[0] = 1.0;

448 
ex
[1] = 
	`exp
(
­
);

449 
i
 = 2; i <ğ
EXPMAX
; i++) {

450 
ex
[
i
] =ƒx[i-1]*ex[1];

453 
	}
}

458 
	$´št_tim”s
() {

463 
i
;

464 *
t¡ršgs
[] = { "otal ",

472 
i
 = 0; i < 
T_MAX
; i++) {

473 ià(
	`tim”_»ad
(
i
) != 0.0) {

474 
	`´štf
("tim” %2d(%16sĞ:%10.6f\n", 
i
, 
t¡ršgs
[i], 
	`tim”_»ad
(i));

477 
	}
}

483 
	$fá
(
dœ
, 
dcom¶ex
 
x1
[
NZ
][
NY
][
NX
], dcom¶ex 
x2
[NZ][NY][NX]) {

488 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

489 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

498 ià(
dœ
 == 1) {

499 
	`cfás1
(1, 
dims
[0], 
x1
, x1, 
y0
, 
y1
);

500 
	`cfás2
(1, 
dims
[1], 
x1
, x1, 
y0
, 
y1
);

501 
	`cfás3
(1, 
dims
[2], 
x1
, 
x2
, 
y0
, 
y1
);

503 
	`cfás3
(-1, 
dims
[2], 
x1
, x1, 
y0
, 
y1
);

504 
	`cfás2
(-1, 
dims
[1], 
x1
, x1, 
y0
, 
y1
);

505 
	`cfás1
(-1, 
dims
[0], 
x1
, 
x2
, 
y0
, 
y1
);

507 
	}
}

513 
	$cfás1
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

514 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

515 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

516 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

521 
logd
[3];

522 
i
, 
j
, 
k
, 
jj
;

524 
i
 = 0; i < 3; i++) {

525 
logd
[
i
] = 
	`og2
(
d
[i]);

528 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
jj
è
	`sh¬ed
(
is
)

530 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

531 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

533 #´agm¨
omp
 

534 
k
 = 0; k < 
d
[2]; k++) {

535 
jj
 = 0; jj <ğ
d
[1] - 
fáblock
; jj+=fftblock) {

537 
j
 = 0; j < 
fáblock
; j++) {

538 
i
 = 0; i < 
d
[0]; i++) {

540 
y0
[
i
][
j
].
»®
 = 
x
[
k
][j+
jj
][i].real;

542 
y0
[
i
][
j
].
imag
 = 
x
[
k
][j+
jj
][i].imag;

548 
	`cfáz
 (
is
, 
logd
[0],

549 
d
[0], 
y0
, 
y1
);

553 
j
 = 0; j < 
fáblock
; j++) {

554 
i
 = 0; i < 
d
[0]; i++) {

555 
xout
[
k
][
j
+
jj
][
i
].
»®
 = 
y0
[i][j].real;

556 
xout
[
k
][
j
+
jj
][
i
].
imag
 = 
y0
[i][j].imag;

563 
	}
}

568 
	$cfás2
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

569 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

570 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

571 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

576 
logd
[3];

577 
i
, 
j
, 
k
, 
ii
;

579 
i
 = 0; i < 3; i++) {

580 
logd
[
i
] = 
	`og2
(
d
[i]);

582 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
è
	`sh¬ed
(
is
)

584 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

585 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

587 #´agm¨
omp
 

588 
k
 = 0; k < 
d
[2]; k++) {

589 
ii
 = 0; i˜<ğ
d
[0] - 
fáblock
; ii+=fftblock) {

591 
j
 = 0; j < 
d
[1]; j++) {

592 
i
 = 0; i < 
fáblock
; i++) {

593 
y0
[
j
][
i
].
»®
 = 
x
[
k
][j][i+
ii
].real;

594 
y0
[
j
][
i
].
imag
 = 
x
[
k
][j][i+
ii
].imag;

599 
	`cfáz
 (
is
, 
logd
[1],

600 
d
[1], 
y0
, 
y1
);

604 
j
 = 0; j < 
d
[1]; j++) {

605 
i
 = 0; i < 
fáblock
; i++) {

606 
xout
[
k
][
j
][
i
+
ii
].
»®
 = 
y0
[j][i].real;

607 
xout
[
k
][
j
][
i
+
ii
].
imag
 = 
y0
[j][i].imag;

614 
	}
}

618 
	$cfás3
(
is
, 
d
[3], 
dcom¶ex
 
x
[
NZ
][
NY
][
NX
],

619 
dcom¶ex
 
xout
[
NZ
][
NY
][
NX
],

620 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
],

621 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
]) {

626 
logd
[3];

627 
i
, 
j
, 
k
, 
ii
;

629 
i
 = 0;i < 3; i++) {

630 
logd
[
i
] = 
	`og2
(
d
[i]);

632 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
ii
è
	`sh¬ed
(
is
)

634 
dcom¶ex
 
y0
[
NX
][
FFTBLOCKPAD
];

635 
dcom¶ex
 
y1
[
NX
][
FFTBLOCKPAD
];

637 #´agm¨
omp
 

638 
j
 = 0; j < 
d
[1]; j++) {

639 
ii
 = 0; i˜<ğ
d
[0] - 
fáblock
; ii+=fftblock) {

641 
k
 = 0; k < 
d
[2]; k++) {

642 
i
 = 0; i < 
fáblock
; i++) {

643 
y0
[
k
][
i
].
»®
 = 
x
[k][
j
][i+
ii
].real;

644 
y0
[
k
][
i
].
imag
 = 
x
[k][
j
][i+
ii
].imag;

650 
	`cfáz
 (
is
, 
logd
[2],

651 
d
[2], 
y0
, 
y1
);

654 
k
 = 0; k < 
d
[2]; k++) {

655 
i
 = 0; i < 
fáblock
; i++) {

656 
xout
[
k
][
j
][
i
+
ii
].
»®
 = 
y0
[k][i].real;

657 
xout
[
k
][
j
][
i
+
ii
].
imag
 = 
y0
[k][i].imag;

664 
	}
}

669 
	$fá_š™
 (
n
) {

678 
m
,
nu
,
ku
,
i
,
j
,
Ê
;

679 
t
, 
ti
;

686 
nu
 = 
n
;

687 
m
 = 
	`og2
(
n
);

688 
u
[0].
»®
 = ()
m
;

689 
u
[0].
imag
 = 0.0;

690 
ku
 = 1;

691 
Ê
 = 1;

693 
j
 = 1; j <ğ
m
; j++) {

694 
t
 = 
PI
 / 
Ê
;

696 
i
 = 0; i <ğ
Ê
 - 1; i++) {

697 
ti
 = 
i
 * 
t
;

698 
u
[
i
+
ku
].
»®
 = 
	`cos
(
ti
);

699 
u
[
i
+
ku
].
imag
 = 
	`sš
(
ti
);

702 
ku
 = ku + 
Ê
;

703 
Ê
 = 2 *†n;

705 
	}
}

711 
	$cfáz
 (
is
, 
m
, 
n
, 
dcom¶ex
 
x
[
NX
][
FFTBLOCKPAD
],

712 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]) {

726 
i
,
j
,
l
,
mx
;

731 
mx
 = ()(
u
[0].
»®
);

732 ià((
is
 !ğ1 && i !ğ-1è|| 
m
 < 1 || m > 
mx
) {

733 
	`´štf
("CFFTZ: Either U has‚ot been initialized, orƒlse\n"

735 
is
, 
m
, 
mx
);

736 
	`ex™
(1);

742 
l
 = 1;† <ğ
m
;†+=2) {

743 
	`fáz2
 (
is
, 
l
, 
m
, 
n
, 
fáblock
, 
fáblock·d
, 
u
, 
x
, 
y
);

744 ià(
l
 =ğ
m
) ;

745 
	`fáz2
 (
is
, 
l
 + 1, 
m
, 
n
, 
fáblock
, 
fáblock·d
, 
u
, 
y
, 
x
);

751 ià(
m
 % 2 == 1) {

752 
j
 = 0; j < 
n
; j++) {

753 
i
 = 0; i < 
fáblock
; i++) {

754 
x
[
j
][
i
].
»®
 = 
y
[j][i].real;

755 
x
[
j
][
i
].
imag
 = 
y
[j][i].imag;

759 
	}
}

765 
	$fáz2
 (
is
, 
l
, 
m
, 
n
, 
ny
, 
ny1
,

766 
dcom¶ex
 
u
[
NX
], dcom¶ex 
x
[NX][
FFTBLOCKPAD
],

767 
dcom¶ex
 
y
[
NX
][
FFTBLOCKPAD
]) {

776 
k
,
n1
,
li
,
lj
,
lk
,
ku
,
i
,
j
,
i11
,
i12
,
i21
,
i22
;

777 
dcom¶ex
 
u1
,
x11
,
x21
;

783 
n1
 = 
n
 / 2;

784 ià(
l
-1 == 0) {

785 
lk
 = 1;

787 
lk
 = 2 << ((
l
 - 1)-1);

789 ià(
m
-
l
 == 0) {

790 
li
 = 1;

792 
li
 = 2 << ((
m
 - 
l
)-1);

794 
lj
 = 2 * 
lk
;

795 
ku
 = 
li
;

797 
i
 = 0; i < 
li
; i++) {

799 
i11
 = 
i
 * 
lk
;

800 
i12
 = 
i11
 + 
n1
;

801 
i21
 = 
i
 * 
lj
;

802 
i22
 = 
i21
 + 
lk
;

803 ià(
is
 >= 1) {

804 
u1
.
»®
 = 
u
[
ku
+
i
].real;

805 
u1
.
imag
 = 
u
[
ku
+
i
].imag;

807 
u1
.
»®
 = 
u
[
ku
+
i
].real;

808 
u1
.
imag
 = -
u
[
ku
+
i
].imag;

814 
k
 = 0; k < 
lk
; k++) {

815 
j
 = 0; j < 
ny
; j++) {

816 
x11»®
, 
x11imag
;

817 
x21»®
, 
x21imag
;

818 
x11»®
 = 
x
[
i11
+
k
][
j
].
»®
;

819 
x11imag
 = 
x
[
i11
+
k
][
j
].
imag
;

820 
x21»®
 = 
x
[
i12
+
k
][
j
].
»®
;

821 
x21imag
 = 
x
[
i12
+
k
][
j
].
imag
;

822 
y
[
i21
+
k
][
j
].
»®
 = 
x11»®
 + 
x21»®
;

823 
y
[
i21
+
k
][
j
].
imag
 = 
x11imag
 + 
x21imag
;

824 
y
[
i22
+
k
][
j
].
»®
 = 
u1
.»® * (
x11»®
 - 
x21»®
)

825 - 
u1
.
imag
 * (
x11imag
 - 
x21imag
);

826 
y
[
i22
+
k
][
j
].
imag
 = 
u1
.
»®
 * (
x11imag
 - 
x21imag
)

827 + 
u1
.
imag
 * (
x11»®
 - 
x21»®
);

831 
	}
}

837 
	$og2
(
n
) {

842 
Â
, 
lg
;

844 ià(
n
 == 1) {

847 
lg
 = 1;

848 
Â
 = 2;

849 
Â
 < 
n
) {

850 
Â
 =‚n << 1;

851 
lg
++;

854  
lg
;

855 
	}
}

861 
	$checksum
(
i
, 
dcom¶ex
 
u1
[
NZ
][
NY
][
NX
], 
d
[3]) {

863 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
)

869 
j
, 
q
,
r
,
s
, 
›¼
;

870 
dcom¶ex
 
chk
,
®lchk
;

872 
chk
.
»®
 = 0.0;

873 
chk
.
imag
 = 0.0;

876 #´agm¨
omp
 
nowa™


877 
j
 = 1; j <= 1024; j++) {

878 
q
 = 
j
%
NX
+1;

879 ià(
q
 >ğ
x¡¬t
[0] && q <ğ
x’d
[0]) {

880 
r
 = (3*
j
)%
NY
+1;

881 ià(
r
 >ğ
y¡¬t
[0] &&„ <ğ
y’d
[0]) {

882 
s
 = (5*
j
)%
NZ
+1;

883 ià(
s
 >ğ
z¡¬t
[0] && s <ğ
z’d
[0]) {

884 
	`ÿdd
(
chk
,chk,
u1
[
s
-
z¡¬t
[0]][
r
-
y¡¬t
[0]][
q
-
x¡¬t
[0]]);

889 #´agm¨
omp
 
ü™iÿl


891 
sums
[
i
].
»®
 +ğ
chk
.real;

892 
sums
[
i
].
imag
 +ğ
chk
.imag;

894 #´agm¨
omp
 
b¬r›r


895 #´agm¨
omp
 
sšgË


898 
sums
[
i
].
»®
 = sums[i].»®/()(
NTOTAL
);

899 
sums
[
i
].
imag
 = sums[i].imag/()(
NTOTAL
);

901 
	`´štf
("T = %5d Checksum = %22.12e %22.12e\n",

902 
i
, 
sums
[i].
»®
, sums[i].
imag
);

905 
	}
}

910 
	$v”ify
 (
d1
, 
d2
, 
d3
, 
Á
,

911 
boŞ—n
 *
v”if›d
, *
şass
) {

916 
›¼
, 
size
, 
i
;

917 
”r
, 
•sÚ
;

926 
vd©a_»®_s
[6+1] = { 0.0,

933 
vd©a_imag_s
[6+1] = { 0.0,

943 
vd©a_»®_w
[6+1] = { 0.0,

950 
vd©a_imag_w
[6+1] = { 0.0,

960 
vd©a_»®_a
[6+1] = { 0.0,

967 
vd©a_imag_a
[6+1] = { 0.0,

977 
vd©a_»®_b
[20+1] = { 0.0,

998 
vd©a_imag_b
[20+1] = { 0.0,

1022 
vd©a_»®_c
[20+1] = { 0.0,

1043 
vd©a_imag_c
[20+1] = { 0.0,

1065 
•sÚ
 = 1.0e-12;

1066 *
v”if›d
 = 
TRUE
;

1067 *
şass
 = 'U';

1069 ià(
d1
 == 64 &&

1070 
d2
 == 64 &&

1071 
d3
 == 64 &&

1072 
Á
 == 6) {

1073 *
şass
 = 'S';

1074 
i
 = 1; i <ğ
Á
; i++) {

1075 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_s
[i]) / vdata_real_s[i];

1076 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1077 *
v”if›d
 = 
FALSE
;

1080 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_s
[i]) / vdata_imag_s[i];

1081 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1082 *
v”if›d
 = 
FALSE
;

1086 } ià(
d1
 == 128 &&

1087 
d2
 == 128 &&

1088 
d3
 == 32 &&

1089 
Á
 == 6) {

1090 *
şass
 = 'W';

1091 
i
 = 1; i <ğ
Á
; i++) {

1092 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_w
[i]) / vdata_real_w[i];

1093 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1094 *
v”if›d
 = 
FALSE
;

1097 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_w
[i]) / vdata_imag_w[i];

1098 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1099 *
v”if›d
 = 
FALSE
;

1103 } ià(
d1
 == 256 &&

1104 
d2
 == 256 &&

1105 
d3
 == 128 &&

1106 
Á
 == 6) {

1107 *
şass
 = 'A';

1108 
i
 = 1; i <ğ
Á
; i++) {

1109 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_a
[i]) / vdata_real_a[i];

1110 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1111 *
v”if›d
 = 
FALSE
;

1114 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_a
[i]) / vdata_imag_a[i];

1115 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1116 *
v”if›d
 = 
FALSE
;

1120 } ià(
d1
 == 512 &&

1121 
d2
 == 256 &&

1122 
d3
 == 256 &&

1123 
Á
 == 20) {

1124 *
şass
 = 'B';

1125 
i
 = 1; i <ğ
Á
; i++) {

1126 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_b
[i]) / vdata_real_b[i];

1127 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1128 *
v”if›d
 = 
FALSE
;

1131 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_b
[i]) / vdata_imag_b[i];

1132 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1133 *
v”if›d
 = 
FALSE
;

1137 } ià(
d1
 == 512 &&

1138 
d2
 == 512 &&

1139 
d3
 == 512 &&

1140 
Á
 == 20) {

1141 *
şass
 = 'C';

1142 
i
 = 1; i <ğ
Á
; i++) {

1143 
”r
 = (
	`g‘_»®
(
sums
[
i
]è- 
vd©a_»®_c
[i]) / vdata_real_c[i];

1144 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1145 *
v”if›d
 = 
FALSE
;

1148 
”r
 = (
	`g‘_imag
(
sums
[
i
]è- 
vd©a_imag_c
[i]) / vdata_imag_c[i];

1149 ià(
	`çbs
(
”r
è> 
•sÚ
) {

1150 *
v”if›d
 = 
FALSE
;

1156 ià(*
şass
 != 'U') {

1157 
	`´štf
("Result verification successful\n");

1159 
	`´štf
("Result verification failed\n");

1161 
	`´štf
("şas ğ%1c\n", *
şass
);

1162 
	}
}

	@FT/global.h

1 
	~"Åb·¿ms.h
"

20 
	#FFTBLOCK_DEFAULT
 16

	)

21 
	#FFTBLOCKPAD_DEFAULT
 18

	)

23 
	#FFTBLOCK
 
FFTBLOCK_DEFAULT


	)

24 
	#FFTBLOCKPAD
 
FFTBLOCKPAD_DEFAULT


	)

27 
	gfáblock
;

28 
	gfáblock·d
;

64 
	gdims
[3][3];

65 
	gx¡¬t
[3];

66 
	gy¡¬t
[3];

67 
	gz¡¬t
[3];

68 
	gx’d
[3];

69 
	gy’d
[3];

70 
	gz’d
[3];

72 
	#T_TOTAL
 0

	)

73 
	#T_SETUP
 1

	)

74 
	#T_FFT
 2

	)

75 
	#T_EVOLVE
 3

	)

76 
	#T_CHECKSUM
 4

	)

77 
	#T_FFTLOW
 5

	)

78 
	#T_FFTCOPY
 6

	)

79 
	#T_MAX
 7

	)

81 
	#TIMERS_ENABLED
 
FALSE


	)

85 
	#SEED
 314159265.0

	)

86 
	#A
 1220703125.0

	)

87 
	#PI
 3.141592653589793238

	)

88 
	#ALPHA
 1.0e-6

	)

90 
	#EXPMAX
 (
NITER_DEFAULT
*(
NX
*NX/4+
NY
*NY/4+
NZ
*NZ/4))

	)

93 
	gex
[
EXPMAX
+1];

101 
dcom¶ex
 
	gu
[
NX
];

106 
dcom¶ex
 
	gsums
[
NITER_DEFAULT
+1];

111 
	gn™”
;

	@FT/npbparams.h

7 
	#NX
 64

	)

8 
	#NY
 64

	)

9 
	#NZ
 64

	)

10 
	#MAXDIM
 64

	)

11 
	#NITER_DEFAULT
 6

	)

12 
	#NTOTAL
 262144

	)

13 
	#CONVERTDOUBLE
 
FALSE


	)

14 
	#COMPILETIME
 "25 S• 2020"

	)

15 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

16 
	#CS1
 "şªg-10"

	)

17 
	#CS2
 "şªg-10"

	)

18 
	#CS3
 "-lm"

	)

19 
	#CS4
 "-I../commÚ "

	)

20 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

21 
	#CS6
 "-lomp"

	)

22 
	#CS7
 "¿nddp"

	)

	@IS/is.c

33 
	~"Åb·¿ms.h
"

34 
	~<Çutus/Çutus.h
>

35 
	~<Çutus/sh–l.h
>

61 #iâdeà
CLASS


62 
	#CLASS
 'S'

	)

69 #ià
CLASS
 == 'S'

70 
	#TOTAL_KEYS_LOG_2
 16

	)

71 
	#MAX_KEY_LOG_2
 11

	)

72 
	#NUM_BUCKETS_LOG_2
 9

	)

79 #ià
CLASS
 == 'W'

80 
	#TOTAL_KEYS_LOG_2
 20

	)

81 
	#MAX_KEY_LOG_2
 16

	)

82 
	#NUM_BUCKETS_LOG_2
 10

	)

88 #ià
CLASS
 == 'A'

89 
	#TOTAL_KEYS_LOG_2
 23

	)

90 
	#MAX_KEY_LOG_2
 19

	)

91 
	#NUM_BUCKETS_LOG_2
 10

	)

98 #ià
CLASS
 == 'B'

99 
	#TOTAL_KEYS_LOG_2
 25

	)

100 
	#MAX_KEY_LOG_2
 21

	)

101 
	#NUM_BUCKETS_LOG_2
 10

	)

108 #ià
CLASS
 == 'C'

109 
	#TOTAL_KEYS_LOG_2
 27

	)

110 
	#MAX_KEY_LOG_2
 23

	)

111 
	#NUM_BUCKETS_LOG_2
 10

	)

115 
	#TOTAL_KEYS
 (1 << 
TOTAL_KEYS_LOG_2
)

	)

116 
	#MAX_KEY
 (1 << 
MAX_KEY_LOG_2
)

	)

117 
	#NUM_BUCKETS
 (1 << 
NUM_BUCKETS_LOG_2
)

	)

118 
	#NUM_KEYS
 
TOTAL_KEYS


	)

119 
	#SIZE_OF_BUFFERS
 
NUM_KEYS


	)

122 
	#MAX_ITERATIONS
 10

	)

123 
	#TEST_ARRAY_SIZE
 5

	)

131 
	tINT_TYPE
;

137 
INT_TYPE
 *
	gkey_buff_±r_glob®
;

140 
	g·s£d_v”ifiÿtiÚ
;

147 
INT_TYPE
 
	gkey_¬¿y
[
SIZE_OF_BUFFERS
],

148 
	gkey_buff1
[
SIZE_OF_BUFFERS
],

149 
	gkey_buff2
[
SIZE_OF_BUFFERS
],

150 
	g·¹Ÿl_v”ify_v®s
[
TEST_ARRAY_SIZE
];

152 #ifdeà
USE_BUCKETS


153 
INT_TYPE
 
	gbuck‘_size
[
NUM_BUCKETS
],

154 
	gbuck‘_±rs
[
NUM_BUCKETS
];

161 
INT_TYPE
 
	g‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
],

162 
	g‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
],

164 
	gS_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

166 
	gS_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

169 
	gW_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

171 
	gW_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

174 
	gA_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

176 
	gA_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

179 
	gB_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

181 
	gB_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

184 
	gC_‹¡_šdex_¬¿y
[
TEST_ARRAY_SIZE
] =

186 
	gC_‹¡_¿nk_¬¿y
[
TEST_ARRAY_SIZE
] =

194 
¿ndlc
Ğ*
X
, *
A
 );

196 
fuÎ_v”ify
( );

237 
	$¿ndlc
(
X
, 
A
)

238 *
X
;

239 *
A
;

241 
KS
=0;

242 
R23
, 
R46
, 
T23
, 
T46
;

243 
T1
, 
T2
, 
T3
, 
T4
;

244 
A1
;

245 
A2
;

246 
X1
;

247 
X2
;

248 
Z
;

249 
i
, 
j
;

251 ià(
KS
 == 0)

253 
R23
 = 1.0;

254 
R46
 = 1.0;

255 
T23
 = 1.0;

256 
T46
 = 1.0;

258 
i
=1; i<=23; i++)

260 
R23
 = 0.50 * R23;

261 
T23
 = 2.0 * T23;

263 
i
=1; i<=46; i++)

265 
R46
 = 0.50 * R46;

266 
T46
 = 2.0 * T46;

268 
KS
 = 1;

273 
T1
 = 
R23
 * *
A
;

274 
j
 = 
T1
;

275 
A1
 = 
j
;

276 
A2
 = *
A
 - 
T23
 * 
A1
;

282 
T1
 = 
R23
 * *
X
;

283 
j
 = 
T1
;

284 
X1
 = 
j
;

285 
X2
 = *
X
 - 
T23
 * 
X1
;

286 
T1
 = 
A1
 * 
X2
 + 
A2
 * 
X1
;

288 
j
 = 
R23
 * 
T1
;

289 
T2
 = 
j
;

290 
Z
 = 
T1
 - 
T23
 * 
T2
;

291 
T3
 = 
T23
 * 
Z
 + 
A2
 * 
X2
;

292 
j
 = 
R46
 * 
T3
;

293 
T4
 = 
j
;

294 *
X
 = 
T3
 - 
T46
 * 
T4
;

295 (
R46
 * *
X
);

296 
	}
}

305 
	$ü—‹_£q
Ğ
£ed
, 
a
 )

307 
x
;

308 
i
, 
j
, 
k
;

310 
k
 = 
MAX_KEY
/4;

312 
i
=0; i<
NUM_KEYS
; i++)

314 
x
 = 
	`¿ndlc
(&
£ed
, &
a
);

315 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

316 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

317 
x
 +ğ
	`¿ndlc
(&
£ed
, &
a
);

319 
key_¬¿y
[
i
] = 
k
*
x
;

321 
	}
}

331 
	$fuÎ_v”ify
()

333 
INT_TYPE
 
i
, 
j
;

334 
INT_TYPE
 
k
;

335 
INT_TYPE
 
m
, 
unique_keys
;

340  
i
=0; i<
NUM_KEYS
; i++ )

341 
key_¬¿y
[--
key_buff_±r_glob®
[
key_buff2
[
i
]]] = key_buff2[i];

346 
j
 = 0;

347  
i
=1; i<
NUM_KEYS
; i++ )

348 ifĞ
key_¬¿y
[
i
-1] > key_array[i] )

349 
j
++;

352 ifĞ
j
 != 0 )

354 
	`´štf
( "Full_verify:‚umber of keys out of sort: %d\n",

355 
j
 );

358 
·s£d_v”ifiÿtiÚ
++;

361 
	}
}

370 
	$¿nk
Ğ
™”©iÚ
 )

373 
INT_TYPE
 
i
, 
j
, 
k
;

374 
INT_TYPE
 
l
, 
m
;

376 
INT_TYPE
 
shiá
 = 
MAX_KEY_LOG_2
 - 
NUM_BUCKETS_LOG_2
;

377 
INT_TYPE
 
key
;

378 
INT_TYPE
 
mš_key_v®
, 
max_key_v®
;

380 
INT_TYPE
 
´v_buff1
[
MAX_KEY
];

382 #´agm¨
omp
 
ma¡”


384 
key_¬¿y
[
™”©iÚ
] = iteration;

385 
key_¬¿y
[
™”©iÚ
+
MAX_ITERATIONS
] = 
MAX_KEY
 - iteration;

389  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

390 
·¹Ÿl_v”ify_v®s
[
i
] = 
key_¬¿y
[
‹¡_šdex_¬¿y
[i]];

393  
i
=0; i<
MAX_KEY
; i++ )

394 
key_buff1
[
i
] = 0;

396 #´agm¨
omp
 
b¬r›r


398 
i
=0; i<
MAX_KEY
; i++)

399 
´v_buff1
[
i
] = 0;

402 #´agm¨
omp
 
nowa™


403  
i
=0; i<
NUM_KEYS
; i++ ) {

404 
key_buff2
[
i
] = 
key_¬¿y
[i];

412 
´v_buff1
[
key_buff2
[
i
]]++;

415  
i
=0; i<
MAX_KEY
-1; i++ )

416 
´v_buff1
[
i
+1] +=…rv_buff1[i];

421  
i
=0; i<
MAX_KEY
; i++ )

422 
key_buff1
[
i
] +ğ
´v_buff1
[i];

429 #´agm¨
omp
 
b¬r›r


430 #´agm¨
omp
 
ma¡”


436  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

438 
k
 = 
·¹Ÿl_v”ify_v®s
[
i
];

439 ifĞ0 <ğ
k
 && k <ğ
NUM_KEYS
-1 )

440  
CLASS
 )

443 ifĞ
i
 <= 2 )

445 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

447 
	`´štf
( "Failed…artial verification: "

449 
™”©iÚ
, 
i
 );

452 
·s£d_v”ifiÿtiÚ
++;

456 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

458 
	`´štf
( "Failed…artial verification: "

460 
™”©iÚ
, 
i
 );

463 
·s£d_v”ifiÿtiÚ
++;

467 ifĞ
i
 < 2 )

469 ifĞ
key_buff1
[
k
-1] !=

470 
‹¡_¿nk_¬¿y
[
i
]+(
™”©iÚ
-2) )

472 
	`´štf
( "Failed…artial verification: "

474 
™”©iÚ
, 
i
 );

477 
·s£d_v”ifiÿtiÚ
++;

481 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

483 
	`´štf
( "Failed…artial verification: "

485 
™”©iÚ
, 
i
 );

488 
·s£d_v”ifiÿtiÚ
++;

492 ifĞ
i
 <= 2 )

494 ifĞ
key_buff1
[
k
-1] !=

495 
‹¡_¿nk_¬¿y
[
i
]+(
™”©iÚ
-1) )

497 
	`´štf
( "Failed…artial verification: "

499 
™”©iÚ
, 
i
 );

502 
·s£d_v”ifiÿtiÚ
++;

506 ifĞ
key_buff1
[
k
-1] !=

507 
‹¡_¿nk_¬¿y
[
i
]-(
™”©iÚ
-1) )

509 
	`´štf
( "Failed…artial verification: "

511 
™”©iÚ
, 
i
 );

514 
·s£d_v”ifiÿtiÚ
++;

518 ifĞ
i
 == 1 || i == 2 || i == 4 )

520 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

522 
	`´štf
( "Failed…artial verification: "

524 
™”©iÚ
, 
i
 );

527 
·s£d_v”ifiÿtiÚ
++;

531 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

533 
	`´štf
( "Failed…artial verification: "

535 
™”©iÚ
, 
i
 );

538 
·s£d_v”ifiÿtiÚ
++;

542 ifĞ
i
 <= 2 )

544 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]+
™”©iÚ
 )

546 
	`´štf
( "Failed…artial verification: "

548 
™”©iÚ
, 
i
 );

551 
·s£d_v”ifiÿtiÚ
++;

555 ifĞ
key_buff1
[
k
-1] !ğ
‹¡_¿nk_¬¿y
[
i
]-
™”©iÚ
 )

557 
	`´štf
( "Failed…artial verification: "

559 
™”©iÚ
, 
i
 );

562 
·s£d_v”ifiÿtiÚ
++;

575 ifĞ
™”©iÚ
 =ğ
MAX_ITERATIONS
 )

576 
key_buff_±r_glob®
 = 
key_buff1
;

579 
	}
}

587 
´og¿m_IS
(*
_buf
, * 
_´iv
);

589 
sh–l_cmd_im¶
 
	gÇs_is_im¶
 = {

590 .
cmd
 = "nas-is",

591 .
	gh–p_¡r
 = "NAS…arallel benchmark IS",

592 .
	ghªdËr
 = 
´og¿m_IS
,

594 
nk_»gi¡”_sh–l_cmd
(
Çs_is_im¶
);

596 
	$´og¿m_IS
(* 
_buf
, *
_´iv
) {

599 
i
, 
™”©iÚ
, 
™emp
;

600 
Áh»ads
 = 1;

601 
timecouÁ”
, 
maxtime
;

606  
i
=0; i<
TEST_ARRAY_SIZE
; i++ )

607  
CLASS
 )

610 
‹¡_šdex_¬¿y
[
i
] = 
S_‹¡_šdex_¬¿y
[i];

611 
‹¡_¿nk_¬¿y
[
i
] = 
S_‹¡_¿nk_¬¿y
[i];

614 
‹¡_šdex_¬¿y
[
i
] = 
A_‹¡_šdex_¬¿y
[i];

615 
‹¡_¿nk_¬¿y
[
i
] = 
A_‹¡_¿nk_¬¿y
[i];

618 
‹¡_šdex_¬¿y
[
i
] = 
W_‹¡_šdex_¬¿y
[i];

619 
‹¡_¿nk_¬¿y
[
i
] = 
W_‹¡_¿nk_¬¿y
[i];

622 
‹¡_šdex_¬¿y
[
i
] = 
B_‹¡_šdex_¬¿y
[i];

623 
‹¡_¿nk_¬¿y
[
i
] = 
B_‹¡_¿nk_¬¿y
[i];

626 
‹¡_šdex_¬¿y
[
i
] = 
C_‹¡_šdex_¬¿y
[i];

627 
‹¡_¿nk_¬¿y
[
i
] = 
C_‹¡_¿nk_¬¿y
[i];

634 
	`´štf
( "\n\n NAS Parallel Benchmarks 2.3 OpenMP C version"

636 
	`´štf
Ğ" Size: %d (şas %c)\n", 
TOTAL_KEYS
, 
CLASS
 );

637 
	`´štf
Ğ" I‹¿tiÚs: %d\n", 
MAX_ITERATIONS
 );

640 
	`tim”_ş—r
( 0 );

643 
	`ü—‹_£q
( 314159265.00,

649 #´agm¨
omp
 
·¿Î–


650 
	`¿nk
( 1 );

653 
·s£d_v”ifiÿtiÚ
 = 0;

655 ifĞ
CLASS
 !ğ'S' ) 
	`´štf
( "\n iteration\n" );

658 
	`tim”_¡¬t
( 0 );

663 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
™”©iÚ
)

664  
™”©iÚ
=1; i‹¿tiÚ<=
MAX_ITERATIONS
; iteration++ )

666 #´agm¨
omp
 
ma¡”


667 ifĞ
CLASS
 !ğ'S' ) 
	`´štf
Ğ" %d\n", 
™”©iÚ
 );

669 
	`¿nk
Ğ
™”©iÚ
 );

671 #ià
	`defšed
(
_OPENMP
)

672 #´agm¨
omp
 
ma¡”


673 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

678 
	`tim”_¡İ
( 0 );

679 
timecouÁ”
 = 
	`tim”_»ad
( 0 );

684 
	`fuÎ_v”ify
();

689 ifĞ
·s£d_v”ifiÿtiÚ
 !ğ5*
MAX_ITERATIONS
 + 1 )

690 
·s£d_v”ifiÿtiÚ
 = 0;

691 
	`c_´št_»suÉs
( "IS",

692 
CLASS
,

693 
TOTAL_KEYS
,

696 
MAX_ITERATIONS
,

697 
Áh»ads
,

698 
timecouÁ”
,

699 ((è(
MAX_ITERATIONS
*
TOTAL_KEYS
))

700 /
timecouÁ”
/1000000.,

702 
·s£d_v”ifiÿtiÚ
,

703 
NPBVERSION
,

704 
COMPILETIME
,

705 
CC
,

706 
CLINK
,

707 
C_LIB
,

708 
C_INC
,

709 
CFLAGS
,

710 
CLINKFLAGS
,

716 
	}
}

	@IS/npbparams.h

1 
	#CLASS
 'S'

	)

7 
	#COMPILETIME
 "25 S• 2020"

	)

8 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

9 
	#CC
 "şªg-10"

	)

10 
	#CFLAGS
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

11 
	#CLINK
 "şªg-10"

	)

12 
	#CLINKFLAGS
 "-lomp"

	)

13 
	#C_LIB
 "-lm"

	)

14 
	#C_INC
 "-I../commÚ "

	)

	@LU/applu.h

12 
	~"Åb·¿ms.h
"

22 
	#IPR_DEFAULT
 1

	)

23 
	#OMEGA_DEFAULT
 1.2

	)

25 
	#TOLRSD1_DEF
 1.0e-8

	)

26 
	#TOLRSD2_DEF
 1.0e-8

	)

27 
	#TOLRSD3_DEF
 1.0e-8

	)

28 
	#TOLRSD4_DEF
 1.0e-8

	)

29 
	#TOLRSD5_DEF
 1.0e-8

	)

31 
	#C1
 1.40e+00

	)

32 
	#C2
 0.40e+00

	)

33 
	#C3
 1.00e-01

	)

34 
	#C4
 1.00e+00

	)

35 
	#C5
 1.40e+00

	)

42 
	gnx
, 
	gny
, 
	gnz
;

43 
	gnx0
, 
	gny0
, 
	gnz0
;

44 
	gi¡
, 
	g›nd
;

45 
	gj¡
, 
	gj’d
;

46 
	gii1
, 
	gii2
;

47 
	gji1
, 
	gji2
;

48 
	gki1
, 
	gki2
;

49 
	gdxi
, 
	gd‘a
, 
	gdz‘a
;

50 
	gtx1
, 
	gtx2
, 
	gtx3
;

51 
	gty1
, 
	gty2
, 
	gty3
;

52 
	gtz1
, 
	gtz2
, 
	gtz3
;

59 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
;

60 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
, 
	gdy5
;

61 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
;

62 
	gds¥
;

73 
	gu
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

74 
	grsd
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

75 
	gäù
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

76 
	gæux
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5];

83 
	gr
, 
	gšÜm
;

90 
	g™max
, 
	gšv”t
;

91 
	gdt
, 
	gomega
, 
	gtŞrsd
[5], 
	grsdnm
[5], 
	g”ºm
[5], 
	gäc
, 
	g‰Ù®
;

94 
	ga
[
ISIZ1
][
ISIZ2
][5][5];

95 
	gb
[
ISIZ1
][
ISIZ2
][5][5];

96 
	gc
[
ISIZ1
][
ISIZ2
][5][5];

97 
	gd
[
ISIZ1
][
ISIZ2
][5][5];

104 
	gû
[5][13];

111 
	gmaxtime
;

	@LU/lu.c

36 
	~"../commÚ/Åb-C.h
"

37 
	~<Çutus/Çutus.h
>

38 
	~<Çutus/sh–l.h
>

39 
	~"../m©h/Çs_m©h.h
"

41 
	~"­¶u.h
"

43 #ià
defšed
(
_OPENMP
)

45 
boŞ—n
 
	gæag
[
ISIZ1
/2*2+1];

49 
bÉs
 (
nx
, 
ny
, 
nz
, 
k
,

50 
omega
,

51 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

52 
ldz
[
ISIZ1
][
ISIZ2
][5][5],

53 
ldy
[
ISIZ1
][
ISIZ2
][5][5],

54 
ldx
[
ISIZ1
][
ISIZ2
][5][5],

55 
d
[
ISIZ1
][
ISIZ2
][5][5],

56 
i¡
, 
›nd
, 
j¡
, 
j’d
,

57 
nx0
, 
ny0
 );

58 
buts
(
nx
, 
ny
, 
nz
, 
k
,

59 
omega
,

60 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

61 
tv
[
ISIZ1
][
ISIZ2
][5],

62 
d
[
ISIZ1
][
ISIZ2
][5][5],

63 
udx
[
ISIZ1
][
ISIZ2
][5][5],

64 
udy
[
ISIZ1
][
ISIZ2
][5][5],

65 
udz
[
ISIZ1
][
ISIZ2
][5][5],

66 
i¡
, 
›nd
, 
j¡
, 
j’d
,

67 
nx0
, 
ny0
 );

68 
domaš
();

69 
”hs
();

70 
”rÜ
();

71 
exaù
Ğ
i
, 
j
, 
k
, 
u000ijk
[5] );

72 
jaşd
(
k
);

73 
jacu
(
k
);

74 
l2nÜm
 (
nx0
, 
ny0
, 
nz0
,

75 
i¡
, 
›nd
,

76 
j¡
, 
j’d
,

77 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

78 
sum
[5]);

79 
pštgr
();

80 
»ad_šput
();

81 
rhs
();

82 
£tbv
();

83 
£tcÛff
();

84 
£tiv
();

85 
ssÜ
();

86 
v”ify
(
xü
[5], 
xû
[5], 
xci
,

87 *
şass
, 
boŞ—n
 *
v”if›d
);

93 
´og¿m_LU
(*
_buf
, * 
_´iv
);

95 
sh–l_cmd_im¶
 
	gÇs_lu_im¶
 = {

96 .
cmd
 = "nas-lu",

97 .
	gh–p_¡r
 = "NAS…arallel benchmark LU",

98 .
	ghªdËr
 = 
´og¿m_LU
,

100 
nk_»gi¡”_sh–l_cmd
(
Çs_lu_im¶
);

102 
	$´og¿m_LU
(* 
_buf
, *
_´iv
) {

111 
şass
;

112 
boŞ—n
 
v”if›d
;

113 
mæİs
;

114 
Áh»ads
 = 1;

119 
	`»ad_šput
();

124 
	`domaš
();

129 
	`£tcÛff
();

134 
	`£tbv
();

139 
	`£tiv
();

144 
	`”hs
();

146 #´agm¨
omp
 
·¿Î–


149 #ià
	`defšed
(
_OPENMP
)

150 #´agm¨
omp
 
ma¡”


151 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

158 
	`ssÜ
();

163 
	`”rÜ
();

168 
	`pštgr
();

173 
	`v”ify
 ( 
rsdnm
, 
”ºm
, 
äc
, &
şass
, &
v”if›d
 );

174 
mæİs
 = ()
™max
*(1984.77*()
nx0


175 *()
ny0


176 *()
nz0


177 -10923.3*
	`pow2
(()Ğ
nx0
+
ny0
+
nz0
 )/3.0)

178 +27770.9* ()Ğ
nx0
+
ny0
+
nz0
 )/3.0

180 / (
maxtime
*1000000.0);

182 
	`c_´št_»suÉs
("LU", 
şass
, 
nx0
,

183 
ny0
, 
nz0
, 
™max
, 
Áh»ads
,

184 
maxtime
, 
mæİs
, " flßtšg…ošt", 
v”if›d
,

185 
NPBVERSION
, 
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
,

187 
	}
}

192 
bÉs
 (
nx
, 
ny
, 
nz
, 
k
,

193 
omega
,

198 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

199 
ldz
[
ISIZ1
][
ISIZ2
][5][5],

200 
ldy
[
ISIZ1
][
ISIZ2
][5][5],

201 
ldx
[
ISIZ1
][
ISIZ2
][5][5],

202 
d
[
ISIZ1
][
ISIZ2
][5][5],

203 
i¡
, 
›nd
, 
j¡
, 
j’d
,

204 
nx0
, 
ny0
 ) {

216 
	gi
, 
	gj
, 
	gm
;

217 
	gtmp
, 
	gtmp1
;

218 
	gtm©
[5][5];

220 #´agm¨
omp
 
nowa™
 
scheduË
()

221 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

222 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

223 
	gm
 = 0; m < 5; m++) {

224 
	gv
[
i
][
j
][
k
][
m
] = 
v
[i][j][k][m]

225 - 
omega
 * ( 
ldz
[
i
][
j
][
m
][0] * 
v
[i][j][
k
-1][0]

226 + 
ldz
[
i
][
j
][
m
][1] * 
v
[i][j][
k
-1][1]

227 + 
ldz
[
i
][
j
][
m
][2] * 
v
[i][j][
k
-1][2]

228 + 
ldz
[
i
][
j
][
m
][3] * 
v
[i][j][
k
-1][3]

229 + 
ldz
[
i
][
j
][
m
][4] * 
v
[i][j][
k
-1][4] );

234 #´agm¨
omp
 
nowa™
 
scheduË
()

235 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

237 #ià
defšed
(
_OPENMP
)

238 ià(
	gi
 !ğ
i¡
) {

239 
æag
[
i
-1] == 0) {

240 #´agm¨
omp
 
æush
(
æag
)

244 ià(
	gi
 !ğ
›nd
) {

245 
æag
[
i
] == 1) {

246 #´agm¨
omp
 
æush
(
æag
)

252 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

253 
	gm
 = 0; m < 5; m++) {

255 
	gv
[
i
][
j
][
k
][
m
] = 
v
[i][j][k][m]

256 - 
omega
 * ( 
ldy
[
i
][
j
][
m
][0] * 
v
[i][j-1][
k
][0]

257 + 
ldx
[
i
][
j
][
m
][0] * 
v
[i-1][j][
k
][0]

258 + 
ldy
[
i
][
j
][
m
][1] * 
v
[i][j-1][
k
][1]

259 + 
ldx
[
i
][
j
][
m
][1] * 
v
[i-1][j][
k
][1]

260 + 
ldy
[
i
][
j
][
m
][2] * 
v
[i][j-1][
k
][2]

261 + 
ldx
[
i
][
j
][
m
][2] * 
v
[i-1][j][
k
][2]

262 + 
ldy
[
i
][
j
][
m
][3] * 
v
[i][j-1][
k
][3]

263 + 
ldx
[
i
][
j
][
m
][3] * 
v
[i-1][j][
k
][3]

264 + 
ldy
[
i
][
j
][
m
][4] * 
v
[i][j-1][
k
][4]

265 + 
ldx
[
i
][
j
][
m
][4] * 
v
[i-1][j][
k
][4] );

273 
	gm
 = 0; m < 5; m++) {

274 
	gtm©
[
m
][0] = 
d
[
i
][
j
][m][0];

275 
	gtm©
[
m
][1] = 
d
[
i
][
j
][m][1];

276 
	gtm©
[
m
][2] = 
d
[
i
][
j
][m][2];

277 
	gtm©
[
m
][3] = 
d
[
i
][
j
][m][3];

278 
	gtm©
[
m
][4] = 
d
[
i
][
j
][m][4];

281 
	gtmp1
 = 1.0 / 
tm©
[0][0];

282 
	gtmp
 = 
tmp1
 * 
tm©
[1][0];

283 
	gtm©
[1][1] = 
tm©
[1][1]

284 - 
tmp
 * 
tm©
[0][1];

285 
	gtm©
[1][2] = 
tm©
[1][2]

286 - 
tmp
 * 
tm©
[0][2];

287 
	gtm©
[1][3] = 
tm©
[1][3]

288 - 
tmp
 * 
tm©
[0][3];

289 
	gtm©
[1][4] = 
tm©
[1][4]

290 - 
tmp
 * 
tm©
[0][4];

291 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

292 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

294 
	gtmp
 = 
tmp1
 * 
tm©
[2][0];

295 
	gtm©
[2][1] = 
tm©
[2][1]

296 - 
tmp
 * 
tm©
[0][1];

297 
	gtm©
[2][2] = 
tm©
[2][2]

298 - 
tmp
 * 
tm©
[0][2];

299 
	gtm©
[2][3] = 
tm©
[2][3]

300 - 
tmp
 * 
tm©
[0][3];

301 
	gtm©
[2][4] = 
tm©
[2][4]

302 - 
tmp
 * 
tm©
[0][4];

303 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

304 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

306 
	gtmp
 = 
tmp1
 * 
tm©
[3][0];

307 
	gtm©
[3][1] = 
tm©
[3][1]

308 - 
tmp
 * 
tm©
[0][1];

309 
	gtm©
[3][2] = 
tm©
[3][2]

310 - 
tmp
 * 
tm©
[0][2];

311 
	gtm©
[3][3] = 
tm©
[3][3]

312 - 
tmp
 * 
tm©
[0][3];

313 
	gtm©
[3][4] = 
tm©
[3][4]

314 - 
tmp
 * 
tm©
[0][4];

315 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

316 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

318 
	gtmp
 = 
tmp1
 * 
tm©
[4][0];

319 
	gtm©
[4][1] = 
tm©
[4][1]

320 - 
tmp
 * 
tm©
[0][1];

321 
	gtm©
[4][2] = 
tm©
[4][2]

322 - 
tmp
 * 
tm©
[0][2];

323 
	gtm©
[4][3] = 
tm©
[4][3]

324 - 
tmp
 * 
tm©
[0][3];

325 
	gtm©
[4][4] = 
tm©
[4][4]

326 - 
tmp
 * 
tm©
[0][4];

327 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

328 - 
v
[
i
][
j
][
k
][0] * 
tmp
;

330 
	gtmp1
 = 1.0 / 
tm©
[ 1][1];

331 
	gtmp
 = 
tmp1
 * 
tm©
[ 2][1];

332 
	gtm©
[2][2] = 
tm©
[2][2]

333 - 
tmp
 * 
tm©
[1][2];

334 
	gtm©
[2][3] = 
tm©
[2][3]

335 - 
tmp
 * 
tm©
[1][3];

336 
	gtm©
[2][4] = 
tm©
[2][4]

337 - 
tmp
 * 
tm©
[1][4];

338 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

339 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

341 
	gtmp
 = 
tmp1
 * 
tm©
[3][1];

342 
	gtm©
[3][2] = 
tm©
[3][2]

343 - 
tmp
 * 
tm©
[1][2];

344 
	gtm©
[3][3] = 
tm©
[3][3]

345 - 
tmp
 * 
tm©
[1][3];

346 
	gtm©
[3][4] = 
tm©
[3][4]

347 - 
tmp
 * 
tm©
[1][4];

348 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

349 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

351 
	gtmp
 = 
tmp1
 * 
tm©
[4][1];

352 
	gtm©
[4][2] = 
tm©
[4][2]

353 - 
tmp
 * 
tm©
[1][2];

354 
	gtm©
[4][3] = 
tm©
[4][3]

355 - 
tmp
 * 
tm©
[1][3];

356 
	gtm©
[4][4] = 
tm©
[4][4]

357 - 
tmp
 * 
tm©
[1][4];

358 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

359 - 
v
[
i
][
j
][
k
][1] * 
tmp
;

361 
	gtmp1
 = 1.0 / 
tm©
[2][2];

362 
	gtmp
 = 
tmp1
 * 
tm©
[3][2];

363 
	gtm©
[3][3] = 
tm©
[3][3]

364 - 
tmp
 * 
tm©
[2][3];

365 
	gtm©
[3][4] = 
tm©
[3][4]

366 - 
tmp
 * 
tm©
[2][4];

367 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

368 - 
v
[
i
][
j
][
k
][2] * 
tmp
;

370 
	gtmp
 = 
tmp1
 * 
tm©
[4][2];

371 
	gtm©
[4][3] = 
tm©
[4][3]

372 - 
tmp
 * 
tm©
[2][3];

373 
	gtm©
[4][4] = 
tm©
[4][4]

374 - 
tmp
 * 
tm©
[2][4];

375 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

376 - 
v
[
i
][
j
][
k
][2] * 
tmp
;

378 
	gtmp1
 = 1.0 / 
tm©
[3][3];

379 
	gtmp
 = 
tmp1
 * 
tm©
[4][3];

380 
	gtm©
[4][4] = 
tm©
[4][4]

381 - 
tmp
 * 
tm©
[3][4];

382 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

383 - 
v
[
i
][
j
][
k
][3] * 
tmp
;

388 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4]

389 / 
tm©
[4][4];

391 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

392 - 
tm©
[3][4] * 
v
[
i
][
j
][
k
][4];

393 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3]

394 / 
tm©
[3][3];

396 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

397 - 
tm©
[2][3] * 
v
[
i
][
j
][
k
][3]

398 - 
tm©
[2][4] * 
v
[
i
][
j
][
k
][4];

399 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2]

400 / 
tm©
[2][2];

402 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

403 - 
tm©
[1][2] * 
v
[
i
][
j
][
k
][2]

404 - 
tm©
[1][3] * 
v
[
i
][
j
][
k
][3]

405 - 
tm©
[1][4] * 
v
[
i
][
j
][
k
][4];

406 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1]

407 / 
tm©
[1][1];

409 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0]

410 - 
tm©
[0][1] * 
v
[
i
][
j
][
k
][1]

411 - 
tm©
[0][2] * 
v
[
i
][
j
][
k
][2]

412 - 
tm©
[0][3] * 
v
[
i
][
j
][
k
][3]

413 - 
tm©
[0][4] * 
v
[
i
][
j
][
k
][4];

414 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0]

415 / 
tm©
[0][0];

418 #ià
defšed
(
_OPENMP
)

419 ià(
	gi
 !ğ
i¡
è
æag
[
i
-1] = 0;

420 ià(
	gi
 !ğ
›nd
è
æag
[
i
] = 1;

421 #´agm¨
omp
 
æush
(
æag
)

429 
buts
(
nx
, 
ny
, 
nz
, 
k
,

430 
omega
,

435 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

436 
tv
[
ISIZ1
][
ISIZ2
][5],

437 
d
[
ISIZ1
][
ISIZ2
][5][5],

438 
udx
[
ISIZ1
][
ISIZ2
][5][5],

439 
udy
[
ISIZ1
][
ISIZ2
][5][5],

440 
udz
[
ISIZ1
][
ISIZ2
][5][5],

441 
i¡
, 
›nd
, 
j¡
, 
j’d
,

442 
nx0
, 
ny0
 ) {

454 
	gi
, 
	gj
, 
	gm
;

455 
	gtmp
, 
	gtmp1
;

456 
	gtm©
[5][5];

458 #´agm¨
omp
 
nowa™
 
scheduË
()

459 
	gi
 = 
›nd
; i >ğ
i¡
; i--) {

460 
	gj
 = 
j’d
; j >ğ
j¡
; j--) {

461 
	gm
 = 0; m < 5; m++) {

462 
	gtv
[
i
][
j
][
m
] =

463 
omega
 * ( 
udz
[
i
][
j
][
m
][0] * 
v
[i][j][
k
+1][0]

464 + 
udz
[
i
][
j
][
m
][1] * 
v
[i][j][
k
+1][1]

465 + 
udz
[
i
][
j
][
m
][2] * 
v
[i][j][
k
+1][2]

466 + 
udz
[
i
][
j
][
m
][3] * 
v
[i][j][
k
+1][3]

467 + 
udz
[
i
][
j
][
m
][4] * 
v
[i][j][
k
+1][4] );

472 #´agm¨
omp
 
nowa™
 
scheduË
()

473 
	gi
 = 
›nd
; i >ğ
i¡
; i--) {

474 #ià
defšed
(
_OPENMP
)

475 ià(
	gi
 !ğ
›nd
) {

476 
æag
[
i
+1] == 0) {

477 #´agm¨
omp
 
æush
(
æag
)

481 ià(
	gi
 !ğ
i¡
) {

482 
æag
[
i
] == 1) {

483 #´agm¨
omp
 
æush
(
æag
)

489 
	gj
 = 
j’d
; j >ğ
j¡
; j--) {

490 
	gm
 = 0; m < 5; m++) {

491 
	gtv
[
i
][
j
][
m
] = 
tv
[i][j][m]

492 + 
omega
 * ( 
udy
[
i
][
j
][
m
][0] * 
v
[i][j+1][
k
][0]

493 + 
udx
[
i
][
j
][
m
][0] * 
v
[i+1][j][
k
][0]

494 + 
udy
[
i
][
j
][
m
][1] * 
v
[i][j+1][
k
][1]

495 + 
udx
[
i
][
j
][
m
][1] * 
v
[i+1][j][
k
][1]

496 + 
udy
[
i
][
j
][
m
][2] * 
v
[i][j+1][
k
][2]

497 + 
udx
[
i
][
j
][
m
][2] * 
v
[i+1][j][
k
][2]

498 + 
udy
[
i
][
j
][
m
][3] * 
v
[i][j+1][
k
][3]

499 + 
udx
[
i
][
j
][
m
][3] * 
v
[i+1][j][
k
][3]

500 + 
udy
[
i
][
j
][
m
][4] * 
v
[i][j+1][
k
][4]

501 + 
udx
[
i
][
j
][
m
][4] * 
v
[i+1][j][
k
][4] );

507 
	gm
 = 0; m < 5; m++) {

508 
	gtm©
[
m
][0] = 
d
[
i
][
j
][m][0];

509 
	gtm©
[
m
][1] = 
d
[
i
][
j
][m][1];

510 
	gtm©
[
m
][2] = 
d
[
i
][
j
][m][2];

511 
	gtm©
[
m
][3] = 
d
[
i
][
j
][m][3];

512 
	gtm©
[
m
][4] = 
d
[
i
][
j
][m][4];

515 
	gtmp1
 = 1.0 / 
tm©
[0][0];

516 
	gtmp
 = 
tmp1
 * 
tm©
[1][0];

517 
	gtm©
[1][1] = 
tm©
[1][1]

518 - 
tmp
 * 
tm©
[0][1];

519 
	gtm©
[1][2] = 
tm©
[1][2]

520 - 
tmp
 * 
tm©
[0][2];

521 
	gtm©
[1][3] = 
tm©
[1][3]

522 - 
tmp
 * 
tm©
[0][3];

523 
	gtm©
[1][4] = 
tm©
[1][4]

524 - 
tmp
 * 
tm©
[0][4];

525 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

526 - 
tv
[
i
][
j
][0] * 
tmp
;

528 
	gtmp
 = 
tmp1
 * 
tm©
[2][0];

529 
	gtm©
[2][1] = 
tm©
[2][1]

530 - 
tmp
 * 
tm©
[0][1];

531 
	gtm©
[2][2] = 
tm©
[2][2]

532 - 
tmp
 * 
tm©
[0][2];

533 
	gtm©
[2][3] = 
tm©
[2][3]

534 - 
tmp
 * 
tm©
[0][3];

535 
	gtm©
[2][4] = 
tm©
[2][4]

536 - 
tmp
 * 
tm©
[0][4];

537 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

538 - 
tv
[
i
][
j
][0] * 
tmp
;

540 
	gtmp
 = 
tmp1
 * 
tm©
[3][0];

541 
	gtm©
[3][1] = 
tm©
[3][1]

542 - 
tmp
 * 
tm©
[0][1];

543 
	gtm©
[3][2] = 
tm©
[3][2]

544 - 
tmp
 * 
tm©
[0][2];

545 
	gtm©
[3][3] = 
tm©
[3][3]

546 - 
tmp
 * 
tm©
[0][3];

547 
	gtm©
[3][4] = 
tm©
[3][4]

548 - 
tmp
 * 
tm©
[0][4];

549 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

550 - 
tv
[
i
][
j
][0] * 
tmp
;

552 
	gtmp
 = 
tmp1
 * 
tm©
[4][0];

553 
	gtm©
[4][1] = 
tm©
[4][1]

554 - 
tmp
 * 
tm©
[0][1];

555 
	gtm©
[4][2] = 
tm©
[4][2]

556 - 
tmp
 * 
tm©
[0][2];

557 
	gtm©
[4][3] = 
tm©
[4][3]

558 - 
tmp
 * 
tm©
[0][3];

559 
	gtm©
[4][4] = 
tm©
[4][4]

560 - 
tmp
 * 
tm©
[0][4];

561 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

562 - 
tv
[
i
][
j
][0] * 
tmp
;

564 
	gtmp1
 = 1.0 / 
tm©
[1][1];

565 
	gtmp
 = 
tmp1
 * 
tm©
[2][1];

566 
	gtm©
[2][2] = 
tm©
[2][2]

567 - 
tmp
 * 
tm©
[1][2];

568 
	gtm©
[2][3] = 
tm©
[2][3]

569 - 
tmp
 * 
tm©
[1][3];

570 
	gtm©
[2][4] = 
tm©
[2][4]

571 - 
tmp
 * 
tm©
[1][4];

572 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

573 - 
tv
[
i
][
j
][1] * 
tmp
;

575 
	gtmp
 = 
tmp1
 * 
tm©
[3][1];

576 
	gtm©
[3][2] = 
tm©
[3][2]

577 - 
tmp
 * 
tm©
[1][2];

578 
	gtm©
[3][3] = 
tm©
[3][3]

579 - 
tmp
 * 
tm©
[1][3];

580 
	gtm©
[3][4] = 
tm©
[3][4]

581 - 
tmp
 * 
tm©
[1][4];

582 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

583 - 
tv
[
i
][
j
][1] * 
tmp
;

585 
	gtmp
 = 
tmp1
 * 
tm©
[4][1];

586 
	gtm©
[4][2] = 
tm©
[4][2]

587 - 
tmp
 * 
tm©
[1][2];

588 
	gtm©
[4][3] = 
tm©
[4][3]

589 - 
tmp
 * 
tm©
[1][3];

590 
	gtm©
[4][4] = 
tm©
[4][4]

591 - 
tmp
 * 
tm©
[1][4];

592 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

593 - 
tv
[
i
][
j
][1] * 
tmp
;

595 
	gtmp1
 = 1.0 / 
tm©
[2][2];

596 
	gtmp
 = 
tmp1
 * 
tm©
[3][2];

597 
	gtm©
[3][3] = 
tm©
[3][3]

598 - 
tmp
 * 
tm©
[2][3];

599 
	gtm©
[3][4] = 
tm©
[3][4]

600 - 
tmp
 * 
tm©
[2][4];

601 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

602 - 
tv
[
i
][
j
][2] * 
tmp
;

604 
	gtmp
 = 
tmp1
 * 
tm©
[4][2];

605 
	gtm©
[4][3] = 
tm©
[4][3]

606 - 
tmp
 * 
tm©
[2][3];

607 
	gtm©
[4][4] = 
tm©
[4][4]

608 - 
tmp
 * 
tm©
[2][4];

609 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

610 - 
tv
[
i
][
j
][2] * 
tmp
;

612 
	gtmp1
 = 1.0 / 
tm©
[3][3];

613 
	gtmp
 = 
tmp1
 * 
tm©
[4][3];

614 
	gtm©
[4][4] = 
tm©
[4][4]

615 - 
tmp
 * 
tm©
[3][4];

616 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

617 - 
tv
[
i
][
j
][3] * 
tmp
;

622 
	gtv
[
i
][
j
][4] = 
tv
[i][j][4]

623 / 
tm©
[4][4];

625 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

626 - 
tm©
[3][4] * 
tv
[
i
][
j
][4];

627 
	gtv
[
i
][
j
][3] = 
tv
[i][j][3]

628 / 
tm©
[3][3];

630 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

631 - 
tm©
[2][3] * 
tv
[
i
][
j
][3]

632 - 
tm©
[2][4] * 
tv
[
i
][
j
][4];

633 
	gtv
[
i
][
j
][2] = 
tv
[i][j][2]

634 / 
tm©
[2][2];

636 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

637 - 
tm©
[1][2] * 
tv
[
i
][
j
][2]

638 - 
tm©
[1][3] * 
tv
[
i
][
j
][3]

639 - 
tm©
[1][4] * 
tv
[
i
][
j
][4];

640 
	gtv
[
i
][
j
][1] = 
tv
[i][j][1]

641 / 
tm©
[1][1];

643 
	gtv
[
i
][
j
][0] = 
tv
[i][j][0]

644 - 
tm©
[0][1] * 
tv
[
i
][
j
][1]

645 - 
tm©
[0][2] * 
tv
[
i
][
j
][2]

646 - 
tm©
[0][3] * 
tv
[
i
][
j
][3]

647 - 
tm©
[0][4] * 
tv
[
i
][
j
][4];

648 
	gtv
[
i
][
j
][0] = 
tv
[i][j][0]

649 / 
tm©
[0][0];

651 
	gv
[
i
][
j
][
k
][0] = 
v
[i][j][k][0] - 
tv
[i][j][0];

652 
	gv
[
i
][
j
][
k
][1] = 
v
[i][j][k][1] - 
tv
[i][j][1];

653 
	gv
[
i
][
j
][
k
][2] = 
v
[i][j][k][2] - 
tv
[i][j][2];

654 
	gv
[
i
][
j
][
k
][3] = 
v
[i][j][k][3] - 
tv
[i][j][3];

655 
	gv
[
i
][
j
][
k
][4] = 
v
[i][j][k][4] - 
tv
[i][j][4];

658 #ià
defšed
(
_OPENMP
)

659 ià(
	gi
 !ğ
›nd
è
æag
[
i
+1] = 0;

660 ià(
	gi
 !ğ
i¡
è
æag
[
i
] = 1;

661 #´agm¨
omp
 
æush
(
æag
)

669 
	$domaš
() {

675 
nx
 = 
nx0
;

676 
ny
 = 
ny0
;

677 
nz
 = 
nz0
;

682 iàĞ
nx
 < 4 || 
ny
 < 4 || 
nz
 < 4 ) {

683 
	`´štf
(" SUBDOMAIN SIZE IS TOO SMALL - \n"

686 " TO 4 THEY ARE CURRENTLY%3d%3d%3d\n", 
nx
, 
ny
, 
nz
);

687 
	`ex™
(1);

690 iàĞ
nx
 > 
ISIZ1
 || 
ny
 > 
ISIZ2
 || 
nz
 > 
ISIZ3
 ) {

691 
	`´štf
(" SUBDOMAIN SIZE IS TOO LARGE - \n"

695 " CURRENTLY%4d%4d%4d\n", 
nx
, 
ny
, 
nz
);

696 
	`ex™
(1);

702 
i¡
 = 1;

703 
›nd
 = 
nx
 - 2;

705 
j¡
 = 1;

706 
j’d
 = 
ny
 - 2;

707 
	}
}

712 
	$”hs
() {

714 #´agm¨
omp
 
·¿Î–


726 
i
, 
j
, 
k
, 
m
;

727 
iglob
, 
jglob
;

728 
L1
, 
L2
;

729 
i¡1
, 
›nd1
;

730 
j¡1
, 
j’d1
;

731 
ds¥m
;

732 
xi
, 
‘a
, 
z‘a
;

733 
q
;

734 
u21
, 
u31
, 
u41
;

735 
tmp
;

736 
u21i
, 
u31i
, 
u41i
, 
u51i
;

737 
u21j
, 
u31j
, 
u41j
, 
u51j
;

738 
u21k
, 
u31k
, 
u41k
, 
u51k
;

739 
u21im1
, 
u31im1
, 
u41im1
, 
u51im1
;

740 
u21jm1
, 
u31jm1
, 
u41jm1
, 
u51jm1
;

741 
u21km1
, 
u31km1
, 
u41km1
, 
u51km1
;

743 
ds¥m
 = 
ds¥
;

745 #´agm¨
omp
 

746 
i
 = 0; i < 
nx
; i++) {

747 
j
 = 0; j < 
ny
; j++) {

748 
k
 = 0; k < 
nz
; k++) {

749 
m
 = 0; m < 5; m++) {

750 
äù
[
i
][
j
][
k
][
m
] = 0.0;

756 #´agm¨
omp
 

757 
i
 = 0; i < 
nx
; i++) {

758 
iglob
 = 
i
;

759 
xi
 = ( ()(
iglob
èè/ ( 
nx0
 - 1 );

760 
j
 = 0; j < 
ny
; j++) {

761 
jglob
 = 
j
;

762 
‘a
 = ( ()(
jglob
èè/ ( 
ny0
 - 1 );

763 
k
 = 0; k < 
nz
; k++) {

764 
z‘a
 = ( ()(
k
èè/ ( 
nz
 - 1 );

765 
m
 = 0; m < 5; m++) {

766 
rsd
[
i
][
j
][
k
][
m
] = 
û
[m][0]

767 + 
û
[
m
][1] * 
xi


768 + 
û
[
m
][2] * 
‘a


769 + 
û
[
m
][3] * 
z‘a


770 + 
û
[
m
][4] * 
xi
 * xi

771 + 
û
[
m
][5] * 
‘a
 *ƒta

772 + 
û
[
m
][6] * 
z‘a
 * zeta

773 + 
û
[
m
][7] * 
xi
 * xi * xi

774 + 
û
[
m
][8] * 
‘a
 *ƒta *ƒta

775 + 
û
[
m
][9] * 
z‘a
 * zeta * zeta

776 + 
û
[
m
][10] * 
xi
 * xi * xi * xi

777 + 
û
[
m
][11] * 
‘a
 *ƒta *ƒta *ƒta

778 + 
û
[
m
][12] * 
z‘a
 * zeta * zeta * zeta;

788 
L1
 = 0;

789 
L2
 = 
nx
-1;

791 #´agm¨
omp
 

792 
i
 = 
L1
; i <ğ
L2
; i++) {

793 
j
 = 
j¡
; j <ğ
j’d
; j++) {

794 
k
 = 1; k < 
nz
 - 1; k++) {

795 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][1];

796 
u21
 = 
rsd
[
i
][
j
][
k
][1] /„sd[i][j][k][0];

797 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

798 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

799 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

800 / 
rsd
[
i
][
j
][
k
][0];

801 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u21
 + 
C2
 *

802 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

803 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u21
;

804 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u21
;

805 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u21
;

810 #´agm¨
omp
 

811 
j
 = 
j¡
; j <ğ
j’d
; j++) {

812 
k
 = 1; k <ğ
nz
 - 2; k++) {

813 
i
 = 
i¡
; i <ğ
›nd
; i++) {

814 
m
 = 0; m < 5; m++) {

815 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

816 - 
tx2
 * ( 
æux
[
i
+1][
j
][
k
][
m
] - flux[i-1][j][k][m] );

819 
i
 = 
i¡
; i <ğ
L2
; i++) {

820 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

822 
u21i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

823 
u31i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

824 
u41i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

825 
u51i
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

827 
tmp
 = 1.0 / 
rsd
[
i
-1][
j
][
k
][0];

829 
u21im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][1];

830 
u31im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][2];

831 
u41im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][3];

832 
u51im1
 = 
tmp
 * 
rsd
[
i
-1][
j
][
k
][4];

834 
æux
[
i
][
j
][
k
][1] = (4.0/3.0è* 
tx3
 *

835 Ğ
u21i
 - 
u21im1
 );

836 
æux
[
i
][
j
][
k
][2] = 
tx3
 * ( 
u31i
 - 
u31im1
 );

837 
æux
[
i
][
j
][
k
][3] = 
tx3
 * ( 
u41i
 - 
u41im1
 );

838 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

839 * 
tx3
 * ( ( 
u21i
 * u21˜+ 
u31i
 * u31˜+ 
u41i
 * u41i )

840 - ( 
u21im1
*u21im1 + 
u31im1
*u31im1 + 
u41im1
*u41im1 ) )

842 * 
tx3
 * ( 
u21i
*u21˜- 
u21im1
*u21im1 )

843 + 
C1
 * 
C5
 * 
tx3
 * ( 
u51i
 - 
u51im1
 );

846 
i
 = 
i¡
; i <ğ
›nd
; i++) {

847 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

848 + 
dx1
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][0]

849 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

850 + 
rsd
[
i
+1][
j
][
k
][0] );

851 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

852 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][1] - flux[i][j][k][1] )

853 + 
dx2
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][1]

854 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

855 + 
rsd
[
i
+1][
j
][
k
][1] );

856 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

857 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][2] - flux[i][j][k][2] )

858 + 
dx3
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][2]

859 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

860 + 
rsd
[
i
+1][
j
][
k
][2] );

861 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

862 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][3] - flux[i][j][k][3] )

863 + 
dx4
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][3]

864 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

865 + 
rsd
[
i
+1][
j
][
k
][3] );

866 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

867 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][4] - flux[i][j][k][4] )

868 + 
dx5
 * 
tx1
 * ( 
rsd
[
i
-1][
j
][
k
][4]

869 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

870 + 
rsd
[
i
+1][
j
][
k
][4] );

876 
m
 = 0; m < 5; m++) {

877 
äù
[1][
j
][
k
][
m
] = frct[1][j][k][m]

878 - 
ds¥m
 * ( + 5.0 * 
rsd
[1][
j
][
k
][
m
]

879 - 4.0 * 
rsd
[2][
j
][
k
][
m
]

880 + 
rsd
[3][
j
][
k
][
m
] );

881 
äù
[2][
j
][
k
][
m
] = frct[2][j][k][m]

882 - 
ds¥m
 * ( - 4.0 * 
rsd
[1][
j
][
k
][
m
]

883 + 6.0 * 
rsd
[2][
j
][
k
][
m
]

884 - 4.0 * 
rsd
[3][
j
][
k
][
m
]

885 + 
rsd
[4][
j
][
k
][
m
] );

888 
i¡1
 = 3;

889 
›nd1
 = 
nx
 - 4;

890 
i
 = 
i¡1
; i <=
›nd1
; i++) {

891 
m
 = 0; m < 5; m++) {

892 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

893 - 
ds¥m
 * ( 
rsd
[
i
-2][
j
][
k
][
m
]

894 - 4.0 * 
rsd
[
i
-1][
j
][
k
][
m
]

895 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

896 - 4.0 * 
rsd
[
i
+1][
j
][
k
][
m
]

897 + 
rsd
[
i
+2][
j
][
k
][
m
] );

901 
m
 = 0; m < 5; m++) {

902 
äù
[
nx
-3][
j
][
k
][
m
] = frct[nx-3][j][k][m]

903 - 
ds¥m
 * ( 
rsd
[
nx
-5][
j
][
k
][
m
]

904 - 4.0 * 
rsd
[
nx
-4][
j
][
k
][
m
]

905 + 6.0 * 
rsd
[
nx
-3][
j
][
k
][
m
]

906 - 4.0 * 
rsd
[
nx
-2][
j
][
k
][
m
] );

907 
äù
[
nx
-2][
j
][
k
][
m
] = frct[nx-2][j][k][m]

908 - 
ds¥m
 * ( 
rsd
[
nx
-4][
j
][
k
][
m
]

909 - 4.0 * 
rsd
[
nx
-3][
j
][
k
][
m
]

910 + 5.0 * 
rsd
[
nx
-2][
j
][
k
][
m
] );

919 
L1
 = 0;

920 
L2
 = 
ny
-1;

922 #´agm¨
omp
 

923 
i
 = 
i¡
; i <ğ
›nd
; i++) {

924 
j
 = 
L1
; j <ğ
L2
; j++) {

925 
k
 = 1; k <ğ
nz
 - 2; k++) {

926 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][2];

927 
u31
 = 
rsd
[
i
][
j
][
k
][2] /„sd[i][j][k][0];

928 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

929 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

930 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

931 / 
rsd
[
i
][
j
][
k
][0];

932 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u31
;

933 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u31
 + 
C2
 *

934 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

935 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u31
;

936 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u31
;

941 #´agm¨
omp
 

942 
i
 = 
i¡
; i <ğ
›nd
; i++) {

943 
k
 = 1; k <ğ
nz
 - 2; k++) {

944 
j
 = 
j¡
; j <ğ
j’d
; j++) {

945 
m
 = 0; m < 5; m++) {

946 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

947 - 
ty2
 * ( 
æux
[
i
][
j
+1][
k
][
m
] - flux[i][j-1][k][m] );

950 
j
 = 
j¡
; j <ğ
L2
; j++) {

951 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

953 
u21j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

954 
u31j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

955 
u41j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

956 
u51j
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

958 
tmp
 = 1.0 / 
rsd
[
i
][
j
-1][
k
][0];

960 
u21jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][1];

961 
u31jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][2];

962 
u41jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][3];

963 
u51jm1
 = 
tmp
 * 
rsd
[
i
][
j
-1][
k
][4];

965 
æux
[
i
][
j
][
k
][1] = 
ty3
 * ( 
u21j
 - 
u21jm1
 );

966 
æux
[
i
][
j
][
k
][2] = (4.0/3.0è* 
ty3
 *

967 Ğ
u31j
 - 
u31jm1
 );

968 
æux
[
i
][
j
][
k
][3] = 
ty3
 * ( 
u41j
 - 
u41jm1
 );

969 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

970 * 
ty3
 * ( ( 
u21j
 *u21j + 
u31j
 *u31j + 
u41j
 *u41j )

971 - ( 
u21jm1
*u21jm1 + 
u31jm1
*u31jm1 + 
u41jm1
*u41jm1 ) )

973 * 
ty3
 * ( 
u31j
*u31j - 
u31jm1
*u31jm1 )

974 + 
C1
 * 
C5
 * 
ty3
 * ( 
u51j
 - 
u51jm1
 );

977 
j
 = 
j¡
; j <ğ
j’d
; j++) {

978 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

979 + 
dy1
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][0]

980 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

981 + 
rsd
[
i
][
j
+1][
k
][0] );

982 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

983 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][1] - flux[i][j][k][1] )

984 + 
dy2
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][1]

985 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

986 + 
rsd
[
i
][
j
+1][
k
][1] );

987 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

988 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][2] - flux[i][j][k][2] )

989 + 
dy3
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][2]

990 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

991 + 
rsd
[
i
][
j
+1][
k
][2] );

992 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

993 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][3] - flux[i][j][k][3] )

994 + 
dy4
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][3]

995 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

996 + 
rsd
[
i
][
j
+1][
k
][3] );

997 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

998 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][4] - flux[i][j][k][4] )

999 + 
dy5
 * 
ty1
 * ( 
rsd
[
i
][
j
-1][
k
][4]

1000 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

1001 + 
rsd
[
i
][
j
+1][
k
][4] );

1007 
m
 = 0; m < 5; m++) {

1008 
äù
[
i
][1][
k
][
m
] = frct[i][1][k][m]

1009 - 
ds¥m
 * ( + 5.0 * 
rsd
[
i
][1][
k
][
m
]

1010 - 4.0 * 
rsd
[
i
][2][
k
][
m
]

1011 + 
rsd
[
i
][3][
k
][
m
] );

1012 
äù
[
i
][2][
k
][
m
] = frct[i][2][k][m]

1013 - 
ds¥m
 * ( - 4.0 * 
rsd
[
i
][1][
k
][
m
]

1014 + 6.0 * 
rsd
[
i
][2][
k
][
m
]

1015 - 4.0 * 
rsd
[
i
][3][
k
][
m
]

1016 + 
rsd
[
i
][4][
k
][
m
] );

1019 
j¡1
 = 3;

1020 
j’d1
 = 
ny
 - 4;

1022 
j
 = 
j¡1
; j <ğ
j’d1
; j++) {

1023 
m
 = 0; m < 5; m++) {

1024 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1025 - 
ds¥m
 * ( 
rsd
[
i
][
j
-2][
k
][
m
]

1026 - 4.0 * 
rsd
[
i
][
j
-1][
k
][
m
]

1027 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

1028 - 4.0 * 
rsd
[
i
][
j
+1][
k
][
m
]

1029 + 
rsd
[
i
][
j
+2][
k
][
m
] );

1033 
m
 = 0; m < 5; m++) {

1034 
äù
[
i
][
ny
-3][
k
][
m
] = frct[i][ny-3][k][m]

1035 - 
ds¥m
 * ( 
rsd
[
i
][
ny
-5][
k
][
m
]

1036 - 4.0 * 
rsd
[
i
][
ny
-4][
k
][
m
]

1037 + 6.0 * 
rsd
[
i
][
ny
-3][
k
][
m
]

1038 - 4.0 * 
rsd
[
i
][
ny
-2][
k
][
m
] );

1039 
äù
[
i
][
ny
-2][
k
][
m
] = frct[i][ny-2][k][m]

1040 - 
ds¥m
 * ( 
rsd
[
i
][
ny
-4][
k
][
m
]

1041 - 4.0 * 
rsd
[
i
][
ny
-3][
k
][
m
]

1042 + 5.0 * 
rsd
[
i
][
ny
-2][
k
][
m
] );

1051 #´agm¨
omp
 

1052 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1053 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1054 
k
 = 0; k <ğ
nz
-1; k++) {

1055 
æux
[
i
][
j
][
k
][0] = 
rsd
[i][j][k][3];

1056 
u41
 = 
rsd
[
i
][
j
][
k
][3] /„sd[i][j][k][0];

1057 
q
 = 0.50 * ( 
rsd
[
i
][
j
][
k
][1] *„sd[i][j][k][1]

1058 + 
rsd
[
i
][
j
][
k
][2] *„sd[i][j][k][2]

1059 + 
rsd
[
i
][
j
][
k
][3] *„sd[i][j][k][3] )

1060 / 
rsd
[
i
][
j
][
k
][0];

1061 
æux
[
i
][
j
][
k
][1] = 
rsd
[i][j][k][1] * 
u41
;

1062 
æux
[
i
][
j
][
k
][2] = 
rsd
[i][j][k][2] * 
u41
;

1063 
æux
[
i
][
j
][
k
][3] = 
rsd
[i][j][k][3] * 
u41
 + 
C2
 *

1064 Ğ
rsd
[
i
][
j
][
k
][4] - 
q
 );

1065 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
rsd
[i][j][k][4] - 
C2
 * 
q
 ) * 
u41
;

1068 
k
 = 1; k <ğ
nz
 - 2; k++) {

1069 
m
 = 0; m < 5; m++) {

1070 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1071 - 
tz2
 * ( 
æux
[
i
][
j
][
k
+1][
m
] - flux[i][j][k-1][m] );

1074 
k
 = 1; k <ğ
nz
-1; k++) {

1075 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
][0];

1077 
u21k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][1];

1078 
u31k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][2];

1079 
u41k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][3];

1080 
u51k
 = 
tmp
 * 
rsd
[
i
][
j
][
k
][4];

1082 
tmp
 = 1.0 / 
rsd
[
i
][
j
][
k
-1][0];

1084 
u21km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][1];

1085 
u31km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][2];

1086 
u41km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][3];

1087 
u51km1
 = 
tmp
 * 
rsd
[
i
][
j
][
k
-1][4];

1089 
æux
[
i
][
j
][
k
][1] = 
tz3
 * ( 
u21k
 - 
u21km1
 );

1090 
æux
[
i
][
j
][
k
][2] = 
tz3
 * ( 
u31k
 - 
u31km1
 );

1091 
æux
[
i
][
j
][
k
][3] = (4.0/3.0è* 
tz3
 * ( 
u41k


1092 - 
u41km1
 );

1093 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

1094 * 
tz3
 * ( ( 
u21k
 *u21k + 
u31k
 *u31k + 
u41k
 *u41k )

1095 - ( 
u21km1
*u21km1 + 
u31km1
*u31km1 + 
u41km1
*u41km1 ) )

1097 * 
tz3
 * ( 
u41k
*u41k - 
u41km1
*u41km1 )

1098 + 
C1
 * 
C5
 * 
tz3
 * ( 
u51k
 - 
u51km1
 );

1101 
k
 = 1; k <ğ
nz
 - 2; k++) {

1102 
äù
[
i
][
j
][
k
][0] = frct[i][j][k][0]

1103 + 
dz1
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][0]

1104 - 2.0 * 
rsd
[
i
][
j
][
k
][0]

1105 + 
rsd
[
i
][
j
][
k
-1][0] );

1106 
äù
[
i
][
j
][
k
][1] = frct[i][j][k][1]

1107 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][1] - flux[i][j][k][1] )

1108 + 
dz2
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][1]

1109 - 2.0 * 
rsd
[
i
][
j
][
k
][1]

1110 + 
rsd
[
i
][
j
][
k
-1][1] );

1111 
äù
[
i
][
j
][
k
][2] = frct[i][j][k][2]

1112 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][2] - flux[i][j][k][2] )

1113 + 
dz3
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][2]

1114 - 2.0 * 
rsd
[
i
][
j
][
k
][2]

1115 + 
rsd
[
i
][
j
][
k
-1][2] );

1116 
äù
[
i
][
j
][
k
][3] = frct[i][j][k][3]

1117 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][3] - flux[i][j][k][3] )

1118 + 
dz4
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][3]

1119 - 2.0 * 
rsd
[
i
][
j
][
k
][3]

1120 + 
rsd
[
i
][
j
][
k
-1][3] );

1121 
äù
[
i
][
j
][
k
][4] = frct[i][j][k][4]

1122 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][4] - flux[i][j][k][4] )

1123 + 
dz5
 * 
tz1
 * ( 
rsd
[
i
][
j
][
k
+1][4]

1124 - 2.0 * 
rsd
[
i
][
j
][
k
][4]

1125 + 
rsd
[
i
][
j
][
k
-1][4] );

1131 
m
 = 0; m < 5; m++) {

1132 
äù
[
i
][
j
][1][
m
] = frct[i][j][1][m]

1133 - 
ds¥m
 * ( + 5.0 * 
rsd
[
i
][
j
][1][
m
]

1134 - 4.0 * 
rsd
[
i
][
j
][2][
m
]

1135 + 
rsd
[
i
][
j
][3][
m
] );

1136 
äù
[
i
][
j
][2][
m
] = frct[i][j][2][m]

1137 - 
ds¥m
 * (- 4.0 * 
rsd
[
i
][
j
][1][
m
]

1138 + 6.0 * 
rsd
[
i
][
j
][2][
m
]

1139 - 4.0 * 
rsd
[
i
][
j
][3][
m
]

1140 + 
rsd
[
i
][
j
][4][
m
] );

1143 
k
 = 3; k <ğ
nz
 - 4; k++) {

1144 
m
 = 0; m < 5; m++) {

1145 
äù
[
i
][
j
][
k
][
m
] = frct[i][j][k][m]

1146 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
k
-2][
m
]

1147 - 4.0 * 
rsd
[
i
][
j
][
k
-1][
m
]

1148 + 6.0 * 
rsd
[
i
][
j
][
k
][
m
]

1149 - 4.0 * 
rsd
[
i
][
j
][
k
+1][
m
]

1150 + 
rsd
[
i
][
j
][
k
+2][
m
] );

1154 
m
 = 0; m < 5; m++) {

1155 
äù
[
i
][
j
][
nz
-3][
m
] = frct[i][j][nz-3][m]

1156 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
nz
-5][
m
]

1157 - 4.0 * 
rsd
[
i
][
j
][
nz
-4][
m
]

1158 + 6.0 * 
rsd
[
i
][
j
][
nz
-3][
m
]

1159 - 4.0 * 
rsd
[
i
][
j
][
nz
-2][
m
] );

1160 
äù
[
i
][
j
][
nz
-2][
m
] = frct[i][j][nz-2][m]

1161 - 
ds¥m
 * ( 
rsd
[
i
][
j
][
nz
-4][
m
]

1162 - 4.0 * 
rsd
[
i
][
j
][
nz
-3][
m
]

1163 + 5.0 * 
rsd
[
i
][
j
][
nz
-2][
m
] );

1168 
	}
}

1172 
	$”rÜ
() {

1183 
i
, 
j
, 
k
, 
m
;

1184 
iglob
, 
jglob
;

1185 
tmp
;

1186 
u000ijk
[5];

1188 
m
 = 0; m < 5; m++) {

1189 
”ºm
[
m
] = 0.0;

1192 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1193 
iglob
 = 
i
;

1194 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1195 
jglob
 = 
j
;

1196 
k
 = 1; k <ğ
nz
-2; k++) {

1197 
	`exaù
Ğ
iglob
, 
jglob
, 
k
, 
u000ijk
 );

1198 
m
 = 0; m < 5; m++) {

1199 
tmp
 = ( 
u000ijk
[
m
] - 
u
[
i
][
j
][
k
][m] );

1200 
”ºm
[
m
] =ƒ¼nm[m] + 
tmp
 *tmp;

1206 
m
 = 0; m < 5; m++) {

1207 
”ºm
[
m
] = 
	`sq¹
 (ƒ¼nm[m] / ( (
nx0
-2)*(
ny0
-2)*(
nz0
-2) ) );

1209 
	}
}

1214 
	$exaù
Ğ
i
, 
j
, 
k
, 
u000ijk
[5] ) {

1225 
m
;

1226 
xi
, 
‘a
, 
z‘a
;

1228 
xi
 = (()
i
è/ (
nx0
 - 1);

1229 
‘a
 = (()
j
è/ (
ny0
 - 1);

1230 
z‘a
 = (()
k
è/ (
nz
 - 1);

1232 
m
 = 0; m < 5; m++) {

1233 
u000ijk
[
m
] = 
û
[m][0]

1234 + 
û
[
m
][1] * 
xi


1235 + 
û
[
m
][2] * 
‘a


1236 + 
û
[
m
][3] * 
z‘a


1237 + 
û
[
m
][4] * 
xi
 * xi

1238 + 
û
[
m
][5] * 
‘a
 *ƒta

1239 + 
û
[
m
][6] * 
z‘a
 * zeta

1240 + 
û
[
m
][7] * 
xi
 * xi * xi

1241 + 
û
[
m
][8] * 
‘a
 *ƒta *ƒta

1242 + 
û
[
m
][9] * 
z‘a
 * zeta * zeta

1243 + 
û
[
m
][10] * 
xi
 * xi * xi * xi

1244 + 
û
[
m
][11] * 
‘a
 *ƒta *ƒta *ƒta

1245 + 
û
[
m
][12] * 
z‘a
 * zeta * zeta * zeta;

1247 
	}
}

1252 
	$jaşd
(
k
) {

1261 
i
, 
j
;

1262 
r43
;

1263 
c1345
;

1264 
c34
;

1265 
tmp1
, 
tmp2
, 
tmp3
;

1267 
r43
 = ( 4.0 / 3.0 );

1268 
c1345
 = 
C1
 * 
C3
 * 
C4
 * 
C5
;

1269 
c34
 = 
C3
 * 
C4
;

1271 #´agm¨
omp
 
nowa™
 
	`scheduË
()

1272 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1273 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1278 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1279 
tmp2
 = 
tmp1
 *mp1;

1280 
tmp3
 = 
tmp1
 * 
tmp2
;

1282 
d
[
i
][
j
][0][0] = 1.0

1283 + 
dt
 * 2.0 * ( 
tx1
 * 
dx1


1284 + 
ty1
 * 
dy1


1285 + 
tz1
 * 
dz1
 );

1286 
d
[
i
][
j
][0][1] = 0.0;

1287 
d
[
i
][
j
][0][2] = 0.0;

1288 
d
[
i
][
j
][0][3] = 0.0;

1289 
d
[
i
][
j
][0][4] = 0.0;

1291 
d
[
i
][
j
][1][0] = 
dt
 * 2.0

1292 * ( 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1293 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1294 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] ) );

1295 
d
[
i
][
j
][1][1] = 1.0

1296 + 
dt
 * 2.0

1297 * ( 
tx1
 * 
r43
 * 
c34
 * 
tmp1


1298 + 
ty1
 * 
c34
 * 
tmp1


1299 + 
tz1
 * 
c34
 * 
tmp1
 )

1300 + 
dt
 * 2.0 * ( 
tx1
 * 
dx2


1301 + 
ty1
 * 
dy2


1302 + 
tz1
 * 
dz2
 );

1303 
d
[
i
][
j
][1][2] = 0.0;

1304 
d
[
i
][
j
][1][3] = 0.0;

1305 
d
[
i
][
j
][1][4] = 0.0;

1307 
d
[
i
][
j
][2][0] = 
dt
 * 2.0

1308 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1309 + 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1310 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] ) );

1311 
d
[
i
][
j
][2][1] = 0.0;

1312 
d
[
i
][
j
][2][2] = 1.0

1313 + 
dt
 * 2.0

1314 * ( 
tx1
 * 
c34
 * 
tmp1


1315 + 
ty1
 * 
r43
 * 
c34
 * 
tmp1


1316 + 
tz1
 * 
c34
 * 
tmp1
 )

1317 + 
dt
 * 2.0 * ( 
tx1
 * 
dx3


1318 + 
ty1
 * 
dy3


1319 + 
tz1
 * 
dz3
 );

1320 
d
[
i
][
j
][2][3] = 0.0;

1321 
d
[
i
][
j
][2][4] = 0.0;

1323 
d
[
i
][
j
][3][0] = 
dt
 * 2.0

1324 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1325 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1326 + 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] ) );

1327 
d
[
i
][
j
][3][1] = 0.0;

1328 
d
[
i
][
j
][3][2] = 0.0;

1329 
d
[
i
][
j
][3][3] = 1.0

1330 + 
dt
 * 2.0

1331 * ( 
tx1
 * 
c34
 * 
tmp1


1332 + 
ty1
 * 
c34
 * 
tmp1


1333 + 
tz1
 * 
r43
 * 
c34
 * 
tmp1
 )

1334 + 
dt
 * 2.0 * ( 
tx1
 * 
dx4


1335 + 
ty1
 * 
dy4


1336 + 
tz1
 * 
dz4
 );

1337 
d
[
i
][
j
][3][4] = 0.0;

1339 
d
[
i
][
j
][4][0] = 
dt
 * 2.0

1340 * ( 
tx1
 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1341 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1342 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1343 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1344 + 
ty1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1345 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1346 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1347 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1348 + 
tz1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1349 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1350 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1351 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] ) );

1352 
d
[
i
][
j
][4][1] = 
dt
 * 2.0

1353 * ( 
tx1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1354 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1355 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1] );

1356 
d
[
i
][
j
][4][2] = 
dt
 * 2.0

1357 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1358 + 
ty1
 * ( 
r43
*
c34
 -
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1359 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2] );

1360 
d
[
i
][
j
][4][3] = 
dt
 * 2.0

1361 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1362 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1363 + 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3] );

1364 
d
[
i
][
j
][4][4] = 1.0

1365 + 
dt
 * 2.0 * ( 
tx1
 * 
c1345
 * 
tmp1


1366 + 
ty1
 * 
c1345
 * 
tmp1


1367 + 
tz1
 * 
c1345
 * 
tmp1
 )

1368 + 
dt
 * 2.0 * ( 
tx1
 * 
dx5


1369 + 
ty1
 * 
dy5


1370 + 
tz1
 * 
dz5
 );

1375 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
-1][0];

1376 
tmp2
 = 
tmp1
 *mp1;

1377 
tmp3
 = 
tmp1
 * 
tmp2
;

1379 
a
[
i
][
j
][0][0] = - 
dt
 * 
tz1
 * 
dz1
;

1380 
a
[
i
][
j
][0][1] = 0.0;

1381 
a
[
i
][
j
][0][2] = 0.0;

1382 
a
[
i
][
j
][0][3] = - 
dt
 * 
tz2
;

1383 
a
[
i
][
j
][0][4] = 0.0;

1385 
a
[
i
][
j
][1][0] = - 
dt
 * 
tz2


1386 * ( - ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][3] ) * 
tmp2
 )

1387 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][1] );

1388 
a
[
i
][
j
][1][1] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][3] * 
tmp1
 )

1389 - 
dt
 * 
tz1
 * 
c34
 * 
tmp1


1390 - 
dt
 * 
tz1
 * 
dz2
 ;

1391 
a
[
i
][
j
][1][2] = 0.0;

1392 
a
[
i
][
j
][1][3] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][1] * 
tmp1
 );

1393 
a
[
i
][
j
][1][4] = 0.0;

1395 
a
[
i
][
j
][2][0] = - 
dt
 * 
tz2


1396 * ( - ( 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][3] ) * 
tmp2
 )

1397 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][2] );

1398 
a
[
i
][
j
][2][1] = 0.0;

1399 
a
[
i
][
j
][2][2] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][3] * 
tmp1
 )

1400 - 
dt
 * 
tz1
 * ( 
c34
 * 
tmp1
 )

1401 - 
dt
 * 
tz1
 * 
dz3
;

1402 
a
[
i
][
j
][2][3] = - 
dt
 * 
tz2
 * ( 
u
[i][j][
k
-1][2] * 
tmp1
 );

1403 
a
[
i
][
j
][2][4] = 0.0;

1405 
a
[
i
][
j
][3][0] = - 
dt
 * 
tz2


1406 * ( - ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) *( u[i][j][k-1][3] *mp1 )

1407 + 0.50 * 
C2


1408 * ( ( 
u
[
i
][
j
][
k
-1][1] * u[i][j][k-1][1]

1409 + 
u
[
i
][
j
][
k
-1][2] * u[i][j][k-1][2]

1410 + 
u
[
i
][
j
][
k
-1][3] * u[i][j][k-1][3] ) * 
tmp2
 ) )

1411 - 
dt
 * 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][3] );

1412 
a
[
i
][
j
][3][1] = - 
dt
 * 
tz2


1413 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][1] * 
tmp1
 ) );

1414 
a
[
i
][
j
][3][2] = - 
dt
 * 
tz2


1415 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][2] * 
tmp1
 ) );

1416 
a
[
i
][
j
][3][3] = - 
dt
 * 
tz2
 * ( 2.0 - 
C2
 )

1417 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 )

1418 - 
dt
 * 
tz1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1419 - 
dt
 * 
tz1
 * 
dz4
;

1420 
a
[
i
][
j
][3][4] = - 
dt
 * 
tz2
 * 
C2
;

1422 
a
[
i
][
j
][4][0] = - 
dt
 * 
tz2


1423 * ( ( 
C2
 * ( 
u
[
i
][
j
][
k
-1][1] * u[i][j][k-1][1]

1424 + 
u
[
i
][
j
][
k
-1][2] * u[i][j][k-1][2]

1425 + 
u
[
i
][
j
][
k
-1][3] * u[i][j][k-1][3] ) * 
tmp2


1426 - 
C1
 * ( 
u
[
i
][
j
][
k
-1][4] * 
tmp1
 ) )

1427 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) )

1428 - 
dt
 * 
tz1


1429 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * (
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][1])

1430 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * (
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][2])

1431 - ( 
r43
*
c34
 - 
c1345
 )* 
tmp3
 * (
u
[
i
][
j
][
k
-1][3]*u[i][j][k-1][3])

1432 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
-1][4] );

1433 
a
[
i
][
j
][4][1] = - 
dt
 * 
tz2


1434 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][3] ) * 
tmp2
 )

1435 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][1];

1436 
a
[
i
][
j
][4][2] = - 
dt
 * 
tz2


1437 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][3] ) * 
tmp2
 )

1438 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][2];

1439 
a
[
i
][
j
][4][3] = - 
dt
 * 
tz2


1440 * ( 
C1
 * ( 
u
[
i
][
j
][
k
-1][4] * 
tmp1
 )

1441 - 0.50 * 
C2


1442 * ( ( 
u
[
i
][
j
][
k
-1][1]*u[i][j][k-1][1]

1443 + 
u
[
i
][
j
][
k
-1][2]*u[i][j][k-1][2]

1444 + 3.0*
u
[
i
][
j
][
k
-1][3]*u[i][j][k-1][3] ) * 
tmp2
 ) )

1445 - 
dt
 * 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
-1][3];

1446 
a
[
i
][
j
][4][4] = - 
dt
 * 
tz2


1447 * ( 
C1
 * ( 
u
[
i
][
j
][
k
-1][3] * 
tmp1
 ) )

1448 - 
dt
 * 
tz1
 * 
c1345
 * 
tmp1


1449 - 
dt
 * 
tz1
 * 
dz5
;

1454 
tmp1
 = 1.0 / 
u
[
i
][
j
-1][
k
][0];

1455 
tmp2
 = 
tmp1
 *mp1;

1456 
tmp3
 = 
tmp1
 * 
tmp2
;

1458 
b
[
i
][
j
][0][0] = - 
dt
 * 
ty1
 * 
dy1
;

1459 
b
[
i
][
j
][0][1] = 0.0;

1460 
b
[
i
][
j
][0][2] = - 
dt
 * 
ty2
;

1461 
b
[
i
][
j
][0][3] = 0.0;

1462 
b
[
i
][
j
][0][4] = 0.0;

1464 
b
[
i
][
j
][1][0] = - 
dt
 * 
ty2


1465 * ( - ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][2] ) * 
tmp2
 )

1466 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][1] );

1467 
b
[
i
][
j
][1][1] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][2] * 
tmp1
 )

1468 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1469 - 
dt
 * 
ty1
 * 
dy2
;

1470 
b
[
i
][
j
][1][2] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][1] * 
tmp1
 );

1471 
b
[
i
][
j
][1][3] = 0.0;

1472 
b
[
i
][
j
][1][4] = 0.0;

1474 
b
[
i
][
j
][2][0] = - 
dt
 * 
ty2


1475 * ( - ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) *( u[i][j-1][k][2] *mp1 )

1476 + 0.50 * 
C2
 * ( ( 
u
[
i
][
j
-1][
k
][1] * u[i][j-1][k][1]

1477 + 
u
[
i
][
j
-1][
k
][2] * u[i][j-1][k][2]

1478 + 
u
[
i
][
j
-1][
k
][3] * u[i][j-1][k][3] )

1479 * 
tmp2
 ) )

1480 - 
dt
 * 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][2] );

1481 
b
[
i
][
j
][2][1] = - 
dt
 * 
ty2


1482 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][1] * 
tmp1
 ) );

1483 
b
[
i
][
j
][2][2] = - 
dt
 * 
ty2
 * ( ( 2.0 - 
C2
 )

1484 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1485 - 
dt
 * 
ty1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1486 - 
dt
 * 
ty1
 * 
dy3
;

1487 
b
[
i
][
j
][2][3] = - 
dt
 * 
ty2


1488 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][3] * 
tmp1
 ) );

1489 
b
[
i
][
j
][2][4] = - 
dt
 * 
ty2
 * 
C2
;

1491 
b
[
i
][
j
][3][0] = - 
dt
 * 
ty2


1492 * ( - ( 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][3] ) * 
tmp2
 )

1493 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
-1][
k
][3] );

1494 
b
[
i
][
j
][3][1] = 0.0;

1495 
b
[
i
][
j
][3][2] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][3] * 
tmp1
 );

1496 
b
[
i
][
j
][3][3] = - 
dt
 * 
ty2
 * ( 
u
[i][j-1][
k
][2] * 
tmp1
 )

1497 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1498 - 
dt
 * 
ty1
 * 
dy4
;

1499 
b
[
i
][
j
][3][4] = 0.0;

1501 
b
[
i
][
j
][4][0] = - 
dt
 * 
ty2


1502 * ( ( 
C2
 * ( 
u
[
i
][
j
-1][
k
][1] * u[i][j-1][k][1]

1503 + 
u
[
i
][
j
-1][
k
][2] * u[i][j-1][k][2]

1504 + 
u
[
i
][
j
-1][
k
][3] * u[i][j-1][k][3] ) * 
tmp2


1505 - 
C1
 * ( 
u
[
i
][
j
-1][
k
][4] * 
tmp1
 ) )

1506 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1507 - 
dt
 * 
ty1


1508 * ( - ( 
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][1]))

1509 - ( 
r43
*
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][2]))

1510 - ( 
c34
 - 
c1345
 )*
tmp3
*(
	`pow2
(
u
[
i
][
j
-1][
k
][3]))

1511 - 
c1345
*
tmp2
*
u
[
i
][
j
-1][
k
][4] );

1512 
b
[
i
][
j
][4][1] = - 
dt
 * 
ty2


1513 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][2] ) * 
tmp2
 )

1514 - 
dt
 * 
ty1


1515 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][1];

1516 
b
[
i
][
j
][4][2] = - 
dt
 * 
ty2


1517 * ( 
C1
 * ( 
u
[
i
][
j
-1][
k
][4] * 
tmp1
 )

1518 - 0.50 * 
C2


1519 * ( ( 
u
[
i
][
j
-1][
k
][1]*u[i][j-1][k][1]

1520 + 3.0 * 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][2]

1521 + 
u
[
i
][
j
-1][
k
][3]*u[i][j-1][k][3] ) * 
tmp2
 ) )

1522 - 
dt
 * 
ty1


1523 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][2];

1524 
b
[
i
][
j
][4][3] = - 
dt
 * 
ty2


1525 * ( - 
C2
 * ( 
u
[
i
][
j
-1][
k
][2]*u[i][j-1][k][3] ) * 
tmp2
 )

1526 - 
dt
 * 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
-1][
k
][3];

1527 
b
[
i
][
j
][4][4] = - 
dt
 * 
ty2


1528 * ( 
C1
 * ( 
u
[
i
][
j
-1][
k
][2] * 
tmp1
 ) )

1529 - 
dt
 * 
ty1
 * 
c1345
 * 
tmp1


1530 - 
dt
 * 
ty1
 * 
dy5
;

1535 
tmp1
 = 1.0 / 
u
[
i
-1][
j
][
k
][0];

1536 
tmp2
 = 
tmp1
 *mp1;

1537 
tmp3
 = 
tmp1
 * 
tmp2
;

1539 
c
[
i
][
j
][0][0] = - 
dt
 * 
tx1
 * 
dx1
;

1540 
c
[
i
][
j
][0][1] = - 
dt
 * 
tx2
;

1541 
c
[
i
][
j
][0][2] = 0.0;

1542 
c
[
i
][
j
][0][3] = 0.0;

1543 
c
[
i
][
j
][0][4] = 0.0;

1545 
c
[
i
][
j
][1][0] = - 
dt
 * 
tx2


1546 * ( - ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) *( u[i-1][j][k][1] *mp1 )

1547 + 
C2
 * 0.50 * ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][1]

1548 + 
u
[
i
-1][
j
][
k
][2] * u[i-1][j][k][2]

1549 + 
u
[
i
-1][
j
][
k
][3] * u[i-1][j][k][3] ) * 
tmp2
 )

1550 - 
dt
 * 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][1] );

1551 
c
[
i
][
j
][1][1] = - 
dt
 * 
tx2


1552 * ( ( 2.0 - 
C2
 ) * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1553 - 
dt
 * 
tx1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1554 - 
dt
 * 
tx1
 * 
dx2
;

1555 
c
[
i
][
j
][1][2] = - 
dt
 * 
tx2


1556 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][2] * 
tmp1
 ) );

1557 
c
[
i
][
j
][1][3] = - 
dt
 * 
tx2


1558 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][3] * 
tmp1
 ) );

1559 
c
[
i
][
j
][1][4] = - 
dt
 * 
tx2
 * 
C2
;

1561 
c
[
i
][
j
][2][0] = - 
dt
 * 
tx2


1562 * ( - ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][2] ) * 
tmp2
 )

1563 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][2] );

1564 
c
[
i
][
j
][2][1] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][2] * 
tmp1
 );

1565 
c
[
i
][
j
][2][2] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][1] * 
tmp1
 )

1566 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1567 - 
dt
 * 
tx1
 * 
dx3
;

1568 
c
[
i
][
j
][2][3] = 0.0;

1569 
c
[
i
][
j
][2][4] = 0.0;

1571 
c
[
i
][
j
][3][0] = - 
dt
 * 
tx2


1572 * ( - ( 
u
[
i
-1][
j
][
k
][1]*u[i-1][j][k][3] ) * 
tmp2
 )

1573 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][3] );

1574 
c
[
i
][
j
][3][1] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][3] * 
tmp1
 );

1575 
c
[
i
][
j
][3][2] = 0.0;

1576 
c
[
i
][
j
][3][3] = - 
dt
 * 
tx2
 * ( 
u
[i-1][j][
k
][1] * 
tmp1
 )

1577 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1578 - 
dt
 * 
tx1
 * 
dx4
;

1579 
c
[
i
][
j
][3][4] = 0.0;

1581 
c
[
i
][
j
][4][0] = - 
dt
 * 
tx2


1582 * ( ( 
C2
 * ( 
u
[
i
-1][
j
][
k
][1] * u[i-1][j][k][1]

1583 + 
u
[
i
-1][
j
][
k
][2] * u[i-1][j][k][2]

1584 + 
u
[
i
-1][
j
][
k
][3] * u[i-1][j][k][3] ) * 
tmp2


1585 - 
C1
 * ( 
u
[
i
-1][
j
][
k
][4] * 
tmp1
 ) )

1586 * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1587 - 
dt
 * 
tx1


1588 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][1]) )

1589 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][2]) )

1590 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
-1][
j
][
k
][3]) )

1591 - 
c1345
 * 
tmp2
 * 
u
[
i
-1][
j
][
k
][4] );

1592 
c
[
i
][
j
][4][1] = - 
dt
 * 
tx2


1593 * ( 
C1
 * ( 
u
[
i
-1][
j
][
k
][4] * 
tmp1
 )

1594 - 0.50 * 
C2


1595 * ( ( 3.0*
u
[
i
-1][
j
][
k
][1]*u[i-1][j][k][1]

1596 + 
u
[
i
-1][
j
][
k
][2]*u[i-1][j][k][2]

1597 + 
u
[
i
-1][
j
][
k
][3]*u[i-1][j][k][3] ) * 
tmp2
 ) )

1598 - 
dt
 * 
tx1


1599 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][1];

1600 
c
[
i
][
j
][4][2] = - 
dt
 * 
tx2


1601 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][2]*u[i-1][j][k][1] ) * 
tmp2
 )

1602 - 
dt
 * 
tx1


1603 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][2];

1604 
c
[
i
][
j
][4][3] = - 
dt
 * 
tx2


1605 * ( - 
C2
 * ( 
u
[
i
-1][
j
][
k
][3]*u[i-1][j][k][1] ) * 
tmp2
 )

1606 - 
dt
 * 
tx1


1607 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
-1][
j
][
k
][3];

1608 
c
[
i
][
j
][4][4] = - 
dt
 * 
tx2


1609 * ( 
C1
 * ( 
u
[
i
-1][
j
][
k
][1] * 
tmp1
 ) )

1610 - 
dt
 * 
tx1
 * 
c1345
 * 
tmp1


1611 - 
dt
 * 
tx1
 * 
dx5
;

1614 
	}
}

1620 
	$jacu
(
k
) {

1629 
i
, 
j
;

1630 
r43
;

1631 
c1345
;

1632 
c34
;

1633 
tmp1
, 
tmp2
, 
tmp3
;

1635 
r43
 = ( 4.0 / 3.0 );

1636 
c1345
 = 
C1
 * 
C3
 * 
C4
 * 
C5
;

1637 
c34
 = 
C3
 * 
C4
;

1639 #´agm¨
omp
 
nowa™
 
	`scheduË
()

1640 #ià
	`defšed
(
_OPENMP
)

1641 
i
 = 
›nd
; i >ğ
i¡
; i--) {

1642 
j
 = 
j’d
; j >ğ
j¡
; j--) {

1644 
i
 = 
i¡
; i <ğ
›nd
; i++) {

1645 
j
 = 
j¡
; j <ğ
j’d
; j++) {

1651 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
][0];

1652 
tmp2
 = 
tmp1
 *mp1;

1653 
tmp3
 = 
tmp1
 * 
tmp2
;

1655 
d
[
i
][
j
][0][0] = 1.0

1656 + 
dt
 * 2.0 * ( 
tx1
 * 
dx1


1657 + 
ty1
 * 
dy1


1658 + 
tz1
 * 
dz1
 );

1659 
d
[
i
][
j
][0][1] = 0.0;

1660 
d
[
i
][
j
][0][2] = 0.0;

1661 
d
[
i
][
j
][0][3] = 0.0;

1662 
d
[
i
][
j
][0][4] = 0.0;

1664 
d
[
i
][
j
][1][0] = 
dt
 * 2.0

1665 * ( 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1666 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] )

1667 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][1] ) );

1668 
d
[
i
][
j
][1][1] = 1.0

1669 + 
dt
 * 2.0

1670 * ( 
tx1
 * 
r43
 * 
c34
 * 
tmp1


1671 + 
ty1
 * 
c34
 * 
tmp1


1672 + 
tz1
 * 
c34
 * 
tmp1
 )

1673 + 
dt
 * 2.0 * ( 
tx1
 * 
dx2


1674 + 
ty1
 * 
dy2


1675 + 
tz1
 * 
dz2
 );

1676 
d
[
i
][
j
][1][2] = 0.0;

1677 
d
[
i
][
j
][1][3] = 0.0;

1678 
d
[
i
][
j
][1][4] = 0.0;

1680 
d
[
i
][
j
][2][0] = 
dt
 * 2.0

1681 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1682 + 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] )

1683 + 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][2] ) );

1684 
d
[
i
][
j
][2][1] = 0.0;

1685 
d
[
i
][
j
][2][2] = 1.0

1686 + 
dt
 * 2.0

1687 * ( 
tx1
 * 
c34
 * 
tmp1


1688 + 
ty1
 * 
r43
 * 
c34
 * 
tmp1


1689 + 
tz1
 * 
c34
 * 
tmp1
 )

1690 + 
dt
 * 2.0 * ( 
tx1
 * 
dx3


1691 + 
ty1
 * 
dy3


1692 + 
tz1
 * 
dz3
 );

1693 
d
[
i
][
j
][2][3] = 0.0;

1694 
d
[
i
][
j
][2][4] = 0.0;

1696 
d
[
i
][
j
][3][0] = 
dt
 * 2.0

1697 * ( 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1698 + 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] )

1699 + 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
][3] ) );

1700 
d
[
i
][
j
][3][1] = 0.0;

1701 
d
[
i
][
j
][3][2] = 0.0;

1702 
d
[
i
][
j
][3][3] = 1.0

1703 + 
dt
 * 2.0

1704 * ( 
tx1
 * 
c34
 * 
tmp1


1705 + 
ty1
 * 
c34
 * 
tmp1


1706 + 
tz1
 * 
r43
 * 
c34
 * 
tmp1
 )

1707 + 
dt
 * 2.0 * ( 
tx1
 * 
dx4


1708 + 
ty1
 * 
dy4


1709 + 
tz1
 * 
dz4
 );

1710 
d
[
i
][
j
][3][4] = 0.0;

1712 
d
[
i
][
j
][4][0] = 
dt
 * 2.0

1713 * ( 
tx1
 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1714 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1715 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1716 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1717 + 
ty1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1718 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1719 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1720 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] )

1721 + 
tz1
 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1]) )

1722 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][2]) )

1723 - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

1724 - ( 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][4] ) );

1725 
d
[
i
][
j
][4][1] = 
dt
 * 2.0

1726 * ( 
tx1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1727 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1]

1728 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][1] );

1729 
d
[
i
][
j
][4][2] = 
dt
 * 2.0

1730 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1731 + 
ty1
 * ( 
r43
*
c34
 -
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2]

1732 + 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][2] );

1733 
d
[
i
][
j
][4][3] = 
dt
 * 2.0

1734 * ( 
tx1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1735 + 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3]

1736 + 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
][3] );

1737 
d
[
i
][
j
][4][4] = 1.0

1738 + 
dt
 * 2.0 * ( 
tx1
 * 
c1345
 * 
tmp1


1739 + 
ty1
 * 
c1345
 * 
tmp1


1740 + 
tz1
 * 
c1345
 * 
tmp1
 )

1741 + 
dt
 * 2.0 * ( 
tx1
 * 
dx5


1742 + 
ty1
 * 
dy5


1743 + 
tz1
 * 
dz5
 );

1748 
tmp1
 = 1.0 / 
u
[
i
+1][
j
][
k
][0];

1749 
tmp2
 = 
tmp1
 *mp1;

1750 
tmp3
 = 
tmp1
 * 
tmp2
;

1752 
a
[
i
][
j
][0][0] = - 
dt
 * 
tx1
 * 
dx1
;

1753 
a
[
i
][
j
][0][1] = 
dt
 * 
tx2
;

1754 
a
[
i
][
j
][0][2] = 0.0;

1755 
a
[
i
][
j
][0][3] = 0.0;

1756 
a
[
i
][
j
][0][4] = 0.0;

1758 
a
[
i
][
j
][1][0] = 
dt
 * 
tx2


1759 * ( - ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) *( u[i+1][j][k][1] *mp1 )

1760 + 
C2
 * 0.50 * ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][1]

1761 + 
u
[
i
+1][
j
][
k
][2] * u[i+1][j][k][2]

1762 + 
u
[
i
+1][
j
][
k
][3] * u[i+1][j][k][3] ) * 
tmp2
 )

1763 - 
dt
 * 
tx1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][1] );

1764 
a
[
i
][
j
][1][1] = 
dt
 * 
tx2


1765 * ( ( 2.0 - 
C2
 ) * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1766 - 
dt
 * 
tx1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1767 - 
dt
 * 
tx1
 * 
dx2
;

1768 
a
[
i
][
j
][1][2] = 
dt
 * 
tx2


1769 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][2] * 
tmp1
 ) );

1770 
a
[
i
][
j
][1][3] = 
dt
 * 
tx2


1771 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][3] * 
tmp1
 ) );

1772 
a
[
i
][
j
][1][4] = 
dt
 * 
tx2
 * 
C2
 ;

1774 
a
[
i
][
j
][2][0] = 
dt
 * 
tx2


1775 * ( - ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][2] ) * 
tmp2
 )

1776 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][2] );

1777 
a
[
i
][
j
][2][1] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][2] * 
tmp1
 );

1778 
a
[
i
][
j
][2][2] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][1] * 
tmp1
 )

1779 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1780 - 
dt
 * 
tx1
 * 
dx3
;

1781 
a
[
i
][
j
][2][3] = 0.0;

1782 
a
[
i
][
j
][2][4] = 0.0;

1784 
a
[
i
][
j
][3][0] = 
dt
 * 
tx2


1785 * ( - ( 
u
[
i
+1][
j
][
k
][1]*u[i+1][j][k][3] ) * 
tmp2
 )

1786 - 
dt
 * 
tx1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][3] );

1787 
a
[
i
][
j
][3][1] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][3] * 
tmp1
 );

1788 
a
[
i
][
j
][3][2] = 0.0;

1789 
a
[
i
][
j
][3][3] = 
dt
 * 
tx2
 * ( 
u
[i+1][j][
k
][1] * 
tmp1
 )

1790 - 
dt
 * 
tx1
 * ( 
c34
 * 
tmp1
 )

1791 - 
dt
 * 
tx1
 * 
dx4
;

1792 
a
[
i
][
j
][3][4] = 0.0;

1794 
a
[
i
][
j
][4][0] = 
dt
 * 
tx2


1795 * ( ( 
C2
 * ( 
u
[
i
+1][
j
][
k
][1] * u[i+1][j][k][1]

1796 + 
u
[
i
+1][
j
][
k
][2] * u[i+1][j][k][2]

1797 + 
u
[
i
+1][
j
][
k
][3] * u[i+1][j][k][3] ) * 
tmp2


1798 - 
C1
 * ( 
u
[
i
+1][
j
][
k
][4] * 
tmp1
 ) )

1799 * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1800 - 
dt
 * 
tx1


1801 * ( - ( 
r43
*
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][1]) )

1802 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][2]) )

1803 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
+1][
j
][
k
][3]) )

1804 - 
c1345
 * 
tmp2
 * 
u
[
i
+1][
j
][
k
][4] );

1805 
a
[
i
][
j
][4][1] = 
dt
 * 
tx2


1806 * ( 
C1
 * ( 
u
[
i
+1][
j
][
k
][4] * 
tmp1
 )

1807 - 0.50 * 
C2


1808 * ( ( 3.0*
u
[
i
+1][
j
][
k
][1]*u[i+1][j][k][1]

1809 + 
u
[
i
+1][
j
][
k
][2]*u[i+1][j][k][2]

1810 + 
u
[
i
+1][
j
][
k
][3]*u[i+1][j][k][3] ) * 
tmp2
 ) )

1811 - 
dt
 * 
tx1


1812 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][1];

1813 
a
[
i
][
j
][4][2] = 
dt
 * 
tx2


1814 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][2]*u[i+1][j][k][1] ) * 
tmp2
 )

1815 - 
dt
 * 
tx1


1816 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][2];

1817 
a
[
i
][
j
][4][3] = 
dt
 * 
tx2


1818 * ( - 
C2
 * ( 
u
[
i
+1][
j
][
k
][3]*u[i+1][j][k][1] ) * 
tmp2
 )

1819 - 
dt
 * 
tx1


1820 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
+1][
j
][
k
][3];

1821 
a
[
i
][
j
][4][4] = 
dt
 * 
tx2


1822 * ( 
C1
 * ( 
u
[
i
+1][
j
][
k
][1] * 
tmp1
 ) )

1823 - 
dt
 * 
tx1
 * 
c1345
 * 
tmp1


1824 - 
dt
 * 
tx1
 * 
dx5
;

1829 
tmp1
 = 1.0 / 
u
[
i
][
j
+1][
k
][0];

1830 
tmp2
 = 
tmp1
 *mp1;

1831 
tmp3
 = 
tmp1
 * 
tmp2
;

1833 
b
[
i
][
j
][0][0] = - 
dt
 * 
ty1
 * 
dy1
;

1834 
b
[
i
][
j
][0][1] = 0.0;

1835 
b
[
i
][
j
][0][2] = 
dt
 * 
ty2
;

1836 
b
[
i
][
j
][0][3] = 0.0;

1837 
b
[
i
][
j
][0][4] = 0.0;

1839 
b
[
i
][
j
][1][0] = 
dt
 * 
ty2


1840 * ( - ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][2] ) * 
tmp2
 )

1841 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][1] );

1842 
b
[
i
][
j
][1][1] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][2] * 
tmp1
 )

1843 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1844 - 
dt
 * 
ty1
 * 
dy2
;

1845 
b
[
i
][
j
][1][2] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][1] * 
tmp1
 );

1846 
b
[
i
][
j
][1][3] = 0.0;

1847 
b
[
i
][
j
][1][4] = 0.0;

1849 
b
[
i
][
j
][2][0] = 
dt
 * 
ty2


1850 * ( - ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) *( u[i][j+1][k][2] *mp1 )

1851 + 0.50 * 
C2
 * ( ( 
u
[
i
][
j
+1][
k
][1] * u[i][j+1][k][1]

1852 + 
u
[
i
][
j
+1][
k
][2] * u[i][j+1][k][2]

1853 + 
u
[
i
][
j
+1][
k
][3] * u[i][j+1][k][3] )

1854 * 
tmp2
 ) )

1855 - 
dt
 * 
ty1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][2] );

1856 
b
[
i
][
j
][2][1] = 
dt
 * 
ty2


1857 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][1] * 
tmp1
 ) );

1858 
b
[
i
][
j
][2][2] = 
dt
 * 
ty2
 * ( ( 2.0 - 
C2
 )

1859 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1860 - 
dt
 * 
ty1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1861 - 
dt
 * 
ty1
 * 
dy3
;

1862 
b
[
i
][
j
][2][3] = 
dt
 * 
ty2


1863 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][3] * 
tmp1
 ) );

1864 
b
[
i
][
j
][2][4] = 
dt
 * 
ty2
 * 
C2
;

1866 
b
[
i
][
j
][3][0] = 
dt
 * 
ty2


1867 * ( - ( 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][3] ) * 
tmp2
 )

1868 - 
dt
 * 
ty1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
+1][
k
][3] );

1869 
b
[
i
][
j
][3][1] = 0.0;

1870 
b
[
i
][
j
][3][2] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][3] * 
tmp1
 );

1871 
b
[
i
][
j
][3][3] = 
dt
 * 
ty2
 * ( 
u
[i][j+1][
k
][2] * 
tmp1
 )

1872 - 
dt
 * 
ty1
 * ( 
c34
 * 
tmp1
 )

1873 - 
dt
 * 
ty1
 * 
dy4
;

1874 
b
[
i
][
j
][3][4] = 0.0;

1876 
b
[
i
][
j
][4][0] = 
dt
 * 
ty2


1877 * ( ( 
C2
 * ( 
u
[
i
][
j
+1][
k
][1] * u[i][j+1][k][1]

1878 + 
u
[
i
][
j
+1][
k
][2] * u[i][j+1][k][2]

1879 + 
u
[
i
][
j
+1][
k
][3] * u[i][j+1][k][3] ) * 
tmp2


1880 - 
C1
 * ( 
u
[
i
][
j
+1][
k
][4] * 
tmp1
 ) )

1881 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1882 - 
dt
 * 
ty1


1883 * ( - ( 
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][1]) )

1884 - ( 
r43
*
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][2]) )

1885 - ( 
c34
 - 
c1345
 )*
tmp3
*Ğ
	`pow2
(
u
[
i
][
j
+1][
k
][3]) )

1886 - 
c1345
*
tmp2
*
u
[
i
][
j
+1][
k
][4] );

1887 
b
[
i
][
j
][4][1] = 
dt
 * 
ty2


1888 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][2] ) * 
tmp2
 )

1889 - 
dt
 * 
ty1


1890 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][1];

1891 
b
[
i
][
j
][4][2] = 
dt
 * 
ty2


1892 * ( 
C1
 * ( 
u
[
i
][
j
+1][
k
][4] * 
tmp1
 )

1893 - 0.50 * 
C2


1894 * ( ( 
u
[
i
][
j
+1][
k
][1]*u[i][j+1][k][1]

1895 + 3.0 * 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][2]

1896 + 
u
[
i
][
j
+1][
k
][3]*u[i][j+1][k][3] ) * 
tmp2
 ) )

1897 - 
dt
 * 
ty1


1898 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][2];

1899 
b
[
i
][
j
][4][3] = 
dt
 * 
ty2


1900 * ( - 
C2
 * ( 
u
[
i
][
j
+1][
k
][2]*u[i][j+1][k][3] ) * 
tmp2
 )

1901 - 
dt
 * 
ty1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
+1][
k
][3];

1902 
b
[
i
][
j
][4][4] = 
dt
 * 
ty2


1903 * ( 
C1
 * ( 
u
[
i
][
j
+1][
k
][2] * 
tmp1
 ) )

1904 - 
dt
 * 
ty1
 * 
c1345
 * 
tmp1


1905 - 
dt
 * 
ty1
 * 
dy5
;

1910 
tmp1
 = 1.0 / 
u
[
i
][
j
][
k
+1][0];

1911 
tmp2
 = 
tmp1
 *mp1;

1912 
tmp3
 = 
tmp1
 * 
tmp2
;

1914 
c
[
i
][
j
][0][0] = - 
dt
 * 
tz1
 * 
dz1
;

1915 
c
[
i
][
j
][0][1] = 0.0;

1916 
c
[
i
][
j
][0][2] = 0.0;

1917 
c
[
i
][
j
][0][3] = 
dt
 * 
tz2
;

1918 
c
[
i
][
j
][0][4] = 0.0;

1920 
c
[
i
][
j
][1][0] = 
dt
 * 
tz2


1921 * ( - ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][3] ) * 
tmp2
 )

1922 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][1] );

1923 
c
[
i
][
j
][1][1] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][3] * 
tmp1
 )

1924 - 
dt
 * 
tz1
 * 
c34
 * 
tmp1


1925 - 
dt
 * 
tz1
 * 
dz2
 ;

1926 
c
[
i
][
j
][1][2] = 0.0;

1927 
c
[
i
][
j
][1][3] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][1] * 
tmp1
 );

1928 
c
[
i
][
j
][1][4] = 0.0;

1930 
c
[
i
][
j
][2][0] = 
dt
 * 
tz2


1931 * ( - ( 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][3] ) * 
tmp2
 )

1932 - 
dt
 * 
tz1
 * ( - 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][2] );

1933 
c
[
i
][
j
][2][1] = 0.0;

1934 
c
[
i
][
j
][2][2] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][3] * 
tmp1
 )

1935 - 
dt
 * 
tz1
 * ( 
c34
 * 
tmp1
 )

1936 - 
dt
 * 
tz1
 * 
dz3
;

1937 
c
[
i
][
j
][2][3] = 
dt
 * 
tz2
 * ( 
u
[i][j][
k
+1][2] * 
tmp1
 );

1938 
c
[
i
][
j
][2][4] = 0.0;

1940 
c
[
i
][
j
][3][0] = 
dt
 * 
tz2


1941 * ( - ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) *( u[i][j][k+1][3] *mp1 )

1942 + 0.50 * 
C2


1943 * ( ( 
u
[
i
][
j
][
k
+1][1] * u[i][j][k+1][1]

1944 + 
u
[
i
][
j
][
k
+1][2] * u[i][j][k+1][2]

1945 + 
u
[
i
][
j
][
k
+1][3] * u[i][j][k+1][3] ) * 
tmp2
 ) )

1946 - 
dt
 * 
tz1
 * ( - 
r43
 * 
c34
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][3] );

1947 
c
[
i
][
j
][3][1] = 
dt
 * 
tz2


1948 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][1] * 
tmp1
 ) );

1949 
c
[
i
][
j
][3][2] = 
dt
 * 
tz2


1950 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][2] * 
tmp1
 ) );

1951 
c
[
i
][
j
][3][3] = 
dt
 * 
tz2
 * ( 2.0 - 
C2
 )

1952 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 )

1953 - 
dt
 * 
tz1
 * ( 
r43
 * 
c34
 * 
tmp1
 )

1954 - 
dt
 * 
tz1
 * 
dz4
;

1955 
c
[
i
][
j
][3][4] = 
dt
 * 
tz2
 * 
C2
;

1957 
c
[
i
][
j
][4][0] = 
dt
 * 
tz2


1958 * ( ( 
C2
 * ( 
u
[
i
][
j
][
k
+1][1] * u[i][j][k+1][1]

1959 + 
u
[
i
][
j
][
k
+1][2] * u[i][j][k+1][2]

1960 + 
u
[
i
][
j
][
k
+1][3] * u[i][j][k+1][3] ) * 
tmp2


1961 - 
C1
 * ( 
u
[
i
][
j
][
k
+1][4] * 
tmp1
 ) )

1962 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) )

1963 - 
dt
 * 
tz1


1964 * ( - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][1]) )

1965 - ( 
c34
 - 
c1345
 ) * 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][2]) )

1966 - ( 
r43
*
c34
 - 
c1345
 )* 
tmp3
 * ( 
	`pow2
(
u
[
i
][
j
][
k
+1][3]) )

1967 - 
c1345
 * 
tmp2
 * 
u
[
i
][
j
][
k
+1][4] );

1968 
c
[
i
][
j
][4][1] = 
dt
 * 
tz2


1969 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][3] ) * 
tmp2
 )

1970 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][1];

1971 
c
[
i
][
j
][4][2] = 
dt
 * 
tz2


1972 * ( - 
C2
 * ( 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][3] ) * 
tmp2
 )

1973 - 
dt
 * 
tz1
 * ( 
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][2];

1974 
c
[
i
][
j
][4][3] = 
dt
 * 
tz2


1975 * ( 
C1
 * ( 
u
[
i
][
j
][
k
+1][4] * 
tmp1
 )

1976 - 0.50 * 
C2


1977 * ( ( 
u
[
i
][
j
][
k
+1][1]*u[i][j][k+1][1]

1978 + 
u
[
i
][
j
][
k
+1][2]*u[i][j][k+1][2]

1979 + 3.0*
u
[
i
][
j
][
k
+1][3]*u[i][j][k+1][3] ) * 
tmp2
 ) )

1980 - 
dt
 * 
tz1
 * ( 
r43
*
c34
 - 
c1345
 ) * 
tmp2
 * 
u
[
i
][
j
][
k
+1][3];

1981 
c
[
i
][
j
][4][4] = 
dt
 * 
tz2


1982 * ( 
C1
 * ( 
u
[
i
][
j
][
k
+1][3] * 
tmp1
 ) )

1983 - 
dt
 * 
tz1
 * 
c1345
 * 
tmp1


1984 - 
dt
 * 
tz1
 * 
dz5
;

1987 
	}
}

1992 
l2nÜm
 (
nx0
, 
ny0
, 
nz0
,

1993 
i¡
, 
›nd
,

1994 
j¡
, 
j’d
,

1999 
v
[
ISIZ1
][
ISIZ2
/2*2+1][
ISIZ3
/2*2+1][5],

2000 
sum
[5]) {

2002 #´agm¨
omp
 
·¿Î–


2012 
	gi
, 
	gj
, 
	gk
, 
	gm
;

2013 
	gsum0
=0.0, 
	gsum1
=0.0, 
	gsum2
=0.0, 
	gsum3
=0.0, 
	gsum4
=0.0;

2015 #´agm¨
omp
 
sšgË


2016 
	gm
 = 0; m < 5; m++) {

2017 
	gsum
[
m
] = 0.0;

2020 #´agm¨
omp
 
nowa™


2021 
	gi
 = 
i¡
; i <ğ
›nd
; i++) {

2022 
	gj
 = 
j¡
; j <ğ
j’d
; j++) {

2023 
	gk
 = 1; k <ğ
nz0
-2; k++) {

2024 
	gsum0
 = 
sum0
 + 
v
[
i
][
j
][
k
][0] * v[i][j][k][0];

2025 
	gsum1
 = 
sum1
 + 
v
[
i
][
j
][
k
][1] * v[i][j][k][1];

2026 
	gsum2
 = 
sum2
 + 
v
[
i
][
j
][
k
][2] * v[i][j][k][2];

2027 
	gsum3
 = 
sum3
 + 
v
[
i
][
j
][
k
][3] * v[i][j][k][3];

2028 
	gsum4
 = 
sum4
 + 
v
[
i
][
j
][
k
][4] * v[i][j][k][4];

2033 #´agm¨
omp
 
ü™iÿl


2035 
	gsum
[0] +ğ
sum0
;

2036 
	gsum
[1] +ğ
sum1
;

2037 
	gsum
[2] +ğ
sum2
;

2038 
	gsum
[3] +ğ
sum3
;

2039 
	gsum
[4] +ğ
sum4
;

2041 #´agm¨
omp
 
b¬r›r


2043 #´agm¨
omp
 
sšgË


2044 
	gm
 = 0; m < 5; m++) {

2045 
	gsum
[
m
] = 
sq¹
 ( 
sum
[m] / ( (
nx0
-2)*(
ny0
-2)*(
nz0
-2) ) );

2052 
	$pštgr
() {

2057 
i
, 
j
, 
k
;

2058 
ibeg
, 
ifš
, 
ifš1
;

2059 
jbeg
, 
jfš
, 
jfš1
;

2060 
iglob
, 
iglob1
, 
iglob2
;

2061 
jglob
, 
jglob1
, 
jglob2
;

2062 
phi1
[
ISIZ2
+2][
ISIZ3
+2];

2063 
phi2
[
ISIZ2
+2][
ISIZ3
+2];

2064 
äc1
, 
äc2
, 
äc3
;

2069 
ibeg
 = 
nx
;

2070 
ifš
 = 0;

2071 
iglob1
 = -1;

2072 
iglob2
 = 
nx
-1;

2073 ià(
iglob1
 >ğ
ii1
 && 
iglob2
 < 
ii2
+
nx
è
ibeg
 = 0;

2074 ià(
iglob1
 >ğ
ii1
-
nx
 && 
iglob2
 <ğ
ii2
è
ifš
 =‚x;

2075 ià(
ii1
 >ğ
iglob1
 && ii1 <ğ
iglob2
è
ibeg
 = ii1;

2076 ià(
ii2
 >ğ
iglob1
 && ii2 <ğ
iglob2
è
ifš
 = ii2;

2077 
jbeg
 = 
ny
;

2078 
jfš
 = -1;

2079 
jglob1
 = 0;

2080 
jglob2
 = 
ny
-1;

2081 ià(
jglob1
 >ğ
ji1
 && 
jglob2
 < 
ji2
+
ny
è
jbeg
 = 0;

2082 ià(
jglob1
 > 
ji1
-
ny
 && 
jglob2
 <ğ
ji2
è
jfš
 =‚y;

2083 ià(
ji1
 >ğ
jglob1
 && ji1 <ğ
jglob2
è
jbeg
 = ji1;

2084 ià(
ji2
 >ğ
jglob1
 && ji2 <ğ
jglob2
è
jfš
 = ji2;

2085 
ifš1
 = 
ifš
;

2086 
jfš1
 = 
jfš
;

2087 ià(
ifš1
 =ğ
ii2
èifš1 = 
ifš
 -1;

2088 ià(
jfš1
 =ğ
ji2
èjfš1 = 
jfš
 -1;

2093 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2094 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2095 
phi1
[
i
][
k
] = 0.0;

2096 
phi2
[
i
][
k
] = 0.0;

2099 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2100 
iglob
 = 
i
;

2101 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2102 
jglob
 = 
j
;

2104 
k
 = 
ki1
;

2106 
phi1
[
i
][
j
] = 
C2
*Ğ
u
[i][j][
k
][4]

2107 - 0.50 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1])

2108 + 
	`pow2
(
u
[
i
][
j
][
k
][2])

2109 + 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

2110 / 
u
[
i
][
j
][
k
][0] );

2112 
k
 = 
ki2
;

2114 
phi2
[
i
][
j
] = 
C2
*Ğ
u
[i][j][
k
][4]

2115 - 0.50 * ( 
	`pow2
(
u
[
i
][
j
][
k
][1])

2116 + 
	`pow2
(
u
[
i
][
j
][
k
][2])

2117 + 
	`pow2
(
u
[
i
][
j
][
k
][3]) )

2118 / 
u
[
i
][
j
][
k
][0] );

2122 
äc1
 = 0.0;

2124 
i
 = 
ibeg
; i <ğ
ifš1
; i++) {

2125 
j
 = 
jbeg
; j <ğ
jfš1
; j++) {

2126 
äc1
 = frc1 + ( 
phi1
[
i
][
j
]

2127 + 
phi1
[
i
+1][
j
]

2128 + 
phi1
[
i
][
j
+1]

2129 + 
phi1
[
i
+1][
j
+1]

2130 + 
phi2
[
i
][
j
]

2131 + 
phi2
[
i
+1][
j
]

2132 + 
phi2
[
i
][
j
+1]

2133 + 
phi2
[
i
+1][
j
+1] );

2137 
äc1
 = 
dxi
 * 
d‘a
 * frc1;

2142 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2143 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2144 
phi1
[
i
][
k
] = 0.0;

2145 
phi2
[
i
][
k
] = 0.0;

2148 
jglob
 = 
jbeg
;

2149 ià(
jglob
 =ğ
ji1
) {

2150 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2151 
iglob
 = 
i
;

2152 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2153 
phi1
[
i
][
k
] = 
C2
*Ğ
u
[i][
jbeg
][k][4]

2154 - 0.50 * ( 
	`pow2
(
u
[
i
][
jbeg
][
k
][1])

2155 + 
	`pow2
(
u
[
i
][
jbeg
][
k
][2])

2156 + 
	`pow2
(
u
[
i
][
jbeg
][
k
][3]) )

2157 / 
u
[
i
][
jbeg
][
k
][0] );

2162 
jglob
 = 
jfš
;

2163 ià(
jglob
 =ğ
ji2
) {

2164 
i
 = 
ibeg
; i <ğ
ifš
; i++) {

2165 
iglob
 = 
i
;

2166 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2167 
phi2
[
i
][
k
] = 
C2
*Ğ
u
[i][
jfš
][k][4]

2168 - 0.50 * ( 
	`pow2
(
u
[
i
][
jfš
][
k
][1])

2169 + 
	`pow2
(
u
[
i
][
jfš
][
k
][2])

2170 + 
	`pow2
(
u
[
i
][
jfš
][
k
][3]) )

2171 / 
u
[
i
][
jfš
][
k
][0] );

2177 
äc2
 = 0.0;

2178 
i
 = 
ibeg
; i <ğ
ifš1
; i++) {

2179 
k
 = 
ki1
; k <ğ
ki2
-1; k++) {

2180 
äc2
 = frc2 + ( 
phi1
[
i
][
k
]

2181 + 
phi1
[
i
+1][
k
]

2182 + 
phi1
[
i
][
k
+1]

2183 + 
phi1
[
i
+1][
k
+1]

2184 + 
phi2
[
i
][
k
]

2185 + 
phi2
[
i
+1][
k
]

2186 + 
phi2
[
i
][
k
+1]

2187 + 
phi2
[
i
+1][
k
+1] );

2192 
äc2
 = 
dxi
 * 
dz‘a
 * frc2;

2197 
i
 = 0; i <ğ
ISIZ2
+1; i++) {

2198 
k
 = 0; k <ğ
ISIZ3
+1; k++) {

2199 
phi1
[
i
][
k
] = 0.0;

2200 
phi2
[
i
][
k
] = 0.0;

2203 
iglob
 = 
ibeg
;

2204 ià(
iglob
 =ğ
ii1
) {

2205 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2206 
jglob
 = 
j
;

2207 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2208 
phi1
[
j
][
k
] = 
C2
*Ğ
u
[
ibeg
][j][k][4]

2209 - 0.50 * ( 
	`pow2
(
u
[
ibeg
][
j
][
k
][1])

2210 + 
	`pow2
(
u
[
ibeg
][
j
][
k
][2])

2211 + 
	`pow2
(
u
[
ibeg
][
j
][
k
][3]) )

2212 / 
u
[
ibeg
][
j
][
k
][0] );

2217 
iglob
 = 
ifš
;

2218 ià(
iglob
 =ğ
ii2
) {

2219 
j
 = 
jbeg
; j <ğ
jfš
; j++) {

2220 
jglob
 = 
j
;

2221 
k
 = 
ki1
; k <ğ
ki2
; k++) {

2222 
phi2
[
j
][
k
] = 
C2
*Ğ
u
[
ifš
][j][k][4]

2223 - 0.50 * ( 
	`pow2
(
u
[
ifš
][
j
][
k
][1])

2224 + 
	`pow2
(
u
[
ifš
][
j
][
k
][2])

2225 + 
	`pow2
(
u
[
ifš
][
j
][
k
][3]) )

2226 / 
u
[
ifš
][
j
][
k
][0] );

2231 
äc3
 = 0.0;

2233 
j
 = 
jbeg
; j <ğ
jfš1
; j++) {

2234 
k
 = 
ki1
; k <ğ
ki2
-1; k++) {

2235 
äc3
 = frc3 + ( 
phi1
[
j
][
k
]

2236 + 
phi1
[
j
+1][
k
]

2237 + 
phi1
[
j
][
k
+1]

2238 + 
phi1
[
j
+1][
k
+1]

2239 + 
phi2
[
j
][
k
]

2240 + 
phi2
[
j
+1][
k
]

2241 + 
phi2
[
j
][
k
+1]

2242 + 
phi2
[
j
+1][
k
+1] );

2246 
äc3
 = 
d‘a
 * 
dz‘a
 * frc3;

2247 
äc
 = 0.25 * ( 
äc1
 + 
äc2
 + 
äc3
 );

2248 
	}
}

2253 
	$»ad_šput
() {

2268 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

2301 
r
 = 
IPR_DEFAULT
;

2302 
šÜm
 = 
INORM_DEFAULT
;

2303 
™max
 = 
ITMAX_DEFAULT
;

2304 
dt
 = 
DT_DEFAULT
;

2305 
omega
 = 
OMEGA_DEFAULT
;

2306 
tŞrsd
[0] = 
TOLRSD1_DEF
;

2307 
tŞrsd
[1] = 
TOLRSD2_DEF
;

2308 
tŞrsd
[2] = 
TOLRSD3_DEF
;

2309 
tŞrsd
[3] = 
TOLRSD4_DEF
;

2310 
tŞrsd
[4] = 
TOLRSD5_DEF
;

2311 
nx0
 = 
ISIZ1
;

2312 
ny0
 = 
ISIZ2
;

2313 
nz0
 = 
ISIZ3
;

2320 iàĞ
nx0
 < 4 || 
ny0
 < 4 || 
nz0
 < 4 ) {

2321 
	`´štf
(" PROBLEM SIZE IS TOO SMALL - \n"

2323 
	`ex™
(1);

2326 iàĞ
nx0
 > 
ISIZ1
 || 
ny0
 > 
ISIZ2
 || 
nz0
 > 
ISIZ3
 ) {

2327 
	`´štf
(" PROBLEM SIZE IS TOO LARGE - \n"

2330 
	`ex™
(1);

2333 
	`´štf
(" Size: %3dx%3dx%3d\n", 
nx0
, 
ny0
, 
nz0
);

2334 
	`´štf
(" I‹¿tiÚs: %3d\n", 
™max
);

2335 
	}
}

2340 
	$rhs
() {

2342 #´agm¨
omp
 
·¿Î–


2352 
i
, 
j
, 
k
, 
m
;

2353 
L1
, 
L2
;

2354 
i¡1
, 
›nd1
;

2355 
j¡1
, 
j’d1
;

2356 
q
;

2357 
u21
, 
u31
, 
u41
;

2358 
tmp
;

2359 
u21i
, 
u31i
, 
u41i
, 
u51i
;

2360 
u21j
, 
u31j
, 
u41j
, 
u51j
;

2361 
u21k
, 
u31k
, 
u41k
, 
u51k
;

2362 
u21im1
, 
u31im1
, 
u41im1
, 
u51im1
;

2363 
u21jm1
, 
u31jm1
, 
u41jm1
, 
u51jm1
;

2364 
u21km1
, 
u31km1
, 
u41km1
, 
u51km1
;

2366 #´agm¨
omp
 

2367 
i
 = 0; i <ğ
nx
-1; i++) {

2368 
j
 = 0; j <ğ
ny
-1; j++) {

2369 
k
 = 0; k <ğ
nz
-1; k++) {

2370 
m
 = 0; m < 5; m++) {

2371 
rsd
[
i
][
j
][
k
][
m
] = - 
äù
[i][j][k][m];

2381 
L1
 = 0;

2382 
L2
 = 
nx
-1;

2384 #´agm¨
omp
 

2385 
i
 = 
L1
; i <ğ
L2
; i++) {

2386 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2387 
k
 = 1; k <ğ
nz
 - 2; k++) {

2388 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][1];

2389 
u21
 = 
u
[
i
][
j
][
k
][1] / u[i][j][k][0];

2391 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2392 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2393 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2394 / 
u
[
i
][
j
][
k
][0];

2396 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u21
 + 
C2
 *

2397 Ğ
u
[
i
][
j
][
k
][4] - 
q
 );

2398 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u21
;

2399 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u21
;

2400 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u21
;

2405 #´agm¨
omp
 

2406 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2407 
k
 = 1; k <ğ
nz
 - 2; k++) {

2408 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2409 
m
 = 0; m < 5; m++) {

2410 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2411 - 
tx2
 * ( 
æux
[
i
+1][
j
][
k
][
m
] - flux[i-1][j][k][m] );

2415 
L2
 = 
nx
-1;

2417 
i
 = 
i¡
; i <ğ
L2
; i++) {

2418 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2420 
u21i
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2421 
u31i
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2422 
u41i
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2423 
u51i
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2425 
tmp
 = 1.0 / 
u
[
i
-1][
j
][
k
][0];

2427 
u21im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][1];

2428 
u31im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][2];

2429 
u41im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][3];

2430 
u51im1
 = 
tmp
 * 
u
[
i
-1][
j
][
k
][4];

2432 
æux
[
i
][
j
][
k
][1] = (4.0/3.0è* 
tx3
 * (
u21i
-
u21im1
);

2433 
æux
[
i
][
j
][
k
][2] = 
tx3
 * ( 
u31i
 - 
u31im1
 );

2434 
æux
[
i
][
j
][
k
][3] = 
tx3
 * ( 
u41i
 - 
u41im1
 );

2435 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2436 * 
tx3
 * ( ( 
	`pow2
(
u21i
è+…ow2(
u31i
è+…ow2(
u41i
) )

2437 - ( 
	`pow2
(
u21im1
è+…ow2(
u31im1
è+…ow2(
u41im1
) ) )

2439 * 
tx3
 * ( 
	`pow2
(
u21i
è-…ow2(
u21im1
) )

2440 + 
C1
 * 
C5
 * 
tx3
 * ( 
u51i
 - 
u51im1
 );

2443 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2444 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2445 + 
dx1
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][0]

2446 - 2.0 * 
u
[
i
][
j
][
k
][0]

2447 + 
u
[
i
+1][
j
][
k
][0] );

2448 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2449 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][1] - flux[i][j][k][1] )

2450 + 
dx2
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][1]

2451 - 2.0 * 
u
[
i
][
j
][
k
][1]

2452 + 
u
[
i
+1][
j
][
k
][1] );

2453 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2454 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][2] - flux[i][j][k][2] )

2455 + 
dx3
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][2]

2456 - 2.0 * 
u
[
i
][
j
][
k
][2]

2457 + 
u
[
i
+1][
j
][
k
][2] );

2458 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2459 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][3] - flux[i][j][k][3] )

2460 + 
dx4
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][3]

2461 - 2.0 * 
u
[
i
][
j
][
k
][3]

2462 + 
u
[
i
+1][
j
][
k
][3] );

2463 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2464 + 
tx3
 * 
C3
 * 
C4
 * ( 
æux
[
i
+1][
j
][
k
][4] - flux[i][j][k][4] )

2465 + 
dx5
 * 
tx1
 * ( 
u
[
i
-1][
j
][
k
][4]

2466 - 2.0 * 
u
[
i
][
j
][
k
][4]

2467 + 
u
[
i
+1][
j
][
k
][4] );

2473 
m
 = 0; m < 5; m++) {

2474 
rsd
[1][
j
][
k
][
m
] =„sd[1][j][k][m]

2475 - 
ds¥
 * ( + 5.0 * 
u
[1][
j
][
k
][
m
]

2476 - 4.0 * 
u
[2][
j
][
k
][
m
]

2477 + 
u
[3][
j
][
k
][
m
] );

2478 
rsd
[2][
j
][
k
][
m
] =„sd[2][j][k][m]

2479 - 
ds¥
 * ( - 4.0 * 
u
[1][
j
][
k
][
m
]

2480 + 6.0 * 
u
[2][
j
][
k
][
m
]

2481 - 4.0 * 
u
[3][
j
][
k
][
m
]

2482 + 
u
[4][
j
][
k
][
m
] );

2485 
i¡1
 = 3;

2486 
›nd1
 = 
nx
 - 4;

2488 
i
 = 
i¡1
; i <ğ
›nd1
; i++) {

2489 
m
 = 0; m < 5; m++) {

2490 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2491 - 
ds¥
 * ( 
u
[
i
-2][
j
][
k
][
m
]

2492 - 4.0 * 
u
[
i
-1][
j
][
k
][
m
]

2493 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2494 - 4.0 * 
u
[
i
+1][
j
][
k
][
m
]

2495 + 
u
[
i
+2][
j
][
k
][
m
] );

2500 
m
 = 0; m < 5; m++) {

2501 
rsd
[
nx
-3][
j
][
k
][
m
] =„sd[nx-3][j][k][m]

2502 - 
ds¥
 * ( 
u
[
nx
-5][
j
][
k
][
m
]

2503 - 4.0 * 
u
[
nx
-4][
j
][
k
][
m
]

2504 + 6.0 * 
u
[
nx
-3][
j
][
k
][
m
]

2505 - 4.0 * 
u
[
nx
-2][
j
][
k
][
m
] );

2506 
rsd
[
nx
-2][
j
][
k
][
m
] =„sd[nx-2][j][k][m]

2507 - 
ds¥
 * ( 
u
[
nx
-4][
j
][
k
][
m
]

2508 - 4.0 * 
u
[
nx
-3][
j
][
k
][
m
]

2509 + 5.0 * 
u
[
nx
-2][
j
][
k
][
m
] );

2518 
L1
 = 0;

2519 
L2
 = 
ny
-1;

2521 #´agm¨
omp
 

2522 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2523 
j
 = 
L1
; j <ğ
L2
; j++) {

2524 
k
 = 1; k <ğ
nz
 - 2; k++) {

2525 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][2];

2526 
u31
 = 
u
[
i
][
j
][
k
][2] / u[i][j][k][0];

2528 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2529 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2530 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2531 / 
u
[
i
][
j
][
k
][0];

2533 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u31
;

2534 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u31
 + 
C2
 * (u[i][j][k][4]-
q
);

2535 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u31
;

2536 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u31
;

2541 #´agm¨
omp
 

2542 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2543 
k
 = 1; k <ğ
nz
 - 2; k++) {

2544 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2545 
m
 = 0; m < 5; m++) {

2546 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2547 - 
ty2
 * ( 
æux
[
i
][
j
+1][
k
][
m
] - flux[i][j-1][k][m] );

2551 
L2
 = 
ny
-1;

2552 
j
 = 
j¡
; j <ğ
L2
; j++) {

2553 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2555 
u21j
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2556 
u31j
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2557 
u41j
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2558 
u51j
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2560 
tmp
 = 1.0 / 
u
[
i
][
j
-1][
k
][0];

2561 
u21jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][1];

2562 
u31jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][2];

2563 
u41jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][3];

2564 
u51jm1
 = 
tmp
 * 
u
[
i
][
j
-1][
k
][4];

2566 
æux
[
i
][
j
][
k
][1] = 
ty3
 * ( 
u21j
 - 
u21jm1
 );

2567 
æux
[
i
][
j
][
k
][2] = (4.0/3.0è* 
ty3
 * (
u31j
-
u31jm1
);

2568 
æux
[
i
][
j
][
k
][3] = 
ty3
 * ( 
u41j
 - 
u41jm1
 );

2569 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2570 * 
ty3
 * ( ( 
	`pow2
(
u21j
è+…ow2(
u31j
è+…ow2(
u41j
) )

2571 - ( 
	`pow2
(
u21jm1
è+…ow2(
u31jm1
è+…ow2(
u41jm1
) ) )

2573 * 
ty3
 * ( 
	`pow2
(
u31j
è-…ow2(
u31jm1
) )

2574 + 
C1
 * 
C5
 * 
ty3
 * ( 
u51j
 - 
u51jm1
 );

2577 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2579 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2580 + 
dy1
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][0]

2581 - 2.0 * 
u
[
i
][
j
][
k
][0]

2582 + 
u
[
i
][
j
+1][
k
][0] );

2584 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2585 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][1] - flux[i][j][k][1] )

2586 + 
dy2
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][1]

2587 - 2.0 * 
u
[
i
][
j
][
k
][1]

2588 + 
u
[
i
][
j
+1][
k
][1] );

2590 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2591 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][2] - flux[i][j][k][2] )

2592 + 
dy3
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][2]

2593 - 2.0 * 
u
[
i
][
j
][
k
][2]

2594 + 
u
[
i
][
j
+1][
k
][2] );

2596 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2597 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][3] - flux[i][j][k][3] )

2598 + 
dy4
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][3]

2599 - 2.0 * 
u
[
i
][
j
][
k
][3]

2600 + 
u
[
i
][
j
+1][
k
][3] );

2602 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2603 + 
ty3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
+1][
k
][4] - flux[i][j][k][4] )

2604 + 
dy5
 * 
ty1
 * ( 
u
[
i
][
j
-1][
k
][4]

2605 - 2.0 * 
u
[
i
][
j
][
k
][4]

2606 + 
u
[
i
][
j
+1][
k
][4] );

2613 
m
 = 0; m < 5; m++) {

2614 
rsd
[
i
][1][
k
][
m
] =„sd[i][1][k][m]

2615 - 
ds¥
 * ( + 5.0 * 
u
[
i
][1][
k
][
m
]

2616 - 4.0 * 
u
[
i
][2][
k
][
m
]

2617 + 
u
[
i
][3][
k
][
m
] );

2618 
rsd
[
i
][2][
k
][
m
] =„sd[i][2][k][m]

2619 - 
ds¥
 * ( - 4.0 * 
u
[
i
][1][
k
][
m
]

2620 + 6.0 * 
u
[
i
][2][
k
][
m
]

2621 - 4.0 * 
u
[
i
][3][
k
][
m
]

2622 + 
u
[
i
][4][
k
][
m
] );

2625 
j¡1
 = 3;

2626 
j’d1
 = 
ny
 - 4;

2627 
j
 = 
j¡1
; j <ğ
j’d1
; j++) {

2628 
m
 = 0; m < 5; m++) {

2629 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2630 - 
ds¥
 * ( 
u
[
i
][
j
-2][
k
][
m
]

2631 - 4.0 * 
u
[
i
][
j
-1][
k
][
m
]

2632 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2633 - 4.0 * 
u
[
i
][
j
+1][
k
][
m
]

2634 + 
u
[
i
][
j
+2][
k
][
m
] );

2638 
m
 = 0; m < 5; m++) {

2639 
rsd
[
i
][
ny
-3][
k
][
m
] =„sd[i][ny-3][k][m]

2640 - 
ds¥
 * ( 
u
[
i
][
ny
-5][
k
][
m
]

2641 - 4.0 * 
u
[
i
][
ny
-4][
k
][
m
]

2642 + 6.0 * 
u
[
i
][
ny
-3][
k
][
m
]

2643 - 4.0 * 
u
[
i
][
ny
-2][
k
][
m
] );

2644 
rsd
[
i
][
ny
-2][
k
][
m
] =„sd[i][ny-2][k][m]

2645 - 
ds¥
 * ( 
u
[
i
][
ny
-4][
k
][
m
]

2646 - 4.0 * 
u
[
i
][
ny
-3][
k
][
m
]

2647 + 5.0 * 
u
[
i
][
ny
-2][
k
][
m
] );

2655 #´agm¨
omp
 

2656 
i
 = 
i¡
; i <ğ
›nd
; i++) {

2657 
j
 = 
j¡
; j <ğ
j’d
; j++) {

2658 
k
 = 0; k <ğ
nz
-1; k++) {

2659 
æux
[
i
][
j
][
k
][0] = 
u
[i][j][k][3];

2660 
u41
 = 
u
[
i
][
j
][
k
][3] / u[i][j][k][0];

2662 
q
 = 0.50 * ( 
u
[
i
][
j
][
k
][1] * u[i][j][k][1]

2663 + 
u
[
i
][
j
][
k
][2] * u[i][j][k][2]

2664 + 
u
[
i
][
j
][
k
][3] * u[i][j][k][3] )

2665 / 
u
[
i
][
j
][
k
][0];

2667 
æux
[
i
][
j
][
k
][1] = 
u
[i][j][k][1] * 
u41
;

2668 
æux
[
i
][
j
][
k
][2] = 
u
[i][j][k][2] * 
u41
;

2669 
æux
[
i
][
j
][
k
][3] = 
u
[i][j][k][3] * 
u41
 + 
C2
 * (u[i][j][k][4]-
q
);

2670 
æux
[
i
][
j
][
k
][4] = ( 
C1
 * 
u
[i][j][k][4] - 
C2
 * 
q
 ) * 
u41
;

2673 
k
 = 1; k <ğ
nz
 - 2; k++) {

2674 
m
 = 0; m < 5; m++) {

2675 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2676 - 
tz2
 * ( 
æux
[
i
][
j
][
k
+1][
m
] - flux[i][j][k-1][m] );

2680 
k
 = 1; k <ğ
nz
-1; k++) {

2681 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
][0];

2683 
u21k
 = 
tmp
 * 
u
[
i
][
j
][
k
][1];

2684 
u31k
 = 
tmp
 * 
u
[
i
][
j
][
k
][2];

2685 
u41k
 = 
tmp
 * 
u
[
i
][
j
][
k
][3];

2686 
u51k
 = 
tmp
 * 
u
[
i
][
j
][
k
][4];

2688 
tmp
 = 1.0 / 
u
[
i
][
j
][
k
-1][0];

2690 
u21km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][1];

2691 
u31km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][2];

2692 
u41km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][3];

2693 
u51km1
 = 
tmp
 * 
u
[
i
][
j
][
k
-1][4];

2695 
æux
[
i
][
j
][
k
][1] = 
tz3
 * ( 
u21k
 - 
u21km1
 );

2696 
æux
[
i
][
j
][
k
][2] = 
tz3
 * ( 
u31k
 - 
u31km1
 );

2697 
æux
[
i
][
j
][
k
][3] = (4.0/3.0è* 
tz3
 * (
u41k
-
u41km1
);

2698 
æux
[
i
][
j
][
k
][4] = 0.50 * ( 1.0 - 
C1
*
C5
 )

2699 * 
tz3
 * ( ( 
	`pow2
(
u21k
è+…ow2(
u31k
è+…ow2(
u41k
) )

2700 - ( 
	`pow2
(
u21km1
è+…ow2(
u31km1
è+…ow2(
u41km1
) ) )

2702 * 
tz3
 * ( 
	`pow2
(
u41k
è-…ow2(
u41km1
) )

2703 + 
C1
 * 
C5
 * 
tz3
 * ( 
u51k
 - 
u51km1
 );

2706 
k
 = 1; k <ğ
nz
 - 2; k++) {

2707 
rsd
[
i
][
j
][
k
][0] =„sd[i][j][k][0]

2708 + 
dz1
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][0]

2709 - 2.0 * 
u
[
i
][
j
][
k
][0]

2710 + 
u
[
i
][
j
][
k
+1][0] );

2711 
rsd
[
i
][
j
][
k
][1] =„sd[i][j][k][1]

2712 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][1] - flux[i][j][k][1] )

2713 + 
dz2
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][1]

2714 - 2.0 * 
u
[
i
][
j
][
k
][1]

2715 + 
u
[
i
][
j
][
k
+1][1] );

2716 
rsd
[
i
][
j
][
k
][2] =„sd[i][j][k][2]

2717 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][2] - flux[i][j][k][2] )

2718 + 
dz3
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][2]

2719 - 2.0 * 
u
[
i
][
j
][
k
][2]

2720 + 
u
[
i
][
j
][
k
+1][2] );

2721 
rsd
[
i
][
j
][
k
][3] =„sd[i][j][k][3]

2722 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][3] - flux[i][j][k][3] )

2723 + 
dz4
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][3]

2724 - 2.0 * 
u
[
i
][
j
][
k
][3]

2725 + 
u
[
i
][
j
][
k
+1][3] );

2726 
rsd
[
i
][
j
][
k
][4] =„sd[i][j][k][4]

2727 + 
tz3
 * 
C3
 * 
C4
 * ( 
æux
[
i
][
j
][
k
+1][4] - flux[i][j][k][4] )

2728 + 
dz5
 * 
tz1
 * ( 
u
[
i
][
j
][
k
-1][4]

2729 - 2.0 * 
u
[
i
][
j
][
k
][4]

2730 + 
u
[
i
][
j
][
k
+1][4] );

2736 
m
 = 0; m < 5; m++) {

2737 
rsd
[
i
][
j
][1][
m
] =„sd[i][j][1][m]

2738 - 
ds¥
 * ( + 5.0 * 
u
[
i
][
j
][1][
m
]

2739 - 4.0 * 
u
[
i
][
j
][2][
m
]

2740 + 
u
[
i
][
j
][3][
m
] );

2741 
rsd
[
i
][
j
][2][
m
] =„sd[i][j][2][m]

2742 - 
ds¥
 * ( - 4.0 * 
u
[
i
][
j
][1][
m
]

2743 + 6.0 * 
u
[
i
][
j
][2][
m
]

2744 - 4.0 * 
u
[
i
][
j
][3][
m
]

2745 + 
u
[
i
][
j
][4][
m
] );

2748 
k
 = 3; k <ğ
nz
 - 4; k++) {

2749 
m
 = 0; m < 5; m++) {

2750 
rsd
[
i
][
j
][
k
][
m
] =„sd[i][j][k][m]

2751 - 
ds¥
 * ( 
u
[
i
][
j
][
k
-2][
m
]

2752 - 4.0 * 
u
[
i
][
j
][
k
-1][
m
]

2753 + 6.0 * 
u
[
i
][
j
][
k
][
m
]

2754 - 4.0 * 
u
[
i
][
j
][
k
+1][
m
]

2755 + 
u
[
i
][
j
][
k
+2][
m
] );

2759 
m
 = 0; m < 5; m++) {

2760 
rsd
[
i
][
j
][
nz
-3][
m
] =„sd[i][j][nz-3][m]

2761 - 
ds¥
 * ( 
u
[
i
][
j
][
nz
-5][
m
]

2762 - 4.0 * 
u
[
i
][
j
][
nz
-4][
m
]

2763 + 6.0 * 
u
[
i
][
j
][
nz
-3][
m
]

2764 - 4.0 * 
u
[
i
][
j
][
nz
-2][
m
] );

2765 
rsd
[
i
][
j
][
nz
-2][
m
] =„sd[i][j][nz-2][m]

2766 - 
ds¥
 * ( 
u
[
i
][
j
][
nz
-4][
m
]

2767 - 4.0 * 
u
[
i
][
j
][
nz
-3][
m
]

2768 + 5.0 * 
u
[
i
][
j
][
nz
-2][
m
] );

2774 
	}
}

2779 
	$£tbv
() {

2781 #´agm¨
omp
 
·¿Î–


2791 
i
, 
j
, 
k
;

2792 
iglob
, 
jglob
;

2797 #´agm¨
omp
 

2798 
i
 = 0; i < 
nx
; i++) {

2799 
iglob
 = 
i
;

2800 
j
 = 0; j < 
ny
; j++) {

2801 
jglob
 = 
j
;

2802 
	`exaù
Ğ
iglob
, 
jglob
, 0, &
u
[
i
][
j
][0][0] );

2803 
	`exaù
Ğ
iglob
, 
jglob
, 
nz
-1, &
u
[
i
][
j
][nz-1][0] );

2810 #´agm¨
omp
 

2811 
i
 = 0; i < 
nx
; i++) {

2812 
iglob
 = 
i
;

2813 
k
 = 0; k < 
nz
; k++) {

2814 
	`exaù
Ğ
iglob
, 0, 
k
, &
u
[
i
][0][k][0] );

2818 #´agm¨
omp
 

2819 
i
 = 0; i < 
nx
; i++) {

2820 
iglob
 = 
i
;

2821 
k
 = 0; k < 
nz
; k++) {

2822 
	`exaù
Ğ
iglob
, 
ny0
-1, 
k
, &
u
[
i
][
ny
-1][k][0] );

2829 #´agm¨
omp
 

2830 
j
 = 0; j < 
ny
; j++) {

2831 
jglob
 = 
j
;

2832 
k
 = 0; k < 
nz
; k++) {

2833 
	`exaù
Ğ0, 
jglob
, 
k
, &
u
[0][
j
][k][0] );

2837 #´agm¨
omp
 

2838 
j
 = 0; j < 
ny
; j++) {

2839 
jglob
 = 
j
;

2840 
k
 = 0; k < 
nz
; k++) {

2841 
	`exaù
Ğ
nx0
-1, 
jglob
, 
k
, &
u
[
nx
-1][
j
][k][0] );

2846 
	}
}

2851 
	$£tcÛff
() {

2856 
dxi
 = 1.0 / ( 
nx0
 - 1 );

2857 
d‘a
 = 1.0 / ( 
ny0
 - 1 );

2858 
dz‘a
 = 1.0 / ( 
nz0
 - 1 );

2860 
tx1
 = 1.0 / ( 
dxi
 * dxi );

2861 
tx2
 = 1.0 / ( 2.0 * 
dxi
 );

2862 
tx3
 = 1.0 / 
dxi
;

2864 
ty1
 = 1.0 / ( 
d‘a
 * deta );

2865 
ty2
 = 1.0 / ( 2.0 * 
d‘a
 );

2866 
ty3
 = 1.0 / 
d‘a
;

2868 
tz1
 = 1.0 / ( 
dz‘a
 * dzeta );

2869 
tz2
 = 1.0 / ( 2.0 * 
dz‘a
 );

2870 
tz3
 = 1.0 / 
dz‘a
;

2872 
ii1
 = 1;

2873 
ii2
 = 
nx0
 - 2;

2874 
ji1
 = 1;

2875 
ji2
 = 
ny0
 - 3;

2876 
ki1
 = 2;

2877 
ki2
 = 
nz0
 - 2;

2882 
dx1
 = 0.75;

2883 
dx2
 = 
dx1
;

2884 
dx3
 = 
dx1
;

2885 
dx4
 = 
dx1
;

2886 
dx5
 = 
dx1
;

2888 
dy1
 = 0.75;

2889 
dy2
 = 
dy1
;

2890 
dy3
 = 
dy1
;

2891 
dy4
 = 
dy1
;

2892 
dy5
 = 
dy1
;

2894 
dz1
 = 1.00;

2895 
dz2
 = 
dz1
;

2896 
dz3
 = 
dz1
;

2897 
dz4
 = 
dz1
;

2898 
dz5
 = 
dz1
;

2903 
ds¥
 = ( 
	`max
 (
dx1
, max(
dy1
, 
dz1
) ) ) / 4.0;

2908 
û
[0][0] = 2.0;

2909 
û
[0][1] = 0.0;

2910 
û
[0][2] = 0.0;

2911 
û
[0][3] = 4.0;

2912 
û
[0][4] = 5.0;

2913 
û
[0][5] = 3.0;

2914 
û
[0][6] = 5.0e-01;

2915 
û
[0][7] = 2.0e-02;

2916 
û
[0][8] = 1.0e-02;

2917 
û
[0][9] = 3.0e-02;

2918 
û
[0][10] = 5.0e-01;

2919 
û
[0][11] = 4.0e-01;

2920 
û
[0][12] = 3.0e-01;

2925 
û
[1][0] = 1.0;

2926 
û
[1][1] = 0.0;

2927 
û
[1][2] = 0.0;

2928 
û
[1][3] = 0.0;

2929 
û
[1][4] = 1.0;

2930 
û
[1][5] = 2.0;

2931 
û
[1][6] = 3.0;

2932 
û
[1][7] = 1.0e-02;

2933 
û
[1][8] = 3.0e-02;

2934 
û
[1][9] = 2.0e-02;

2935 
û
[1][10] = 4.0e-01;

2936 
û
[1][11] = 3.0e-01;

2937 
û
[1][12] = 5.0e-01;

2942 
û
[2][0] = 2.0;

2943 
û
[2][1] = 2.0;

2944 
û
[2][2] = 0.0;

2945 
û
[2][3] = 0.0;

2946 
û
[2][4] = 0.0;

2947 
û
[2][5] = 2.0;

2948 
û
[2][6] = 3.0;

2949 
û
[2][7] = 4.0e-02;

2950 
û
[2][8] = 3.0e-02;

2951 
û
[2][9] = 5.0e-02;

2952 
û
[2][10] = 3.0e-01;

2953 
û
[2][11] = 5.0e-01;

2954 
û
[2][12] = 4.0e-01;

2959 
û
[3][0] = 2.0;

2960 
û
[3][1] = 2.0;

2961 
û
[3][2] = 0.0;

2962 
û
[3][3] = 0.0;

2963 
û
[3][4] = 0.0;

2964 
û
[3][5] = 2.0;

2965 
û
[3][6] = 3.0;

2966 
û
[3][7] = 3.0e-02;

2967 
û
[3][8] = 5.0e-02;

2968 
û
[3][9] = 4.0e-02;

2969 
û
[3][10] = 2.0e-01;

2970 
û
[3][11] = 1.0e-01;

2971 
û
[3][12] = 3.0e-01;

2976 
û
[4][0] = 5.0;

2977 
û
[4][1] = 4.0;

2978 
û
[4][2] = 3.0;

2979 
û
[4][3] = 2.0;

2980 
û
[4][4] = 1.0e-01;

2981 
û
[4][5] = 4.0e-01;

2982 
û
[4][6] = 3.0e-01;

2983 
û
[4][7] = 5.0e-02;

2984 
û
[4][8] = 4.0e-02;

2985 
û
[4][9] = 3.0e-02;

2986 
û
[4][10] = 1.0e-01;

2987 
û
[4][11] = 3.0e-01;

2988 
û
[4][12] = 2.0e-01;

2989 
	}
}

2995 
	$£tiv
() {

2997 #´agm¨
omp
 
·¿Î–


3009 
i
, 
j
, 
k
, 
m
;

3010 
iglob
, 
jglob
;

3011 
xi
, 
‘a
, 
z‘a
;

3012 
pxi
, 
³
, 
pz‘a
;

3013 
ue_1jk
[5],
ue_nx0jk
[5],
ue_i1k
[5],

3014 
ue_šy0k
[5],
ue_ij1
[5],
ue_ijnz
[5];

3016 #´agm¨
omp
 

3017 
j
 = 0; j < 
ny
; j++) {

3018 
jglob
 = 
j
;

3019 
k
 = 1; k < 
nz
 - 1; k++) {

3020 
z‘a
 = (()
k
è/ (
nz
-1);

3021 ià(
jglob
 !ğ0 && jglob !ğ
ny0
-1) {

3022 
‘a
 = ( (è(
jglob
èè/ (
ny0
-1);

3023 
i
 = 0; i < 
nx
; i++) {

3024 
iglob
 = 
i
;

3025 if(
iglob
 !ğ0 && iglob !ğ
nx0
-1) {

3026 
xi
 = ( (è(
iglob
èè/ (
nx0
-1);

3027 
	`exaù
 (0,
jglob
,
k
,
ue_1jk
);

3028 
	`exaù
 (
nx0
-1,
jglob
,
k
,
ue_nx0jk
);

3029 
	`exaù
 (
iglob
,0,
k
,
ue_i1k
);

3030 
	`exaù
 (
iglob
,
ny0
-1,
k
,
ue_šy0k
);

3031 
	`exaù
 (
iglob
,
jglob
,0,
ue_ij1
);

3032 
	`exaù
 (
iglob
,
jglob
,
nz
-1,
ue_ijnz
);

3033 
m
 = 0; m < 5; m++) {

3034 
pxi
 = ( 1.0 - 
xi
 ) * 
ue_1jk
[
m
]

3035 + 
xi
 * 
ue_nx0jk
[
m
];

3036 
³
 = ( 1.0 - 
‘a
 ) * 
ue_i1k
[
m
]

3037 + 
‘a
 * 
ue_šy0k
[
m
];

3038 
pz‘a
 = ( 1.0 - 
z‘a
 ) * 
ue_ij1
[
m
]

3039 + 
z‘a
 * 
ue_ijnz
[
m
];

3041 
u
[
i
][
j
][
k
][
m
] = 
pxi
 + 
³
 + 
pz‘a


3042 - 
pxi
 * 
³
 -…‘¨* 
pz‘a
 -…zeta *…xi

3043 + 
pxi
 * 
³
 * 
pz‘a
;

3051 
	}
}

3055 
	$ssÜ
() {

3065 
i
, 
j
, 
k
, 
m
;

3066 
i¡•
;

3067 
tmp
;

3068 
d–unm
[5], 
tv
[
ISIZ1
][
ISIZ2
][5];

3073 
tmp
 = 1.0 / ( 
omega
 * ( 2.0 - omega ) ) ;

3079 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i
,
j
,
k
,
m
)

3081 #´agm¨
omp
 

3082 
i
 = 0; i < 
ISIZ1
; i++) {

3083 
j
 = 0; j < 
ISIZ2
; j++) {

3084 
k
 = 0; k < 5; k++) {

3085 
m
 = 0; m < 5; m++) {

3086 
a
[
i
][
j
][
k
][
m
] = 0.0;

3087 
b
[
i
][
j
][
k
][
m
] = 0.0;

3088 
c
[
i
][
j
][
k
][
m
] = 0.0;

3089 
d
[
i
][
j
][
k
][
m
] = 0.0;

3098 
	`rhs
();

3103 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3104 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3105 
rsd
, 
rsdnm
 );

3108 
	`tim”_ş—r
(1);

3109 
	`tim”_¡¬t
(1);

3116 
i¡•
 = 1; i¡• <ğ
™max
; istep++) {

3118 ià(
i¡•
%20 =ğ0 || i¡• =ğ
™max
 || istep == 1) {

3119 #´agm¨
omp
 
ma¡”


3120 
	`´štf
(" Tim¡• %4d\n", 
i¡•
);

3123 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i¡•
,
i
,
j
,
k
,
m
)

3129 #´agm¨
omp
 

3130 
i
 = 
i¡
; i <ğ
›nd
; i++) {

3131 
j
 = 
j¡
; j <ğ
j’d
; j++) {

3132 
k
 = 1; k <ğ
nz
 - 2; k++) {

3133 
m
 = 0; m < 5; m++) {

3134 
rsd
[
i
][
j
][
k
][
m
] = 
dt
 *„sd[i][j][k][m];

3140 
k
 = 1; k <ğ
nz
 - 2; k++) {

3144 
	`jaşd
(
k
);

3149 
	`bÉs
(
nx
, 
ny
, 
nz
, 
k
,

3150 
omega
,

3151 
rsd
,

3152 
a
, 
b
, 
c
, 
d
,

3153 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3154 
nx0
, 
ny0
 );

3157 #´agm¨
omp
 
b¬r›r


3159 
k
 = 
nz
 - 2; k >= 1; k--) {

3163 
	`jacu
(
k
);

3168 
	`buts
(
nx
, 
ny
, 
nz
, 
k
,

3169 
omega
,

3170 
rsd
, 
tv
,

3171 
d
, 
a
, 
b
, 
c
,

3172 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3173 
nx0
, 
ny0
 );

3175 #´agm¨
omp
 
b¬r›r


3181 #´agm¨
omp
 

3182 
i
 = 
i¡
; i <ğ
›nd
; i++) {

3183 
j
 = 
j¡
; j <ğ
j’d
; j++) {

3184 
k
 = 1; k <ğ
nz
-2; k++) {

3185 
m
 = 0; m < 5; m++) {

3186 
u
[
i
][
j
][
k
][
m
] = u[i][j][k][m]

3187 + 
tmp
 * 
rsd
[
i
][
j
][
k
][
m
];

3196 iàĞ
i¡•
 % 
šÜm
 == 0 ) {

3197 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3198 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3199 
rsd
, 
d–unm
 );

3205 
	`rhs
();

3210 iàĞĞ
i¡•
 % 
šÜm
 == 0 ) ||

3211 Ğ
i¡•
 =ğ
™max
 ) ) {

3212 
	`l2nÜm
Ğ
nx0
, 
ny0
, 
nz0
,

3213 
i¡
, 
›nd
, 
j¡
, 
j’d
,

3214 
rsd
, 
rsdnm
 );

3220 iàĞĞ
rsdnm
[0] < 
tŞrsd
[0] ) &&

3221 Ğ
rsdnm
[1] < 
tŞrsd
[1] ) &&

3222 Ğ
rsdnm
[2] < 
tŞrsd
[2] ) &&

3223 Ğ
rsdnm
[3] < 
tŞrsd
[3] ) &&

3224 Ğ
rsdnm
[4] < 
tŞrsd
[4] ) ) {

3225 
	`ex™
(1);

3230 
	`tim”_¡İ
(1);

3231 
maxtime
ğ
	`tim”_»ad
(1);

3233 
	}
}

3238 
	$v”ify
(
xü
[5], 
xû
[5], 
xci
,

3239 *
şass
, 
boŞ—n
 *
v”if›d
) {

3245 
xü»f
[5],
xû»f
[5],
xcœef
,

3246 
xüdif
[5],
xûdif
[5],
xcidif
,

3247 
•sÚ
, 
dŒef
;

3248 
m
;

3253 
•sÚ
 = 1.0e-08;

3255 *
şass
 = 'U';

3256 *
v”if›d
 = 
TRUE
;

3258 
m
 = 0; m < 5; m++) {

3259 
xü»f
[
m
] = 1.0;

3260 
xû»f
[
m
] = 1.0;

3262 
xcœef
 = 1.0;

3264 iàĞ
nx0
 =ğ12 && 
ny0
 =ğ12 && 
nz0
 =ğ12 && 
™max
 == 50) {

3265 *
şass
 = 'S';

3266 
dŒef
 = 5.0e-1;

3272 
xü»f
[0] = 1.6196343210976702e-02;

3273 
xü»f
[1] = 2.1976745164821318e-03;

3274 
xü»f
[2] = 1.5179927653399185e-03;

3275 
xü»f
[3] = 1.5029584435994323e-03;

3276 
xü»f
[4] = 3.4264073155896461e-02;

3282 
xû»f
[0] = 6.4223319957960924e-04;

3283 
xû»f
[1] = 8.4144342047347926e-05;

3284 
xû»f
[2] = 5.8588269616485186e-05;

3285 
xû»f
[3] = 5.8474222595157350e-05;

3286 
xû»f
[4] = 1.3103347914111294e-03;

3292 
xcœef
 = 7.8418928865937083;

3294 } iàĞ
nx0
 =ğ33 && 
ny0
 =ğ33 && 
nz0
 =ğ33 && 
™max
 == 300) {

3296 *
şass
 = 'W';

3297 
dŒef
 = 1.5e-3;

3302 
xü»f
[0] = 0.1236511638192e+02;

3303 
xü»f
[1] = 0.1317228477799e+01;

3304 
xü»f
[2] = 0.2550120713095e+01;

3305 
xü»f
[3] = 0.2326187750252e+01;

3306 
xü»f
[4] = 0.2826799444189e+02;

3311 
xû»f
[0] = 0.4867877144216;

3312 
xû»f
[1] = 0.5064652880982e-01;

3313 
xû»f
[2] = 0.9281818101960e-01;

3314 
xû»f
[3] = 0.8570126542733e-01;

3315 
xû»f
[4] = 0.1084277417792e+01;

3321 
xcœef
 = 0.1161399311023e+02;

3323 } iàĞ
nx0
 =ğ64 && 
ny0
 =ğ64 && 
nz0
 =ğ64 && 
™max
 == 250) {

3325 *
şass
 = 'A';

3326 
dŒef
 = 2.0e+0;

3331 
xü»f
[0] = 7.7902107606689367e+02;

3332 
xü»f
[1] = 6.3402765259692870e+01;

3333 
xü»f
[2] = 1.9499249727292479e+02;

3334 
xü»f
[3] = 1.7845301160418537e+02;

3335 
xü»f
[4] = 1.8384760349464247e+03;

3341 
xû»f
[0] = 2.9964085685471943e+01;

3342 
xû»f
[1] = 2.8194576365003349;

3343 
xû»f
[2] = 7.3473412698774742;

3344 
xû»f
[3] = 6.7139225687777051;

3345 
xû»f
[4] = 7.0715315688392578e+01;

3351 
xcœef
 = 2.6030925604886277e+01;

3353 } iàĞ
nx0
 =ğ102 && 
ny0
 =ğ102 && 
nz0
 =ğ102 && 
™max
 == 250) {

3355 *
şass
 = 'B';

3356 
dŒef
 = 2.0e+0;

3362 
xü»f
[0] = 3.5532672969982736e+03;

3363 
xü»f
[1] = 2.6214750795310692e+02;

3364 
xü»f
[2] = 8.8333721850952190e+02;

3365 
xü»f
[3] = 7.7812774739425265e+02;

3366 
xü»f
[4] = 7.3087969592545314e+03;

3372 
xû»f
[0] = 1.1401176380212709e+02;

3373 
xû»f
[1] = 8.1098963655421574;

3374 
xû»f
[2] = 2.8480597317698308e+01;

3375 
xû»f
[3] = 2.5905394567832939e+01;

3376 
xû»f
[4] = 2.6054907504857413e+02;

3382 
xcœef
 = 4.7887162703308227e+01;

3384 } iàĞ
nx0
 =ğ162 && 
ny0
 =ğ162 && 
nz0
 =ğ162 && 
™max
 == 250) {

3386 *
şass
 = 'C';

3387 
dŒef
 = 2.0e+0;

3393 
xü»f
[0] = 1.03766980323537846e+04;

3394 
xü»f
[1] = 8.92212458801008552e+02;

3395 
xü»f
[2] = 2.56238814582660871e+03;

3396 
xü»f
[3] = 2.19194343857831427e+03;

3397 
xü»f
[4] = 1.78078057261061185e+04;

3403 
xû»f
[0] = 2.15986399716949279e+02;

3404 
xû»f
[1] = 1.55789559239863600e+01;

3405 
xû»f
[2] = 5.41318863077207766e+01;

3406 
xû»f
[3] = 4.82262643154045421e+01;

3407 
xû»f
[4] = 4.55902910043250358e+02;

3413 
xcœef
 = 6.66404553572181300e+01;

3415 *
v”if›d
 = 
FALSE
;

3426 
m
 = 0; m < 5; m++) {

3428 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]);

3429 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

3432 
xcidif
 = 
	`çbs
((
xci
 - 
xcœef
)/xciref);

3438 ià(*
şass
 != 'U') {

3439 
	`´štf
("\ÀV”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

3440 
	`´štf
(" Accu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

3441 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

3442 *
v”if›d
 = 
FALSE
;

3443 *
şass
 = 'U';

3444 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

3447 
	`´štf
(" Unknown class\n");

3450 ià(*
şass
 != 'U') {

3451 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

3453 
	`´štf
(" RMS-norms of„esidual\n");

3456 
m
 = 0; m < 5; m++) {

3457 ià(*
şass
 == 'U') {

3458 
	`´štf
(" %2d %20.13e\n", 
m
, 
xü
[m]);

3459 } ià(
xüdif
[
m
] > 
•sÚ
) {

3460 *
v”if›d
 = 
FALSE
;

3461 
	`´štf
(" FAILURE: %2d %20.13e%20.13e%20.13e\n",

3462 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

3464 
	`´štf
(" %2d %20.13e%20.13e%20.13e\n",

3465 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

3469 ià(*
şass
 != 'U') {

3470 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

3472 
	`´štf
(" RMS-norms of solutionƒrror\n");

3475 
m
 = 0; m < 5; m++) {

3476 ià(*
şass
 == 'U') {

3477 
	`´štf
(" %2d %20.13e\n", 
m
, 
xû
[m]);

3478 } ià(
xûdif
[
m
] > 
•sÚ
) {

3479 *
v”if›d
 = 
FALSE
;

3480 
	`´štf
(" FAILURE: %2d %20.13e%20.13e%20.13e\n",

3481 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

3483 
	`´štf
(" %2d %20.13e%20.13e%20.13e\n",

3484 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

3488 ià(*
şass
 != 'U') {

3489 
	`´štf
(" Comparison of surface integral\n");

3491 
	`´štf
(" Surface integral\n");

3494 ià(*
şass
 == 'U') {

3495 
	`´štf
(" %20.13e\n", 
xci
);

3496 } ià(
xcidif
 > 
•sÚ
) {

3497 *
v”if›d
 = 
FALSE
;

3498 
	`´štf
(" FAILURE: %20.13e%20.13e%20.13e\n",

3499 
xci
, 
xcœef
, 
xcidif
);

3501 
	`´štf
(" %20.13e%20.13e%20.13e\n",

3502 
xci
, 
xcœef
, 
xcidif
);

3505 ià(*
şass
 == 'U') {

3506 
	`´štf
(" No„eference values…rovided\n");

3507 
	`´štf
(" No verification…erformed\n");

3508 } ià(*
v”if›d
) {

3509 
	`´štf
(" Verification Successful\n");

3511 
	`´štf
(" Verification failed\n");

3513 
	}
}

	@LU/npbparams.h

9 
	#ISIZ1
 12

	)

10 
	#ISIZ2
 12

	)

11 
	#ISIZ3
 12

	)

13 
	#ITMAX_DEFAULT
 50

	)

14 
	#INORM_DEFAULT
 50

	)

15 
	#DT_DEFAULT
 0.5

	)

16 
	#CONVERTDOUBLE
 
FALSE


	)

17 
	#COMPILETIME
 "25 S• 2020"

	)

18 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

19 
	#CS1
 "şªg-10"

	)

20 
	#CS2
 "şªg-10"

	)

21 
	#CS3
 "-lm"

	)

22 
	#CS4
 "-I../commÚ "

	)

23 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

24 
	#CS6
 "-lomp"

	)

25 
	#CS7
 "¿nddp"

	)

	@MG/globals.h

11 
	~"Åb·¿ms.h
"

15 
	#NM
 (2+(2<<(
LM
-1)))

	)

17 
	#NV
 (2+(2<<(
NDIM1
-1))*(2+(2<<(
NDIM2
-1)))*(2+(2<<(
NDIM3
-1))))

	)

19 
	#NR
 ((8*(
NV
+(
NM
*NM)+5*NM+7*
LM
))/7)

	)

21 
	#NM2
 (2*
NM
*NM)

	)

23 
	#MAXLEVEL
 11

	)

27 
	gnx
[
MAXLEVEL
+1], 
	gny
[MAXLEVEL+1], 
	gnz
[MAXLEVEL+1];

29 
	gCÏss
;

31 
	gdebug_vec
[8];

34 
	gm1
[
MAXLEVEL
+1], 
	gm2
[MAXLEVEL+1], 
	gm3
[MAXLEVEL+1];

35 
	gÉ
, 
	glb
;

40 
	#M
 1037

	)

	@MG/mg.c

36 
	~"../commÚ/Åb-C.h
"

37 
	~"glob®s.h
"

38 
	~"../m©h/Çs_m©h.h
"

40 
	~<Çutus/Çutus.h
>

41 
	~<Çutus/sh–l.h
>

43 
	#T_BENCH
 1

	)

44 
	#T_INIT
 2

	)

48 
	gis1
, 
	gis2
, 
	gis3
, 
	g›1
, 
	g›2
, 
	g›3
;

51 
£tup
(*
n1
, *
n2
, *
n3
, 
É
);

52 
mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

53 
c
[4], 
n1
, 
n2
, 
n3
, 
k
);

54 
psšv
Ğ***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

55 
c
[4], 
k
);

56 
»sid
Ğ***
u
, ***
v
, ***
r
,

57 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 );

58 
½rj3
Ğ***
r
, 
m1k
, 
m2k
, 
m3k
,

59 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 );

60 
š‹½
Ğ***
z
, 
mm1
, 
mm2
, 
mm3
,

61 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 );

62 
nÜm2u3
(***
r
, 
n1
, 
n2
, 
n3
,

63 *
ºm2
, *
ºmu
, 
nx
, 
ny
, 
nz
);

64 
»p_Äm
(***
u
, 
n1
, 
n2
, 
n3
,

65 *
t™Ë
, 
kk
);

66 
comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
);

67 
z¿n3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
);

68 
show®l
(***
z
, 
n1
, 
n2
, 
n3
);

69 
pow”
Ğ
a
, 
n
 );

70 
bubbË
Ğ
‹n
[
M
][2], 
j1
[M][2], 
j2
[M][2],

71 
j3
[
M
][2], 
m
, 
šd
 );

72 
z”o3
(***
z
, 
n1
, 
n2
, 
n3
);

73 
nÚz”o
(***
z
, 
n1
, 
n2
, 
n3
);

78 
´og¿m_MG
(*
_buf
, * 
_´iv
);

80 
sh–l_cmd_im¶
 
	gÇs_mg_im¶
 = {

81 .
cmd
 = "nas-mg",

82 .
	gh–p_¡r
 = "NAS…arallel benchmark MG",

83 .
	ghªdËr
 = 
´og¿m_MG
,

85 
nk_»gi¡”_sh–l_cmd
(
Çs_mg_im¶
);

87 
	$´og¿m_MG
(* 
_buf
, *
_´iv
) {

94 
k
, 
™
;

95 
t
, 
tš™
, 
mæİs
;

96 
Áh»ads
 = 1;

104 ****
u
, ***
v
, ****
r
;

105 
a
[4], 
c
[4];

107 
ºm2
, 
ºmu
;

108 
•sÚ
 = 1.0e-8;

109 
n1
, 
n2
, 
n3
, 
n™
;

110 
v”ify_v®ue
;

111 
boŞ—n
 
v”if›d
;

113 
i
, 
j
, 
l
;

116 
	`tim”_ş—r
(
T_BENCH
);

117 
	`tim”_ş—r
(
T_INIT
);

119 
	`tim”_¡¬t
(
T_INIT
);

125 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

144 
É
 = 
LT_DEFAULT
;

145 
n™
 = 
NIT_DEFAULT
;

146 
nx
[
É
] = 
NX_DEFAULT
;

147 
ny
[
É
] = 
NY_DEFAULT
;

148 
nz
[
É
] = 
NZ_DEFAULT
;

150 
i
 = 0; i <= 7; i++) {

151 
debug_vec
[
i
] = 
DEBUG_DEFAULT
;

155 iàĞ(
nx
[
É
] !ğ
ny
[É]è|| (nx[É] !ğ
nz
[lt]) ) {

156 
CÏss
 = 'U';

157 } ifĞ
nx
[
É
] =ğ32 && 
n™
 == 4 ) {

158 
CÏss
 = 'S';

159 } ifĞ
nx
[
É
] =ğ64 && 
n™
 == 40 ) {

160 
CÏss
 = 'W';

161 } ifĞ
nx
[
É
] =ğ256 && 
n™
 == 20 ) {

162 
CÏss
 = 'B';

163 } ifĞ
nx
[
É
] =ğ512 && 
n™
 == 20 ) {

164 
CÏss
 = 'C';

165 } ifĞ
nx
[
É
] =ğ256 && 
n™
 == 4 ) {

166 
CÏss
 = 'A';

168 
CÏss
 = 'U';

185 
a
[0] = -8.0/3.0;

186 
a
[1] = 0.0;

187 
a
[2] = 1.0/6.0;

188 
a
[3] = 1.0/12.0;

190 ià(
CÏss
 == 'A' || Class == 'S' || Class =='W') {

194 
c
[0] = -3.0/8.0;

195 
c
[1] = 1.0/32.0;

196 
c
[2] = -1.0/64.0;

197 
c
[3] = 0.0;

202 
c
[0] = -3.0/17.0;

203 
c
[1] = 1.0/33.0;

204 
c
[2] = -1.0/61.0;

205 
c
[3] = 0.0;

208 
lb
 = 1;

210 
	`£tup
(&
n1
,&
n2
,&
n3
,
É
);

212 
u
 = (****)
	`m®loc
((
É
+1)*(***));

213 
l
 = 
É
;† >=1;†--) {

214 
u
[
l
] = (***)
	`m®loc
(
m3
[l]*(**));

215 
k
 = 0; k < 
m3
[
l
]; k++) {

216 
u
[
l
][
k
] = (**)
	`m®loc
(
m2
[l]*(*));

217 
j
 = 0; j < 
m2
[
l
]; j++) {

218 
u
[
l
][
k
][
j
] = (*)
	`m®loc
(
m1
[l]*());

222 
v
 = (***)
	`m®loc
(
m3
[
É
]*(**));

223 
k
 = 0; k < 
m3
[
É
]; k++) {

224 
v
[
k
] = (**)
	`m®loc
(
m2
[
É
]*(*));

225 
j
 = 0; j < 
m2
[
É
]; j++) {

226 
v
[
k
][
j
] = (*)
	`m®loc
(
m1
[
É
]*());

229 
r
 = (****)
	`m®loc
((
É
+1)*(***));

230 
l
 = 
É
;† >=1;†--) {

231 
r
[
l
] = (***)
	`m®loc
(
m3
[l]*(**));

232 
k
 = 0; k < 
m3
[
l
]; k++) {

233 
r
[
l
][
k
] = (**)
	`m®loc
(
m2
[l]*(*));

234 
j
 = 0; j < 
m2
[
l
]; j++) {

235 
r
[
l
][
k
][
j
] = (*)
	`m®loc
(
m1
[l]*());

240 
	`z”o3
(
u
[
É
],
n1
,
n2
,
n3
);

241 
	`z¿n3
(
v
,
n1
,
n2
,
n3
,
nx
[
É
],
ny
[lt],lt);

243 
	`nÜm2u3
(
v
,
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[
É
],
ny
[É],
nz
[lt]);

249 
	`´štf
(" Size: %3dx%3dx%3d (class %1c)\n",

250 
nx
[
É
], 
ny
[É], 
nz
[É], 
CÏss
);

251 
	`´štf
(" I‹¿tiÚs: %3d\n", 
n™
);

253 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

254 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

259 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
É
);

260 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

262 
	`£tup
(&
n1
,&
n2
,&
n3
,
É
);

264 
	`z”o3
(
u
[
É
],
n1
,
n2
,
n3
);

266 
	`z¿n3
(
v
,
n1
,
n2
,
n3
,
nx
[
É
],
ny
[lt],lt);

269 
	`tim”_¡İ
(
T_INIT
);

270 
	`tim”_¡¬t
(
T_BENCH
);

272 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

273 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

275  
™
 = 1; iˆ<ğ
n™
; it++) {

276 
	`mg3P
(
u
,
v
,
r
,
a
,
c
,
n1
,
n2
,
n3
,
É
);

277 
	`»sid
(
u
[
É
],
v
,
r
[É],
n1
,
n2
,
n3
,
a
,lt);

279 
	`nÜm2u3
(
r
[
É
],
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[É],
ny
[É],
nz
[lt]);

281 #´agm¨
omp
 
·¿Î–


283 #ià
	`defšed
(
_OPENMP
)

284 #´agm¨
omp
 
ma¡”


285 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

289 
	`tim”_¡İ
(
T_BENCH
);

290 
t
 = 
	`tim”_»ad
(
T_BENCH
);

291 
tš™
 = 
	`tim”_»ad
(
T_INIT
);

293 
v”if›d
 = 
FALSE
;

294 
v”ify_v®ue
 = 0.0;

296 
	`´štf
(" In™Ÿliz©iÚime: %15.3à£cÚds\n", 
tš™
);

297 
	`´štf
(" Benchmark completed\n");

299 ià(
CÏss
 != 'U') {

300 ià(
CÏss
 == 'S') {

301 
v”ify_v®ue
 = 0.530770700573e-04;

302 } ià(
CÏss
 == 'W') {

303 
v”ify_v®ue
 = 0.250391406439e-17;

305 } ià(
CÏss
 == 'A') {

306 
v”ify_v®ue
 = 0.2433365309e-5;

307 } ià(
CÏss
 == 'B') {

308 
v”ify_v®ue
 = 0.180056440132e-5;

309 } ià(
CÏss
 == 'C') {

310 
v”ify_v®ue
 = 0.570674826298e-06;

313 iàĞ
	`çbs
Ğ
ºm2
 - 
v”ify_v®ue
 ) <ğ
•sÚ
 ) {

314 
v”if›d
 = 
TRUE
;

315 
	`´štf
(" VERIFICATION SUCCESSFUL\n");

316 
	`´štf
(" L2 NÜm i %20.12e\n", 
ºm2
);

317 
	`´štf
(" E¼Ü i  %20.12e\n", 
ºm2
 - 
v”ify_v®ue
);

319 
v”if›d
 = 
FALSE
;

320 
	`´štf
(" VERIFICATION FAILED\n");

321 
	`´štf
(" L2 NÜm i  %20.12e\n", 
ºm2
);

322 
	`´štf
(" ThcÜ»ù L2 NÜm i %20.12e\n", 
v”ify_v®ue
);

325 
v”if›d
 = 
FALSE
;

326 
	`´štf
(" Problem size unknown\n");

327 
	`´štf
(" NO VERIFICATION PERFORMED\n");

330 iàĞ
t
 != 0.0 ) {

331 
Â
 = 
nx
[
É
]*
ny
[É]*
nz
[lt];

332 
mæİs
 = 58.*
n™
*
Â
*1.0e-6 / 
t
;

334 
mæİs
 = 0.0;

337 
	`c_´št_»suÉs
("MG", 
CÏss
, 
nx
[
É
], 
ny
[É], 
nz
[lt],

338 
n™
, 
Áh»ads
, 
t
, 
mæİs
, " floating…oint",

339 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

340 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

341 
	}
}

346 
	$£tup
(*
n1
, *
n2
, *
n3
, 
É
) {

351 
k
;

353  
k
 = 
É
-1; k >= 1; k--) {

354 
nx
[
k
] =‚x[k+1]/2;

355 
ny
[
k
] =‚y[k+1]/2;

356 
nz
[
k
] =‚z[k+1]/2;

359 
k
 = 1; k <ğ
É
; k++) {

360 
m1
[
k
] = 
nx
[k]+2;

361 
m2
[
k
] = 
nz
[k]+2;

362 
m3
[
k
] = 
ny
[k]+2;

365 
is1
 = 1;

366 
›1
 = 
nx
[
É
];

367 *
n1
 = 
nx
[
É
]+2;

368 
is2
 = 1;

369 
›2
 = 
ny
[
É
];

370 *
n2
 = 
ny
[
É
]+2;

371 
is3
 = 1;

372 
›3
 = 
nz
[
É
];

373 *
n3
 = 
nz
[
É
]+2;

375 ià(
debug_vec
[1] >= 1 ) {

376 
	`´štf
(" in setup, \n");

377 
	`´štf
("†t‚x‚y‚z‚1‚2‚3 is1 is2 is3 ie1 ie2 ie3\n");

378 
	`´štf
("%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d%4d\n",

379 
É
,
nx
[É],
ny
[É],
nz
[É],*
n1
,*
n2
,*
n3
,
is1
,
is2
,
is3
,
›1
,
›2
,
›3
);

381 
	}
}

386 
	$mg3P
(****
u
, ***
v
, ****
r
, 
a
[4],

387 
c
[4], 
n1
, 
n2
, 
n3
, 
k
) {

396 
j
;

403 
k
 = 
É
; k >ğ
lb
+1; k--) {

404 
j
 = 
k
-1;

405 
	`½rj3
(
r
[
k
], 
m1
[k], 
m2
[k], 
m3
[k],

406 
r
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], 
k
);

409 
k
 = 
lb
;

413 
	`z”o3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

414 
	`psšv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

416 
k
 = 
lb
+1; k <ğ
É
-1; k++) {

417 
j
 = 
k
-1;

421 
	`z”o3
(
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k]);

422 
	`š‹½
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j],

423 
u
[
k
], 
m1
[k], 
m2
[k], 
m3
[k], k);

427 
	`»sid
(
u
[
k
], 
r
[k],„[k], 
m1
[k], 
m2
[k], 
m3
[k], 
a
, k);

431 
	`psšv
(
r
[
k
], 
u
[k], 
m1
[k], 
m2
[k], 
m3
[k], 
c
, k);

434 
j
 = 
É
 - 1;

435 
k
 = 
É
;

436 
	`š‹½
(
u
[
j
], 
m1
[j], 
m2
[j], 
m3
[j], u[
É
], 
n1
, 
n2
, 
n3
, 
k
);

437 
	`»sid
(
u
[
É
], 
v
, 
r
[É], 
n1
, 
n2
, 
n3
, 
a
, 
k
);

438 
	`psšv
(
r
[
É
], 
u
[É], 
n1
, 
n2
, 
n3
, 
c
, 
k
);

439 
	}
}

444 
	$psšv
Ğ***
r
, ***
u
, 
n1
, 
n2
, 
n3
,

445 
c
[4], 
k
) {

462 
i3
, 
i2
, 
i1
;

463 
r1
[
M
], 
r2
[M];

464 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
r1
,
r2
)

465 
i3
 = 1; i3 < 
n3
-1; i3++) {

466 
i2
 = 1; i2 < 
n2
-1; i2++) {

467 
i1
 = 0; i1 < 
n1
; i1++) {

468 
r1
[
i1
] = 
r
[
i3
][
i2
-1][i1] +„[i3][i2+1][i1]

469 + 
r
[
i3
-1][
i2
][
i1
] +„[i3+1][i2][i1];

470 
r2
[
i1
] = 
r
[
i3
-1][
i2
-1][i1] +„[i3-1][i2+1][i1]

471 + 
r
[
i3
+1][
i2
-1][
i1
] +„[i3+1][i2+1][i1];

473 
i1
 = 1; i1 < 
n1
-1; i1++) {

474 
u
[
i3
][
i2
][
i1
] = u[i3][i2][i1]

475 + 
c
[0] * 
r
[
i3
][
i2
][
i1
]

476 + 
c
[1] * ( 
r
[
i3
][
i2
][
i1
-1] +„[i3][i2][i1+1]

477 + 
r1
[
i1
] )

478 + 
c
[2] * ( 
r2
[
i1
] + 
r1
[i1-1] +„1[i1+1] );

491 
	`comm3
(
u
,
n1
,
n2
,
n3
,
k
);

493 ià(
debug_vec
[0] >= 1 ) {

494 
	`»p_Äm
(
u
,
n1
,
n2
,
n3
,"…sšv",
k
);

497 iàĞ
debug_vec
[3] >ğ
k
 ) {

498 
	`show®l
(
u
,
n1
,
n2
,
n3
);

500 
	}
}

505 
	$»sid
Ğ***
u
, ***
v
, ***
r
,

506 
n1
, 
n2
, 
n3
, 
a
[4], 
k
 ) {

524 
i3
, 
i2
, 
i1
;

525 
u1
[
M
], 
u2
[M];

526 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
u1
,
u2
)

527 
i3
 = 1; i3 < 
n3
-1; i3++) {

528 
i2
 = 1; i2 < 
n2
-1; i2++) {

529 
i1
 = 0; i1 < 
n1
; i1++) {

530 
u1
[
i1
] = 
u
[
i3
][
i2
-1][i1] + u[i3][i2+1][i1]

531 + 
u
[
i3
-1][
i2
][
i1
] + u[i3+1][i2][i1];

532 
u2
[
i1
] = 
u
[
i3
-1][
i2
-1][i1] + u[i3-1][i2+1][i1]

533 + 
u
[
i3
+1][
i2
-1][
i1
] + u[i3+1][i2+1][i1];

535 
i1
 = 1; i1 < 
n1
-1; i1++) {

536 
r
[
i3
][
i2
][
i1
] = 
v
[i3][i2][i1]

537 - 
a
[0] * 
u
[
i3
][
i2
][
i1
]

544 - 
a
[2] * ( 
u2
[
i1
] + 
u1
[i1-1] + u1[i1+1] )

545 - 
a
[3] * ( 
u2
[
i1
-1] + u2[i1+1] );

553 
	`comm3
(
r
,
n1
,
n2
,
n3
,
k
);

555 ià(
debug_vec
[0] >= 1 ) {

556 
	`»p_Äm
(
r
,
n1
,
n2
,
n3
,"„esid",
k
);

559 iàĞ
debug_vec
[2] >ğ
k
 ) {

560 
	`show®l
(
r
,
n1
,
n2
,
n3
);

562 
	}
}

567 
	$½rj3
Ğ***
r
, 
m1k
, 
m2k
, 
m3k
,

568 ***
s
, 
m1j
, 
m2j
, 
m3j
, 
k
 ) {

583 
j3
, 
j2
, 
j1
, 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
;

585 
x1
[
M
], 
y1
[M], 
x2
, 
y2
;

588 ià(
m1k
 == 3) {

589 
d1
 = 2;

591 
d1
 = 1;

594 ià(
m2k
 == 3) {

595 
d2
 = 2;

597 
d2
 = 1;

600 ià(
m3k
 == 3) {

601 
d3
 = 2;

603 
d3
 = 1;

605 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
j1
,
j2
,
j3
,
i1
,
i2
,
i3
,
x1
,
y1
,
x2
,
y2
)

606 
j3
 = 1; j3 < 
m3j
-1; j3++) {

607 
i3
 = 2*
j3
-
d3
;

609 
j2
 = 1; j2 < 
m2j
-1; j2++) {

610 
i2
 = 2*
j2
-
d2
;

613 
j1
 = 1; j1 < 
m1j
; j1++) {

614 
i1
 = 2*
j1
-
d1
;

616 
x1
[
i1
] = 
r
[
i3
+1][
i2
][i1] +„[i3+1][i2+2][i1]

617 + 
r
[
i3
][
i2
+1][
i1
] +„[i3+2][i2+1][i1];

618 
y1
[
i1
] = 
r
[
i3
][
i2
][i1] +„[i3+2][i2][i1]

619 + 
r
[
i3
][
i2
+2][
i1
] +„[i3+2][i2+2][i1];

622 
j1
 = 1; j1 < 
m1j
-1; j1++) {

623 
i1
 = 2*
j1
-
d1
;

625 
y2
 = 
r
[
i3
][
i2
][
i1
+1] +„[i3+2][i2][i1+1]

626 + 
r
[
i3
][
i2
+2][
i1
+1] +„[i3+2][i2+2][i1+1];

627 
x2
 = 
r
[
i3
+1][
i2
][
i1
+1] +„[i3+1][i2+2][i1+1]

628 + 
r
[
i3
][
i2
+1][
i1
+1] +„[i3+2][i2+1][i1+1];

629 
s
[
j3
][
j2
][
j1
] =

630 0.5 * 
r
[
i3
+1][
i2
+1][
i1
+1]

631 + 0.25 * ( 
r
[
i3
+1][
i2
+1][
i1
] +„[i3+1][i2+1][i1+2] + 
x2
)

632 + 0.125 * ( 
x1
[
i1
] + x1[i1+2] + 
y2
)

633 + 0.0625 * ( 
y1
[
i1
] + y1[i1+2] );

637 
	`comm3
(
s
,
m1j
,
m2j
,
m3j
,
k
-1);

639 ià(
debug_vec
[0] >= 1 ) {

640 
	`»p_Äm
(
s
,
m1j
,
m2j
,
m3j
,"„´j3",
k
-1);

643 ià(
debug_vec
[4] >ğ
k
 ) {

644 
	`show®l
(
s
,
m1j
,
m2j
,
m3j
);

646 
	}
}

651 
	$š‹½
Ğ***
z
, 
mm1
, 
mm2
, 
mm3
,

652 ***
u
, 
n1
, 
n2
, 
n3
, 
k
 ) {

668 
i3
, 
i2
, 
i1
, 
d1
, 
d2
, 
d3
, 
t1
, 
t2
, 
t3
;

676 
z1
[
M
], 
z2
[M], 
z3
[M];

678 iàĞ
n1
 !ğ3 && 
n2
 !ğ3 && 
n3
 != 3 ) {

679 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
z1
,
z2
,
z3
)

680 
i3
 = 0; i3 < 
mm3
-1; i3++) {

681 
i2
 = 0; i2 < 
mm2
-1; i2++) {

682 
i1
 = 0; i1 < 
mm1
; i1++) {

683 
z1
[
i1
] = 
z
[
i3
][
i2
+1][i1] + z[i3][i2][i1];

684 
z2
[
i1
] = 
z
[
i3
+1][
i2
][i1] + z[i3][i2][i1];

685 
z3
[
i1
] = 
z
[
i3
+1][
i2
+1][i1] + z[i3+1][i2][i1] + 
z1
[i1];

687 
i1
 = 0; i1 < 
mm1
-1; i1++) {

688 
u
[2*
i3
][2*
i2
][2*
i1
] = u[2*i3][2*i2][2*i1]

689 +
z
[
i3
][
i2
][
i1
];

690 
u
[2*
i3
][2*
i2
][2*
i1
+1] = u[2*i3][2*i2][2*i1+1]

691 +0.5*(
z
[
i3
][
i2
][
i1
+1]+z[i3][i2][i1]);

693 
i1
 = 0; i1 < 
mm1
-1; i1++) {

694 
u
[2*
i3
][2*
i2
+1][2*
i1
] = u[2*i3][2*i2+1][2*i1]

695 +0.5 * 
z1
[
i1
];

696 
u
[2*
i3
][2*
i2
+1][2*
i1
+1] = u[2*i3][2*i2+1][2*i1+1]

697 +0.25*Ğ
z1
[
i1
] + z1[i1+1] );

699 
i1
 = 0; i1 < 
mm1
-1; i1++) {

700 
u
[2*
i3
+1][2*
i2
][2*
i1
] = u[2*i3+1][2*i2][2*i1]

701 +0.5 * 
z2
[
i1
];

702 
u
[2*
i3
+1][2*
i2
][2*
i1
+1] = u[2*i3+1][2*i2][2*i1+1]

703 +0.25*Ğ
z2
[
i1
] + z2[i1+1] );

705 
i1
 = 0; i1 < 
mm1
-1; i1++) {

706 
u
[2*
i3
+1][2*
i2
+1][2*
i1
] = u[2*i3+1][2*i2+1][2*i1]

707 +0.25* 
z3
[
i1
];

708 
u
[2*
i3
+1][2*
i2
+1][2*
i1
+1] = u[2*i3+1][2*i2+1][2*i1+1]

709 +0.125*Ğ
z3
[
i1
] + z3[i1+1] );

714 ià(
n1
 == 3) {

715 
d1
 = 2;

716 
t1
 = 1;

718 
d1
 = 1;

719 
t1
 = 0;

722 ià(
n2
 == 3) {

723 
d2
 = 2;

724 
t2
 = 1;

726 
d2
 = 1;

727 
t2
 = 0;

730 ià(
n3
 == 3) {

731 
d3
 = 2;

732 
t3
 = 1;

734 
d3
 = 1;

735 
t3
 = 0;

738 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
)

740 #´agm¨
omp
 

741  
i3
 = 
d3
; i3 <ğ
mm3
-1; i3++) {

742  
i2
 = 
d2
; i2 <ğ
mm2
-1; i2++) {

743  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

744 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

745 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

746 +
z
[
i3
-1][
i2
-1][
i1
-1];

748  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

749 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

750 
u
[2*
i3
-
d3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

751 +0.5*(
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

754  
i2
 = 1; i2 <ğ
mm2
-1; i2++) {

755  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

756 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

757 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

758 +0.5*(
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

760  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

761 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

762 
u
[2*
i3
-
d3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

763 +0.25*(
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

764 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

768 #´agm¨
omp
 
nowa™


769  
i3
 = 1; i3 <ğ
mm3
-1; i3++) {

770  
i2
 = 
d2
; i2 <ğ
mm2
-1; i2++) {

771  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

772 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1] =

773 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
d1
-1]

774 +0.5*(
z
[
i3
][
i2
-1][
i1
-1]+z[i3-1][i2-1][i1-1]);

776  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

777 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1] =

778 
u
[2*
i3
-
t3
-1][2*
i2
-
d2
-1][2*
i1
-
t1
-1]

779 +0.25*(
z
[
i3
][
i2
-1][
i1
]+z[i3][i2-1][i1-1]

780 +
z
[
i3
-1][
i2
-1][
i1
]+z[i3-1][i2-1][i1-1]);

783  
i2
 = 1; i2 <ğ
mm2
-1; i2++) {

784  
i1
 = 
d1
; i1 <ğ
mm1
-1; i1++) {

785 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1] =

786 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
d1
-1]

787 +0.25*(
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

788 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

790  
i1
 = 1; i1 <ğ
mm1
-1; i1++) {

791 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1] =

792 
u
[2*
i3
-
t3
-1][2*
i2
-
t2
-1][2*
i1
-
t1
-1]

793 +0.125*(
z
[
i3
][
i2
][
i1
]+z[i3][i2-1][i1]

794 +
z
[
i3
][
i2
][
i1
-1]+z[i3][i2-1][i1-1]

795 +
z
[
i3
-1][
i2
][
i1
]+z[i3-1][i2-1][i1]

796 +
z
[
i3
-1][
i2
][
i1
-1]+z[i3-1][i2-1][i1-1]);

802 ià(
debug_vec
[0] >= 1 ) {

803 
	`»p_Äm
(
z
,
mm1
,
mm2
,
mm3
,"z: iÁ”",
k
-1);

804 
	`»p_Äm
(
u
,
n1
,
n2
,
n3
,"u: iÁ”",
k
);

807 iàĞ
debug_vec
[5] >ğ
k
 ) {

808 
	`show®l
(
z
,
mm1
,
mm2
,
mm3
);

809 
	`show®l
(
u
,
n1
,
n2
,
n3
);

811 
	}
}

816 
	$nÜm2u3
(***
r
, 
n1
, 
n2
, 
n3
,

817 *
ºm2
, *
ºmu
, 
nx
, 
ny
, 
nz
) {

830 
s
 = 0.0;

831 
i3
, 
i2
, 
i1
, 
n
;

832 
a
 = 0.0, 
tmp
 = 0.0;

834 
n
 = 
nx
*
ny
*
nz
;

836 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
,
a
è
	`»duùiÚ
(+:
s
è»duùiÚ(
max
:
tmp
)

837 
i3
 = 1; i3 < 
n3
-1; i3++) {

838 
i2
 = 1; i2 < 
n2
-1; i2++) {

839 
i1
 = 1; i1 < 
n1
-1; i1++) {

840 
s
 = s + 
r
[
i3
][
i2
][
i1
] *„[i3][i2][i1];

841 
a
 = 
	`çbs
(
r
[
i3
][
i2
][
i1
]);

842 ià(
a
 > 
tmp
)mp =‡;

846 *
ºmu
 = 
tmp
;

847 *
ºm2
 = 
	`sq¹
(
s
/()
n
);

848 
	}
}

853 
	$»p_Äm
(***
u
, 
n1
, 
n2
, 
n3
,

854 *
t™Ë
, 
kk
) {

863 
ºm2
, 
ºmu
;

866 
	`nÜm2u3
(
u
,
n1
,
n2
,
n3
,&
ºm2
,&
ºmu
,
nx
[
kk
],
ny
[kk],
nz
[kk]);

867 
	`´štf
(" Level%2d in %8s:‚orms =%21.14e%21.14e\n",

868 
kk
, 
t™Ë
, 
ºm2
, 
ºmu
);

869 
	}
}

874 
	$comm3
(***
u
, 
n1
, 
n2
, 
n3
, 
kk
) {

883 
i1
, 
i2
, 
i3
;

886 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i1
,
i2
,
i3
)

888 #´agm¨
omp
 

889  
i3
 = 1; i3 < 
n3
-1; i3++) {

890  
i2
 = 1; i2 < 
n2
-1; i2++) {

891 
u
[
i3
][
i2
][
n1
-1] = u[i3][i2][1];

892 
u
[
i3
][
i2
][0] = u[i3][i2][
n1
-2];

899  
i1
 = 0; i1 < 
n1
; i1++) {

900 
u
[
i3
][
n2
-1][
i1
] = u[i3][1][i1];

901 
u
[
i3
][0][
i1
] = u[i3][
n2
-2][i1];

906 #´agm¨
omp
 
nowa™


907  
i2
 = 0; i2 < 
n2
; i2++) {

908  
i1
 = 0; i1 < 
n1
; i1++) {

909 
u
[
n3
-1][
i2
][
i1
] = u[1][i2][i1];

910 
u
[0][
i2
][
i1
] = u[
n3
-2][i2][i1];

914 
	}
}

919 
	$z¿n3
(***
z
, 
n1
, 
n2
, 
n3
, 
nx
, 
ny
, 
k
) {

930 
	#MM
 10

	)

931 
__A
=1220703125.e0;

932 
	#A
 
__A


	)

933 
	#X
 314159265.e0

	)

935 
i0
, 
m0
, 
m1
;

936 
i1
, 
i2
, 
i3
, 
d1
, 
e1
, 
e2
, 
e3
;

937 
xx
, 
x0
, 
x1
, 
a1
, 
a2
, 
ai
;

939 
‹n
[
MM
][2], 
be¡
;

940 
i
, 
j1
[
MM
][2], 
j2
[MM][2], 
j3
[MM][2];

941 
jg
[4][
MM
][2];

943 
rdummy
;

945 
a1
 = 
	`pow”
Ğ
A
, 
nx
 );

946 
a2
 = 
	`pow”
Ğ
A
, 
nx
*
ny
 );

948 
	`z”o3
(
z
,
n1
,
n2
,
n3
);

950 
i
 = 
is1
-1+
nx
*(
is2
-1+
ny
*(
is3
-1));

952 
ai
 = 
	`pow”
Ğ
A
, 
i
 );

953 
d1
 = 
›1
 - 
is1
 + 1;

954 
e1
 = 
›1
 - 
is1
 + 2;

955 
e2
 = 
›2
 - 
is2
 + 2;

956 
e3
 = 
›3
 - 
is3
 + 2;

957 
x0
 = 
X
;

958 
rdummy
 = 
	`¿ndlc
Ğ&
x0
, 
ai
 );

960 
i3
 = 1; i3 < 
e3
; i3++) {

961 
x1
 = 
x0
;

962 
i2
 = 1; i2 < 
e2
; i2++) {

963 
xx
 = 
x1
;

964 
	`v¿Æc
Ğ
d1
, &
xx
, 
A
, &(
z
[
i3
][
i2
][0]));

965 
rdummy
 = 
	`¿ndlc
Ğ&
x1
, 
a1
 );

967 
rdummy
 = 
	`¿ndlc
Ğ&
x0
, 
a2
 );

978 
i
 = 0; i < 
MM
; i++) {

979 
‹n
[
i
][1] = 0.0;

980 
j1
[
i
][1] = 0;

981 
j2
[
i
][1] = 0;

982 
j3
[
i
][1] = 0;

983 
‹n
[
i
][0] = 1.0;

984 
j1
[
i
][0] = 0;

985 
j2
[
i
][0] = 0;

986 
j3
[
i
][0] = 0;

988 
i3
 = 1; i3 < 
n3
-1; i3++) {

989 
i2
 = 1; i2 < 
n2
-1; i2++) {

990 
i1
 = 1; i1 < 
n1
-1; i1++) {

991 iàĞ
z
[
i3
][
i2
][
i1
] > 
‹n
[0][1] ) {

992 
‹n
[0][1] = 
z
[
i3
][
i2
][
i1
];

993 
j1
[0][1] = 
i1
;

994 
j2
[0][1] = 
i2
;

995 
j3
[0][1] = 
i3
;

996 
	`bubbË
Ğ
‹n
, 
j1
, 
j2
, 
j3
, 
MM
, 1 );

998 iàĞ
z
[
i3
][
i2
][
i1
] < 
‹n
[0][0] ) {

999 
‹n
[0][0] = 
z
[
i3
][
i2
][
i1
];

1000 
j1
[0][0] = 
i1
;

1001 
j2
[0][0] = 
i2
;

1002 
j3
[0][0] = 
i3
;

1003 
	`bubbË
Ğ
‹n
, 
j1
, 
j2
, 
j3
, 
MM
, 0 );

1012 
i1
 = 
MM
 - 1;

1013 
i0
 = 
MM
 - 1;

1014 
i
 = 
MM
 - 1 ; i >= 0; i--) {

1015 
be¡
 = 
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]];

1016 ià(
be¡
 =ğ
z
[
j3
[
i1
][1]][
j2
[i1][1]][
j1
[i1][1]]) {

1017 
jg
[0][
i
][1] = 0;

1018 
jg
[1][
i
][1] = 
is1
 - 1 + 
j1
[
i1
][1];

1019 
jg
[2][
i
][1] = 
is2
 - 1 + 
j2
[
i1
][1];

1020 
jg
[3][
i
][1] = 
is3
 - 1 + 
j3
[
i1
][1];

1021 
i1
 = i1-1;

1023 
jg
[0][
i
][1] = 0;

1024 
jg
[1][
i
][1] = 0;

1025 
jg
[2][
i
][1] = 0;

1026 
jg
[3][
i
][1] = 0;

1028 
‹n
[
i
][1] = 
be¡
;

1029 
be¡
 = 
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]];

1030 ià(
be¡
 =ğ
z
[
j3
[
i0
][0]][
j2
[i0][0]][
j1
[i0][0]]) {

1031 
jg
[0][
i
][0] = 0;

1032 
jg
[1][
i
][0] = 
is1
 - 1 + 
j1
[
i0
][0];

1033 
jg
[2][
i
][0] = 
is2
 - 1 + 
j2
[
i0
][0];

1034 
jg
[3][
i
][0] = 
is3
 - 1 + 
j3
[
i0
][0];

1035 
i0
 = i0-1;

1037 
jg
[0][
i
][0] = 0;

1038 
jg
[1][
i
][0] = 0;

1039 
jg
[2][
i
][0] = 0;

1040 
jg
[3][
i
][0] = 0;

1042 
‹n
[
i
][0] = 
be¡
;

1044 
m1
 = 
i1
+1;

1045 
m0
 = 
i0
+1;

1075 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i2
, 
i1
)

1076 
i3
 = 0; i3 < 
n3
; i3++) {

1077 
i2
 = 0; i2 < 
n2
; i2++) {

1078 
i1
 = 0; i1 < 
n1
; i1++) {

1079 
z
[
i3
][
i2
][
i1
] = 0.0;

1083 
i
 = 
MM
-1; i >ğ
m0
; i--) {

1084 
z
[
j3
[
i
][0]][
j2
[i][0]][
j1
[i][0]] = -1.0;

1086 
i
 = 
MM
-1; i >ğ
m1
; i--) {

1087 
z
[
j3
[
i
][1]][
j2
[i][1]][
j1
[i][1]] = 1.0;

1089 
	`comm3
(
z
,
n1
,
n2
,
n3
,
k
);

1094 
	}
}

1099 
	$show®l
(***
z
, 
n1
, 
n2
, 
n3
) {

1104 
i1
,
i2
,
i3
;

1105 
m1
, 
m2
, 
m3
;

1107 
m1
 = 
	`mš
(
n1
,18);

1108 
m2
 = 
	`mš
(
n2
,14);

1109 
m3
 = 
	`mš
(
n3
,18);

1111 
	`´štf
("\n");

1112 
i3
 = 0; i3 < 
m3
; i3++) {

1113 
i1
 = 0; i1 < 
m1
; i1++) {

1114 
i2
 = 0; i2 < 
m2
; i2++) {

1115 
	`´štf
("%6.3f", 
z
[
i3
][
i2
][
i1
]);

1117 
	`´štf
("\n");

1119 
	`´štf
(" - - - - - - - \n");

1121 
	`´štf
("\n");

1122 
	}
}

1127 
	$pow”
Ğ
a
, 
n
 ) {

1136 
aj
;

1137 
nj
;

1138 
rdummy
;

1139 
pow”
;

1141 
pow”
 = 1.0;

1142 
nj
 = 
n
;

1143 
aj
 = 
a
;

1145 
nj
 != 0) {

1146 ifĞ(
nj
%2è=ğ1 ) 
rdummy
 = 
	`¿ndlc
Ğ&
pow”
, 
aj
 );

1147 
rdummy
 = 
	`¿ndlc
Ğ&
aj
,‡j );

1148 
nj
 =‚j/2;

1151  (
pow”
);

1152 
	}
}

1157 
	$bubbË
Ğ
‹n
[
M
][2], 
j1
[M][2], 
j2
[M][2],

1158 
j3
[
M
][2], 
m
, 
šd
 ) {

1167 
‹mp
;

1168 
i
, 
j_‹mp
;

1170 iàĞ
šd
 == 1 ) {

1171 
i
 = 0; i < 
m
-1; i++) {

1172 iàĞ
‹n
[
i
][
šd
] >en[i+1][ind] ) {

1174 
‹mp
 = 
‹n
[
i
+1][
šd
];

1175 
‹n
[
i
+1][
šd
] =en[i][ind];

1176 
‹n
[
i
][
šd
] = 
‹mp
;

1178 
j_‹mp
 = 
j1
[
i
+1][
šd
];

1179 
j1
[
i
+1][
šd
] = j1[i][ind];

1180 
j1
[
i
][
šd
] = 
j_‹mp
;

1182 
j_‹mp
 = 
j2
[
i
+1][
šd
];

1183 
j2
[
i
+1][
šd
] = j2[i][ind];

1184 
j2
[
i
][
šd
] = 
j_‹mp
;

1186 
j_‹mp
 = 
j3
[
i
+1][
šd
];

1187 
j3
[
i
+1][
šd
] = j3[i][ind];

1188 
j3
[
i
][
šd
] = 
j_‹mp
;

1194 
i
 = 0; i < 
m
-1; i++) {

1195 iàĞ
‹n
[
i
][
šd
] <en[i+1][ind] ) {

1197 
‹mp
 = 
‹n
[
i
+1][
šd
];

1198 
‹n
[
i
+1][
šd
] =en[i][ind];

1199 
‹n
[
i
][
šd
] = 
‹mp
;

1201 
j_‹mp
 = 
j1
[
i
+1][
šd
];

1202 
j1
[
i
+1][
šd
] = j1[i][ind];

1203 
j1
[
i
][
šd
] = 
j_‹mp
;

1205 
j_‹mp
 = 
j2
[
i
+1][
šd
];

1206 
j2
[
i
+1][
šd
] = j2[i][ind];

1207 
j2
[
i
][
šd
] = 
j_‹mp
;

1209 
j_‹mp
 = 
j3
[
i
+1][
šd
];

1210 
j3
[
i
+1][
šd
] = j3[i][ind];

1211 
j3
[
i
][
šd
] = 
j_‹mp
;

1217 
	}
}

1222 
	$z”o3
(***
z
, 
n1
, 
n2
, 
n3
) {

1227 
i1
, 
i2
, 
i3
;

1228 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
i1
,
i2
,
i3
)

1229 
i3
 = 0;i3 < 
n3
; i3++) {

1230 
i2
 = 0; i2 < 
n2
; i2++) {

1231 
i1
 = 0; i1 < 
n1
; i1++) {

1232 
z
[
i3
][
i2
][
i1
] = 0.0;

1236 
	}
}

	@MG/npbparams.h

7 
	#NX_DEFAULT
 32

	)

8 
	#NY_DEFAULT
 32

	)

9 
	#NZ_DEFAULT
 32

	)

10 
	#NIT_DEFAULT
 4

	)

11 
	#LM
 5

	)

12 
	#LT_DEFAULT
 5

	)

13 
	#DEBUG_DEFAULT
 0

	)

14 
	#NDIM1
 5

	)

15 
	#NDIM2
 5

	)

16 
	#NDIM3
 5

	)

17 
	#CONVERTDOUBLE
 
FALSE


	)

18 
	#COMPILETIME
 "25 S• 2020"

	)

19 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

20 
	#CS1
 "şªg-10"

	)

21 
	#CS2
 "şªg-10"

	)

22 
	#CS3
 "-lm"

	)

23 
	#CS4
 "-I../commÚ "

	)

24 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

25 
	#CS6
 "-lomp"

	)

26 
	#CS7
 "¿nddp"

	)

	@SP/header.h

14 
	~"Åb·¿ms.h
"

17 
	ggrid_pošts
[3];

20 
	gtx1
, 
	gtx2
, 
	gtx3
, 
	gty1
, 
	gty2
, 
	gty3
, 
	gtz1
, 
	gtz2
, 
	gtz3
,

21 
	gdx1
, 
	gdx2
, 
	gdx3
, 
	gdx4
, 
	gdx5
, 
	gdy1
, 
	gdy2
, 
	gdy3
, 
	gdy4
,

22 
	gdy5
, 
	gdz1
, 
	gdz2
, 
	gdz3
, 
	gdz4
, 
	gdz5
, 
	gds¥
, 
	gdt
,

23 
	gû
[13][5], 
	gdxmax
, 
	gdymax
, 
	gdzmax
, 
	gxxcÚ1
, 
	gxxcÚ2
,

24 
	gxxcÚ3
, 
	gxxcÚ4
, 
	gxxcÚ5
, 
	gdx1tx1
, 
	gdx2tx1
, 
	gdx3tx1
,

25 
	gdx4tx1
, 
	gdx5tx1
, 
	gyycÚ1
, 
	gyycÚ2
, 
	gyycÚ3
, 
	gyycÚ4
,

26 
	gyycÚ5
, 
	gdy1ty1
, 
	gdy2ty1
, 
	gdy3ty1
, 
	gdy4ty1
, 
	gdy5ty1
,

27 
	gzzcÚ1
, 
	gzzcÚ2
, 
	gzzcÚ3
, 
	gzzcÚ4
, 
	gzzcÚ5
, 
	gdz1tz1
,

28 
	gdz2tz1
, 
	gdz3tz1
, 
	gdz4tz1
, 
	gdz5tz1
, 
	gdnxm1
, 
	gdnym1
,

29 
	gdnzm1
, 
	gc1c2
, 
	gc1c5
, 
	gc3c4
, 
	gc1345
, 
	gcÚz1
, 
	gc1
, 
	gc2
,

30 
	gc3
, 
	gc4
, 
	gc5
, 
	gc4ds¥
, 
	gc5ds¥
, 
	gdtds¥
, 
	gd‰x1
, 
	gbt
,

31 
	gd‰x2
, 
	gd‰y1
, 
	gd‰y2
, 
	gd‰z1
, 
	gd‰z2
, 
	gc2d‰x1
,

32 
	gc2d‰y1
, 
	gc2d‰z1
, 
	gcomz1
, 
	gcomz4
, 
	gcomz5
, 
	gcomz6
,

33 
	gc3c4tx3
, 
	gc3c4ty3
, 
	gc3c4tz3
, 
	gc2iv
, 
	gcÚ43
, 
	gcÚ16
;

36 
	#IMAX
 
PROBLEM_SIZE


	)

37 
	#JMAX
 
PROBLEM_SIZE


	)

38 
	#KMAX
 
PROBLEM_SIZE


	)

46 
	gu
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

47 
	gus
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

48 
	gvs
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

49 
	gws
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

50 
	gqs
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

51 
	gašv
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

52 
	grho_i
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

53 
	g¥“d
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

54 
	gsqu¬e
 [
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

55 
	grhs
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

56 
	gfÜcšg
 [5][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1],

57 
	glhs
 [15][
IMAX
/2*2+1][
JMAX
/2*2+1][
KMAX
/2*2+1];

60 
	gcv
[
PROBLEM_SIZE
], 
	grhÚ
[PROBLEM_SIZE],

61 
	grhos
[
PROBLEM_SIZE
], 
	grhoq
[PROBLEM_SIZE],

62 
	gcuf
[
PROBLEM_SIZE
], 
	gq
[PROBLEM_SIZE],

63 
	gue
[5][
PROBLEM_SIZE
], 
	gbuf
[5][PROBLEM_SIZE];

	@SP/npbparams.h

7 
	#PROBLEM_SIZE
 12

	)

8 
	#NITER_DEFAULT
 100

	)

9 
	#DT_DEFAULT
 0.015

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "25 S• 2020"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "şªg-10"

	)

14 
	#CS2
 "şªg-10"

	)

15 
	#CS3
 "-lm"

	)

16 
	#CS4
 "-I../commÚ "

	)

17 
	#CS5
 "-O3 -fİ’m°-lom°-âoİ’mp-u£-s"

	)

18 
	#CS6
 "-lomp"

	)

19 
	#CS7
 "¿nddp"

	)

	@SP/sp.c

34 
	~"../commÚ/Åb-C.h
"

35 
	~"../m©h/Çs_m©h.h
"

36 
	~<Çutus/Çutus.h
>

37 
	~<Çutus/sh–l.h
>

39 
	~"h—d”.h
"

42 
add
();

43 
adi
();

44 
”rÜ_nÜm
(
rms
[5]);

45 
rhs_nÜm
(
rms
[5]);

46 
exaù_rhs
();

47 
exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

48 
d‹mp
[5]);

49 
š™Ÿlize
();

50 
lhsš™
();

51 
lhsx
();

52 
lhsy
();

53 
lhsz
();

54 
nšvr
();

55 
pšvr
();

56 
compu‹_rhs
();

57 
£t_cÚ¡ªts
();

58 
txšvr
();

59 
tz‘¬
();

60 
v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
);

61 
x_sŞve
();

62 
y_sŞve
();

63 
z_sŞve
();

68 
´og¿m_SP
(*
_buf
, * 
_´iv
);

70 
sh–l_cmd_im¶
 
	gÇs_¥_im¶
 = {

71 .
cmd
 = "nas-sp",

72 .
	gh–p_¡r
 = "NAS…arallel benchmark SP",

73 .
	ghªdËr
 = 
´og¿m_SP
,

75 
nk_»gi¡”_sh–l_cmd
(
Çs_¥_im¶
);

78 
	$´og¿m_SP
(* 
_buf
, * 
_´iv
) {

80 
n™”
, 
¡•
;

81 
mæİs
, 
tmax
;

82 
Áh»ads
 = 1;

83 
boŞ—n
 
v”if›d
;

84 
şass
;

92 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

108 
n™”
 = 
NITER_DEFAULT
;

109 
dt
 = 
DT_DEFAULT
;

110 
grid_pošts
[0] = 
PROBLEM_SIZE
;

111 
grid_pošts
[1] = 
PROBLEM_SIZE
;

112 
grid_pošts
[2] = 
PROBLEM_SIZE
;

115 
	`´štf
(" Size: %3dx%3dx%3d\n",

116 
grid_pošts
[0], grid_points[1], grid_points[2]);

117 
	`´štf
(" I‹¿tiÚs: %3d dt: %10.6f\n", 
n™”
, 
dt
);

119 iàĞ(
grid_pošts
[0] > 
IMAX
) ||

120 (
grid_pošts
[1] > 
JMAX
) ||

121 (
grid_pošts
[2] > 
KMAX
) ) {

122 
	`´štf
("%d, %d, %d\n", 
grid_pošts
[0], grid_points[1], grid_points[2]);

123 
	`´štf
(" Problem sizeoo big for compiled‡rray sizes\n");

124 
	`ex™
(1);

127 
	`£t_cÚ¡ªts
();

129 
	`š™Ÿlize
();

131 
	`lhsš™
();

133 
	`exaù_rhs
();

140 
	`adi
();

143 
	`š™Ÿlize
();

145 
	`tim”_ş—r
(1);

146 
	`tim”_¡¬t
(1);

148 
¡•
 = 1; s‹°<ğ
n™”
; step++) {

149 ià(
¡•
 % 20 == 0 || step == 1) {

151 
	`´štf
(" Tim¡• %4d\n", 
¡•
);

153 
	`adi
();

155 #´agm¨
omp
 
·¿Î–


157 #ià
	`defšed
(
_OPENMP
)

158 #´agm¨
omp
 
ma¡”


159 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

163 
	`tim”_¡İ
(1);

164 
tmax
 = 
	`tim”_»ad
(1);

166 
	`v”ify
(
n™”
, &
şass
, &
v”if›d
);

168 ià(
tmax
 != 0) {

169 
mæİs
 = ( 881.174 * (()
PROBLEM_SIZE
*PROBLEM_SIZE*PROBLEM_SIZE)

170 - 4683.91 * 
	`pow2
(()
PROBLEM_SIZE
)

171 + 11484.5 * ()
PROBLEM_SIZE


172 - 19272.4è* ()
n™”
 / (
tmax
*1000000.0);

174 
mæİs
 = 0.0;

177 
	`c_´št_»suÉs
("SP", 
şass
, 
grid_pošts
[0],

178 
grid_pošts
[1], grid_pošts[2], 
n™”
, 
Áh»ads
,

179 
tmax
, 
mæİs
, " floating…oint",

180 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
, 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
,

181 
CS6
, "(none)");

182 
	}
}

187 
	$add
() {

188 
i
, 
j
, 
k
, 
m
;

196 #´agm¨
omp
 

197 
m
 = 0; m < 5; m++) {

198 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

199 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

200 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

201 
u
[
m
][
i
][
j
][
k
] = u[m][i][j][k] + 
rhs
[m][i][j][k];

206 
	}
}

211 
	$adi
() {

215 
	`compu‹_rhs
();

217 
	`txšvr
();

219 
	`x_sŞve
();

221 
	`y_sŞve
();

223 
	`z_sŞve
();

225 
	`add
();

227 
	}
}

232 
	$”rÜ_nÜm
(
rms
[5]) {

242 
i
, 
j
, 
k
, 
m
, 
d
;

243 
xi
, 
‘a
, 
z‘a
, 
u_exaù
[5], 
add
;

245 
m
 = 0; m < 5; m++) {

246 
rms
[
m
] = 0.0;

249 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

250 
xi
 = ()
i
 * 
dnxm1
;

251 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

252 
‘a
 = ()
j
 * 
dnym1
;

253 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

254 
z‘a
 = ()
k
 * 
dnzm1
;

255 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
u_exaù
);

256 
m
 = 0; m < 5; m++) {

257 
add
 = 
u
[
m
][
i
][
j
][
k
] - 
u_exaù
[m];

258 
rms
[
m
] =„ms[m] + 
add
*add;

264 
m
 = 0; m < 5; m++) {

265 
d
 = 0; d < 3; d++) {

266 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

268 
rms
[
m
] = 
	`sq¹
(rms[m]);

270 
	}
}

275 
	$rhs_nÜm
(
rms
[5]) {

280 
i
, 
j
, 
k
, 
d
, 
m
;

281 
add
;

283 
m
 = 0; m < 5; m++) {

284 
rms
[
m
] = 0.0;

287 
i
 = 0; i <ğ
grid_pošts
[0]-2; i++) {

288 
j
 = 0; j <ğ
grid_pošts
[1]-2; j++) {

289 
k
 = 0; k <ğ
grid_pošts
[2]-2; k++) {

290 
m
 = 0; m < 5; m++) {

291 
add
 = 
rhs
[
m
][
i
][
j
][
k
];

292 
rms
[
m
] =„ms[m] + 
add
*add;

298 
m
 = 0; m < 5; m++) {

299 
d
 = 0; d < 3; d++) {

300 
rms
[
m
] =„ms[m] / ()(
grid_pošts
[
d
]-2);

302 
rms
[
m
] = 
	`sq¹
(rms[m]);

304 
	}
}

309 
	$exaù_rhs
() {

318 
d‹mp
[5], 
xi
, 
‘a
, 
z‘a
, 
dp
;

319 
m
, 
i
, 
j
, 
k
, 
1
, 
im1
, 
jp1
, 
jm1
, 
km1
, 
kp1
;

324 
m
 = 0; m < 5; m++) {

325 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

326 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

327 
k
ğ0; k <ğ
grid_pošts
[2]-1; k++) {

328 
fÜcšg
[
m
][
i
][
j
][
k
] = 0.0;

337 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

338 
z‘a
 = ()
k
 * 
dnzm1
;

339 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

340 
‘a
 = ()
j
 * 
dnym1
;

342 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

343 
xi
 = ()
i
 * 
dnxm1
;

345 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

346 
m
 = 0; m < 5; m++) {

347 
ue
[
m
][
i
] = 
d‹mp
[m];

350 
dp
 = 1.0 / 
d‹mp
[0];

352 
m
 = 1; m < 5; m++) {

353 
buf
[
m
][
i
] = 
dp
 * 
d‹mp
[m];

356 
cuf
[
i
] = 
buf
[1][i] * buf[1][i];

357 
buf
[0][
i
] = 
cuf
[i] + buf[2][i] * buf[2][i] + buf[3][i] * buf[3][i];

358 
q
[
i
] = 0.5 * (
buf
[1][i]*
ue
[1][i] + buf[2][i]*ue[2][i]

359 + 
buf
[3][
i
]*
ue
[3][i]);

362 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

363 
im1
 = 
i
-1;

364 
1
 = 
i
+1;

366 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

367 
tx2
*Ğ
ue
[1][
1
]-ue[1][
im1
] )+

368 
dx1tx1
*(
ue
[0][
1
]-2.0*ue[0][
i
]+ue[0][
im1
]);

370 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

371 - 
tx2
 * ((
ue
[1][
1
]*
buf
[1][1]+
c2
*(ue[4][1]-
q
[ip1]))-

372 (
ue
[1][
im1
]*
buf
[1][im1]+
c2
*(ue[4][im1]-
q
[im1])))+

373 
xxcÚ1
*(
buf
[1][
1
]-2.0*buf[1][
i
]+buf[1][
im1
])+

374 
dx2tx1
*Ğ
ue
[1][
1
]-2.0* ue[1][
i
]+ue[1][
im1
]);

376 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

377 - 
tx2
 * (
ue
[2][
1
]*
buf
[1][1]-ue[2][
im1
]*buf[1][im1])+

378 
xxcÚ2
*(
buf
[2][
1
]-2.0*buf[2][
i
]+buf[2][
im1
])+

379 
dx3tx1
*Ğ
ue
[2][
1
]-2.0*ue[2][
i
] +ue[2][
im1
]);

381 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

382 - 
tx2
*(
ue
[3][
1
]*
buf
[1][1]-ue[3][
im1
]*buf[1][im1])+

383 
xxcÚ2
*(
buf
[3][
1
]-2.0*buf[3][
i
]+buf[3][
im1
])+

384 
dx4tx1
*Ğ
ue
[3][
1
]-2.0* ue[3][
i
]+ ue[3][
im1
]);

386 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

387 - 
tx2
*(
buf
[1][
1
]*(
c1
*
ue
[4][1]-
c2
*
q
[ip1])-

388 
buf
[1][
im1
]*(
c1
*
ue
[4][im1]-
c2
*
q
[im1]))+

389 0.5*
xxcÚ3
*(
buf
[0][
1
]-2.0*buf[0][
i
]+

390 
buf
[0][
im1
])+

391 
xxcÚ4
*(
cuf
[
1
]-2.0*cuf[
i
]+cuf[
im1
])+

392 
xxcÚ5
*(
buf
[4][
1
]-2.0*buf[4][
i
]+buf[4][
im1
])+

393 
dx5tx1
*Ğ
ue
[4][
1
]-2.0* ue[4][
i
]+ ue[4][
im1
]);

399 
m
 = 0; m < 5; m++) {

400 
i
 = 1;

401 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

402 (5.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1] +ue[m][i+2]);

403 
i
 = 2;

404 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

405 (-4.0*
ue
[
m
][
i
-1] + 6.0*ue[m][i] -

406 4.0*
ue
[
m
][
i
+1] + ue[m][i+2]);

409 
m
 = 0; m < 5; m++) {

410 
i
 = 3; i <ğ
grid_pošts
[0]-4; i++) {

411 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

412 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] +

413 6.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1] + ue[m][i+2]);

417 
m
 = 0; m < 5; m++) {

418 
i
 = 
grid_pošts
[0]-3;

419 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

420 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] +

421 6.0*
ue
[
m
][
i
] - 4.0*ue[m][i+1]);

422 
i
 = 
grid_pošts
[0]-2;

423 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

424 (
ue
[
m
][
i
-2] - 4.0*ue[m][i-1] + 5.0*ue[m][i]);

432 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

433 
z‘a
 = ()
k
 * 
dnzm1
;

434 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

435 
xi
 = ()
i
 * 
dnxm1
;

437 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

438 
‘a
 = ()
j
 * 
dnym1
;

440 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

441 
m
 = 0; m < 5; m++) {

442 
ue
[
m
][
j
] = 
d‹mp
[m];

444 
dp
 = 1.0/
d‹mp
[0];

446 
m
 = 1; m < 5; m++) {

447 
buf
[
m
][
j
] = 
dp
 * 
d‹mp
[m];

450 
cuf
[
j
] = 
buf
[2][j] * buf[2][j];

451 
buf
[0][
j
] = 
cuf
[j] + buf[1][j] * buf[1][j] +

452 
buf
[3][
j
] * buf[3][j];

453 
q
[
j
] = 0.5*(
buf
[1][j]*
ue
[1][j] + buf[2][j]*ue[2][j] +

454 
buf
[3][
j
]*
ue
[3][j]);

457 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

458 
jm1
 = 
j
-1;

459 
jp1
 = 
j
+1;

461 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

462 
ty2
*Ğ
ue
[2][
jp1
]-ue[2][
jm1
] )+

463 
dy1ty1
*(
ue
[0][
jp1
]-2.0*ue[0][
j
]+ue[0][
jm1
]);

465 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

466 - 
ty2
*(
ue
[1][
jp1
]*
buf
[2][jp1]-ue[1][
jm1
]*buf[2][jm1])+

467 
yycÚ2
*(
buf
[1][
jp1
]-2.0*buf[1][
j
]+buf[1][
jm1
])+

468 
dy2ty1
*Ğ
ue
[1][
jp1
]-2.0* ue[1][
j
]+ ue[1][
jm1
]);

470 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

471 - 
ty2
*((
ue
[2][
jp1
]*
buf
[2][jp1]+
c2
*(ue[4][jp1]-
q
[jp1]))-

472 (
ue
[2][
jm1
]*
buf
[2][jm1]+
c2
*(ue[4][jm1]-
q
[jm1])))+

473 
yycÚ1
*(
buf
[2][
jp1
]-2.0*buf[2][
j
]+buf[2][
jm1
])+

474 
dy3ty1
*Ğ
ue
[2][
jp1
]-2.0*ue[2][
j
] +ue[2][
jm1
]);

476 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

477 - 
ty2
*(
ue
[3][
jp1
]*
buf
[2][jp1]-ue[3][
jm1
]*buf[2][jm1])+

478 
yycÚ2
*(
buf
[3][
jp1
]-2.0*buf[3][
j
]+buf[3][
jm1
])+

479 
dy4ty1
*Ğ
ue
[3][
jp1
]-2.0*ue[3][
j
]+ ue[3][
jm1
]);

481 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

482 - 
ty2
*(
buf
[2][
jp1
]*(
c1
*
ue
[4][jp1]-
c2
*
q
[jp1])-

483 
buf
[2][
jm1
]*(
c1
*
ue
[4][jm1]-
c2
*
q
[jm1]))+

484 0.5*
yycÚ3
*(
buf
[0][
jp1
]-2.0*buf[0][
j
]+

485 
buf
[0][
jm1
])+

486 
yycÚ4
*(
cuf
[
jp1
]-2.0*cuf[
j
]+cuf[
jm1
])+

487 
yycÚ5
*(
buf
[4][
jp1
]-2.0*buf[4][
j
]+buf[4][
jm1
])+

488 
dy5ty1
*(
ue
[4][
jp1
]-2.0*ue[4][
j
]+ue[4][
jm1
]);

494 
m
 = 0; m < 5; m++) {

495 
j
 = 1;

496 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

497 (5.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1] +ue[m][j+2]);

498 
j
 = 2;

499 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

500 (-4.0*
ue
[
m
][
j
-1] + 6.0*ue[m][j] -

501 4.0*
ue
[
m
][
j
+1] + ue[m][j+2]);

504 
m
 = 0; m < 5; m++) {

505 
j
 = 3; j <ğ
grid_pošts
[1]-4; j++) {

506 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

507 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] +

508 6.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1] + ue[m][j+2]);

512 
m
 = 0; m < 5; m++) {

513 
j
 = 
grid_pošts
[1]-3;

514 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

515 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] +

516 6.0*
ue
[
m
][
j
] - 4.0*ue[m][j+1]);

517 
j
 = 
grid_pošts
[1]-2;

518 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

519 (
ue
[
m
][
j
-2] - 4.0*ue[m][j-1] + 5.0*ue[m][j]);

528 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

529 
‘a
 = ()
j
 * 
dnym1
;

530 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

531 
xi
 = ()
i
 * 
dnxm1
;

533 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

534 
z‘a
 = ()
k
 * 
dnzm1
;

536 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
d‹mp
);

537 
m
 = 0; m < 5; m++) {

538 
ue
[
m
][
k
] = 
d‹mp
[m];

541 
dp
 = 1.0/
d‹mp
[0];

543 
m
 = 1; m < 5; m++) {

544 
buf
[
m
][
k
] = 
dp
 * 
d‹mp
[m];

547 
cuf
[
k
] = 
buf
[3][k] * buf[3][k];

548 
buf
[0][
k
] = 
cuf
[k] + buf[1][k] * buf[1][k] +

549 
buf
[2][
k
] * buf[2][k];

550 
q
[
k
] = 0.5*(
buf
[1][k]*
ue
[1][k] + buf[2][k]*ue[2][k] +

551 
buf
[3][
k
]*
ue
[3][k]);

554 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

555 
km1
 = 
k
-1;

556 
kp1
 = 
k
+1;

558 
fÜcšg
[0][
i
][
j
][
k
] = forcing[0][i][j][k] -

559 
tz2
*Ğ
ue
[3][
kp1
]-ue[3][
km1
] )+

560 
dz1tz1
*(
ue
[0][
kp1
]-2.0*ue[0][
k
]+ue[0][
km1
]);

562 
fÜcšg
[1][
i
][
j
][
k
] = forcing[1][i][j][k]

563 - 
tz2
 * (
ue
[1][
kp1
]*
buf
[3][kp1]-ue[1][
km1
]*buf[3][km1])+

564 
zzcÚ2
*(
buf
[1][
kp1
]-2.0*buf[1][
k
]+buf[1][
km1
])+

565 
dz2tz1
*Ğ
ue
[1][
kp1
]-2.0* ue[1][
k
]+ ue[1][
km1
]);

567 
fÜcšg
[2][
i
][
j
][
k
] = forcing[2][i][j][k]

568 - 
tz2
 * (
ue
[2][
kp1
]*
buf
[3][kp1]-ue[2][
km1
]*buf[3][km1])+

569 
zzcÚ2
*(
buf
[2][
kp1
]-2.0*buf[2][
k
]+buf[2][
km1
])+

570 
dz3tz1
*(
ue
[2][
kp1
]-2.0*ue[2][
k
]+ue[2][
km1
]);

572 
fÜcšg
[3][
i
][
j
][
k
] = forcing[3][i][j][k]

573 - 
tz2
 * ((
ue
[3][
kp1
]*
buf
[3][kp1]+
c2
*(ue[4][kp1]-
q
[kp1]))-

574 (
ue
[3][
km1
]*
buf
[3][km1]+
c2
*(ue[4][km1]-
q
[km1])))+

575 
zzcÚ1
*(
buf
[3][
kp1
]-2.0*buf[3][
k
]+buf[3][
km1
])+

576 
dz4tz1
*Ğ
ue
[3][
kp1
]-2.0*ue[3][
k
] +ue[3][
km1
]);

578 
fÜcšg
[4][
i
][
j
][
k
] = forcing[4][i][j][k]

579 - 
tz2
 * (
buf
[3][
kp1
]*(
c1
*
ue
[4][kp1]-
c2
*
q
[kp1])-

580 
buf
[3][
km1
]*(
c1
*
ue
[4][km1]-
c2
*
q
[km1]))+

581 0.5*
zzcÚ3
*(
buf
[0][
kp1
]-2.0*buf[0][
k
]

582 +
buf
[0][
km1
])+

583 
zzcÚ4
*(
cuf
[
kp1
]-2.0*cuf[
k
]+cuf[
km1
])+

584 
zzcÚ5
*(
buf
[4][
kp1
]-2.0*buf[4][
k
]+buf[4][
km1
])+

585 
dz5tz1
*Ğ
ue
[4][
kp1
]-2.0*ue[4][
k
]+ ue[4][
km1
]);

591 
m
 = 0; m < 5; m++) {

592 
k
 = 1;

593 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

594 (5.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1] +ue[m][k+2]);

595 
k
 = 2;

596 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

597 (-4.0*
ue
[
m
][
k
-1] + 6.0*ue[m][k] -

598 4.0*
ue
[
m
][
k
+1] + ue[m][k+2]);

601 
m
 = 0; m < 5; m++) {

602 
k
 = 3; k <ğ
grid_pošts
[2]-4; k++) {

603 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
*

604 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] +

605 6.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1] + ue[m][k+2]);

609 
m
 = 0; m < 5; m++) {

610 
k
 = 
grid_pošts
[2]-3;

611 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

612 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] +

613 6.0*
ue
[
m
][
k
] - 4.0*ue[m][k+1]);

614 
k
 = 
grid_pošts
[2]-2;

615 
fÜcšg
[
m
][
i
][
j
][
k
] = fÜcšg[m][i][j][k] - 
ds¥
 *

616 (
ue
[
m
][
k
-2] - 4.0*ue[m][k-1] + 5.0*ue[m][k]);

624 
m
 = 0; m < 5; m++) {

625 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

626 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

627 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

628 
fÜcšg
[
m
][
i
][
j
][
k
] = -1.0 * forcing[m][i][j][k];

633 
	}
}

638 
	$exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
,

639 
d‹mp
[5]) {

648 
m
;

650 
m
 = 0; m < 5; m++) {

651 
d‹mp
[
m
] = 
û
[0][m] +

652 
xi
*(
û
[1][
m
] + xi*(ce[4][m] +

653 
xi
*(
û
[7][
m
] + xi*ce[10][m]))) +

654 
‘a
*(
û
[2][
m
] +ƒta*(ce[5][m] +

655 
‘a
*(
û
[8][
m
] +ƒta*ce[11][m])))+

656 
z‘a
*(
û
[3][
m
] + zeta*(ce[6][m] +

657 
z‘a
*(
û
[9][
m
] +

658 
z‘a
*
û
[12][
m
])));

660 
	}
}

665 
	$š™Ÿlize
() {

675 
i
, 
j
, 
k
, 
m
, 
ix
, 
iy
, 
iz
;

676 
xi
, 
‘a
, 
z‘a
, 
Pçû
[2][3][5], 
Pxi
, 
P‘a
, 
Pz‘a
, 
‹mp
[5];

685 
i
 = 0; i <ğ
IMAX
-1; i++) {

686 
j
 = 0; j <ğ
IMAX
-1; j++) {

687 
k
 = 0; k <ğ
IMAX
-1; k++) {

688 
u
[0][
i
][
j
][
k
] = 1.0;

689 
u
[1][
i
][
j
][
k
] = 0.0;

690 
u
[2][
i
][
j
][
k
] = 0.0;

691 
u
[3][
i
][
j
][
k
] = 0.0;

692 
u
[4][
i
][
j
][
k
] = 1.0;

701 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

702 
xi
 = ()
i
 * 
dnxm1
;

703 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

704 
‘a
 = ()
j
 * 
dnym1
;

705 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

706 
z‘a
 = ()
k
 * 
dnzm1
;

708 
ix
 = 0; ix < 2; ix++) {

709 
	`exaù_sŞutiÚ
(()
ix
, 
‘a
, 
z‘a
,

710 &
Pçû
[
ix
][0][0]);

713 
iy
 = 0; iy < 2; iy++) {

714 
	`exaù_sŞutiÚ
(
xi
, ()
iy
 , 
z‘a
,

715 &
Pçû
[
iy
][1][0]);

718 
iz
 = 0; iz < 2; iz++) {

719 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, ()
iz
,

720 &
Pçû
[
iz
][2][0]);

723 
m
 = 0; m < 5; m++) {

724 
Pxi
 = 
xi
 * 
Pçû
[1][0][
m
] +

725 (1.0-
xi
è* 
Pçû
[0][0][
m
];

726 
P‘a
 = 
‘a
 * 
Pçû
[1][1][
m
] +

727 (1.0-
‘a
è* 
Pçû
[0][1][
m
];

728 
Pz‘a
 = 
z‘a
 * 
Pçû
[1][2][
m
] +

729 (1.0-
z‘a
è* 
Pçû
[0][2][
m
];

731 
u
[
m
][
i
][
j
][
k
] = 
Pxi
 + 
P‘a
 + 
Pz‘a
 -

732 
Pxi
*
P‘a
 - Pxi*
Pz‘a
 - Peta*Pzeta +

733 
Pxi
*
P‘a
*
Pz‘a
;

748 
xi
 = 0.0;

749 
i
 = 0;

750 
j
 = 0; j < 
grid_pošts
[1]; j++) {

751 
‘a
 = ()
j
 * 
dnym1
;

752 
k
 = 0; k < 
grid_pošts
[2]; k++) {

753 
z‘a
 = ()
k
 * 
dnzm1
;

754 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

755 
m
 = 0; m < 5; m++) {

756 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

765 
xi
 = 1.0;

766 
i
 = 
grid_pošts
[0]-1;

767 
j
 = 0; j < 
grid_pošts
[1]; j++) {

768 
‘a
 = ()
j
 * 
dnym1
;

769 
k
 = 0; k < 
grid_pošts
[2]; k++) {

770 
z‘a
 = ()
k
 * 
dnzm1
;

771 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

772 
m
 = 0; m < 5; m++) {

773 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

782 
‘a
 = 0.0;

783 
j
 = 0;

784 
i
 = 0; i < 
grid_pošts
[0]; i++) {

785 
xi
 = ()
i
 * 
dnxm1
;

786 
k
 = 0; k < 
grid_pošts
[2]; k++) {

787 
z‘a
 = ()
k
 * 
dnzm1
;

788 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

789 
m
 = 0; m < 5; m++) {

790 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

799 
‘a
 = 1.0;

800 
j
 = 
grid_pošts
[1]-1;

801 
i
 = 0; i < 
grid_pošts
[0]; i++) {

802 
xi
 = ()
i
 * 
dnxm1
;

803 
k
 = 0; k < 
grid_pošts
[2]; k++) {

804 
z‘a
 = ()
k
 * 
dnzm1
;

805 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

806 
m
 = 0; m < 5; m++) {

807 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

816 
z‘a
 = 0.0;

817 
k
 = 0;

818 
i
 = 0; i < 
grid_pošts
[0]; i++) {

819 
xi
 = ()
i
 *
dnxm1
;

820 
j
 = 0; j < 
grid_pošts
[1]; j++) {

821 
‘a
 = ()
j
 * 
dnym1
;

822 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

823 
m
 = 0; m < 5; m++) {

824 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

833 
z‘a
 = 1.0;

834 
k
 = 
grid_pošts
[2]-1;

835 
i
 = 0; i < 
grid_pošts
[0]; i++) {

836 
xi
 = ()
i
 * 
dnxm1
;

837 
j
 = 0; j < 
grid_pošts
[1]; j++) {

838 
‘a
 = ()
j
 * 
dnym1
;

839 
	`exaù_sŞutiÚ
(
xi
, 
‘a
, 
z‘a
, 
‹mp
);

840 
m
 = 0; m < 5; m++) {

841 
u
[
m
][
i
][
j
][
k
] = 
‹mp
[m];

845 
	}
}

851 
	$lhsš™
() {

856 
i
, 
j
, 
k
, 
n
;

861 
n
 = 0;‚ < 15;‚++) {

862 #´agm¨
omp
 
nowa™


863 
i
 = 0; i < 
grid_pošts
[0]; i++) {

864 
j
 = 0; j < 
grid_pošts
[1]; j++) {

865 
k
 = 0; k < 
grid_pošts
[2]; k++) {

866 
lhs
[
n
][
i
][
j
][
k
] = 0.0;

871 #´agm¨
omp
 
b¬r›r


877 
n
 = 0;‚ < 3;‚++) {

878 #´agm¨
omp
 

879 
i
 = 0; i < 
grid_pošts
[0]; i++) {

880 
j
 = 0; j < 
grid_pošts
[1]; j++) {

881 
k
 = 0; k < 
grid_pošts
[2]; k++) {

882 
lhs
[5*
n
+2][
i
][
j
][
k
] = 1.0;

887 
	}
}

892 
	$lhsx
() {

901 
ru1
;

902 
i
, 
j
, 
k
;

907 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

908 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

909 #´agm¨
omp
 

910 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

911 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

912 
cv
[
i
] = 
us
[i][
j
][
k
];

913 
rhÚ
[
i
] = 
	`max
(
dx2
+
cÚ43
*
ru1
,

914 
	`max
(
dx5
+
c1c5
*
ru1
,

915 
	`max
(
dxmax
+
ru1
,

916 
dx1
)));

919 #´agm¨
omp
 

920 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

921 
lhs
[0][
i
][
j
][
k
] = 0.0;

922 
lhs
[1][
i
][
j
][
k
] = - 
d‰x2
 * 
cv
[i-1] - 
d‰x1
 * 
rhÚ
[i-1];

923 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰x1
 * 
rhÚ
[i];

924 
lhs
[3][
i
][
j
][
k
] = 
d‰x2
 * 
cv
[i+1] - 
d‰x1
 * 
rhÚ
[i+1];

925 
lhs
[4][
i
][
j
][
k
] = 0.0;

934 
i
 = 1;

935 #´agm¨
omp
 
nowa™


936 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

937 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

938 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

939 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

940 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

941 
lhs
[1][
i
+1][
j
][
k
] =†hs[1][i+1][j][k] - 
comz4
;

942 
lhs
[2][
i
+1][
j
][
k
] =†hs[2][i+1][j][k] + 
comz6
;

943 
lhs
[3][
i
+1][
j
][
k
] =†hs[3][i+1][j][k] - 
comz4
;

944 
lhs
[4][
i
+1][
j
][
k
] =†hs[4][i+1][j][k] + 
comz1
;

948 #´agm¨
omp
 
nowa™


949 
i
 = 3; i <ğ
grid_pošts
[0]-4; i++) {

950 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

951 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

952 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

953 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

954 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

955 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

956 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

961 
i
 = 
grid_pošts
[0]-3;

962 #´agm¨
omp
 

963 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

964 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

965 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

966 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

967 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

968 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

970 
lhs
[0][
i
+1][
j
][
k
] =†hs[0][i+1][j][k] + 
comz1
;

971 
lhs
[1][
i
+1][
j
][
k
] =†hs[1][i+1][j][k] - 
comz4
;

972 
lhs
[2][
i
+1][
j
][
k
] =†hs[2][i+1][j][k] + 
comz5
;

980 #´agm¨
omp
 

981 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

982 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

983 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

984 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

985 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

986 
d‰x2
 * 
¥“d
[
i
-1][
j
][
k
];

987 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

988 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

989 
d‰x2
 * 
¥“d
[
i
+1][
j
][
k
];

990 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

991 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

992 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

993 
d‰x2
 * 
¥“d
[
i
-1][
j
][
k
];

994 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

995 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

996 
d‰x2
 * 
¥“d
[
i
+1][
j
][
k
];

997 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1001 
	}
}

1006 
	$lhsy
() {

1015 
ru1
;

1016 
i
, 
j
, 
k
;

1021 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1022 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1023 #´agm¨
omp
 

1024 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1025 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

1026 
cv
[
j
] = 
vs
[
i
][j][
k
];

1027 
rhoq
[
j
] = 
	`max
(
dy3
 + 
cÚ43
 * 
ru1
,

1028 
	`max
(
dy5
 + 
c1c5
*
ru1
,

1029 
	`max
(
dymax
 + 
ru1
,

1030 
dy1
)));

1033 #´agm¨
omp
 

1034 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1035 
lhs
[0][
i
][
j
][
k
] = 0.0;

1036 
lhs
[1][
i
][
j
][
k
] = -
d‰y2
 * 
cv
[j-1] - 
d‰y1
 * 
rhoq
[j-1];

1037 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰y1
 * 
rhoq
[j];

1038 
lhs
[3][
i
][
j
][
k
] = 
d‰y2
 * 
cv
[j+1] - 
d‰y1
 * 
rhoq
[j+1];

1039 
lhs
[4][
i
][
j
][
k
] = 0.0;

1048 
j
 = 1;

1049 #´agm¨
omp
 
nowa™


1050 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1051 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1053 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

1054 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1055 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1057 
lhs
[1][
i
][
j
+1][
k
] =†hs[1][i][j+1][k] - 
comz4
;

1058 
lhs
[2][
i
][
j
+1][
k
] =†hs[2][i][j+1][k] + 
comz6
;

1059 
lhs
[3][
i
][
j
+1][
k
] =†hs[3][i][j+1][k] - 
comz4
;

1060 
lhs
[4][
i
][
j
+1][
k
] =†hs[4][i][j+1][k] + 
comz1
;

1064 #´agm¨
omp
 
nowa™


1065 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1066 
j
 = 3; j <ğ
grid_pošts
[1]-4; j++) {

1067 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1068 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1069 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1070 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1071 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1072 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1077 
j
 = 
grid_pošts
[1]-3;

1078 #´agm¨
omp
 

1079 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1080 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1081 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1082 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1083 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1084 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1086 
lhs
[0][
i
][
j
+1][
k
] =†hs[0][i][j+1][k] + 
comz1
;

1087 
lhs
[1][
i
][
j
+1][
k
] =†hs[1][i][j+1][k] - 
comz4
;

1088 
lhs
[2][
i
][
j
+1][
k
] =†hs[2][i][j+1][k] + 
comz5
;

1095 #´agm¨
omp
 

1096 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1097 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1098 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1099 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

1100 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

1101 
d‰y2
 * 
¥“d
[
i
][
j
-1][
k
];

1102 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

1103 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

1104 
d‰y2
 * 
¥“d
[
i
][
j
+1][
k
];

1105 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

1106 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

1107 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

1108 
d‰y2
 * 
¥“d
[
i
][
j
-1][
k
];

1109 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

1110 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

1111 
d‰y2
 * 
¥“d
[
i
][
j
+1][
k
];

1112 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1116 
	}
}

1121 
	$lhsz
() {

1130 
ru1
;

1131 
i
, 
j
, 
k
;

1136 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1137 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1138 #´agm¨
omp
 

1139 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1140 
ru1
 = 
c3c4
*
rho_i
[
i
][
j
][
k
];

1141 
cv
[
k
] = 
ws
[
i
][
j
][k];

1142 
rhos
[
k
] = 
	`max
(
dz4
 + 
cÚ43
 * 
ru1
,

1143 
	`max
(
dz5
 + 
c1c5
 * 
ru1
,

1144 
	`max
(
dzmax
 + 
ru1
,

1145 
dz1
)));

1148 #´agm¨
omp
 

1149 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1150 
lhs
[0][
i
][
j
][
k
] = 0.0;

1151 
lhs
[1][
i
][
j
][
k
] = -
d‰z2
 * 
cv
[k-1] - 
d‰z1
 * 
rhos
[k-1];

1152 
lhs
[2][
i
][
j
][
k
] = 1.0 + 
c2d‰z1
 * 
rhos
[k];

1153 
lhs
[3][
i
][
j
][
k
] = 
d‰z2
 * 
cv
[k+1] - 
d‰z1
 * 
rhos
[k+1];

1154 
lhs
[4][
i
][
j
][
k
] = 0.0;

1163 
k
 = 1;

1164 #´agm¨
omp
 
nowa™


1165 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1166 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1167 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz5
;

1168 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1169 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1171 
lhs
[1][
i
][
j
][
k
+1] =†hs[1][i][j][k+1] - 
comz4
;

1172 
lhs
[2][
i
][
j
][
k
+1] =†hs[2][i][j][k+1] + 
comz6
;

1173 
lhs
[3][
i
][
j
][
k
+1] =†hs[3][i][j][k+1] - 
comz4
;

1174 
lhs
[4][
i
][
j
][
k
+1] =†hs[4][i][j][k+1] + 
comz1
;

1178 #´agm¨
omp
 
nowa™


1179 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1180 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1181 
k
 = 3; k <ğ
grid_pošts
[2]-4; k++) {

1182 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1183 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1184 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1185 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1186 
lhs
[4][
i
][
j
][
k
] =†hs[4][i][j][k] + 
comz1
;

1191 
k
 = 
grid_pošts
[2]-3;

1192 #´agm¨
omp
 

1193 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1194 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1195 
lhs
[0][
i
][
j
][
k
] =†hs[0][i][j][k] + 
comz1
;

1196 
lhs
[1][
i
][
j
][
k
] =†hs[1][i][j][k] - 
comz4
;

1197 
lhs
[2][
i
][
j
][
k
] =†hs[2][i][j][k] + 
comz6
;

1198 
lhs
[3][
i
][
j
][
k
] =†hs[3][i][j][k] - 
comz4
;

1200 
lhs
[0][
i
][
j
][
k
+1] =†hs[0][i][j][k+1] + 
comz1
;

1201 
lhs
[1][
i
][
j
][
k
+1] =†hs[1][i][j][k+1] - 
comz4
;

1202 
lhs
[2][
i
][
j
][
k
+1] =†hs[2][i][j][k+1] + 
comz5
;

1209 #´agm¨
omp
 

1210 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1211 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1212 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1213 
lhs
[0+5][
i
][
j
][
k
] =†hs[0][i][j][k];

1214 
lhs
[1+5][
i
][
j
][
k
] =†hs[1][i][j][k] -

1215 
d‰z2
 * 
¥“d
[
i
][
j
][
k
-1];

1216 
lhs
[2+5][
i
][
j
][
k
] =†hs[2][i][j][k];

1217 
lhs
[3+5][
i
][
j
][
k
] =†hs[3][i][j][k] +

1218 
d‰z2
 * 
¥“d
[
i
][
j
][
k
+1];

1219 
lhs
[4+5][
i
][
j
][
k
] =†hs[4][i][j][k];

1220 
lhs
[0+10][
i
][
j
][
k
] =†hs[0][i][j][k];

1221 
lhs
[1+10][
i
][
j
][
k
] =†hs[1][i][j][k] +

1222 
d‰z2
 * 
¥“d
[
i
][
j
][
k
-1];

1223 
lhs
[2+10][
i
][
j
][
k
] =†hs[2][i][j][k];

1224 
lhs
[3+10][
i
][
j
][
k
] =†hs[3][i][j][k] -

1225 
d‰z2
 * 
¥“d
[
i
][
j
][
k
+1];

1226 
lhs
[4+10][
i
][
j
][
k
] =†hs[4][i][j][k];

1230 
	}
}

1235 
	$nšvr
() {

1244 
i
, 
j
, 
k
;

1245 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
t1
, 
t2
;

1246 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
r1
,
r2
,
r3
,
r4
,
r5
,
t1
,
t2
)

1247 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1248 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1249 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1251 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1252 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1253 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1254 
r4
 = 
rhs
[3][
i
][
j
][
k
];

1255 
r5
 = 
rhs
[4][
i
][
j
][
k
];

1257 
t1
 = 
bt
 * 
r3
;

1258 
t2
 = 0.5 * ( 
r4
 + 
r5
 );

1260 
rhs
[0][
i
][
j
][
k
] = -
r2
;

1261 
rhs
[1][
i
][
j
][
k
] = 
r1
;

1262 
rhs
[2][
i
][
j
][
k
] = 
bt
 * ( 
r4
 - 
r5
 );

1263 
rhs
[3][
i
][
j
][
k
] = -
t1
 + 
t2
;

1264 
rhs
[4][
i
][
j
][
k
] = 
t1
 + 
t2
;

1268 
	}
}

1273 
	$pšvr
() {

1282 
i
, 
j
, 
k
;

1283 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
t1
, 
t2
;

1285 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
,
j
,
k
,
r1
,
r2
,
r3
,
r4
,
r5
,
t1
,
t2
)

1286 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1287 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1288 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1290 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1291 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1292 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1293 
r4
 = 
rhs
[3][
i
][
j
][
k
];

1294 
r5
 = 
rhs
[4][
i
][
j
][
k
];

1296 
t1
 = 
bt
 * 
r1
;

1297 
t2
 = 0.5 * ( 
r4
 + 
r5
 );

1299 
rhs
[0][
i
][
j
][
k
] = 
bt
 * ( 
r4
 - 
r5
 );

1300 
rhs
[1][
i
][
j
][
k
] = -
r3
;

1301 
rhs
[2][
i
][
j
][
k
] = 
r2
;

1302 
rhs
[3][
i
][
j
][
k
] = -
t1
 + 
t2
;

1303 
rhs
[4][
i
][
j
][
k
] = 
t1
 + 
t2
;

1307 
	}
}

1312 
	$compu‹_rhs
() {

1314 #´agm¨
omp
 
·¿Î–


1320 
i
, 
j
, 
k
, 
m
;

1321 
aux
, 
rho_šv
, 
uijk
, 
up1
, 
um1
, 
vijk
, 
vp1
, 
vm1
,

1322 
wijk
, 
wp1
, 
wm1
;

1329 #´agm¨
omp
 
nowa™


1330 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

1331 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1332 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1333 
rho_šv
 = 1.0/
u
[0][
i
][
j
][
k
];

1334 
rho_i
[
i
][
j
][
k
] = 
rho_šv
;

1335 
us
[
i
][
j
][
k
] = 
u
[1][i][j][k] * 
rho_šv
;

1336 
vs
[
i
][
j
][
k
] = 
u
[2][i][j][k] * 
rho_šv
;

1337 
ws
[
i
][
j
][
k
] = 
u
[3][i][j][k] * 
rho_šv
;

1338 
squ¬e
[
i
][
j
][
k
] = 0.5* (
u
[1][i][j][k]*u[1][i][j][k] +

1339 
u
[2][
i
][
j
][
k
]*u[2][i][j][k] +

1340 
u
[3][
i
][
j
][
k
]*u[3][i][j][k] ) * 
rho_šv
;

1341 
qs
[
i
][
j
][
k
] = 
squ¬e
[i][j][k] * 
rho_šv
;

1345 
aux
 = 
c1c2
*
rho_šv
* (
u
[4][
i
][
j
][
k
] - 
squ¬e
[i][j][k]);

1346 
aux
 = 
	`sq¹
(aux);

1347 
¥“d
[
i
][
j
][
k
] = 
aux
;

1348 
ašv
[
i
][
j
][
k
] = 1.0/
aux
;

1359 
m
 = 0; m < 5; m++) {

1360 #´agm¨
omp
 

1361 
i
 = 0; i <ğ
grid_pošts
[0]-1; i++) {

1362 
j
 = 0; j <ğ
grid_pošts
[1]-1; j++) {

1363 
k
 = 0; k <ğ
grid_pošts
[2]-1; k++) {

1364 
rhs
[
m
][
i
][
j
][
k
] = 
fÜcšg
[m][i][j][k];

1373 #´agm¨
omp
 

1374 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1375 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1376 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1377 
uijk
 = 
us
[
i
][
j
][
k
];

1378 
up1
 = 
us
[
i
+1][
j
][
k
];

1379 
um1
 = 
us
[
i
-1][
j
][
k
];

1381 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dx1tx1
 *

1382 (
u
[0][
i
+1][
j
][
k
] - 2.0*u[0][i][j][k] +

1383 
u
[0][
i
-1][
j
][
k
]) -

1384 
tx2
 * (
u
[1][
i
+1][
j
][
k
] - u[1][i-1][j][k]);

1385 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dx2tx1
 *

1386 (
u
[1][
i
+1][
j
][
k
] - 2.0*u[1][i][j][k] +

1387 
u
[1][
i
-1][
j
][
k
]) +

1388 
xxcÚ2
*
cÚ43
 * (
up1
 - 2.0*
uijk
 + 
um1
) -

1389 
tx2
 * (
u
[1][
i
+1][
j
][
k
]*
up1
 -

1390 
u
[1][
i
-1][
j
][
k
]*
um1
 +

1391 (
u
[4][
i
+1][
j
][
k
]- 
squ¬e
[i+1][j][k]-

1392 
u
[4][
i
-1][
j
][
k
]+ 
squ¬e
[i-1][j][k])*

1393 
c2
);

1395 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dx3tx1
 *

1396 (
u
[2][
i
+1][
j
][
k
] - 2.0*u[2][i][j][k] +

1397 
u
[2][
i
-1][
j
][
k
]) +

1398 
xxcÚ2
 * (
vs
[
i
+1][
j
][
k
] - 2.0*vs[i][j][k] +

1399 
vs
[
i
-1][
j
][
k
]) -

1400 
tx2
 * (
u
[2][
i
+1][
j
][
k
]*
up1
 -

1401 
u
[2][
i
-1][
j
][
k
]*
um1
);

1403 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dx4tx1
 *

1404 (
u
[3][
i
+1][
j
][
k
] - 2.0*u[3][i][j][k] +

1405 
u
[3][
i
-1][
j
][
k
]) +

1406 
xxcÚ2
 * (
ws
[
i
+1][
j
][
k
] - 2.0*ws[i][j][k] +

1407 
ws
[
i
-1][
j
][
k
]) -

1408 
tx2
 * (
u
[3][
i
+1][
j
][
k
]*
up1
 -

1409 
u
[3][
i
-1][
j
][
k
]*
um1
);

1411 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dx5tx1
 *

1412 (
u
[4][
i
+1][
j
][
k
] - 2.0*u[4][i][j][k] +

1413 
u
[4][
i
-1][
j
][
k
]) +

1414 
xxcÚ3
 * (
qs
[
i
+1][
j
][
k
] - 2.0*qs[i][j][k] +

1415 
qs
[
i
-1][
j
][
k
]) +

1416 
xxcÚ4
 * (
up1
*up1 - 2.0*
uijk
*uijk +

1417 
um1
*um1) +

1418 
xxcÚ5
 * (
u
[4][
i
+1][
j
][
k
]*
rho_i
[i+1][j][k] -

1419 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1420 
u
[4][
i
-1][
j
][
k
]*
rho_i
[i-1][j][k]) -

1421 
tx2
 * ( (
c1
*
u
[4][
i
+1][
j
][
k
] -

1422 
c2
*
squ¬e
[
i
+1][
j
][
k
])*
up1
 -

1423 (
c1
*
u
[4][
i
-1][
j
][
k
] -

1424 
c2
*
squ¬e
[
i
-1][
j
][
k
])*
um1
 );

1433 
i
 = 1;

1434 
m
 = 0; m < 5; m++) {

1435 #´agm¨
omp
 

1436 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1437 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1438 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1439 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] +

1440 
u
[
m
][
i
+2][
j
][
k
]);

1444 
i
 = 2;

1445 
m
 = 0; m < 5; m++) {

1446 #´agm¨
omp
 

1447 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1448 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1449 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1450 (-4.0*
u
[
m
][
i
-1][
j
][
k
] + 6.0*u[m][i][j][k] -

1451 4.0*
u
[
m
][
i
+1][
j
][
k
] + u[m][i+2][j][k]);

1456 
m
 = 0; m < 5; m++) {

1457 #´agm¨
omp
 

1458 
i
 = 3*1; i <ğ
grid_pošts
[0]-3*1-1; i++) {

1459 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1460 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1461 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1462 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1463 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] +

1464 
u
[
m
][
i
+2][
j
][
k
] );

1470 
i
 = 
grid_pošts
[0]-3;

1471 
m
 = 0; m < 5; m++) {

1472 #´agm¨
omp
 

1473 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1474 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1475 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1476 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1477 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i+1][j][k] );

1482 
i
 = 
grid_pošts
[0]-2;

1483 
m
 = 0; m < 5; m++) {

1484 #´agm¨
omp
 

1485 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1486 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1487 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1488 Ğ
u
[
m
][
i
-2][
j
][
k
] - 4.0*u[m][i-1][j][k] +

1489 5.0*
u
[
m
][
i
][
j
][
k
] );

1493 #´agm¨
omp
 
b¬r›r


1498 #´agm¨
omp
 

1499 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1500 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1501 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1502 
vijk
 = 
vs
[
i
][
j
][
k
];

1503 
vp1
 = 
vs
[
i
][
j
+1][
k
];

1504 
vm1
 = 
vs
[
i
][
j
-1][
k
];

1505 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dy1ty1
 *

1506 (
u
[0][
i
][
j
+1][
k
] - 2.0*u[0][i][j][k] +

1507 
u
[0][
i
][
j
-1][
k
]) -

1508 
ty2
 * (
u
[2][
i
][
j
+1][
k
] - u[2][i][j-1][k]);

1509 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dy2ty1
 *

1510 (
u
[1][
i
][
j
+1][
k
] - 2.0*u[1][i][j][k] +

1511 
u
[1][
i
][
j
-1][
k
]) +

1512 
yycÚ2
 * (
us
[
i
][
j
+1][
k
] - 2.0*us[i][j][k] +

1513 
us
[
i
][
j
-1][
k
]) -

1514 
ty2
 * (
u
[1][
i
][
j
+1][
k
]*
vp1
 -

1515 
u
[1][
i
][
j
-1][
k
]*
vm1
);

1516 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dy3ty1
 *

1517 (
u
[2][
i
][
j
+1][
k
] - 2.0*u[2][i][j][k] +

1518 
u
[2][
i
][
j
-1][
k
]) +

1519 
yycÚ2
*
cÚ43
 * (
vp1
 - 2.0*
vijk
 + 
vm1
) -

1520 
ty2
 * (
u
[2][
i
][
j
+1][
k
]*
vp1
 -

1521 
u
[2][
i
][
j
-1][
k
]*
vm1
 +

1522 (
u
[4][
i
][
j
+1][
k
] - 
squ¬e
[i][j+1][k] -

1523 
u
[4][
i
][
j
-1][
k
] + 
squ¬e
[i][j-1][k])

1524 *
c2
);

1525 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dy4ty1
 *

1526 (
u
[3][
i
][
j
+1][
k
] - 2.0*u[3][i][j][k] +

1527 
u
[3][
i
][
j
-1][
k
]) +

1528 
yycÚ2
 * (
ws
[
i
][
j
+1][
k
] - 2.0*ws[i][j][k] +

1529 
ws
[
i
][
j
-1][
k
]) -

1530 
ty2
 * (
u
[3][
i
][
j
+1][
k
]*
vp1
 -

1531 
u
[3][
i
][
j
-1][
k
]*
vm1
);

1532 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dy5ty1
 *

1533 (
u
[4][
i
][
j
+1][
k
] - 2.0*u[4][i][j][k] +

1534 
u
[4][
i
][
j
-1][
k
]) +

1535 
yycÚ3
 * (
qs
[
i
][
j
+1][
k
] - 2.0*qs[i][j][k] +

1536 
qs
[
i
][
j
-1][
k
]) +

1537 
yycÚ4
 * (
vp1
*vp1 - 2.0*
vijk
*vijk +

1538 
vm1
*vm1) +

1539 
yycÚ5
 * (
u
[4][
i
][
j
+1][
k
]*
rho_i
[i][j+1][k] -

1540 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1541 
u
[4][
i
][
j
-1][
k
]*
rho_i
[i][j-1][k]) -

1542 
ty2
 * ((
c1
*
u
[4][
i
][
j
+1][
k
] -

1543 
c2
*
squ¬e
[
i
][
j
+1][
k
]è* 
vp1
 -

1544 (
c1
*
u
[4][
i
][
j
-1][
k
] -

1545 
c2
*
squ¬e
[
i
][
j
-1][
k
]è* 
vm1
);

1554 
j
 = 1;

1555 
m
 = 0; m < 5; m++) {

1556 #´agm¨
omp
 

1557 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1558 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1559 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1560 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] +

1561 
u
[
m
][
i
][
j
+2][
k
]);

1566 
j
 = 2;

1567 
m
 = 0; m < 5; m++) {

1568 #´agm¨
omp
 

1569 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1570 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1571 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1572 (-4.0*
u
[
m
][
i
][
j
-1][
k
] + 6.0*u[m][i][j][k] -

1573 4.0*
u
[
m
][
i
][
j
+1][
k
] + u[m][i][j+2][k]);

1578 
m
 = 0; m < 5; m++) {

1579 #´agm¨
omp
 

1580 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1581 
j
 = 3*1; j <ğ
grid_pošts
[1]-3*1-1; j++) {

1582 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1583 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1584 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1585 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] +

1586 
u
[
m
][
i
][
j
+2][
k
] );

1592 
j
 = 
grid_pošts
[1]-3;

1593 
m
 = 0; m < 5; m++) {

1594 #´agm¨
omp
 

1595 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1596 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1597 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1598 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1599 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j+1][k] );

1604 
j
 = 
grid_pošts
[1]-2;

1605 
m
 = 0; m < 5; m++) {

1606 #´agm¨
omp
 

1607 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1608 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1609 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1610 Ğ
u
[
m
][
i
][
j
-2][
k
] - 4.0*u[m][i][j-1][k] +

1611 5.0*
u
[
m
][
i
][
j
][
k
] );

1615 #´agm¨
omp
 
b¬r›r


1620 #´agm¨
omp
 

1621 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1622 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1623 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1624 
wijk
 = 
ws
[
i
][
j
][
k
];

1625 
wp1
 = 
ws
[
i
][
j
][
k
+1];

1626 
wm1
 = 
ws
[
i
][
j
][
k
-1];

1628 
rhs
[0][
i
][
j
][
k
] =„hs[0][i][j][k] + 
dz1tz1
 *

1629 (
u
[0][
i
][
j
][
k
+1] - 2.0*u[0][i][j][k] +

1630 
u
[0][
i
][
j
][
k
-1]) -

1631 
tz2
 * (
u
[3][
i
][
j
][
k
+1] - u[3][i][j][k-1]);

1632 
rhs
[1][
i
][
j
][
k
] =„hs[1][i][j][k] + 
dz2tz1
 *

1633 (
u
[1][
i
][
j
][
k
+1] - 2.0*u[1][i][j][k] +

1634 
u
[1][
i
][
j
][
k
-1]) +

1635 
zzcÚ2
 * (
us
[
i
][
j
][
k
+1] - 2.0*us[i][j][k] +

1636 
us
[
i
][
j
][
k
-1]) -

1637 
tz2
 * (
u
[1][
i
][
j
][
k
+1]*
wp1
 -

1638 
u
[1][
i
][
j
][
k
-1]*
wm1
);

1639 
rhs
[2][
i
][
j
][
k
] =„hs[2][i][j][k] + 
dz3tz1
 *

1640 (
u
[2][
i
][
j
][
k
+1] - 2.0*u[2][i][j][k] +

1641 
u
[2][
i
][
j
][
k
-1]) +

1642 
zzcÚ2
 * (
vs
[
i
][
j
][
k
+1] - 2.0*vs[i][j][k] +

1643 
vs
[
i
][
j
][
k
-1]) -

1644 
tz2
 * (
u
[2][
i
][
j
][
k
+1]*
wp1
 -

1645 
u
[2][
i
][
j
][
k
-1]*
wm1
);

1646 
rhs
[3][
i
][
j
][
k
] =„hs[3][i][j][k] + 
dz4tz1
 *

1647 (
u
[3][
i
][
j
][
k
+1] - 2.0*u[3][i][j][k] +

1648 
u
[3][
i
][
j
][
k
-1]) +

1649 
zzcÚ2
*
cÚ43
 * (
wp1
 - 2.0*
wijk
 + 
wm1
) -

1650 
tz2
 * (
u
[3][
i
][
j
][
k
+1]*
wp1
 -

1651 
u
[3][
i
][
j
][
k
-1]*
wm1
 +

1652 (
u
[4][
i
][
j
][
k
+1] - 
squ¬e
[i][j][k+1] -

1653 
u
[4][
i
][
j
][
k
-1] + 
squ¬e
[i][j][k-1])

1654 *
c2
);

1655 
rhs
[4][
i
][
j
][
k
] =„hs[4][i][j][k] + 
dz5tz1
 *

1656 (
u
[4][
i
][
j
][
k
+1] - 2.0*u[4][i][j][k] +

1657 
u
[4][
i
][
j
][
k
-1]) +

1658 
zzcÚ3
 * (
qs
[
i
][
j
][
k
+1] - 2.0*qs[i][j][k] +

1659 
qs
[
i
][
j
][
k
-1]) +

1660 
zzcÚ4
 * (
wp1
*wp1 - 2.0*
wijk
*wijk +

1661 
wm1
*wm1) +

1662 
zzcÚ5
 * (
u
[4][
i
][
j
][
k
+1]*
rho_i
[i][j][k+1] -

1663 2.0*
u
[4][
i
][
j
][
k
]*
rho_i
[i][j][k] +

1664 
u
[4][
i
][
j
][
k
-1]*
rho_i
[i][j][k-1]) -

1665 
tz2
 * ( (
c1
*
u
[4][
i
][
j
][
k
+1] -

1666 
c2
*
squ¬e
[
i
][
j
][
k
+1])*
wp1
 -

1667 (
c1
*
u
[4][
i
][
j
][
k
-1] -

1668 
c2
*
squ¬e
[
i
][
j
][
k
-1])*
wm1
);

1677 
k
 = 1;

1678 
m
 = 0; m < 5; m++) {

1679 #´agm¨
omp
 

1680 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1681 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1682 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k]- 
ds¥
 *

1683 Ğ5.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] +

1684 
u
[
m
][
i
][
j
][
k
+2]);

1689 
k
 = 2;

1690 
m
 = 0; m < 5; m++) {

1691 #´agm¨
omp
 

1692 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1693 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1694 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1695 (-4.0*
u
[
m
][
i
][
j
][
k
-1] + 6.0*u[m][i][j][k] -

1696 4.0*
u
[
m
][
i
][
j
][
k
+1] + u[m][i][j][k+2]);

1701 
m
 = 0; m < 5; m++) {

1702 #´agm¨
omp
 

1703 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1704 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1705 
k
 = 3*1; k <ğ
grid_pošts
[2]-3*1-1; k++) {

1706 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1707 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1708 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] +

1709 
u
[
m
][
i
][
j
][
k
+2] );

1715 
k
 = 
grid_pošts
[2]-3;

1716 
m
 = 0; m < 5; m++) {

1717 #´agm¨
omp
 

1718 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1719 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1720 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1721 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1722 6.0*
u
[
m
][
i
][
j
][
k
] - 4.0*u[m][i][j][k+1] );

1727 
k
 = 
grid_pošts
[2]-2;

1728 
m
 = 0; m < 5; m++) {

1729 #´agm¨
omp
 

1730 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1731 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1732 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] - 
ds¥
 *

1733 Ğ
u
[
m
][
i
][
j
][
k
-2] - 4.0*u[m][i][j][k-1] +

1734 5.0*
u
[
m
][
i
][
j
][
k
] );

1739 
m
 = 0; m < 5; m++) {

1740 #´agm¨
omp
 

1741 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1742 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1743 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1744 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] * 
dt
;

1751 
	}
}

1756 
	$£t_cÚ¡ªts
() {

1761 
û
[0][0] = 2.0;

1762 
û
[1][0] = 0.0;

1763 
û
[2][0] = 0.0;

1764 
û
[3][0] = 4.0;

1765 
û
[4][0] = 5.0;

1766 
û
[5][0] = 3.0;

1767 
û
[6][0] = 0.5;

1768 
û
[7][0] = 0.02;

1769 
û
[8][0] = 0.01;

1770 
û
[9][0] = 0.03;

1771 
û
[10][0] = 0.5;

1772 
û
[11][0] = 0.4;

1773 
û
[12][0] = 0.3;

1775 
û
[0][1] = 1.0;

1776 
û
[1][1] = 0.0;

1777 
û
[2][1] = 0.0;

1778 
û
[3][1] = 0.0;

1779 
û
[4][1] = 1.0;

1780 
û
[5][1] = 2.0;

1781 
û
[6][1] = 3.0;

1782 
û
[7][1] = 0.01;

1783 
û
[8][1] = 0.03;

1784 
û
[9][1] = 0.02;

1785 
û
[10][1] = 0.4;

1786 
û
[11][1] = 0.3;

1787 
û
[12][1] = 0.5;

1789 
û
[0][2] = 2.0;

1790 
û
[1][2] = 2.0;

1791 
û
[2][2] = 0.0;

1792 
û
[3][2] = 0.0;

1793 
û
[4][2] = 0.0;

1794 
û
[5][2] = 2.0;

1795 
û
[6][2] = 3.0;

1796 
û
[7][2] = 0.04;

1797 
û
[8][2] = 0.03;

1798 
û
[9][2] = 0.05;

1799 
û
[10][2] = 0.3;

1800 
û
[11][2] = 0.5;

1801 
û
[12][2] = 0.4;

1803 
û
[0][3] = 2.0;

1804 
û
[1][3] = 2.0;

1805 
û
[2][3] = 0.0;

1806 
û
[3][3] = 0.0;

1807 
û
[4][3] = 0.0;

1808 
û
[5][3] = 2.0;

1809 
û
[6][3] = 3.0;

1810 
û
[7][3] = 0.03;

1811 
û
[8][3] = 0.05;

1812 
û
[9][3] = 0.04;

1813 
û
[10][3] = 0.2;

1814 
û
[11][3] = 0.1;

1815 
û
[12][3] = 0.3;

1817 
û
[0][4] = 5.0;

1818 
û
[1][4] = 4.0;

1819 
û
[2][4] = 3.0;

1820 
û
[3][4] = 2.0;

1821 
û
[4][4] = 0.1;

1822 
û
[5][4] = 0.4;

1823 
û
[6][4] = 0.3;

1824 
û
[7][4] = 0.05;

1825 
û
[8][4] = 0.04;

1826 
û
[9][4] = 0.03;

1827 
û
[10][4] = 0.1;

1828 
û
[11][4] = 0.3;

1829 
û
[12][4] = 0.2;

1831 
c1
 = 1.4;

1832 
c2
 = 0.4;

1833 
c3
 = 0.1;

1834 
c4
 = 1.0;

1835 
c5
 = 1.4;

1837 
bt
 = 
	`sq¹
(0.5);

1839 
dnxm1
 = 1.0 / ()(
grid_pošts
[0]-1);

1840 
dnym1
 = 1.0 / ()(
grid_pošts
[1]-1);

1841 
dnzm1
 = 1.0 / ()(
grid_pošts
[2]-1);

1843 
c1c2
 = 
c1
 * 
c2
;

1844 
c1c5
 = 
c1
 * 
c5
;

1845 
c3c4
 = 
c3
 * 
c4
;

1846 
c1345
 = 
c1c5
 * 
c3c4
;

1848 
cÚz1
 = (1.0-
c1c5
);

1850 
tx1
 = 1.0 / (
dnxm1
 * dnxm1);

1851 
tx2
 = 1.0 / (2.0 * 
dnxm1
);

1852 
tx3
 = 1.0 / 
dnxm1
;

1854 
ty1
 = 1.0 / (
dnym1
 * dnym1);

1855 
ty2
 = 1.0 / (2.0 * 
dnym1
);

1856 
ty3
 = 1.0 / 
dnym1
;

1858 
tz1
 = 1.0 / (
dnzm1
 * dnzm1);

1859 
tz2
 = 1.0 / (2.0 * 
dnzm1
);

1860 
tz3
 = 1.0 / 
dnzm1
;

1862 
dx1
 = 0.75;

1863 
dx2
 = 0.75;

1864 
dx3
 = 0.75;

1865 
dx4
 = 0.75;

1866 
dx5
 = 0.75;

1868 
dy1
 = 0.75;

1869 
dy2
 = 0.75;

1870 
dy3
 = 0.75;

1871 
dy4
 = 0.75;

1872 
dy5
 = 0.75;

1874 
dz1
 = 1.0;

1875 
dz2
 = 1.0;

1876 
dz3
 = 1.0;

1877 
dz4
 = 1.0;

1878 
dz5
 = 1.0;

1880 
dxmax
 = 
	`max
(
dx3
, 
dx4
);

1881 
dymax
 = 
	`max
(
dy2
, 
dy4
);

1882 
dzmax
 = 
	`max
(
dz2
, 
dz3
);

1884 
ds¥
 = 0.25 * 
	`max
(
dx1
, max(
dy1
, 
dz1
) );

1886 
c4ds¥
 = 4.0 * 
ds¥
;

1887 
c5ds¥
 = 5.0 * 
ds¥
;

1889 
d‰x1
 = 
dt
*
tx1
;

1890 
d‰x2
 = 
dt
*
tx2
;

1891 
d‰y1
 = 
dt
*
ty1
;

1892 
d‰y2
 = 
dt
*
ty2
;

1893 
d‰z1
 = 
dt
*
tz1
;

1894 
d‰z2
 = 
dt
*
tz2
;

1896 
c2d‰x1
 = 2.0*
d‰x1
;

1897 
c2d‰y1
 = 2.0*
d‰y1
;

1898 
c2d‰z1
 = 2.0*
d‰z1
;

1900 
dtds¥
 = 
dt
*
ds¥
;

1902 
comz1
 = 
dtds¥
;

1903 
comz4
 = 4.0*
dtds¥
;

1904 
comz5
 = 5.0*
dtds¥
;

1905 
comz6
 = 6.0*
dtds¥
;

1907 
c3c4tx3
 = 
c3c4
*
tx3
;

1908 
c3c4ty3
 = 
c3c4
*
ty3
;

1909 
c3c4tz3
 = 
c3c4
*
tz3
;

1911 
dx1tx1
 = 
dx1
*
tx1
;

1912 
dx2tx1
 = 
dx2
*
tx1
;

1913 
dx3tx1
 = 
dx3
*
tx1
;

1914 
dx4tx1
 = 
dx4
*
tx1
;

1915 
dx5tx1
 = 
dx5
*
tx1
;

1917 
dy1ty1
 = 
dy1
*
ty1
;

1918 
dy2ty1
 = 
dy2
*
ty1
;

1919 
dy3ty1
 = 
dy3
*
ty1
;

1920 
dy4ty1
 = 
dy4
*
ty1
;

1921 
dy5ty1
 = 
dy5
*
ty1
;

1923 
dz1tz1
 = 
dz1
*
tz1
;

1924 
dz2tz1
 = 
dz2
*
tz1
;

1925 
dz3tz1
 = 
dz3
*
tz1
;

1926 
dz4tz1
 = 
dz4
*
tz1
;

1927 
dz5tz1
 = 
dz5
*
tz1
;

1929 
c2iv
 = 2.5;

1930 
cÚ43
 = 4.0/3.0;

1931 
cÚ16
 = 1.0/6.0;

1933 
xxcÚ1
 = 
c3c4tx3
*
cÚ43
*
tx3
;

1934 
xxcÚ2
 = 
c3c4tx3
*
tx3
;

1935 
xxcÚ3
 = 
c3c4tx3
*
cÚz1
*
tx3
;

1936 
xxcÚ4
 = 
c3c4tx3
*
cÚ16
*
tx3
;

1937 
xxcÚ5
 = 
c3c4tx3
*
c1c5
*
tx3
;

1939 
yycÚ1
 = 
c3c4ty3
*
cÚ43
*
ty3
;

1940 
yycÚ2
 = 
c3c4ty3
*
ty3
;

1941 
yycÚ3
 = 
c3c4ty3
*
cÚz1
*
ty3
;

1942 
yycÚ4
 = 
c3c4ty3
*
cÚ16
*
ty3
;

1943 
yycÚ5
 = 
c3c4ty3
*
c1c5
*
ty3
;

1945 
zzcÚ1
 = 
c3c4tz3
*
cÚ43
*
tz3
;

1946 
zzcÚ2
 = 
c3c4tz3
*
tz3
;

1947 
zzcÚ3
 = 
c3c4tz3
*
cÚz1
*
tz3
;

1948 
zzcÚ4
 = 
c3c4tz3
*
cÚ16
*
tz3
;

1949 
zzcÚ5
 = 
c3c4tz3
*
c1c5
*
tz3
;

1950 
	}
}

1955 
	$txšvr
() {

1964 
i
, 
j
, 
k
;

1965 
t1
, 
t2
, 
t3
, 
ac
, 
ru1
, 
uu
, 
vv
, 
ww
, 
r1
, 
r2
, 
r3
,

1966 
r4
, 
r5
, 
ac2šv
;

1968 #´agm¨
omp
 

1969 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

1970 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

1971 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

1973 
ru1
 = 
rho_i
[
i
][
j
][
k
];

1974 
uu
 = 
us
[
i
][
j
][
k
];

1975 
vv
 = 
vs
[
i
][
j
][
k
];

1976 
ww
 = 
ws
[
i
][
j
][
k
];

1977 
ac
 = 
¥“d
[
i
][
j
][
k
];

1978 
ac2šv
 = 
ašv
[
i
][
j
][
k
]*ainv[i][j][k];

1980 
r1
 = 
rhs
[0][
i
][
j
][
k
];

1981 
r2
 = 
rhs
[1][
i
][
j
][
k
];

1982 
r3
 = 
rhs
[2][
i
][
j
][
k
];

1983 
r4
 = 
rhs
[3][
i
][
j
][
k
];

1984 
r5
 = 
rhs
[4][
i
][
j
][
k
];

1986 
t1
 = 
c2
 * 
ac2šv
 * ( 
qs
[
i
][
j
][
k
]*
r1
 - 
uu
*
r2
 -

1987 
vv
*
r3
 - 
ww
*
r4
 + 
r5
 );

1988 
t2
 = 
bt
 * 
ru1
 * ( 
uu
 * 
r1
 - 
r2
 );

1989 
t3
 = ( 
bt
 * 
ru1
 * 
ac
 ) * 
t1
;

1991 
rhs
[0][
i
][
j
][
k
] = 
r1
 - 
t1
;

1992 
rhs
[1][
i
][
j
][
k
] = - 
ru1
 * ( 
ww
*
r1
 - 
r4
 );

1993 
rhs
[2][
i
][
j
][
k
] = 
ru1
 * ( 
vv
*
r1
 - 
r3
 );

1994 
rhs
[3][
i
][
j
][
k
] = - 
t2
 + 
t3
;

1995 
rhs
[4][
i
][
j
][
k
] = 
t2
 + 
t3
;

1999 
	}
}

2004 
	$tz‘¬
() {

2013 
i
, 
j
, 
k
;

2014 
t1
, 
t2
, 
t3
, 
ac
, 
xv–
, 
yv–
, 
zv–
, 
r1
, 
r2
, 
r3
,

2015 
r4
, 
r5
, 
btuz
, 
acšv
, 
ac2u
, 
uzik1
;

2017 #´agm¨
omp
 
	`´iv©e
(
i
,
j
,
k
,
t1
,
t2
,
t3
,
ac
,
xv–
,
yv–
,
zv–
,
r1
,
r2
,
r3
,
r4
,
r5
,
btuz
,
ac2u
,
uzik1
)

2018 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2019 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2020 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2022 
xv–
 = 
us
[
i
][
j
][
k
];

2023 
yv–
 = 
vs
[
i
][
j
][
k
];

2024 
zv–
 = 
ws
[
i
][
j
][
k
];

2025 
ac
 = 
¥“d
[
i
][
j
][
k
];

2026 
acšv
 = 
ašv
[
i
][
j
][
k
];

2028 
ac2u
 = 
ac
*ac;

2030 
r1
 = 
rhs
[0][
i
][
j
][
k
];

2031 
r2
 = 
rhs
[1][
i
][
j
][
k
];

2032 
r3
 = 
rhs
[2][
i
][
j
][
k
];

2033 
r4
 = 
rhs
[3][
i
][
j
][
k
];

2034 
r5
 = 
rhs
[4][
i
][
j
][
k
];

2036 
uzik1
 = 
u
[0][
i
][
j
][
k
];

2037 
btuz
 = 
bt
 * 
uzik1
;

2039 
t1
 = 
btuz
*
acšv
 * (
r4
 + 
r5
);

2040 
t2
 = 
r3
 + 
t1
;

2041 
t3
 = 
btuz
 * (
r4
 - 
r5
);

2043 
rhs
[0][
i
][
j
][
k
] = 
t2
;

2044 
rhs
[1][
i
][
j
][
k
] = -
uzik1
*
r2
 + 
xv–
*
t2
;

2045 
rhs
[2][
i
][
j
][
k
] = 
uzik1
*
r1
 + 
yv–
*
t2
;

2046 
rhs
[3][
i
][
j
][
k
] = 
zv–
*
t2
 + 
t3
;

2047 
rhs
[4][
i
][
j
][
k
] = 
uzik1
*(-
xv–
*
r2
 + 
yv–
*
r1
) +

2048 
qs
[
i
][
j
][
k
]*
t2
 + 
c2iv
*
ac2u
*
t1
 + 
zv–
*
t3
;

2052 
	}
}

2058 
	$v”ify
(
no_time_¡•s
, *
şass
, 
boŞ—n
 *
v”if›d
) {

2067 
xü»f
[5],
xû»f
[5],
xüdif
[5],
xûdif
[5],

2068 
•sÚ
, 
xû
[5], 
xü
[5], 
dŒef
;

2069 
m
;

2074 
•sÚ
 = 1.0e-08;

2080 
	`”rÜ_nÜm
(
xû
);

2081 
	`compu‹_rhs
();

2083 
	`rhs_nÜm
(
xü
);

2085 
m
 = 0; m < 5; m++) {

2086 
xü
[
m
] = xü[m] / 
dt
;

2089 *
şass
 = 'U';

2090 *
v”if›d
 = 
TRUE
;

2092 
m
 = 0; m < 5; m++) {

2093 
xü»f
[
m
] = 1.0;

2094 
xû»f
[
m
] = 1.0;

2100 iàĞ
grid_pošts
[0] == 12 &&

2101 
grid_pošts
[1] == 12 &&

2102 
grid_pošts
[2] == 12 &&

2103 
no_time_¡•s
 == 100) {

2105 *
şass
 = 'S';

2106 
dŒef
 = 1.5e-2;

2111 
xü»f
[0] = 2.7470315451339479e-02;

2112 
xü»f
[1] = 1.0360746705285417e-02;

2113 
xü»f
[2] = 1.6235745065095532e-02;

2114 
xü»f
[3] = 1.5840557224455615e-02;

2115 
xü»f
[4] = 3.4849040609362460e-02;

2120 
xû»f
[0] = 2.7289258557377227e-05;

2121 
xû»f
[1] = 1.0364446640837285e-05;

2122 
xû»f
[2] = 1.6154798287166471e-05;

2123 
xû»f
[3] = 1.5750704994480102e-05;

2124 
xû»f
[4] = 3.4177666183390531e-05;

2130 } ià(
grid_pošts
[0] == 36 &&

2131 
grid_pošts
[1] == 36 &&

2132 
grid_pošts
[2] == 36 &&

2133 
no_time_¡•s
 == 400) {

2135 *
şass
 = 'W';

2136 
dŒef
 = 1.5e-3;

2141 
xü»f
[0] = 0.1893253733584e-02;

2142 
xü»f
[1] = 0.1717075447775e-03;

2143 
xü»f
[2] = 0.2778153350936e-03;

2144 
xü»f
[3] = 0.2887475409984e-03;

2145 
xü»f
[4] = 0.3143611161242e-02;

2150 
xû»f
[0] = 0.7542088599534e-04;

2151 
xû»f
[1] = 0.6512852253086e-05;

2152 
xû»f
[2] = 0.1049092285688e-04;

2153 
xû»f
[3] = 0.1128838671535e-04;

2154 
xû»f
[4] = 0.1212845639773e-03;

2159 } ià(
grid_pošts
[0] == 64 &&

2160 
grid_pošts
[1] == 64 &&

2161 
grid_pošts
[2] == 64 &&

2162 
no_time_¡•s
 == 400 ) {

2164 *
şass
 = 'A';

2165 
dŒef
 = 1.5e-3;

2170 
xü»f
[0] = 2.4799822399300195;

2171 
xü»f
[1] = 1.1276337964368832;

2172 
xü»f
[2] = 1.5028977888770491;

2173 
xü»f
[3] = 1.4217816211695179;

2174 
xü»f
[4] = 2.1292113035138280;

2179 
xû»f
[0] = 1.0900140297820550e-04;

2180 
xû»f
[1] = 3.7343951769282091e-05;

2181 
xû»f
[2] = 5.0092785406541633e-05;

2182 
xû»f
[3] = 4.7671093939528255e-05;

2183 
xû»f
[4] = 1.3621613399213001e-04;

2189 } ià(
grid_pošts
[0] == 102 &&

2190 
grid_pošts
[1] == 102 &&

2191 
grid_pošts
[2] == 102 &&

2192 
no_time_¡•s
 == 400) {

2194 *
şass
 = 'B';

2195 
dŒef
 = 1.0e-3;

2200 
xü»f
[0] = 0.6903293579998e+02;

2201 
xü»f
[1] = 0.3095134488084e+02;

2202 
xü»f
[2] = 0.4103336647017e+02;

2203 
xü»f
[3] = 0.3864769009604e+02;

2204 
xü»f
[4] = 0.5643482272596e+02;

2209 
xû»f
[0] = 0.9810006190188e-02;

2210 
xû»f
[1] = 0.1022827905670e-02;

2211 
xû»f
[2] = 0.1720597911692e-02;

2212 
xû»f
[3] = 0.1694479428231e-02;

2213 
xû»f
[4] = 0.1847456263981e-01;

2220 } ià(
grid_pošts
[0] == 162 &&

2221 
grid_pošts
[1] == 162 &&

2222 
grid_pošts
[2] == 162 &&

2223 
no_time_¡•s
 == 400) {

2225 *
şass
 = 'C';

2226 
dŒef
 = 0.67e-3;

2231 
xü»f
[0] = 0.5881691581829e+03;

2232 
xü»f
[1] = 0.2454417603569e+03;

2233 
xü»f
[2] = 0.3293829191851e+03;

2234 
xü»f
[3] = 0.3081924971891e+03;

2235 
xü»f
[4] = 0.4597223799176e+03;

2240 
xû»f
[0] = 0.2598120500183e+00;

2241 
xû»f
[1] = 0.2590888922315e-01;

2242 
xû»f
[2] = 0.5132886416320e-01;

2243 
xû»f
[3] = 0.4806073419454e-01;

2244 
xû»f
[4] = 0.5483377491301e+00;

2247 *
v”if›d
 = 
FALSE
;

2258 
m
 = 0; m < 5; m++) {

2260 
xüdif
[
m
] = 
	`çbs
((
xü
[m]-
xü»f
[m])/xcrref[m]) ;

2261 
xûdif
[
m
] = 
	`çbs
((
xû
[m]-
xû»f
[m])/xceref[m]);

2269 ià(*
şass
 != 'U') {

2270 
	`´štf
(" V”ifiÿtiÚ bešg…”fÜmed fÜ cÏs %1c\n", *
şass
);

2271 
	`´štf
("‡ccu¿cy s‘tšg fÜƒpsÚ = %20.13e\n", 
•sÚ
);

2273 ià(
	`çbs
(
dt
-
dŒef
è> 
•sÚ
) {

2274 *
v”if›d
 = 
FALSE
;

2275 *
şass
 = 'U';

2276 
	`´štf
(" DT dÛ nÙ m©chh»ã»nû v®uoà%15.8e\n", 
dŒef
);

2279 
	`´štf
(" Unknown class\n");

2282 ià(*
şass
 != 'U') {

2283 
	`´štf
(" Comparison of RMS-norms of„esidual\n");

2285 
	`´štf
(" RMS-norms of„esidual\n");

2288 
m
 = 0; m < 5; m++) {

2289 ià(*
şass
 == 'U') {

2290 
	`´štf
(" %2d%20.13e\n", 
m
, 
xü
[m]);

2291 } ià(
xüdif
[
m
] > 
•sÚ
) {

2292 *
v”if›d
 = 
FALSE
;

2293 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2294 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

2296 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2297 
m
,
xü
[m],
xü»f
[m],
xüdif
[m]);

2301 ià(*
şass
 != 'U') {

2302 
	`´štf
(" Comparison of RMS-norms of solutionƒrror\n");

2304 
	`´štf
(" RMS-norms of solutionƒrror\n");

2307 
m
 = 0; m < 5; m++) {

2308 ià(*
şass
 == 'U') {

2309 
	`´štf
(" %2d%20.13e\n", 
m
, 
xû
[m]);

2310 } ià(
xûdif
[
m
] > 
•sÚ
) {

2311 *
v”if›d
 = 
FALSE
;

2312 
	`´štf
(" FAILURE: %2d%20.13e%20.13e%20.13e\n",

2313 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

2315 
	`´štf
(" %2d%20.13e%20.13e%20.13e\n",

2316 
m
,
xû
[m],
xû»f
[m],
xûdif
[m]);

2320 ià(*
şass
 == 'U') {

2321 
	`´štf
(" No„eference values…rovided\n");

2322 
	`´štf
(" No verification…erformed\n");

2323 } ià(*
v”if›d
) {

2324 
	`´štf
(" Verification Successful\n");

2326 
	`´štf
(" Verification failed\n");

2328 
	}
}

2333 
	$x_sŞve
() {

2335 #´agm¨
omp
 
·¿Î–


2348 
i
, 
j
, 
k
, 
n
, 
i1
, 
i2
, 
m
;

2349 
çc1
, 
çc2
;

2354 
	`lhsx
();

2359 
n
 = 0;

2360 
i
 = 0; i <ğ
grid_pošts
[0]-3; i++) {

2361 
i1
 = 
i
 + 1;

2362 
i2
 = 
i
 + 2;

2363 #´agm¨
omp
 

2364 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2365 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2366 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2367 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2368 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2369 
m
 = 0; m < 3; m++) {

2370 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2372 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2373 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2374 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2375 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2376 
m
 = 0; m < 3; m++) {

2377 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2378 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2380 
lhs
[
n
+1][
i2
][
j
][
k
] =†hs[n+1][i2][j][k] -

2381 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+3][
i
][j][k];

2382 
lhs
[
n
+2][
i2
][
j
][
k
] =†hs[n+2][i2][j][k] -

2383 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+4][
i
][j][k];

2384 
m
 = 0; m < 3; m++) {

2385 
rhs
[
m
][
i2
][
j
][
k
] =„hs[m][i2][j][k] -

2386 
lhs
[
n
+0][
i2
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2398 
i
 = 
grid_pošts
[0]-2;

2399 
i1
 = 
grid_pošts
[0]-1;

2400 #´agm¨
omp
 

2401 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2402 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2403 
çc1
 = 1.0/
lhs
[
n
+2][
i
][
j
][
k
];

2404 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2405 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2406 
m
 = 0; m < 3; m++) {

2407 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2409 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2410 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2411 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2412 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2413 
m
 = 0; m < 3; m++) {

2414 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2415 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2421 
çc2
 = 1./
lhs
[
n
+2][
i1
][
j
][
k
];

2422 
m
 = 0; m < 3; m++) {

2423 
rhs
[
m
][
i1
][
j
][
k
] = 
çc2
*rhs[m][i1][j][k];

2432 
m
 = 3; m < 5; m++) {

2433 
n
 = (
m
-3+1)*5;

2434 
i
 = 0; i <ğ
grid_pošts
[0]-3; i++) {

2435 
i1
 = 
i
 + 1;

2436 
i2
 = 
i
 + 2;

2437 #´agm¨
omp
 

2438 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2439 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2440 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2441 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2442 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2443 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2444 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2445 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2446 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2447 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2448 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2449 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2450 
lhs
[
n
+1][
i2
][
j
][
k
] =†hs[n+1][i2][j][k] -

2451 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+3][
i
][j][k];

2452 
lhs
[
n
+2][
i2
][
j
][
k
] =†hs[n+2][i2][j][k] -

2453 
lhs
[
n
+0][
i2
][
j
][
k
]*lhs[n+4][
i
][j][k];

2454 
rhs
[
m
][
i2
][
j
][
k
] =„hs[m][i2][j][k] -

2455 
lhs
[
n
+0][
i2
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2463 
i
 = 
grid_pošts
[0]-2;

2464 
i1
 = 
grid_pošts
[0]-1;

2466 #´agm¨
omp
 

2467 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2468 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2469 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2470 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2471 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2472 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2473 
lhs
[
n
+2][
i1
][
j
][
k
] =†hs[n+2][i1][j][k] -

2474 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+3][
i
][j][k];

2475 
lhs
[
n
+3][
i1
][
j
][
k
] =†hs[n+3][i1][j][k] -

2476 
lhs
[
n
+1][
i1
][
j
][
k
]*lhs[n+4][
i
][j][k];

2477 
rhs
[
m
][
i1
][
j
][
k
] =„hs[m][i1][j][k] -

2478 
lhs
[
n
+1][
i1
][
j
][
k
]*
rhs
[
m
][
i
][j][k];

2482 
çc2
 = 1./
lhs
[
n
+2][
i1
][
j
][
k
];

2483 
rhs
[
m
][
i1
][
j
][
k
] = 
çc2
*rhs[m][i1][j][k];

2493 
i
 = 
grid_pošts
[0]-2;

2494 
i1
 = 
grid_pošts
[0]-1;

2495 
n
 = 0;

2496 
m
 = 0; m < 3; m++) {

2497 #´agm¨
omp
 

2498 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2499 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2500 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2501 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k];

2506 
m
 = 3; m < 5; m++) {

2507 #´agm¨
omp
 

2508 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2509 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2510 
n
 = (
m
-3+1)*5;

2511 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2512 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k];

2520 
n
 = 0;

2521 
i
 = 
grid_pošts
[0]-3; i >= 0; i--) {

2522 
i1
 = 
i
 + 1;

2523 
i2
 = 
i
 + 2;

2524 #´agm¨
omp
 

2525 
m
 = 0; m < 3; m++) {

2526 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2527 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2528 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2529 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k] -

2530 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][
i2
][j][k];

2539 
m
 = 3; m < 5; m++) {

2540 
n
 = (
m
-3+1)*5;

2541 
i
 = 
grid_pošts
[0]-3; i >= 0; i--) {

2542 
i1
 = 
i
 + 1;

2543 
i2
 = 
i
 + 2;

2544 #´agm¨
omp
 

2545 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2546 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2547 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2548 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][
i1
][j][k] -

2549 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][
i2
][j][k];

2560 
	`nšvr
();

2561 
	}
}

2566 
	$y_sŞve
() {

2568 #´agm¨
omp
 
·¿Î–


2581 
i
, 
j
, 
k
, 
n
, 
j1
, 
j2
, 
m
;

2582 
çc1
, 
çc2
;

2587 
	`lhsy
();

2589 
n
 = 0;

2591 
j
 = 0; j <ğ
grid_pošts
[1]-3; j++) {

2592 
j1
 = 
j
 + 1;

2593 
j2
 = 
j
 + 2;

2594 #´agm¨
omp
 

2595 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2596 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2597 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2598 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2599 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2600 
m
 = 0; m < 3; m++) {

2601 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2603 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2604 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2605 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2606 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2607 
m
 = 0; m < 3; m++) {

2608 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2609 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2611 
lhs
[
n
+1][
i
][
j2
][
k
] =†hs[n+1][i][j2][k] -

2612 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+3][i][
j
][k];

2613 
lhs
[
n
+2][
i
][
j2
][
k
] =†hs[n+2][i][j2][k] -

2614 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+4][i][
j
][k];

2615 
m
 = 0; m < 3; m++) {

2616 
rhs
[
m
][
i
][
j2
][
k
] =„hs[m][i][j2][k] -

2617 
lhs
[
n
+0][
i
][
j2
][
k
]*
rhs
[
m
][i][
j
][k];

2629 
j
 = 
grid_pošts
[1]-2;

2630 
j1
 = 
grid_pošts
[1]-1;

2631 #´agm¨
omp
 

2632 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2633 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2634 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2635 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2636 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2637 
m
 = 0; m < 3; m++) {

2638 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2640 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2641 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2642 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2643 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2644 
m
 = 0; m < 3; m++) {

2645 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2646 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2651 
çc2
 = 1./
lhs
[
n
+2][
i
][
j1
][
k
];

2652 
m
 = 0; m < 3; m++) {

2653 
rhs
[
m
][
i
][
j1
][
k
] = 
çc2
*rhs[m][i][j1][k];

2661 
m
 = 3; m < 5; m++) {

2662 
n
 = (
m
-3+1)*5;

2663 
j
 = 0; j <ğ
grid_pošts
[1]-3; j++) {

2664 
j1
 = 
j
 + 1;

2665 
j2
 = 
j
 + 2;

2666 #´agm¨
omp
 

2667 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2668 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2669 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2670 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2671 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2672 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2673 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2674 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2675 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2676 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2677 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2678 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2679 
lhs
[
n
+1][
i
][
j2
][
k
] =†hs[n+1][i][j2][k] -

2680 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+3][i][
j
][k];

2681 
lhs
[
n
+2][
i
][
j2
][
k
] =†hs[n+2][i][j2][k] -

2682 
lhs
[
n
+0][
i
][
j2
][
k
]*lhs[n+4][i][
j
][k];

2683 
rhs
[
m
][
i
][
j2
][
k
] =„hs[m][i][j2][k] -

2684 
lhs
[
n
+0][
i
][
j2
][
k
]*
rhs
[
m
][i][
j
][k];

2692 
j
 = 
grid_pošts
[1]-2;

2693 
j1
 = 
grid_pošts
[1]-1;

2694 #´agm¨
omp
 

2695 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2696 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2697 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2698 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2699 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2700 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2701 
lhs
[
n
+2][
i
][
j1
][
k
] =†hs[n+2][i][j1][k] -

2702 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+3][i][
j
][k];

2703 
lhs
[
n
+3][
i
][
j1
][
k
] =†hs[n+3][i][j1][k] -

2704 
lhs
[
n
+1][
i
][
j1
][
k
]*lhs[n+4][i][
j
][k];

2705 
rhs
[
m
][
i
][
j1
][
k
] =„hs[m][i][j1][k] -

2706 
lhs
[
n
+1][
i
][
j1
][
k
]*
rhs
[
m
][i][
j
][k];

2710 
çc2
 = 1./
lhs
[
n
+2][
i
][
j1
][
k
];

2711 
rhs
[
m
][
i
][
j1
][
k
] = 
çc2
*rhs[m][i][j1][k];

2720 
j
 = 
grid_pošts
[1]-2;

2721 
j1
 = 
grid_pošts
[1]-1;

2722 
n
 = 0;

2723 
m
 = 0; m < 3; m++) {

2724 #´agm¨
omp
 

2725 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2726 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2727 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2728 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k];

2733 
m
 = 3; m < 5; m++) {

2734 #´agm¨
omp
 

2735 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2736 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2737 
n
 = (
m
-3+1)*5;

2738 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2739 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k];

2747 
n
 = 0;

2748 
m
 = 0; m < 3; m++) {

2749 
j
 = 
grid_pošts
[1]-3; j >= 0; j--) {

2750 
j1
 = 
j
 + 1;

2751 
j2
 = 
j
 + 2;

2752 #´agm¨
omp
 

2753 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2754 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2755 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2756 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k] -

2757 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][
j2
][k];

2766 
m
 = 3; m < 5; m++) {

2767 
n
 = (
m
-3+1)*5;

2768 
j
 = 
grid_pošts
[1]-3; j >= 0; j--) {

2769 
j1
 = 
j
 + 1;

2770 
j2
 = 
j1
 + 1;

2771 #´agm¨
omp
 

2772 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2773 
k
 = 1; k <ğ
grid_pošts
[2]-2; k++) {

2774 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2775 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][
j1
][k] -

2776 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][
j2
][k];

2784 
	`pšvr
();

2785 
	}
}

2790 
	$z_sŞve
() {

2792 #´agm¨
omp
 
·¿Î–


2805 
i
, 
j
, 
k
, 
n
, 
k1
, 
k2
, 
m
;

2806 
çc1
, 
çc2
;

2812 
	`lhsz
();

2814 
n
 = 0;

2816 #´agm¨
omp
 

2817 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2818 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2819 
k
 = 0; k <ğ
grid_pošts
[2]-3; k++) {

2820 
k1
 = 
k
 + 1;

2821 
k2
 = 
k
 + 2;

2822 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2823 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2824 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2825 
m
 = 0; m < 3; m++) {

2826 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2828 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2829 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2830 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2831 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2832 
m
 = 0; m < 3; m++) {

2833 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2834 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2836 
lhs
[
n
+1][
i
][
j
][
k2
] =†hs[n+1][i][j][k2] -

2837 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+3][i][j][
k
];

2838 
lhs
[
n
+2][
i
][
j
][
k2
] =†hs[n+2][i][j][k2] -

2839 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+4][i][j][
k
];

2840 
m
 = 0; m < 3; m++) {

2841 
rhs
[
m
][
i
][
j
][
k2
] =„hs[m][i][j][k2] -

2842 
lhs
[
n
+0][
i
][
j
][
k2
]*
rhs
[
m
][i][j][
k
];

2853 
k
 = 
grid_pošts
[2]-2;

2854 
k1
 = 
grid_pošts
[2]-1;

2855 #´agm¨
omp
 

2856 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2857 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2858 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2859 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2860 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2861 
m
 = 0; m < 3; m++) {

2862 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2864 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2865 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2866 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2867 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2868 
m
 = 0; m < 3; m++) {

2869 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2870 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2876 
çc2
 = 1./
lhs
[
n
+2][
i
][
j
][
k1
];

2877 
m
 = 0; m < 3; m++) {

2878 
rhs
[
m
][
i
][
j
][
k1
] = 
çc2
*rhs[m][i][j][k1];

2886 
m
 = 3; m < 5; m++) {

2887 
n
 = (
m
-3+1)*5;

2888 #´agm¨
omp
 

2889 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2890 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2891 
k
 = 0; k <ğ
grid_pošts
[2]-3; k++) {

2892 
k1
 = 
k
 + 1;

2893 
k2
 = 
k
 + 2;

2894 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2895 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2896 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2897 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2898 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2899 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2900 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2901 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2902 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2903 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2904 
lhs
[
n
+1][
i
][
j
][
k2
] =†hs[n+1][i][j][k2] -

2905 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+3][i][j][
k
];

2906 
lhs
[
n
+2][
i
][
j
][
k2
] =†hs[n+2][i][j][k2] -

2907 
lhs
[
n
+0][
i
][
j
][
k2
]*lhs[n+4][i][j][
k
];

2908 
rhs
[
m
][
i
][
j
][
k2
] =„hs[m][i][j][k2] -

2909 
lhs
[
n
+0][
i
][
j
][
k2
]*
rhs
[
m
][i][j][
k
];

2917 
k
 = 
grid_pošts
[2]-2;

2918 
k1
 = 
grid_pošts
[2]-1;

2919 #´agm¨
omp
 

2920 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2921 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2922 
çc1
 = 1./
lhs
[
n
+2][
i
][
j
][
k
];

2923 
lhs
[
n
+3][
i
][
j
][
k
] = 
çc1
*lhs[n+3][i][j][k];

2924 
lhs
[
n
+4][
i
][
j
][
k
] = 
çc1
*lhs[n+4][i][j][k];

2925 
rhs
[
m
][
i
][
j
][
k
] = 
çc1
*rhs[m][i][j][k];

2926 
lhs
[
n
+2][
i
][
j
][
k1
] =†hs[n+2][i][j][k1] -

2927 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+3][i][j][
k
];

2928 
lhs
[
n
+3][
i
][
j
][
k1
] =†hs[n+3][i][j][k1] -

2929 
lhs
[
n
+1][
i
][
j
][
k1
]*lhs[n+4][i][j][
k
];

2930 
rhs
[
m
][
i
][
j
][
k1
] =„hs[m][i][j][k1] -

2931 
lhs
[
n
+1][
i
][
j
][
k1
]*
rhs
[
m
][i][j][
k
];

2936 
çc2
 = 1./
lhs
[
n
+2][
i
][
j
][
k1
];

2937 
rhs
[
m
][
i
][
j
][
k1
] = 
çc2
*rhs[m][i][j][k1];

2947 
k
 = 
grid_pošts
[2]-2;

2948 
k1
 = 
grid_pošts
[2]-1;

2949 
n
 = 0;

2950 
m
 = 0; m < 3; m++) {

2951 #´agm¨
omp
 

2952 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2953 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2954 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2955 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
];

2960 
m
 = 3; m < 5; m++) {

2961 
n
 = (
m
-3+1)*5;

2962 #´agm¨
omp
 

2963 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2964 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2965 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2966 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
];

2979 
n
 = 0;

2980 
m
 = 0; m < 3; m++) {

2981 #´agm¨
omp
 

2982 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

2983 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

2984 
k
 = 
grid_pošts
[2]-3; k >= 0; k--) {

2985 
k1
 = 
k
 + 1;

2986 
k2
 = 
k
 + 2;

2987 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

2988 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
] -

2989 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k2
];

2998 
m
 = 3; m < 5; m++) {

2999 
n
 = (
m
-3+1)*5;

3000 #´agm¨
omp
 

3001 
i
 = 1; i <ğ
grid_pošts
[0]-2; i++) {

3002 
j
 = 1; j <ğ
grid_pošts
[1]-2; j++) {

3003 
k
 = 
grid_pošts
[2]-3; k >= 0; k--) {

3004 
k1
 = 
k
 + 1;

3005 
k2
 = 
k
 + 2;

3006 
rhs
[
m
][
i
][
j
][
k
] =„hs[m][i][j][k] -

3007 
lhs
[
n
+3][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k1
] -

3008 
lhs
[
n
+4][
i
][
j
][
k
]*
rhs
[
m
][i][j][
k2
];

3016 
	`tz‘¬
();

3017 
	}
}

	@common/c_print_results.c

7 
	~<Çutus/Çutus.h
>

9 
	$c_´št_»suÉs
Ğ*
Çme
,

10 
şass
,

11 
n1
,

12 
n2
,

13 
n3
,

14 
n™”
,

15 
Áh»ads
,

16 
t
,

17 
mİs
,

18 *
İty³
,

19 
·s£d_v”ifiÿtiÚ
,

20 *
Åbv”siÚ
,

21 *
comp‘ime
,

22 *
cc
,

23 *
şšk
,

24 *
c_lib
,

25 *
c_šc
,

26 *
cæags
,

27 *
şškæags
,

28 *
¿nd
)

30 *
ev®ue
="1000";

32 
	`´štf
Ğ"\n\À% B’chm¬k Com¶‘ed\n", 
Çme
 );

34 
	`´štf
Ğ" CÏs  = %c\n", 
şass
 );

36 ifĞ
n2
 =ğ0 && 
n3
 == 0 )

37 
	`´štf
Ğ" Siz = %12d\n", 
n1
 );

39 
	`´štf
Ğ" Siz = %3dx%3dx%3d\n", 
n1
,
n2
,
n3
 );

41 
	`´štf
Ğ" I‹¿tiÚ  = %12d\n", 
n™”
 );

43 
	`´štf
Ğ" Th»ad  = %12d\n", 
Áh»ads
 );

45 
	`´štf
Ğ" Timš secÚd ğ %12.2f\n", 
t
 );

47 
	`´štf
Ğ" Mİ/ tÙ® = %12.2f\n", 
mİs
 );

49 
	`´štf
Ğ" O³¿tiÚy³ = %24s\n", 
İty³
);

51 ifĞ
·s£d_v”ifiÿtiÚ
 )

52 
	`´štf
( " Verification = SUCCESSFUL\n" );

54 
	`´štf
( " Verification = UNSUCCESSFUL\n" );

56 
	`´štf
Ğ" V”siÚ = %12s\n", 
Åbv”siÚ
 );

58 
	`´štf
Ğ" Compd© = %12s\n", 
comp‘ime
 );

60 
	`´štf
( "\n Compile options:\n" );

62 
	`´štf
Ğ" CC = %s\n", 
cc
 );

64 
	`´štf
Ğ" CLINK = %s\n", 
şšk
 );

66 
	`´štf
Ğ" C_LIB = %s\n", 
c_lib
 );

68 
	`´štf
Ğ" C_INC = %s\n", 
c_šc
 );

70 
	`´štf
Ğ" CFLAGS = %s\n", 
cæags
 );

72 
	`´štf
Ğ" CLINKFLAGS = %s\n", 
şškæags
 );

74 
	`´štf
Ğ" RAND = %s\n", 
¿nd
 );

75 #ifdeà
SMP


76 
ev®ue
 = 
	`g‘’v
("MP_SET_NUMTHREADS");

77 
	`´štf
Ğ" MULTICPUS = %s\n", 
ev®ue
 );

89 
	}
}

	@common/c_timers.c

1 
	~"wtime.h
"

3 
	~<Çutus/Çutus.h
>

5 
wtime
( * );

11 
	$–­£d_time
( )

13 
t
;

15 
	`wtime
Ğ&
t
 );

16 Ğ
t
 );

17 
	}
}

20 
	g¡¬t
[64], 
	g–­£d
[64];

25 
	$tim”_ş—r
Ğ
n
 )

27 
–­£d
[
n
] = 0.0;

28 
	}
}

34 
	$tim”_¡¬t
Ğ
n
 )

36 
¡¬t
[
n
] = 
	`–­£d_time
();

37 
	}
}

43 
	$tim”_¡İ
Ğ
n
 )

45 
t
, 
now
;

47 
now
 = 
	`–­£d_time
();

48 
t
 = 
now
 - 
¡¬t
[
n
];

49 
–­£d
[
n
] +ğ
t
;

51 
	}
}

57 
	$tim”_»ad
Ğ
n
 )

59 Ğ
–­£d
[
n
] );

60 
	}
}

	@common/common.h

2 #iâdeà
COMMON_H


3 
	#COMMON_H


	)

5 
	~<Çutus/Çutus.h
>

7 
	#´štf
(...è
	`nk_vc_´štf
(
__VA_ARGS__
)

	)

9 
	#©of
(
x
è(()
	`©oi
(x))

	)

11 
	#EXIT_FAILURE
 -1

	)

12 
	#EXIT_SUCCESS
 0

	)

13 
	#ex™
(
x
è
	`·nic
("ex™ from om±e¡\n");

	)

15 
	~<¹/İ’mp/İ’mp.h
>

16 
šlše
 
	$sq¹
(
x
)

18 
»t
;

19 
asm
 volatile(

23 : "ô"(
»t
)

24 : "g"(
x
)

27  
»t
;

28 
	}
}

30 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

	@common/npb-C.h

4 #iâdeà
_NPB_C_H_


5 
	#_NPB_C_H_


	)

9 
	~<Çutus/Çutus.h
>

18 
	tboŞ—n
;

19 ¡ruù { 
	m»®
; 
	mimag
; } 
	tdcom¶ex
;

21 
	#TRUE
 1

	)

22 
	#FALSE
 0

	)

24 
	#max
(
a
,
b
è((×è> (b)è? (aè: (b))

	)

25 
	#mš
(
a
,
b
è((×è< (b)è? (aè: (b))

	)

26 
	#pow2
(
a
è(×)*×))

	)

28 
	#g‘_»®
(
c
èc.
»®


	)

29 
	#g‘_imag
(
c
èc.
imag


	)

30 
	#ÿdd
(
c
,
a
,
b
è(c.
»®
 =‡.»® + b.»®, c.
imag
 =‡.imag + b.imag)

	)

31 
	#csub
(
c
,
a
,
b
è(c.
»®
 =‡.»® - b.»®, c.
imag
 =‡.imag - b.imag)

	)

32 
	#cmul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b.»® -‡.
imag
 * b.imag, \

33 
c
.
imag
 = 
a
.
»®
 * 
b
.imag +‡.imag * b.»®)

	)

34 
	#ümul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b, c.
imag
 =‡.imag * b)

	)

36 
¿ndlc
(*, );

37 
v¿Æc
(, *, , *);

38 
tim”_ş—r
();

39 
tim”_¡¬t
();

40 
tim”_¡İ
();

41 
tim”_»ad
();

43 
c_´št_»suÉs
(*
Çme
, 
şass
, 
n1
, 
n2
,

44 
n3
, 
n™”
, 
Áh»ads
, 
t
,

45 
mİs
, *
İty³
, 
·s£d_v”ifiÿtiÚ
,

46 *
Åbv”siÚ
, *
comp‘ime
, *
cc
,

47 *
şšk
, *
c_lib
, *
c_šc
,

48 *
cæags
, *
şškæags
, *
¿nd
);

	@common/wtime.c

1 
	~"wtime.h
"

4 
	$wtime
(*
t
)

6 
£c
 = -1;

7 
timev®
 
tv
;

8 
	`g‘timeofday
(&
tv
, (*)0);

9 ià(
£c
 < 0è£øğ
tv
.
tv_£c
;

10 *
t
 = (
tv
.
tv_£c
 - 
£c
è+ 1.0e-6*tv.
tv_u£c
;

11 
	}
}

	@common/wtime.h

5 #iâdeà
_WTIME_H_


6 
	#_WTIME_H_


	)

8 #ià
defšed
(
IBM
)

9 
	#wtime
 
wtime


	)

10 #–ià
defšed
(
CRAY
)

11 
	#wtime
 
WTIME


	)

13 
	#wtime
 
wtime_


	)

17 
	~<Çutus/libccom·t.h
>

18 
	#su£cÚds_t
 
ušt64_t


	)

19 
	stimev®
 {

20 
time_t
 
	mtv_£c
;

21 
su£cÚds_t
 
	mtv_u£c
;

	@common/wtime_sgi64.c

8 
	~<Çutus/Çutus.h
>

12 
	tiÙim”_t
;

14 
	gcyşev®
;

15 vŞ©
iÙim”_t
 *
	giÙim”_addr
, 
	gba£_couÁ”
;

16 
	g»sŞutiÚ
;

19 
	tadd»ss_t
;

23 
	$tim”_š™
()

26 
fd
;

27 *
vœt_addr
;

28 
add»ss_t
 
phys_addr
, 
·ge_off£t
, 
·gemask
, 
·geba£_addr
;

30 
·gemask
 = 
	`g‘·gesize
() - 1;

31 
”ºo
 = 0;

32 
phys_addr
 = 
	`syssgi
(
SGI_QUERY_CYCLECNTR
, &
cyşev®
);

33 ià(
”ºo
 != 0) {

34 
	`³¼Ü
("SGI_QUERY_CYCLECNTR");

35 
	`ex™
(1);

38 
·ge_off£t
 = 
phys_addr
 & 
·gemask
;

39 
·geba£_addr
 = 
phys_addr
 - 
·ge_off£t
;

40 
fd
 = 
	`İ’
("/dev/mmem", 
O_RDONLY
);

42 
vœt_addr
 = 
	`mm­
(0, 
·gemask
, 
PROT_READ
, 
MAP_PRIVATE
, 
fd
, 
·geba£_addr
);

43 
vœt_addr
 = vœt_add¸+ 
·ge_off£t
;

44 
iÙim”_addr
 = (
iÙim”_t
 *)
vœt_addr
;

46 
»sŞutiÚ
 = 1.0e-12*
cyşev®
;

47 
ba£_couÁ”
 = *
iÙim”_addr
;

48 
	}
}

50 
	$wtime_
(*
time
)

52 
š™Ÿlized
 = 0;

53 vŞ©
iÙim”_t
 
couÁ”_v®ue
;

54 ià(!
š™Ÿlized
) {

55 
	`tim”_š™
();

56 
š™Ÿlized
 = 1;

58 
couÁ”_v®ue
 = *
iÙim”_addr
 - 
ba£_couÁ”
;

59 *
time
 = ()
couÁ”_v®ue
 * 
»sŞutiÚ
;

60 
	}
}

63 
	$wtime
(*
time
)

65 
š™Ÿlized
 = 0;

66 vŞ©
iÙim”_t
 
couÁ”_v®ue
;

67 ià(!
š™Ÿlized
) {

68 
	`tim”_š™
();

69 
š™Ÿlized
 = 1;

71 
couÁ”_v®ue
 = *
iÙim”_addr
 - 
ba£_couÁ”
;

72 *
time
 = ()
couÁ”_v®ue
 * 
»sŞutiÚ
;

73 
	}
}

	@math/exp/nas_exp.h

3 #iâdeà
_NAS_EXP_H_


4 
	#_NAS_EXP_H_


	)

7 
	gÚe
 = 1.0,

8 
	gh®F
[2] = {0.5,-0.5,},

9 
	ghuge
 = 1.0e+300,

10 
	gtwom1000
= 9.33263618503218878990e-302,

11 
	go_th»shŞd
= 7.09782712893383973096e+02,

12 
	gu_th»shŞd
= -7.45133219101941108420e+02,

13 
	gÊ2HI
[2] ={ 6.93147180369123816490e-01,

15 
	gÊ2LO
[2] ={ 1.90821492927058770002e-10,

17 
	gšvÊ2
 = 1.44269504088896338700e+00,

18 
	gP1
 = 1.66666666666666019037e-01,

19 
	gP2
 = -2.77777777770155933842e-03,

20 
	gP3
 = 6.61375632143793436117e-05,

21 
	gP4
 = -1.65339022054652515390e-06,

22 
	gP5
 = 4.13813679705723846039e-08;

24 uniÚ {
	md
; 
	mu
;} 
	g_x
, 
	g_y
;

26 
	#__HI
(
a
èa.
u
 >> 32

	)

27 
	#__LO
(
a
èa.
u
 <<32>>32

	)

29 
	$exp
(
x
)

31 
y
,
hi
,
lo
,
c
,
t
;

32 
k
,
xsb
;

33 
hx
;

34 
_x
.
d
 = 
x
;

35 
hx
 = 
	`__HI
(
_x
);

36 
xsb
 = (
hx
>>31)&1;

37 
hx
 &= 0x7fffffff;

39 if(
hx
 >= 0x40862E42) {

40 if(
hx
>=0x7ff00000) {

41 if(((
hx
&0xfffff)|
	`__LO
(
_x
))!=0)

42  
x
+x;

43  (
xsb
==0)? 
x
:0.0;

45 if(
x
 > 
o_th»shŞd
è 
huge
*huge;

46 if(
x
 < 
u_th»shŞd
è 
twom1000
*twom1000;

50 if(
hx
 > 0x3fd62e42) {

51 if(
hx
 < 0x3FF0A2B2) {

52 
hi
 = 
x
-
Ê2HI
[
xsb
]; 
lo
=
Ê2LO
[xsb]; 
k
 = 1-xsb-xsb;

54 
k
 = ()(
švÊ2
*
x
+
h®F
[
xsb
]);

55 
t
 = 
k
;

56 
hi
 = 
x
 - 
t
*
Ê2HI
[0];

57 
lo
 = 
t
*
Ê2LO
[0];

59 
x
 = 
hi
 - 
lo
;

61 if(
hx
 < 0x3e300000) {

62 if(
huge
+
x
>
Úe
)  one+x;

64 
k
 = 0;

67 
t
 = 
x
*x;

68 
c
 = 
x
 - 
t
*(
P1
+t*(
P2
+t*(
P3
+t*(
P4
+t*
P5
))));

69 if(
k
==0è 
Úe
-((
x
*
c
)/(c-2.0)-x);

70 
y
 = 
Úe
-((
lo
-(
x
*
c
)/(2.0-c))-
hi
);

71 
_y
.
d
 = 
y
;

72 if(
k
 >= -1021) {

73 
_t
 = 
	`__HI
(
_y
);

74 
_t
 +ğ(
k
<<20);

75 
_y
.
u
 = 
_t
 << 32 | 
	`__LO
(_y);

76  
_y
.
d
;

78 
_t
 = 
	`__HI
(
_y
);

79 
_t
 +ğ((
k
+1000)<<20);

80 
_y
.
u
 = 
_t
 << 32 | 
	`__LO
(_y);

82  
_y
.
d
*
twom1000
;

84 
	}
}

	@math/log/frexp.h

2 
	md
;

3 
	mu
;

4 }
	tudoubË
;

6 
	$äexp
(
x
, * 
e
){

7 
udoubË
 
a
;

8 
a
.
d
 = 
x
;

9 
_a
 = 
a
.
u
;

12 ifĞ! (~(
_a
<<1 >>53)<< 53)){

13 *
e
 = 1023;

16 ià(
x
 == 0.0){

17 *
e
 = 0;

21 
udoubË
 
_mª
;

22 
sign
 = 
_a
 >> 63 << 63, 
mask
 = 0x3FF;

23 
_mª
.
u
 = 
_a
>>63<<63 \

24 | 
mask
 << 52 \

25 | 
_a
 << 12 >> 12;

27 *
e
 = (()(
_a
 << 1 >> 53) -1023 ) + 1;

33  
_mª
.
d
/2;

34 
	}
}

	@math/log/nas_log.h

1 #iâdeà
_NAS_LOG_H_


2 
	#_NAS_LOG_H_


	)

3 
	~"äexp.h
"

4 
	gLOG2_HI
 = 0x1.62e42ãe00000
p
-1;

5 
	gLOG2_LOW
 = 0x1.a39ef35793c76
p
-33;

6 
	gL1
 = 0x1.5555555555593
p
-1;

7 
	gL2
 = 0x1.999999997ç04
p
-2;

8 
	gL3
 = 0x1.2492494229359
p
-2;

9 
	gL4
 = 0x1.c71c51d8e78af
p
-3;

10 
	gL5
 = 0x1.7466496cb03de
p
-3;

11 
	gL6
 = 0x1.39a09d078c69f
p
-3;

12 
	gL7
 = 0x1.2f112df3e5244
p
-3;

13 
	gSQRT2_HALF
 = 0x1.6a09e667f3bcd
p
-1;

14 
	gæ
, 
	gk
, 
	gf
, 
	gs
, 
	g_s2
,
	g_s4
,
	gR
,
	gt1
,
	gt2
,
	ghfsq
;

16 
	$log
(
x
){

18 
ki
;

19 
f1
 = 
	`äexp
(
x
,&
ki
);

21 ià(
f1
 < 
SQRT2_HALF
){

22 
f1
 *= 2;

23 
ki
 -= 1;

25 
f
 = 
f1
-1;

26 
k
 = ()
ki
;

28 
s
 = 
f
 / (2 + f);

29 
_s2
 = 
s
 * s;

30 
_s4
 = 
_s2
 * _s2;

32 
t1
 = 
_s2
 * (
L1
 + 
_s4
 * (
L3
 + _s4 * (
L5
 + _s4 * 
L7
)));

34 
t2
 = 
_s4
 * (
L2
 + _s4 * (
L4
 + _s4 * 
L6
));

35 
R
 = 
t1
 + 
t2
;

36 
hfsq
 = 0.5 * 
f
 * f;

37  
k
 * 
LOG2_HI
 - ((
hfsq
 - (
s
 * (hfsq + 
R
è+ k * 
LOG2_LOW
)è- 
f
);

38 
	}
}

41 
	gšput
; \

42 
sÿnf
("%lf", &
šput
); \

43 
	glo
 = 
log
(
šput
); \

44 
´štf
("lØ%à\n",
lo
); \

	@math/log/test.c

1 
	~<¡dio.h
>

3 
	~"Çs_log.h
"

5 
	$maš
(){

6 
šput
 = 5;

7 
	`´štf
("%20.20f",
	`log
(0.4));

8 
	}
}

	@math/nas_math.h

2 #iâdeà
_NAS_MATH_H_


3 
	#_NAS_MATH_H_


	)

5 
	~<Çutus/Çutus.h
>

6 
	~"log/Çs_log.h
"

7 
	~"pow/Çs_pow.h
"

8 
	~"exp/Çs_exp.h
"

9 
	~"sšcos/Çs_sšcos.h
"

13 
šlše
 
	$sq¹
(
x
)

15 
»t
;

16 
asm
 volatile(

20 : "ô"(
»t
)

21 : "g"(
x
)

24  
»t
;

25 
	}
}

27 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

	@math/pow/nas_pow.h

1 
	~"../log/Çs_log.h
"

2 
	~"../exp/Çs_exp.h
"

3 
	$pow
(
a
, 
b
){

5  
	`exp
(
b
*
	`log
(
a
));

7 
	}
}

	@math/pow/test.c

1 
	~<¡dio.h
>

2 
	~"pow.h
"

3 
	$maš
(){

4 
šput1
, 
šput2
;

5 
šput1
 = 0.4;

6 
šput2
 = 0.5;

8 
a
 = 
	`pow
(
šput1
,
šput2
);

10 
	`´štf
("%20.20f",
a
);

13 
	}
}

	@math/sincos/__sincostab.h

20 
	~"Çs_mydefs.h
"

21 
	~"Çs_’dŸn.h
"

27 #ifdeà
BIG_ENDI


28 cÚ¡ uniÚ {
št4
 
	mi
[880]; 
	mx
[440];}
	g__sšco¡ab
 = { .
i
 = {

470 #ifdeà
LITTLE_ENDI


471 cÚ¡ uniÚ {
št4
 
	mi
[880]; 
	mx
[440];} 
	g__sšco¡ab
 = { .
i
 = {

	@math/sincos/nas_branred.c

34 
	~"Çs_mydefs.h
"

35 
	~"Çs_b¿Äed_ty³.h
"

36 
	~"Çs_b¿Äed.h
"

38 #iâdeà
SECTION


39 
	#SECTION


	)

50 
SECTION


51 
	$__b¿Äed
(
x
, *
a
, *
¯
)

53 
i
=0,
k
=0;

54 
mynumb”
 
u
,
gÜ
;

55 
r
[6],
s
=0,
t
=0,
sum
=0,
b
=0,
bb
=0,
sum1
=0,
sum2
=0,
b1
=0,
bb1
=0,
b2
=0,
bb2
=0,
x1
=0,
x2
=0,
t1
=0,
t2
=0;

57 
x
*=
tm600
.x;

58 
t
=
x
*
¥l™
;

59 
x1
=
t
-Ñ-
x
);

60 
x2
=
x
-
x1
;

61 
sum
=0;

62 
u
.
x
 = 
x1
;

63 
k
 = (
u
.
i
[
HIGH_HALF
]>>20)&2047;

64 
k
 = (k-450)/24;

65 ià(
k
<0)

66 
k
=0;

67 
gÜ
.
x
 = 
t576
.x;

68 
gÜ
.
i
[
HIGH_HALF
] -ğ((
k
*24)<<20);

69 
i
=0;i<6;i++)

70 { 
r
[
i
] = 
x1
*
tov”p
[
k
+i]*
gÜ
.
x
; gÜ.x *ğ
tm24
.x; }

71 
i
=0;i<3;i++) {

72 
s
=(
r
[
i
]+
big
.
x
)-big.x;

73 
sum
+=
s
;

74 
r
[
i
]-=
s
;

76 
t
=0;

77 
i
=0;i<6;i++)

78 
t
+=
r
[5-
i
];

79 
bb
=(((((
r
[0]-
t
)+r[1])+r[2])+r[3])+r[4])+r[5];

80 
s
=(
t
+
big
.
x
)-big.x;

81 
sum
+=
s
;

82 
t
-=
s
;

83 
b
=
t
+
bb
;

84 
bb
=(
t
-
b
)+bb;

85 
s
=(
sum
+
big1
.
x
)-big1.x;

86 
sum
-=
s
;

87 
b1
=
b
;

88 
bb1
=
bb
;

89 
sum1
=
sum
;

90 
sum
=0;

92 
u
.
x
 = 
x2
;

93 
k
 = (
u
.
i
[
HIGH_HALF
]>>20)&2047;

94 
k
 = (k-450)/24;

95 ià(
k
<0)

96 
k
=0;

97 
gÜ
.
x
 = 
t576
.x;

98 
gÜ
.
i
[
HIGH_HALF
] -ğ((
k
*24)<<20);

99 
i
=0;i<6;i++)

100 { 
r
[
i
] = 
x2
*
tov”p
[
k
+i]*
gÜ
.
x
; gÜ.x *ğ
tm24
.x; }

101 
i
=0;i<3;i++) {

102 
s
=(
r
[
i
]+
big
.
x
)-big.x;

103 
sum
+=
s
;

104 
r
[
i
]-=
s
;

106 
t
=0;

107 
i
=0;i<6;i++)

108 
t
+=
r
[5-
i
];

109 
bb
=(((((
r
[0]-
t
)+r[1])+r[2])+r[3])+r[4])+r[5];

110 
s
=(
t
+
big
.
x
)-big.x;

111 
sum
+=
s
;

112 
t
-=
s
;

113 
b
=
t
+
bb
;

114 
bb
=(
t
-
b
)+bb;

115 
s
=(
sum
+
big1
.
x
)-big1.x;

116 
sum
-=
s
;

118 
b2
=
b
;

119 
bb2
=
bb
;

120 
sum2
=
sum
;

122 
sum
=
sum1
+
sum2
;

123 
b
=
b1
+
b2
;

124 
bb
 = (
	`çbs
(
b1
)>çbs(
b2
))? (b1-
b
)+b2 : (b2-b)+b1;

125 ià(
b
 > 0.5)

126 {
b
-=1.0; 
sum
+=1.0;}

127 ià(
b
 < -0.5)

128 {
b
+=1.0; 
sum
-=1.0;}

129 
s
=
b
+(
bb
+
bb1
+
bb2
);

130 
t
=((
b
-
s
)+
bb
)+(
bb1
+
bb2
);

131 
b
=
s
*
¥l™
;

132 
t1
=
b
-(b-
s
);

133 
t2
=
s
-
t1
;

134 
b
=
s
*
hp0
.
x
;

135 
bb
=(((
t1
*
mp1
.
x
-
b
)+t1*
mp2
.x)+
t2
*mp1.x)+Ñ2*mp2.x+
s
*
hp1
.x+
t
*
hp0
.x);

136 
s
=
b
+
bb
;

137 
t
=(
b
-
s
)+
bb
;

138 *
a
=
s
;

139 *
¯
=
t
;

140  ((è
sum
)&3;

141 
	}
}

	@math/sincos/nas_branred.h

2 #iâdeà
_BRANRED_H_


3 
	#_BRANRED_H_


	)

5 
__b¿Äed
(
x
, *
a
, *
¯
);

	@math/sincos/nas_branred_type.h

26 #iâdeà
_BRANRED_TYPE_H


27 
	#_BRANRED_TYPE_H


	)

28 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

31 
	#CN
 134217729.0

	)

32 
	#HIGH_HALF
 1

	)

33 
	#LOW_HALF
 0

	)

36 #iâdeà
LITTLE_ENDI


37 
	#LITTLE_ENDI


	)

39 #ifdeà
BIG_ENDI


40 cÚ¡ 
mynumb”


42  
	gt576
 = {{0x63f00000, 0x00000000}},

43  
	gtm600
 = {{0x1a700000, 0x00000000}},

44  
	gtm24
 = {{0x3e700000, 0x00000000}},

45  
	gbig
 = {{0x43380000, 0x00000000}},

46  
	gbig1
 = {{0x43580000, 0x00000000}},

47  
	ghp0
 = {{0x3FF921FB, 0x54442D18}} ,

48  
	ghp1
 = {{0x3C91A626, 0x33145C07}} ,

49  
	gmp1
 = {{0x3FF921FB, 0x58000000}},

50  
	gmp2
 = {{0xBE4DDE97, 0x40000000}};

53 #ifdeà
LITTLE_ENDI


54 cÚ¡ 
mynumb”


56  
	gt576
 = {{0x00000000, 0x63f00000}},

57  
	gtm600
 = {{0x00000000, 0x1a700000}},

58  
	gtm24
 = {{0x00000000, 0x3e700000}},

59  
	gbig
 = {{0x00000000, 0x43380000}},

60  
	gbig1
 = {{0x00000000, 0x43580000}},

61  
	ghp0
 = {{0x54442D18, 0x3FF921FB}},

62  
	ghp1
 = {{0x33145C07, 0x3C91A626}},

63  
	gmp1
 = {{0x58000000, 0x3FF921FB}},

64  
	gmp2
 = {{0x40000000, 0xBE4DDE97}};

69 cÚ¡ 
	gtov”p
[75] = {

86 cÚ¡ 
	g¥l™
 = 
CN
;

	@math/sincos/nas_endian.h

1 #iâdeà
_NAS_ENDIAN_H_


2 
	#_NAS_ENDIAN_H_


	)

4 #iâdeà
LITTLE_ENDI


5 
	#LITTLE_ENDI


	)

	@math/sincos/nas_mydefs.h

27 #iâdeà
MY_H


28 
	#MY_H


	)

30 
	tšt4
;

31 uniÚ { 
št4
 
	mi
[2]; 
	mx
; } 
	tmynumb”
;

33 
	#max
(
x
, 
y
è(((yè> (x)è? (yè: (x))

	)

34 
	#mš
(
x
, 
y
è(((yè< (x)è? (yè: (x))

	)

	@math/sincos/nas_sincos.c

2 
	~"Çs_ty³.h
"

3 
	~"Çs_b¿Äed.h
"

4 
	~"__sšco¡ab.h
"

5 
	~"Çs_sšcos.h
"

6 
	#ERROR
(
fmt
, 
¬gs
...)

	)

9 
	#çbs
(
x
è
	`__butš_çbs
(x)

	)

13 
št4
 
	gi
[880]; \

14 
	gx
[440]; \

15 } 
	g__sšco¡ab
;

21 
	#POLYNOMIAL2
(
xx
è((((
s5
 * (xxè+ 
s4
è* (xxè+ 
s3
è* (xxè+ 
s2
è* (xx))

	)

23 
	#POLYNOMIAL
(
xx
è(
	`POLYNOMIAL2
 (xxè+ 
s1
)

	)

32 
	$TAYLOR_SIN
(
xx
, 
a
,
da
) { \

33 
t
 = ((
	`POLYNOMIAL
 (
xx
è* (
a
è- 0.5 * (
da
)) * (xx) + (da)); \

34 
»s
 = (
a
è+ 
t
; \

35  
»s
; \

36 
	}
}

38 
	$SINCOS_TABLE_LOOKUP
(
mynumb”
 
u
, * 
¢
,* 
s¢
,* 
cs
, *
ccs
){

40 
št4
 
k
 = 
u
.
i
[
LOW_HALF
] << 2;

41 *
¢
 = 
__sšco¡ab
.
x
[
k
]; \

42 *
s¢
 = 
__sšco¡ab
.
x
[
k
 + 1]; \

43 *
cs
 = 
__sšco¡ab
.
x
[
k
 + 2]; \

44 *
ccs
 = 
__sšco¡ab
.
x
[
k
 + 3]; \

45 
	}
}

49 
	g¢3
 = -1.66666666666664880952546298448555E-01,

50 
	g¢5
 = 8.33333214285722277379541354343671E-03,

51 
	gcs2
 = 4.99999999999999999999950396842453E-01,

52 
	gcs4
 = -4.16666666666664434524222570944589E-02,

53 
	gcs6
 = 1.38888874007937613028114285595617E-03;

59 
šlše
 

61 
	$do_cos
 (
x
, 
dx
)

63 
mynumb”
 
u
;

65 ià(
x
 < 0)

66 
dx
 = -dx;

68 
u
.
x
 = 
big
 + 
	`çbs
 (x);

69 
x
 = 
	`çbs
 (xè- (
u
.x - 
big
è+ 
dx
;

71 
xx
=0, 
s
=0, 
¢
=0, 
s¢
=0, 
c
=0, 
cs
=0, 
ccs
=0, 
cÜ
=0;

72 
xx
 = 
x
 * x;

73 
s
 = 
x
 + x * 
xx
 * (
¢3
 + xx * 
¢5
);

74 
c
 = 
xx
 * (
cs2
 + xx * (
cs4
 + xx * 
cs6
));

75 
	`SINCOS_TABLE_LOOKUP
 (
u
, &
¢
, &
s¢
, &
cs
, &
ccs
);

76 
cÜ
 = (
ccs
 - 
s
 * 
s¢
 - 
cs
 * 
c
è- 
¢
 * s;

77  
cs
 + 
cÜ
;

78 
	}
}

84 
šlše
 

86 
	$do_sš
 (
x
, 
dx
)

88 
xŞd
 = 
x
;

90 ià(
	`çbs
 (
x
) < 0.126)

91  
	`TAYLOR_SIN
 (
x
 * x, x, 
dx
);

93 
mynumb”
 
u
;

95 ià(
x
 <= 0)

96 
dx
 = -dx;

97 
u
.
x
 = 
big
 + 
	`çbs
 (x);

98 
x
 = 
	`çbs
 (xè- (
u
.x - 
big
);

100 
xx
=0, 
s
=0, 
¢
=0, 
s¢
=0, 
c
=0, 
cs
=0, 
ccs
=0, 
cÜ
=0;

101 
xx
 = 
x
 * x;

102 
s
 = 
x
 + (
dx
 + x * 
xx
 * (
¢3
 + xx * 
¢5
));

103 
c
 = 
x
 * 
dx
 + 
xx
 * (
cs2
 + xx * (
cs4
 + xx * 
cs6
));

104 
	`SINCOS_TABLE_LOOKUP
 (
u
, &
¢
, &
s¢
,& 
cs
, &
ccs
);

105 
cÜ
 = (
s¢
 + 
s
 * 
ccs
 - 
¢
 * 
c
è+ 
cs
 * s;

106  
	`__cİysign
 (
¢
 + 
cÜ
, 
xŞd
);

107 
	}
}

113 
šlše
 
št4


115 
	$»duû_sšcos
 (
x
, *
a
, *
da
)

117 
mynumb”
 
v
;

119 
t
 = (
x
 * 
hpšv
 + 
tošt
);

121 
xn
 = 
t
 - 
tošt
;

124 
v
.
x
 = 
t
;

125 
y
 = (
x
 - 
xn
 * 
mp1
è- xÀ* 
mp2
;

126 
št4
 
n
 = 
v
.
i
[
LOW_HALF
] & 3;

128 
b
=0, 
db
=0, 
t1
=0, 
t2
=0;

129 
t1
 = 
xn
 * 
µ3
;

130 
t2
 = 
y
 - 
t1
;

133 
db
 = (
y
 - 
t2
è- 
t1
;

136 
t1
 = 
xn
 * 
µ4
;

137 
b
 = 
t2
 - 
t1
;

139 
db
 +ğ(
t2
 - 
b
è- 
t1
;

142 *
a
 = 
b
;

143 *
da
 = 
db
;

146  
n
;

147 
	}
}

150 
šlše
 

152 
	$do_sšcos
 (
a
, 
da
, 
št4
 
n
)

154 
»tv®
;

156 ià(
n
 & 1)

158 
»tv®
 = 
	`do_cos
 (
a
, 
da
);

161 
»tv®
 = 
	`do_sš
 (
a
, 
da
);

163  (
n
 & 2è? -
»tv®
 :„etval;

164 
	}
}

172 
	$__sš
 (
x
)

174 
t
=0, 
a
=0, 
da
=0;

175 
mynumb”
 
u
;

176 
št4
 
k
=0, 
m
=0, 
n
=0;

177 
»tv®
 = 0;

181 
u
.
x
 = x;

182 
m
 = 
u
.
i
[
HIGH_HALF
];

183 
k
 = 0x7ffffffà& 
m
;

186 ià(
k
 < 0x3e500000)

188 
	`ERROR
("underflow !");

190 
»tv®
 = 
x
;

193 ià(
k
 < 0x3feb6000)

196 
»tv®
 = 
	`do_sš
 (
x
, 0);

200 ià(
k
 < 0x400368fd)

202 
t
 = 
hp0
 - 
	`çbs
 (
x
);

204 
»tv®
 = 
	`__cİysign
 (
	`do_cos
 (
t
, 
hp1
), 
x
);

208 ià(
k
 < 0x419921FB)

210 
n
 = 
	`»duû_sšcos
 (
x
, &
a
, &
da
);

212 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
);

216 ià(
k
 < 0x7ff00000)

218 
n
 = 
	`__b¿Äed
 (
x
, &
a
, &
da
);

219 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
);

224 ià(
k
 =ğ0x7ff00000 && 
u
.
i
[
LOW_HALF
] == 0)

226 
»tv®
 = 
x
 / x;

229  
»tv®
;

230 
	}
}

239 
	$__cos
 (
x
)

241 
y
=0, 
a
=0, 
da
=0;

242 
mynumb”
 
u
;

243 
št4
 
k
=0, 
m
=0, 
n
=0;

245 
»tv®
 = 0;

249 
u
.
x
 = x;

250 
m
 = 
u
.
i
[
HIGH_HALF
];

251 
k
 = 0x7ffffffà& 
m
;

254 ià(
k
 < 0x3e400000)

255 
»tv®
 = 1.0;

257 ià(
k
 < 0x3feb6000)

260 
»tv®
 = 
	`do_cos
 (
x
, 0);

263 ià(
k
 < 0x400368fd)

265 
y
 = 
hp0
 - 
	`çbs
 (
x
);

266 
a
 = 
y
 + 
hp1
;

267 
da
 = (
y
 - 
a
è+ 
hp1
;

270 
»tv®
 = 
	`do_sš
 (
a
, 
da
);

273 ià(
k
 < 0x419921FB)

275 
n
 = 
	`»duû_sšcos
 (
x
, &
a
, &
da
);

276 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
 + 1);

280 ià(
k
 < 0x7ff00000)

282 
n
 = 
	`__b¿Äed
 (
x
, &
a
, &
da
);

283 
»tv®
 = 
	`do_sšcos
 (
a
, 
da
, 
n
 + 1);

288 ià(
k
 =ğ0x7ff00000 && 
u
.
i
[
LOW_HALF
] == 0)

290 
»tv®
 = 
x
 / x;

293  
»tv®
;

294 
	}
}

297 
	$sš
(
x
è{ 
	`__sš
(x);
	}
}

298 
	$cos
(
x
è{ 
	`__cos
(x);
	}
}

	@math/sincos/nas_sincos.h

1 #iâdeà
_NAS_SINCOS_H_


2 
	#_NAS_SINCOS_H_


	)

4 
sš
(
x
);

5 
cos
(
x
);

	@math/sincos/nas_type.h

1 #iâdeà
_SINCOS_TYPE_H_


2 
	#_SINCOS_TYPE_H_


	)

3 
	~"Çs_mydefs.h
"

7 cÚ¡ 
	gs1
 = -0x1.5555555555555
p
-3;

8 cÚ¡ 
	gs2
 = 0x1.1111111110ECE
p
-7;

9 cÚ¡ 
	gs3
 = -0x1.A01A019DB08B8
p
-13;

10 cÚ¡ 
	gs4
 = 0x1.71DE27B9A7ED9
p
-19;

11 cÚ¡ 
	gs5
 = -0x1.ADDFFC2FCDF59
p
-26;

12 cÚ¡ 
	g¯
 = -0x1.5558000000000
p
-3;

13 cÚ¡ 
	gbb
 = 0x1.5555555556E24
p
-18;

14 cÚ¡ 
	gbig
 = 0x1.8000000000000
p45
;

15 cÚ¡ 
	ghp0
 = 0x1.921FB54442D18
p0
;

16 cÚ¡ 
	ghp1
 = 0x1.1A62633145C07
p
-54;

17 cÚ¡ 
	gmp1
 = 0x1.921FB58000000
p0
;

18 cÚ¡ 
	gmp2
 = -0x1.DDE973C000000
p
-27;

19 cÚ¡ 
	gmp3
 = -0x1.CB3B399D747F2
p
-55;

20 cÚ¡ 
	gµ3
 = -0x1.CB3B398000000
p
-55;

21 cÚ¡ 
	gµ4
 = -0x1.d747f23e32ed7
p
-83;

22 cÚ¡ 
	ghpšv
 = 0x1.45F306DC9C883
p
-1;

23 cÚ¡ 
	gtošt
 = 0x1.8000000000000
p52
;

27 
	$__cİysign
 (
x
, 
y
)

29 uniÚ {
x
; 
u
;} 
_x
, 
_y
, 
_r
;

30 
_x
.
x
 = x;

31 
_y
.
x
 = 
y
;

32 
_r
.
u
 = 
_x
.u <<1 >>1 | 
_y
.u >>63 <<63;

33  
_r
.
x
;

36 
	}
}

39 
	#LITTLE_ENDI
 1

	)

40 
	#HIGH_HALF
 1

	)

41 
	#LOW_HALF
 0

	)

	@math/sincos/sincos_test.c

1 
	~<Çutus/Çutus.h
>

2 
	~<Çutus/sh–l.h
>

3 
	~"Çs_sšcos.h
"

5 
sšcos
(*
__buf
, * 
__´iv
);

7 
sh–l_cmd_im¶
 
	gÇs_sšcos_im¶
 = {

8 .
cmd
 = "sc",

9 .
	gh–p_¡r
 = "sincosest",

10 .
	ghªdËr
 = 
sšcos
,

12 
nk_»gi¡”_sh–l_cmd
(
Çs_sšcos_im¶
);

16 
	$sšcos
(*
__buf
, * 
__´iv
) {

18 
	`´štf
("sš : %lf, co : %là\n", 
	`sš
(0.567),
	`cos
(9.087));

20 
	}
}

	@math/sincos/test.c

1 
	~"Çs_sšcos.h
"

2 
	~<¡dio.h
>

3 
	$maš
(){

5 
a
 = 4.5;

6 
	`´štf
("%20.20à%20.20à%20.20f\À%20.20à%20.20à%20.20f\À%20.20à%20.20à%20.20f\n", 
	`cos
(6.78), 
	`sš
(0.045664),cos(0.0678), sin(90),sin(0.987),sin(33.8),cos(90),cos(7.9));

7 
	}
}

	@npbparams.h

7 
	#PROBLEM_SIZE
 12

	)

8 
	#NITER_DEFAULT
 60

	)

9 
	#DT_DEFAULT
 0.010

	)

10 
	#CONVERTDOUBLE
 
FALSE


	)

11 
	#COMPILETIME
 "21 S• 2020"

	)

12 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

13 
	#CS1
 "cc"

	)

14 
	#CS2
 "cc"

	)

15 
	#CS3
 "ÒÚe)"

	)

16 
	#CS4
 "-I../commÚ"

	)

17 
	#CS5
 "-O3 "

	)

18 
	#CS6
 "ÒÚe)"

	)

19 
	#CS7
 "¿nddp"

	)

	@rand/c_randdp.c

3 #ià
defšed
(
USE_POW
)

4 
	#r23
 
	`pow
(0.5, 23.0)

	)

5 
	#r46
 (
r23
*r23)

	)

6 
	#t23
 
	`pow
(2.0, 23.0)

	)

7 
	#t46
 (
t23
*t23)

	)

9 
	#r23
 (0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5*0.5)

	)

10 
	#r46
 (
r23
*r23)

	)

11 
	#t23
 (2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0*2.0)

	)

12 
	#t46
 (
t23
*t23)

	)

18 
	$¿ndlc
 (*
x
, 
a
) {

46 
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

51 
t1
 = 
r23
 * 
a
;

52 
a1
 = ()
t1
;

53 
a2
 = 
a
 - 
t23
 * 
a1
;

60 
t1
 = 
r23
 * (*
x
);

61 
x1
 = ()
t1
;

62 
x2
 = (*
x
è- 
t23
 * 
x1
;

63 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

64 
t2
 = ()(
r23
 * 
t1
);

65 
z
 = 
t1
 - 
t23
 * 
t2
;

66 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

67 
t4
 = ()(
r46
 * 
t3
);

68 (*
x
èğ
t3
 - 
t46
 * 
t4
;

70  (
r46
 * (*
x
));

71 
	}
}

76 
	$v¿Æc
 (
n
, *
x_£ed
, 
a
, 
y
[]) {

104 
i
;

105 
x
,
t1
,
t2
,
t3
,
t4
,
a1
,
a2
,
x1
,
x2
,
z
;

110 
t1
 = 
r23
 * 
a
;

111 
a1
 = ()
t1
;

112 
a2
 = 
a
 - 
t23
 * 
a1
;

113 
x
 = *
x_£ed
;

118 
i
 = 1; i <ğ
n
; i++) {

125 
t1
 = 
r23
 * 
x
;

126 
x1
 = ()
t1
;

127 
x2
 = 
x
 - 
t23
 * 
x1
;

128 
t1
 = 
a1
 * 
x2
 + 
a2
 * 
x1
;

129 
t2
 = ()(
r23
 * 
t1
);

130 
z
 = 
t1
 - 
t23
 * 
t2
;

131 
t3
 = 
t23
 * 
z
 + 
a2
 * 
x2
;

132 
t4
 = ()(
r46
 * 
t3
);

133 
x
 = 
t3
 - 
t46
 * 
t4
;

134 
y
[
i
] = 
r46
 * 
x
;

136 *
x_£ed
 = 
x
;

137 
	}
}

	@sys/setparams.c

41 
	~<Çutus/Çutus.h
>

42 
	~<Çutus/sh–l.h
>

43 
	~<Çutus/Çut_¡ršg.h
>

52 
	#VERSION
 "3.0 sŒuùu»d"

	)

57 
	#FILENAME
 "Åb·¿ms.h"

	)

58 
	#DESC_LINE
 "/* CLASS = %ø*/\n"

	)

59 
	#DEF_CLASS_LINE
 "#defšCLASS '%c'\n"

	)

60 
	#FINDENT
 " "

	)

61 
	#CONTINUE
 " > "

	)

63 
g‘_šfo
(*
¬gv
[], *
ty³p
, *
şas¥
);

64 
check_šfo
(
ty³
, 
şass
);

65 
»ad_šfo
(
ty³
, *
şas¥
);

66 
wr™e_šfo
(
ty³
, 
şass
);

67 
wr™e_¥_šfo
(
FILE
 *
å
, 
şass
);

68 
wr™e_bt_šfo
(
FILE
 *
å
, 
şass
);

69 
wr™e_lu_šfo
(
FILE
 *
å
, 
şass
);

70 
wr™e_mg_šfo
(
FILE
 *
å
, 
şass
);

71 
wr™e_cg_šfo
(
FILE
 *
å
, 
şass
);

72 
wr™e_á_šfo
(
FILE
 *
å
, 
şass
);

73 
wr™e_•_šfo
(
FILE
 *
å
, 
şass
);

74 
wr™e_is_šfo
(
FILE
 *
å
, 
şass
);

75 
wr™e_comp”_šfo
(
ty³
, 
FILE
 *
å
);

76 
wr™e_cÚv”tdoubË_šfo
(
ty³
, 
FILE
 *
å
);

77 
check_lše
(*
lše
, *
Ïb–
, *
v®
);

78 
check_šşude_lše
(*
lše
, *
f’ame
);

79 
put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
);

80 
put_def_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
);

81 
put_def_v¬ŸbË
(
FILE
 *
å
, *
Çme
, *
v®
);

82 
og2
(
i
);

84 
	eb’chm¬k_ty³s
 {
	mSP
, 
	mBT
, 
	mLU
, 
	mMG
, 
	mFT
, 
	mIS
, 
	mEP
, 
	mCG
};

86 
	$NAS_’Œy
(
¬gc
, *
¬gv
[])

88 
ty³
;

89 
şass
, 
şass_Şd
;

91 ià(
¬gc
 != 3) {

92 
	`´štf
("U§ge: % b’chm¬k-Çmşass\n", 
¬gv
[0]);

93 
	`ex™
(1);

97 
	`g‘_šfo
(
¬gv
, &
ty³
, &
şass
);

98 ià(
şass
 != 'U') {

99 #ifdeà
VERBOSE


100 
	`´štf
("setparams: For benchmark %s: class = %c\n",

101 
¬gv
[1], 
şass
);

103 
	`check_šfo
(
ty³
, 
şass
);

107 
	`»ad_šfo
(
ty³
, &
şass_Şd
);

108 ià(
şass
 != 'U') {

109 ià(
şass_Şd
 != 'X') {

110 #ifdeà
VERBOSE


111 
	`´štf
("setparams: old settings: class = %c\n",

112 
şass_Şd
);

116 
	`´štf
("setparams:\n\
*********************************************************************\n\
* You must specify CLASSo buildhis benchmark *\n\
* Forƒxample,o build‡ class A benchmark,ype *\n\
* make {benchmark-name} CLASS=A *\n\
*********************************************************************\n\n");

123 ià(
şass_Şd
 != 'X') {

124 #ifdeà
VERBOSE


125 
	`´štf
("£¬ams: P»viou £‰šg w”CLASS=%ø\n", 
şass_Şd
);

128 
	`ex™
(1);

132 ià(
şass
 !ğ
şass_Şd
) {

133 #ifdeà
VERBOSE


134 
	`´štf
("£¬ams: Wr™šg %s\n", 
FILENAME
);

136 
	`wr™e_šfo
(
ty³
, 
şass
);

138 #ifdeà
VERBOSE


139 
	`´štf
("£¬ams: S‘tšg unchªged. % unmodif›d\n", 
FILENAME
);

143 
	`ex™
(0);

144 
	}
}

151 
	$g‘_šfo
(*
¬gv
[], *
ty³p
, *
şas¥
)

154 *
şas¥
 = *
¬gv
[2];

156 ià(!
	`¡rcmp
(
¬gv
[1], "¥"è|| !¡rcmp×rgv[1], "SP")è*
ty³p
 = 
SP
;

157 ià(!
	`¡rcmp
(
¬gv
[1], "bt"è|| !¡rcmp×rgv[1], "BT")è*
ty³p
 = 
BT
;

158 ià(!
	`¡rcmp
(
¬gv
[1], "á"è|| !¡rcmp×rgv[1], "FT")è*
ty³p
 = 
FT
;

159 ià(!
	`¡rcmp
(
¬gv
[1], "lu"è|| !¡rcmp×rgv[1], "LU")è*
ty³p
 = 
LU
;

160 ià(!
	`¡rcmp
(
¬gv
[1], "mg"è|| !¡rcmp×rgv[1], "MG")è*
ty³p
 = 
MG
;

161 ià(!
	`¡rcmp
(
¬gv
[1], "is"è|| !¡rcmp×rgv[1], "IS")è*
ty³p
 = 
IS
;

162 ià(!
	`¡rcmp
(
¬gv
[1], "•"è|| !¡rcmp×rgv[1], "EP")è*
ty³p
 = 
EP
;

163 ià(!
	`¡rcmp
(
¬gv
[1], "cg"è|| !¡rcmp×rgv[1], "CG")è*
ty³p
 = 
CG
;

165 
	`´štf
("£¬ams: E¼Ü: unknowÀb’chm¬ky³ %s\n", 
¬gv
[1]);

166 
	`ex™
(1);

168 
	}
}

174 
	$check_šfo
(
ty³
, 
şass
)

176 
tm¶og
;

179 ià(
şass
 != 'S' &&

180 
şass
 != 'A' &&

181 
şass
 != 'B' &&

182 
şass
 != 'R' &&

183 
şass
 != 'W' &&

184 
şass
 != 'C') {

185 
	`´štf
("£¬ams: UnknowÀb’chm¬k cÏs %c\n", 
şass
);

186 
	`´štf
("setparams: Allowed classes‡re \"S\", \"A\", \"B\"‡nd \"C\"\n");

187 
	`ex™
(1);

190 
	}
}

201 
	$»ad_šfo
(
ty³
, *
şas¥
)

203 
Ä—d
, 
gÙem
 = 0;

204 
lše
[200];

243 
nÜm®_»tuº
:

244 *
şas¥
 = *classp;

245 
	`fşo£
(
å
);

250 
abÜt
:

251 *
şas¥
 = 'X';

253 
	}
}

263 
	$wr™e_šfo
(
ty³
, 
şass
)

340 
	}
}

347 
	$wr™e_¥_šfo
(
FILE
 *
å
, 
şass
)

349 
´obËm_size
, 
n™”
;

350 *
dt
;

351 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt
 = "0.015"; 
n™”
 = 100; }

352 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 36; 
dt
 = "0.0015"; 
n™”
 = 400; }

353 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt
 = "0.0015"; 
n™”
 = 400; }

354 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt
 = "0.001"; 
n™”
 = 400; }

355 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt
 = "0.00067"; 
n™”
 = 400; }

357 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

358 
	`ex™
(1);

360 
	`årštf
(
å
, "#defše\tPROBLEM_SIZE\t%d\n", 
´obËm_size
);

361 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

362 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt
);

363 
	}
}

369 
	$wr™e_bt_šfo
(
FILE
 *
å
, 
şass
)

371 
´obËm_size
, 
n™”
;

372 *
dt
;

373 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt
 = "0.010"; 
n™”
 = 60; }

374 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 24; 
dt
 = "0.0008"; 
n™”
 = 200; }

375 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt
 = "0.0008"; 
n™”
 = 200; }

376 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt
 = "0.0003"; 
n™”
 = 200; }

377 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt
 = "0.0001"; 
n™”
 = 200; }

379 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

380 
	`ex™
(1);

382 
	`årštf
(
å
, "#defše\tPROBLEM_SIZE\t%d\n", 
´obËm_size
);

383 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

384 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt
);

385 
	}
}

393 
	$wr™e_lu_šfo
(
FILE
 *
å
, 
şass
)

395 
isiz1
, 
isiz2
, 
™max
, 
šÜm
, 
´obËm_size
;

396 
xdiv
, 
ydiv
;

397 *
dt_deçuÉ
;

399 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 12; 
dt_deçuÉ
 = "0.5"; 
™max
 = 50; }

400 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 33; 
dt_deçuÉ
 = "1.5e-3"; 
™max
 = 300; }

401 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 64; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

402 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 102; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

403 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 162; 
dt_deçuÉ
 = "2.0"; 
™max
 = 250; }

405 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs %c\n", 
şass
);

406 
	`ex™
(1);

408 
šÜm
 = 
™max
;

409 
isiz1
 = 
´obËm_size
;

410 
isiz2
 = 
´obËm_size
;

412 
	`årštf
(
å
, "\n/* full…roblem size */\n");

413 
	`årštf
(
å
, "#defše\tISIZ1\t%d\n", 
´obËm_size
);

414 
	`årštf
(
å
, "#defše\tISIZ2\t%d\n", 
´obËm_size
);

415 
	`årštf
(
å
, "#defše\tISIZ3\t%d\n", 
´obËm_size
);

417 
	`årštf
(
å
, "/*‚umber of iterations‡nd how ofteno…rinthe‚orm */\n");

418 
	`årštf
(
å
, "#defše\tITMAX_DEFAULT\t%d\n", 
™max
);

419 
	`årštf
(
å
, "#defše\tINORM_DEFAULT\t%d\n", 
šÜm
);

421 
	`årštf
(
å
, "#defše\tDT_DEFAULT\t%s\n", 
dt_deçuÉ
);

422 
	}
}

428 
	$wr™e_mg_šfo
(
FILE
 *
å
, 
şass
)

430 
´obËm_size
, 
n™
, 
log2_size
, 
É_deçuÉ
, 
lm
;

431 
ndim1
, 
ndim2
, 
ndim3
;

432 ià(
şass
 =ğ'S'è{ 
´obËm_size
 = 32; 
n™
 = 4; }

433 ià(
şass
 =ğ'W'è{ 
´obËm_size
 = 64; 
n™
 = 40; }

434 ià(
şass
 =ğ'A'è{ 
´obËm_size
 = 256; 
n™
 = 4; }

435 ià(
şass
 =ğ'B'è{ 
´obËm_size
 = 256; 
n™
 = 20; }

436 ià(
şass
 =ğ'C'è{ 
´obËm_size
 = 512; 
n™
 = 20; }

438 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

439 
	`ex™
(1);

441 
log2_size
 = 
	`og2
(
´obËm_size
);

443 
É_deçuÉ
 = 
log2_size
;

445 
lm
 = 
log2_size
;

446 
ndim1
 = 
lm
;

447 
ndim3
 = 
log2_size
;

448 
ndim2
 = 
log2_size
;

450 
	`årštf
(
å
, "#defše\tNX_DEFAULT\t%d\n", 
´obËm_size
);

451 
	`årštf
(
å
, "#defše\tNY_DEFAULT\t%d\n", 
´obËm_size
);

452 
	`årštf
(
å
, "#defše\tNZ_DEFAULT\t%d\n", 
´obËm_size
);

453 
	`årštf
(
å
, "#defše\tNIT_DEFAULT\t%d\n", 
n™
);

454 
	`årštf
(
å
, "#defše\tLM\t%d\n", 
lm
);

455 
	`årštf
(
å
, "#defše\tLT_DEFAULT\t%d\n", 
É_deçuÉ
);

456 
	`årštf
(
å
, "#define\tDEBUG_DEFAULT\t%d\n", 0);

457 
	`årštf
(
å
, "#defše\tNDIM1\t%d\n", 
ndim1
);

458 
	`årštf
(
å
, "#defše\tNDIM2\t%d\n", 
ndim2
);

459 
	`årštf
(
å
, "#defše\tNDIM3\t%d\n", 
ndim3
);

460 
	}
}

467 
	$wr™e_is_šfo
(
FILE
 *
å
, 
şass
)

469 
m1
, 
m2
, 
m3
 ;

470 ifĞ
şass
 != 'S' &&

471 
şass
 != 'W' &&

472 
şass
 != 'A' &&

473 
şass
 != 'B' &&

474 
şass
 != 'C')

476 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

477 
	`ex™
(1);

479 
	}
}

486 
	$wr™e_cg_šfo
(
FILE
 *
å
, 
şass
)

488 
Ç
,
nÚz”
,
n™”
;

489 *
shiá
,*
rcÚd
="1.0e-1";

490 *
shiáS
="10.0",

491 *
shiáW
="12.0",

492 *
shiáA
="20.0",

493 *
shiáB
="60.0",

494 *
shiáC
="110.0";

497 ifĞ
şass
 == 'S' )

498 { 
Ç
=1400; 
nÚz”
=7; 
n™”
=15; 
shiá
=
shiáS
; }

499 ifĞ
şass
 == 'W' )

500 { 
Ç
=7000; 
nÚz”
=8; 
n™”
=15; 
shiá
=
shiáW
; }

501 ifĞ
şass
 == 'A' )

502 { 
Ç
=14000; 
nÚz”
=11; 
n™”
=15; 
shiá
=
shiáA
; }

503 ifĞ
şass
 == 'B' )

504 { 
Ç
=75000; 
nÚz”
=13; 
n™”
=75; 
shiá
=
shiáB
; }

505 ifĞ
şass
 == 'C' )

506 { 
Ç
=150000; 
nÚz”
=15; 
n™”
=75; 
shiá
=
shiáC
; }

509 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

510 
	`ex™
(1);

512 
	`årštf
Ğ
å
, "#defše\tNA\t%d\n", 
Ç
);

513 
	`årštf
Ğ
å
, "#defše\tNONZER\t%d\n", 
nÚz”
);

514 
	`årštf
Ğ
å
, "#defše\tNITER\t%d\n", 
n™”
);

515 
	`årštf
Ğ
å
, "#defše\tSHIFT\t%s\n", 
shiá
);

516 
	`årštf
Ğ
å
, "#defše\tRCOND\t%s\n", 
rcÚd
);

517 
	}
}

524 
	$wr™e_á_šfo
(
FILE
 *
å
, 
şass
)

530 
nx
, 
ny
, 
nz
, 
maxdim
, 
n™”
, 
Å_mš
;

531 ià(
şass
 =ğ'S'è{ 
nx
 = 64; 
ny
 = 64; 
nz
 = 64; 
n™”
 = 6;}

532 ià(
şass
 =ğ'W'è{ 
nx
 = 128; 
ny
 = 128; 
nz
 = 32; 
n™”
 = 6;}

533 ià(
şass
 =ğ'A'è{ 
nx
 = 256; 
ny
 = 256; 
nz
 = 128; 
n™”
 = 6;}

534 ià(
şass
 =ğ'B'è{ 
nx
 = 512; 
ny
 = 256; 
nz
 = 256; 
n™”
 =20;}

535 ià(
şass
 =ğ'C'è{ 
nx
 = 512; 
ny
 = 512; 
nz
 = 512; 
n™”
 =20;}

537 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

538 
	`ex™
(1);

540 
maxdim
 = 
nx
;

541 ià(
ny
 > 
maxdim
) maxdim =‚y;

542 ià(
nz
 > 
maxdim
) maxdim =‚z;

543 
	`årštf
(
å
, "#defše\tNX\t%d\n", 
nx
);

544 
	`årštf
(
å
, "#defše\tNY\t%d\n", 
ny
);

545 
	`årštf
(
å
, "#defše\tNZ\t%d\n", 
nz
);

546 
	`årštf
(
å
, "#defše\tMAXDIM\t%d\n", 
maxdim
);

547 
	`årštf
(
å
, "#defše\tNITER_DEFAULT\t%d\n", 
n™”
);

548 
	`årštf
(
å
, "#defše\tNTOTAL\t%d\n", 
nx
*
ny
*
nz
);

549 
	}
}

555 
	$wr™e_•_šfo
(
FILE
 *
å
, 
şass
)

561 
m
;

562 ià(
şass
 =ğ'S'è{ 
m
 = 24; }

563 ià(
şass
 =ğ'W'è{ 
m
 = 25; }

564 ià(
şass
 =ğ'A'è{ 
m
 = 28; }

565 ià(
şass
 =ğ'B'è{ 
m
 = 30; }

566 ià(
şass
 =ğ'C'è{ 
m
 = 32; }

568 
	`´štf
("£¬ams: IÁ”ÇÈ”rÜ: inv®id cÏs ty³ %c\n", 
şass
);

569 
	`ex™
(1);

572 
	`årštf
(
å
, "#defše\tCLASS\ˆ\'%c\'\n", 
şass
);

573 
	`årštf
(
å
, "#defše\tM\t%d\n", 
m
);

574 
	}
}

589 
	#VERBOSE


	)

590 
	#LL
 400

	)

591 
	~<¡dio.h
>

592 
	#DEFFILE
 "../cÚfig/make.def"

	)

593 
	#DEFAULT_MESSAGE
 "ÒÚe)"

	)

594 
	$wr™e_comp”_šfo
(
ty³
, 
FILE
 *
å
)

596 
FILE
 *
deffe
;

597 
lše
[
LL
];

598 
f77
[
LL
], 
æšk
[LL], 
f_lib
[LL], 
f_šc
[LL], 
fæags
[LL], 
æškæags
[LL];

599 
comp‘ime
[
LL
], 
¿ndfe
[LL];

600 
cc
[
LL
], 
cæags
[LL], 
şšk
[LL], 
şškæags
[LL],

601 
c_lib
[
LL
], 
c_šc
[LL];

602 
tm
 *
tmp
;

603 
time_t
 
t
;

604 
deffe
 = 
	`fİ’
(
DEFFILE
, "r");

605 ià(
deffe
 =ğ
NULL
) {

606 
	`´štf
("\n\
: F% dÛ¢'ˆexi¡. TØbudhNAS b’chm¬ks\n\
‚“dØü—‹ i accÜdšgØthš¡ruùiÚs\n\
hREADME iÀthmaš dœeùÜy‡nd comm’t š \n\
 fcÚfig/make.def.‹m¶©e\n", 
DEFFILE
);

611 
	`ex™
(1);

613 
	`¡rıy
(
f77
, 
DEFAULT_MESSAGE
);

614 
	`¡rıy
(
æšk
, 
DEFAULT_MESSAGE
);

615 
	`¡rıy
(
f_lib
, 
DEFAULT_MESSAGE
);

616 
	`¡rıy
(
f_šc
, 
DEFAULT_MESSAGE
);

617 
	`¡rıy
(
fæags
, 
DEFAULT_MESSAGE
);

618 
	`¡rıy
(
æškæags
, 
DEFAULT_MESSAGE
);

619 
	`¡rıy
(
¿ndfe
, 
DEFAULT_MESSAGE
);

620 
	`¡rıy
(
cc
, 
DEFAULT_MESSAGE
);

621 
	`¡rıy
(
cæags
, 
DEFAULT_MESSAGE
);

622 
	`¡rıy
(
şšk
, 
DEFAULT_MESSAGE
);

623 
	`¡rıy
(
şškæags
, 
DEFAULT_MESSAGE
);

624 
	`¡rıy
(
c_lib
, 
DEFAULT_MESSAGE
);

625 
	`¡rıy
(
c_šc
, 
DEFAULT_MESSAGE
);

627 
	`fg‘s
(
lše
, 
LL
, 
deffe
è!ğ
NULL
) {

628 ià(*
lše
 == '#') ;

630 
	`check_lše
(
lše
, "F77", 
f77
);

631 
	`check_lše
(
lše
, "FLINK", 
æšk
);

632 
	`check_lše
(
lše
, "F_LIB", 
f_lib
);

633 
	`check_lše
(
lše
, "F_INC", 
f_šc
);

634 
	`check_lše
(
lše
, "FFLAGS", 
fæags
);

635 
	`check_lše
(
lše
, "FLINKFLAGS", 
æškæags
);

636 
	`check_lše
(
lše
, "RAND", 
¿ndfe
);

637 
	`check_lše
(
lše
, "CC", 
cc
);

638 
	`check_lše
(
lše
, "CFLAGS", 
cæags
);

639 
	`check_lše
(
lše
, "CLINK", 
şšk
);

640 
	`check_lše
(
lše
, "CLINKFLAGS", 
şškæags
);

641 
	`check_lše
(
lše
, "C_LIB", 
c_lib
);

642 
	`check_lše
(
lše
, "C_INC", 
c_šc
);

646 (è
	`time
(&
t
);

647 
tmp
 = 
	`loÿÉime
(&
t
);

648 (è
	`¡ráime
(
comp‘ime
, (
size_t
)
LL
, "%d %b %Y", 
tmp
);

651 
ty³
) {

652 
FT
:

653 
SP
:

654 
BT
:

655 
MG
:

656 
LU
:

657 
EP
:

658 
CG
:

659 
	`put_def_¡ršg
(
å
, "COMPILETIME", 
comp‘ime
);

660 
	`put_def_¡ršg
(
å
, "NPBVERSION", 
VERSION
);

661 
	`put_def_¡ršg
(
å
, "CS1", 
cc
);

662 
	`put_def_¡ršg
(
å
, "CS2", 
şšk
);

663 
	`put_def_¡ršg
(
å
, "CS3", 
c_lib
);

664 
	`put_def_¡ršg
(
å
, "CS4", 
c_šc
);

665 
	`put_def_¡ršg
(
å
, "CS5", 
cæags
);

666 
	`put_def_¡ršg
(
å
, "CS6", 
şškæags
);

667 
	`put_def_¡ršg
(
å
, "CS7", 
¿ndfe
);

669 
IS
:

670 
	`put_def_¡ršg
(
å
, "COMPILETIME", 
comp‘ime
);

671 
	`put_def_¡ršg
(
å
, "NPBVERSION", 
VERSION
);

672 
	`put_def_¡ršg
(
å
, "CC", 
cc
);

673 
	`put_def_¡ršg
(
å
, "CFLAGS", 
cæags
);

674 
	`put_def_¡ršg
(
å
, "CLINK", 
şšk
);

675 
	`put_def_¡ršg
(
å
, "CLINKFLAGS", 
şškæags
);

676 
	`put_def_¡ršg
(
å
, "C_LIB", 
c_lib
);

677 
	`put_def_¡ršg
(
å
, "C_INC", 
c_šc
);

680 
	`´štf
("setparams: (Internalƒrror): Unknown benchmarkype %d\n",

681 
ty³
);

682 
	`ex™
(1);

685 
	}
}

687 
	$check_lše
(*
lše
, *
Ïb–
, *
v®
)

689 *
Üigš®_lše
;

690 
Üigš®_lše
 = 
lše
;

692 *
Ïb–
 !ğ'\0' && *
lše
 == *label) {

693 
lše
++; 
Ïb–
++;

696 ià(*
Ïb–
 != '\0') ;

698 ià(!
	`is¥aû
(*
lše
) && *line != '=')  ;

700 
	`is¥aû
(*
lše
))†ine++;

702 ià(*
lše
 != '=') ;

704 
	`is¥aû
(*++
lše
));

706 ià(*
lše
 == '\0') ;

708 
	`¡rıy
(
v®
, 
lše
);

710 
v®
[
	`¡¾’
(val)-1] = '\0';

711 ià(
v®
[
	`¡¾’
(val) - 1] == '\\') {

712 
	`´štf
("\n\
: E¼Ü iÀfmake.def. Beÿu£ oàthway iÀwhich\n\
†š¬gum’t ¬šcÜpÜ©ed iÁØthe\n\
 b’chm¬k, you cª'ˆhavªy cÚtšued\n\
 iÀthfmake.def,h© is,†še ’dšg\n\
hch¬aù” \"\\\". AÉhough iˆmay bugly, \n\
 should babËØ»fÜm© w™houˆcÚtšu©iÚ\n\
. Thofãndšg†šis\n\
%s\n", 
Üigš®_lše
);

721 
	`ex™
(1);

723 
	}
}

725 
	$check_šşude_lše
(*
lše
, *
f’ame
)

727 *
šşude_¡ršg
 = "include";

729 *
šşude_¡ršg
 !ğ'\0' && *
lše
 == *include_string) {

730 
lše
++; 
šşude_¡ršg
++;

733 ià(*
šşude_¡ršg
 != '\0') (0);

735 ià(!
	`is¥aû
(*
lše
)) (0);

737 
	`is¥aû
(*++
lše
));

739 ià(*
lše
 == '\0') (0);

741 *
f’ame
 !ğ'\0' && *
lše
 == *filename) {

742 
lše
++; 
f’ame
++;

744 ià(*
f’ame
 != '\0' ||

745 (*
lše
 != ' ' && *line != '\0' && *line !='\n')) (0);

747 
	}
}

750 
	#MAXL
 46

	)

751 
	$put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

753 
Ën
;

754 
Ën
 = 
	`¡¾’
(
v®
);

755 ià(
Ën
 > 
MAXL
) {

756 
v®
[
MAXL
] = '\0';

757 
v®
[
MAXL
-1] = '.';

758 
v®
[
MAXL
-2] = '.';

759 
v®
[
MAXL
-3] = '.';

760 
Ën
 = 
MAXL
;

762 
	`årštf
(
å
, "%sch¬aù”*%d %s\n", 
FINDENT
, 
Ën
, 
Çme
);

763 
	`årštf
(
å
, "%¥¬am‘” (%s=\'%s\')\n", 
FINDENT
, 
Çme
, 
v®
);

764 
	}
}

767 
	$put_def_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

769 
Ën
;

770 
Ën
 = 
	`¡¾’
(
v®
);

771 ià(
Ën
 > 
MAXL
) {

772 
v®
[
MAXL
] = '\0';

773 
v®
[
MAXL
-1] = '.';

774 
v®
[
MAXL
-2] = '.';

775 
v®
[
MAXL
-3] = '.';

776 
Ën
 = 
MAXL
;

778 
	`årštf
(
å
, "#defš% \"%s\"\n", 
Çme
, 
v®
);

779 
	}
}

781 
	$put_def_v¬ŸbË
(
FILE
 *
å
, *
Çme
, *
v®
)

783 
Ën
;

784 
Ën
 = 
	`¡¾’
(
v®
);

785 ià(
Ën
 > 
MAXL
) {

786 
v®
[
MAXL
] = '\0';

787 
v®
[
MAXL
-1] = '.';

788 
v®
[
MAXL
-2] = '.';

789 
v®
[
MAXL
-3] = '.';

790 
Ën
 = 
MAXL
;

792 
	`årštf
(
å
, "#defš% %s\n", 
Çme
, 
v®
);

793 
	}
}

804 
	#LINELEN
 65

	)

805 
	$put_¡ršg
(
FILE
 *
å
, *
Çme
, *
v®
)

807 
Ën
, 
Æšes
, 
pos
, 
i
;

808 
lše
[100];

809 
Ën
 = 
	`¡¾’
(
v®
);

810 
Æšes
 = 
Ën
/
LINELEN
;

811 ià(
Æšes
*
LINELEN
 < 
Ën
)‚lines++;

812 
	`årštf
(
å
, "%sch¬aù”*%d %s\n", 
FINDENT
, 
Æšes
*
LINELEN
, 
Çme
);

813 
	`årštf
(
å
, "%¥¬am‘” (% ğ\n", 
FINDENT
, 
Çme
);

814 
i
 = 0; i < 
Æšes
; i++) {

815 
pos
 = 
i
*
LINELEN
;

816 ià(
i
 =ğ0è
	`årštf
(
å
, "%s\'", 
CONTINUE
);

817 
	`årštf
(
å
, "%s", 
CONTINUE
);

819 
	`årštf
(
å
, "%.65s", 
v®
+
pos
);

820 ià(
i
 =ğ
Æšes
-1è
	`årštf
(
å
, "\')\n");

821 
	`årštf
(
å
, "\n");

823 
	}
}

832 
	$og2
(
i
)

834 
log2
;

835 
exp2
 = 1;

836 ià(
i
 <= 0) (-1);

838 
log2
 = 0;†og2 < 20;†og2++) {

839 ià(
exp2
 =ğ
i
è(
log2
);

840 
exp2
 *= 2;

843 
	}
}

847 
	$wr™e_cÚv”tdoubË_šfo
(
ty³
, 
FILE
 *
å
)

849 
ty³
) {

850 
SP
:

851 
BT
:

852 
LU
:

853 
FT
:

854 
MG
:

855 
EP
:

856 
CG
:

857 #ifdeà
CONVERTDOUBLE


858 
	`årštf
(
å
, "#define\tCONVERTDOUBLE\tTRUE\n");

860 
	`årštf
(
å
, "#define\tCONVERTDOUBLE\tFALSE\n");

864 
	}
}

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	#__Ãed___va_li¡


	)

36 
	~<¡d¬g.h
>

38 
	~<b™s/ty³s.h
>

39 
	~<b™s/ty³s/__åos_t.h
>

40 
	~<b™s/ty³s/__åos64_t.h
>

41 
	~<b™s/ty³s/__FILE.h
>

42 
	~<b™s/ty³s/FILE.h
>

43 
	~<b™s/ty³s/¡ruù_FILE.h
>

45 #ifdeà
__USE_GNU


46 
	~<b™s/ty³s/cook›_io_funùiÚs_t.h
>

49 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


50 #ifdeà
__GNUC__


51 #iâdeà
_VA_LIST_DEFINED


52 
__gnuc_va_li¡
 
	tva_li¡
;

53 
	#_VA_LIST_DEFINED


	)

56 
	~<¡d¬g.h
>

60 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__off_t_defšed


62 #iâdeà
__USE_FILE_OFFSET64


63 
__off_t
 
	toff_t
;

65 
__off64_t
 
	toff_t
;

67 
	#__off_t_defšed


	)

69 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


70 
__off64_t
 
	toff64_t
;

71 
	#__off64_t_defšed


	)

75 #ifdeà
__USE_XOPEN2K8


76 #iâdeà
__ssize_t_defšed


77 
__ssize_t
 
	tssize_t
;

78 
	#__ssize_t_defšed


	)

83 #iâdeà
__USE_FILE_OFFSET64


84 
__åos_t
 
	tåos_t
;

86 
__åos64_t
 
	tåos_t
;

88 #ifdeà
__USE_LARGEFILE64


89 
__åos64_t
 
	tåos64_t
;

93 
	#_IOFBF
 0

	)

94 
	#_IOLBF
 1

	)

95 
	#_IONBF
 2

	)

99 
	#BUFSIZ
 8192

	)

104 
	#EOF
 (-1)

	)

109 
	#SEEK_SET
 0

	)

110 
	#SEEK_CUR
 1

	)

111 
	#SEEK_END
 2

	)

112 #ifdeà
__USE_GNU


113 
	#SEEK_DATA
 3

	)

114 
	#SEEK_HOLE
 4

	)

118 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


120 
	#P_tmpdœ
 "/tmp"

	)

133 
	~<b™s/¡dio_lim.h
>

137 
FILE
 *
¡dš
;

138 
FILE
 *
¡dout
;

139 
FILE
 *
¡d”r
;

141 
	#¡dš
 
¡dš


	)

142 
	#¡dout
 
¡dout


	)

143 
	#¡d”r
 
¡d”r


	)

146 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

148 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

150 #ifdeà
__USE_ATFILE


152 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

153 cÚ¡ *
__Ãw
è
__THROW
;

156 #ifdeà
__USE_GNU


158 
	#RENAME_NOREPLACE
 (1 << 0)

	)

159 
	#RENAME_EXCHANGE
 (1 << 1)

	)

160 
	#RENAME_WHITEOUT
 (1 << 2)

	)

164 
	$»Çm—t2
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

165 cÚ¡ *
__Ãw
, 
__æags
è
__THROW
;

172 #iâdeà
__USE_FILE_OFFSET64


173 
FILE
 *
	$tmpfe
 (è
__wur
;

175 #ifdeà
__REDIRECT


176 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

178 
	#tmpfe
 
tmpfe64


	)

182 #ifdeà
__USE_LARGEFILE64


183 
FILE
 *
	$tmpfe64
 (è
__wur
;

187 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

213 
	`fşo£
 (
FILE
 *
__¡»am
);

218 
	`fæush
 (
FILE
 *
__¡»am
);

220 #ifdeà
__USE_MISC


227 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

230 #ifdeà
__USE_GNU


237 
	`fşo£®l
 ();

241 #iâdeà
__USE_FILE_OFFSET64


246 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

252 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

253 cÚ¡ *
__»¡riù
 
__modes
,

254 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

256 #ifdeà
__REDIRECT


257 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

258 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

259 
__wur
;

260 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

261 cÚ¡ *
__»¡riù
 
__modes
,

262 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

263 
__wur
;

265 
	#fİ’
 
fİ’64


	)

266 
	#äeİ’
 
äeİ’64


	)

269 #ifdeà
__USE_LARGEFILE64


270 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

271 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

272 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
,

274 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

277 #ifdef 
__USE_POSIX


279 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

282 #ifdef 
__USE_GNU


285 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

286 cÚ¡ *
__»¡riù
 
__modes
,

287 
cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

290 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

292 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

293 
__THROW
 
__wur
;

298 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

304 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

308 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

309 
__modes
, 
size_t
 
__n
è
__THROW
;

311 #ifdef 
__USE_MISC


314 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

315 
size_t
 
__size
è
__THROW
;

318 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

326 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

327 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

332 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

334 
	$¥rštf
 (*
__»¡riù
 
__s
,

335 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

341 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

342 
__gnuc_va_li¡
 
__¬g
);

347 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
);

349 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

350 
__gnuc_va_li¡
 
__¬g
è
__THROWNL
;

352 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


354 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

355 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

356 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

358 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

359 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

363 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

366 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

367 
__gnuc_va_li¡
 
__¬g
)

368 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

369 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

370 cÚ¡ *
__»¡riù
 
__fmt
, ...)

371 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

372 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

373 cÚ¡ *
__»¡riù
 
__fmt
, ...)

374 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

377 #ifdeà
__USE_XOPEN2K8


379 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

380 
__gnuc_va_li¡
 
__¬g
)

381 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

382 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

383 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

391 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

392 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

397 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

399 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

400 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

405 #ià!
	`__GLIBC_USE
 (
DEPRECATED_SCANF
è&& !
defšed
 
__LDBL_COMPAT


406 #ifdeà
__REDIRECT


407 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

409 
__isoc99_fsÿnf
è
__wur
;

410 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

411 
__isoc99_sÿnf
è
__wur
;

412 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

413 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

414 
__isoc99_ssÿnf
);

416 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

417 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

418 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

419 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

420 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

421 
	#fsÿnf
 
__isoc99_fsÿnf


	)

422 
	#sÿnf
 
__isoc99_sÿnf


	)

423 
	#ssÿnf
 
__isoc99_ssÿnf


	)

427 #ifdef 
__USE_ISOC99


432 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

433 
__gnuc_va_li¡
 
__¬g
)

434 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

440 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

441 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

444 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

446 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

449 #ià!
	`__GLIBC_USE
 (
DEPRECATED_SCANF
)

450 #ià
defšed
 
__REDIRECT
 && !defšed 
__LDBL_COMPAT


451 
	`__REDIRECT
 (
vfsÿnf
,

452 (
FILE
 *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
),

454 
__isoc99_vfsÿnf
)

455 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

456 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

457 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

458 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

459 
	`__REDIRECT_NTH
 (
vssÿnf
,

460 (cÚ¡ *
__»¡riù
 
__s
,

461 cÚ¡ *
__»¡riù
 
__fÜm©
,

462 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

463 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

464 #–ià!
defšed
 
__REDIRECT


465 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

466 cÚ¡ *
__»¡riù
 
__fÜm©
,

467 
__gnuc_va_li¡
 
__¬g
è
__wur
;

468 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

469 
__gnuc_va_li¡
 
__¬g
è
__wur
;

470 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

471 cÚ¡ *
__»¡riù
 
__fÜm©
,

472 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

473 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

474 
	#vsÿnf
 
__isoc99_vsÿnf


	)

475 
	#vssÿnf
 
__isoc99_vssÿnf


	)

485 
	`fg‘c
 (
FILE
 *
__¡»am
);

486 
	`g‘c
 (
FILE
 *
__¡»am
);

492 
	`g‘ch¬
 ();

494 #ifdeà
__USE_POSIX199506


499 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

500 
	`g‘ch¬_uÆocked
 ();

503 #ifdeà
__USE_MISC


510 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

521 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

522 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

528 
	`putch¬
 (
__c
);

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
__ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
__ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
__ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
__gnuc_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 
	`__uæow
 (
FILE
 *);

859 
	`__ov”æow
 (
FILE
 *, );

863 #ifdeà
__USE_EXTERN_INLINES


864 
	~<b™s/¡dio.h
>

866 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


867 
	~<b™s/¡dio2.h
>

869 #ifdeà
__LDBL_COMPAT


870 
	~<b™s/¡dio-ldbl.h
>

873 
__END_DECLS


	@
1
.
1
/usr/include
55
889
BT/bt.c
BT/bt.old.c
BT/bt.old2.c
BT/bt.swap.c
BT/header.h
BT/npbparams.h
BT/old.c
BT/toy.c
CG/cg.c
CG/npbparams.h
EP/ep.c
EP/npbparams.h
FT/ft.c
FT/global.h
FT/npbparams.h
IS/is.c
IS/npbparams.h
LU/applu.h
LU/lu.c
LU/npbparams.h
MG/globals.h
MG/mg.c
MG/npbparams.h
SP/header.h
SP/npbparams.h
SP/sp.c
common/c_print_results.c
common/c_timers.c
common/common.h
common/npb-C.h
common/wtime.c
common/wtime.h
common/wtime_sgi64.c
math/exp/nas_exp.h
math/log/frexp.h
math/log/nas_log.h
math/log/test.c
math/nas_math.h
math/pow/nas_pow.h
math/pow/test.c
math/sincos/__sincostab.h
math/sincos/nas_branred.c
math/sincos/nas_branred.h
math/sincos/nas_branred_type.h
math/sincos/nas_endian.h
math/sincos/nas_mydefs.h
math/sincos/nas_sincos.c
math/sincos/nas_sincos.h
math/sincos/nas_type.h
math/sincos/sincos_test.c
math/sincos/test.c
npbparams.h
rand/c_randdp.c
sys/setparams.c
/usr/include/stdio.h
