cscope 15 $HOME/nautilus-NPB/src/test/openmp/NPB-NAS/EP               0000006786
	@ep.c

35 
	~"../commÚ/Åb-C.h
"

36 
	~"Åb·¿ms.h
"

37 
	~"../m©h/Çs_m©h.h
"

39 
	#M
 24

	)

40 
	#CLASS
 "E"

	)

41 
	#MK
 16

	)

42 
	#MM
 (
M
 - 
MK
)

	)

43 
	#NN
 (1 << 
MM
)

	)

44 
	#NK
 (1 << 
MK
)

	)

45 
	#NQ
 10

	)

46 
	#EPSILON
 1.0e-8

	)

47 
	#A
 1220703125.0

	)

48 
	#S
 271828183.0

	)

49 
	#TIMERS_ENABLED
 
FALSE


	)

53 
	gx
[2*
NK
];

54 #´agm¨
omp
 
th»ad´iv©e
(
x
)

55 
	gq
[
NQ
];

69 
	~<Çutžus/Çutžus.h
>

70 
	~<Çutžus/sh–l.h
>

71 
	~<Çutžus/libccom·t.h
>

73 
´og¿m_EP
(*
buf
, * 
´iv
);

75 
sh–l_cmd_im¶
 
	gÇs_•_im¶
 = {

76 .
cmd
 = "nas-ep",

77 .
	gh–p_¡r
 = "NAS…arallel benchmark EP",

78 .
	ghªdËr
 = 
´og¿m_EP
,

80 
nk_»gi¡”_sh–l_cmd
(
Çs_•_im¶
);

84 
	$´og¿m_EP
(*
buf
, * 
´iv
) {

86 
MÝs
, 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
, 
sx
, 
sy
, 
tm
, 
ª
, 
‰
, 
gc
;

87 
dum
[3] = { 1.0, 1.0, 1.0 };

88 
Å
, 
›¼
, 
node
, 
no_nodes
, 
i
, 
ik
, 
kk
, 
l
, 
k
, 
n™
, 
›¼code
,

89 
no_Ïrge_nodes
, 
Å_add
, 
k_off£t
, 
j
;

90 
Áh»ads
 = 1;

91 
boÞ—n
 
v”if›d
;

92 
size
[13+1];

101 
	`´štf
("\n\n NAS Parallel Benchmarks 3.0 structured OpenMP C version"

103 
	`¥rštf
(
size
, "%12.0f", 
	`pow
(2.0, 
M
+1));

104 
j
 = 13; j >= 1; j--) {

105 ià(
size
[
j
] == '.') size[j] = ' ';

107 
	`´štf
(" Numb” oà¿ndom‚umb” g’”©ed: %13s\n", 
size
);

109 
v”if›d
 = 
FALSE
;

116 
Å
 = 
NN
;

124 
	`v¿Æc
(0, &(
dum
[0]), dum[1], &(dum[2]));

125 
dum
[0] = 
	`¿ndlc
(&(dum[1]), dum[2]);

127 #´agm¨
omp
 
·¿Î–
 (
sh¬ed
è
	`´iv©e
(
i
)

128 
i
 = 0; i < 2*
NK
; i++è
x
[i] = -1.0e99;

130 
MÝs
 = 0.0;

132 
	`tim”_þ—r
(1);

133 
	`tim”_þ—r
(2);

134 
	`tim”_þ—r
(3);

135 
	`tim”_¡¬t
(1);

137 
	`v¿Æc
(0, &
t1
, 
A
, 
x
);

141 
t1
 = 
A
;

143  
i
 = 1; i <ð
MK
+1; i++) {

144 
t2
 = 
	`¿ndlc
(&
t1
,1);

147 
ª
 = 
t1
;

148 
‰
 = 
S
;

149 
gc
 = 0.0;

150 
sx
 = 0.0;

151 
sy
 = 0.0;

153  
i
 = 0; i <ð
NQ
 - 1; i++) {

154 
q
[
i
] = 0.0;

162 
k_off£t
 = -1;

164 #´agm¨
omp
 
·¿Î–
 
	`cÝyš
(
x
)

166 
t1
, 
t2
, 
t3
, 
t4
, 
x1
, 
x2
;

167 
kk
, 
i
, 
ik
, 
l
;

168 
qq
[
NQ
];

170 
i
 = 0; i < 
NQ
; i++è
qq
[i] = 0.0;

172 #´agm¨
omp
 
	`»duùiÚ
(+:
sx
,
sy
è
	`scheduË
()

173 
k
 = 1; k <ð
Å
; k++) {

174 
kk
 = 
k_off£t
 + 
k
;

175 
t1
 = 
S
;

176 
t2
 = 
ª
;

180 
i
 = 1; i <= 100; i++) {

181 
ik
 = 
kk
 / 2;

182 ià(2 * 
ik
 !ð
kk
è
t3
 = 
	`¿ndlc
(&
t1
, 
t2
);

183 ià(
ik
 == 0) ;

184 
t3
 = 
	`¿ndlc
(&
t2
,2);

185 
kk
 = 
ik
;

190 ià(
TIMERS_ENABLED
 =ð
TRUE
è
	`tim”_¡¬t
(3);

191 
	`v¿Æc
(2*
NK
, &
t1
, 
A
, 
x
-1);

192 ià(
TIMERS_ENABLED
 =ð
TRUE
è
	`tim”_¡Ý
(3);

199 ià(
TIMERS_ENABLED
 =ð
TRUE
è
	`tim”_¡¬t
(2);

201  
i
 = 0; i < 
NK
; i++) {

202 
x1
 = 2.0 * 
x
[2*
i
] - 1.0;

203 
x2
 = 2.0 * 
x
[2*
i
+1] - 1.0;

204 
t1
 = 
	`pow2
(
x1
è+…ow2(
x2
);

205 ià(
t1
 <= 1.0) {

206 
t2
 = 
	`sq¹
(-2.0 * 
	`log
(
t1
) /1);

207 
t3
 = (
x1
 * 
t2
);

208 
t4
 = (
x2
 * 
t2
);

209 
l
 = 
	`max
(
	`çbs
(
t3
), fabs(
t4
));

210 
qq
[
l
] += 1.0;

211 
sx
 = sx + 
t3
;

212 
sy
 = sy + 
t4
;

215 ià(
TIMERS_ENABLED
 =ð
TRUE
è
	`tim”_¡Ý
(2);

217 #´agm¨
omp
 
ü™iÿl


219 
i
 = 0; i <ð
NQ
 - 1; i++è
q
[i] +ð
qq
[i];

221 #ià
	`defšed
(
_OPENMP
)

222 #´agm¨
omp
 
ma¡”


223 
Áh»ads
 = 
	`omp_g‘_num_th»ads
();

227 
i
 = 0; i <ð
NQ
-1; i++) {

228 
gc
 = gø+ 
q
[
i
];

231 
	`tim”_¡Ý
(1);

232 
tm
 = 
	`tim”_»ad
(1);

234 
n™
 = 0;

235 ià(
M
 == 24) {

236 if((
	`çbs
((
sx
- (-3.247834652034740e3))/sxè<ð
EPSILON
) &&

237 (
	`çbs
((
sy
- (-6.958407078382297e3))/syè<ð
EPSILON
)) {

238 
v”if›d
 = 
TRUE
;

240 } ià(
M
 == 25) {

241 ià((
	`çbs
((
sx
- (-2.863319731645753e3))/sxè<ð
EPSILON
) &&

242 (
	`çbs
((
sy
- (-6.320053679109499e3))/syè<ð
EPSILON
)) {

243 
v”if›d
 = 
TRUE
;

245 } ià(
M
 == 28) {

246 ià((
	`çbs
((
sx
- (-4.295875165629892e3))/sxè<ð
EPSILON
) &&

247 (
	`çbs
((
sy
- (-1.580732573678431e4))/syè<ð
EPSILON
)) {

248 
v”if›d
 = 
TRUE
;

250 } ià(
M
 == 30) {

251 ià((
	`çbs
((
sx
- (4.033815542441498e4))/sxè<ð
EPSILON
) &&

252 (
	`çbs
((
sy
- (-2.660669192809235e4))/syè<ð
EPSILON
)) {

253 
v”if›d
 = 
TRUE
;

255 } ià(
M
 == 32) {

256 ià((
	`çbs
((
sx
- (4.764367927995374e4))/sxè<ð
EPSILON
) &&

257 (
	`çbs
((
sy
- (-8.084072988043731e4))/syè<ð
EPSILON
)) {

258 
v”if›d
 = 
TRUE
;

262 
MÝs
 = 
	`pow
(2.0, 
M
+1)/
tm
/1000000.0;

264 
	`´štf
("EP Benchmark Results: \n"

270 
tm
, 
M
, 
gc
, 
sx
, 
sy
);

271 
i
 = 0; i <ð
NQ
-1; i++) {

272 
	`´štf
("%3d %15.0f\n", 
i
, 
q
[i]);

275 
	`c_´št_»suÉs
("EP", 
CLASS
, 
M
+1, 0, 0, 
n™
, 
Áh»ads
,

276 
tm
, 
MÝs
,

278 
v”if›d
, 
NPBVERSION
, 
COMPILETIME
,

279 
CS1
, 
CS2
, 
CS3
, 
CS4
, 
CS5
, 
CS6
, 
CS7
);

281 ià(
TIMERS_ENABLED
 =ð
TRUE
) {

282 
	`´štf
("TÙ®ime: %f", 
	`tim”_»ad
(1));

283 
	`´štf
("GaussŸÀ·œs: %f", 
	`tim”_»ad
(2));

284 
	`´štf
("Rªdom‚umb”s: %f", 
	`tim”_»ad
(3));

286 
	}
}

	@npbparams.h

9 
	#PROBLEM_SIZE
 5

	)

10 
	#NITER_DEFAULT
 10

	)

11 
	#DT_DEFAULT
 0.010

	)

12 
	#CONVERTDOUBLE
 
FALSE


	)

13 
	#COMPILETIME
 "21 S• 2020"

	)

14 
	#NPBVERSION
 "3.0 sŒuùu»d"

	)

15 
	#CS1
 "cc"

	)

16 
	#CS2
 "cc"

	)

17 
	#CS3
 "ÒÚe)"

	)

18 
	#CS4
 "-I../commÚ"

	)

19 
	#CS5
 "-O3 "

	)

20 
	#CS6
 "ÒÚe)"

	)

21 
	#CS7
 "¿nddp"

	)

	@../common/npb-C.h

4 #iâdeà
_NPB_C_H_


5 
	#_NPB_C_H_


	)

9 
	~<Çutžus/Çutžus.h
>

18 
	tboÞ—n
;

19 ¡ruù { 
	m»®
; 
	mimag
; } 
	tdcom¶ex
;

21 
	#TRUE
 1

	)

22 
	#FALSE
 0

	)

24 
	#max
(
a
,
b
è((×è> (b)è? (aè: (b))

	)

25 
	#mš
(
a
,
b
è((×è< (b)è? (aè: (b))

	)

26 
	#pow2
(
a
è(×)*×))

	)

28 
	#g‘_»®
(
c
èc.
»®


	)

29 
	#g‘_imag
(
c
èc.
imag


	)

30 
	#ÿdd
(
c
,
a
,
b
è(c.
»®
 =‡.»® + b.»®, c.
imag
 =‡.imag + b.imag)

	)

31 
	#csub
(
c
,
a
,
b
è(c.
»®
 =‡.»® - b.»®, c.
imag
 =‡.imag - b.imag)

	)

32 
	#cmul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b.»® -‡.
imag
 * b.imag, \

33 
c
.
imag
 = 
a
.
»®
 * 
b
.imag +‡.imag * b.»®)

	)

34 
	#ümul
(
c
,
a
,
b
è(c.
»®
 =‡.»® * b, c.
imag
 =‡.imag * b)

	)

36 
¿ndlc
(*, );

37 
v¿Æc
(, *, , *);

38 
tim”_þ—r
();

39 
tim”_¡¬t
();

40 
tim”_¡Ý
();

41 
tim”_»ad
();

43 
c_´št_»suÉs
(*
Çme
, 
þass
, 
n1
, 
n2
,

44 
n3
, 
n™”
, 
Áh»ads
, 
t
,

45 
mÝs
, *
Ýty³
, 
·s£d_v”ifiÿtiÚ
,

46 *
Åbv”siÚ
, *
compž‘ime
, *
cc
,

47 *
þšk
, *
c_lib
, *
c_šc
,

48 *
cæags
, *
þškæags
, *
¿nd
);

	@../math/nas_math.h

2 #iâdeà
_NAS_MATH_H_


3 
	#_NAS_MATH_H_


	)

5 
	~<Çutžus/Çutžus.h
>

6 
	~"log/Çs_log.h
"

7 
	~"pow/Çs_pow.h
"

8 
	~"exp/Çs_exp.h
"

9 
	~"sšcos/Çs_sšcos.h
"

13 
šlše
 
	$sq¹
(
x
)

15 
»t
;

16 
asm
 volatile(

20 : "ô"(
»t
)

21 : "g"(
x
)

24  
»t
;

25 
	}
}

27 
	#çbs
(
x
è
	`__bužtš_çbs
(x)

	)

	@
1
.
1
/usr/include
4
54
ep.c
npbparams.h
../common/npb-C.h
../math/nas_math.h
